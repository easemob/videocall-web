{"version":3,"sources":["../../websdk/packages/emedia/pannel/src/components/MouseTrigger.js","../../websdk/packages/emedia/webrtc/src/components/_Stream.js","../../websdk/packages/emedia/pannel/src/components/MouseTrack.js","../../websdk/packages/emedia/webrtc/src/components/Session.js","../../websdk/packages/emedia/webrtc/src/components/mgr/DeployMore.js","../../websdk/packages/emedia/webrtc/src/components/Attendee.js","../../websdk/packages/emedia/webrtc/src/components/_Webrtc.js","../../websdk/packages/emedia/webrtc/src/components/PCStats.js","../../websdk/packages/emedia/pannel/src/components/DefaultTrack.js","pages/room/whiteboardsSdk.js","../../websdk/packages/emedia/webrtc/src/_adapter/_Adapter.import.js","../../websdk/packages/emedia/webrtc/src/_adapter/adapter-7.6.1.js","../../websdk/packages/emedia/webrtc/src/components/Service.js","../../websdk/packages/emedia/webrtc/src/components/_Member.js","../../websdk/packages/emedia/webrtc/src/_adapter/SoundMeter.js","../../websdk/packages/emedia/webrtc/src/components/EventHandler.js","../../websdk/packages/emedia/webrtc/src/components/_Desktop.js","../../websdk/packages/emedia/webrtc/src/components/AddonsP2P.js","../../websdk/packages/emedia/webrtc/src/components/mgr/EventsObservable.js","../../websdk/packages/emedia/webrtc/src/components/pannelVideo.js","../../websdk/packages/emedia/pannel/src/components/Mouse.js","../../websdk/packages/emedia/pannel/src/components/Keyboard.js","../../websdk/packages/emedia/pannel/src/components/TotalBuffer.js","../../websdk/packages/emedia/pannel/src/components/EventBuffer.js","../../websdk/packages/emedia/pannel/src/components/TrackBuffer.js","../../websdk/packages/emedia/webrtc/src/components/CompositeCanvas.js","../../websdk/packages/emedia/pannel/src/components/KeyboardTrack.js","../../websdk/packages/emedia/webrtc/src/components/electron.js","assets/images sync /^/.//.*/.png$","assets/images/admin-icon.png","assets/images/admin-small-icon.png","../../websdk/packages/emedia/webrtc/src/components/event.js","assets/images/apply-icon.png","assets/images/apply-to-audience-icon.png","assets/images/apply-to-talker-icon.png","assets/images/audio-is-close-icon.png","assets/images/close-handle-icon.png","assets/images/destory-white-board-icon.png","assets/images/expand-icon.png","assets/images/invite-icon.png","assets/images/is-speak-icon.png","assets/images/join-white-board-icon.png","assets/images/leave-icon.png","assets/images/login-bg.png","assets/images/logo-text-login.png","assets/images/logo-text-room.png","assets/images/logo.png","assets/images/micro-is-close-icon.png","assets/images/micro-is-open-icon.png","assets/images/mute-all-icon.png","assets/images/no-speak-icon.png","assets/images/room-setting-close-icon.png","assets/images/room-setting-open-icon.png","assets/images/setting-icon.png","assets/images/share-desktop-icon.png","assets/images/stop-share-desktop-icon.png","assets/images/unmute-all-icon.png","assets/images/video-icon.png","assets/images/video-is-close-icon.png","assets/images/video-is-open-icon.png","assets/images/volume-0.png","assets/images/volume-1.png","assets/images/volume-10.png","assets/images/volume-11.png","assets/images/volume-12.png","assets/images/volume-13.png","assets/images/volume-14.png","assets/images/volume-2.png","assets/images/volume-3.png","assets/images/volume-4.png","assets/images/volume-5.png","assets/images/volume-6.png","assets/images/volume-7.png","assets/images/volume-8.png","assets/images/volume-9.png","assets/images/warning-icon.png","../../websdk/packages/emedia/webrtc/src/entry.js","api/ajax.js","config.js","api/index.js","pages/room/login.js","pages/room/room.jsx","App.js","index.js","../../websdk/packages/emedia/webrtc/src/components/mgr/UploadStats.js","../../websdk/packages/emedia/webrtc/src/components/mgr/Manager.js","../../websdk/packages/emedia/webrtc/src/components/mgr/outer.js","../../websdk/packages/emedia/webrtc/src/components/Util.js"],"names":["_util","require","BTN","tagLogger","LEFT","WHEEL","RIGHT","WHEEL_ROLL_UP","WHEEL_ROLL_DOWN","KEY_UP","KEY_DOWN","MOVE","KEYBOARD_DOWN","KEYBOARD_UP","module","exports","prototypeExtend","_timeoutMillis","_time","Date","getTime","isKeyup","this","oper","isKeydown","isWheelup","btn","isWheeldown","isLeftKey","isRightKey","isWheelKey","isWheelRoll","timeout","_toString","list","xy","x","y","join","SoundMeter","emedia","subscribed","stream","_located","type","_webrtc","undefined","MediaSoundMeter","voff","aoff","__init__","self","_mediaStream","_logger","error","hasEnabledTracks","__audioContext","__soundMeter","connectToSource","e","__worked","mediaStream","getSoundMeters","active","instant","slow","clip","_finally","stop","__undefinedEQDelete","Update","ifAoff","update","if","ifVoff","ifMediaStream","key","located","webrtc","getMediaStream","_localMediaStream","getRemoteStream","getLocalStream","requestFrame","getVideoTracks","forEach","track","getLocalMediaStream","getRemoteMediaStream","mutedNeed","mutedMuted","updateAttributes","i","arguments","length","arg","isPlainObject","_key","_value","getHtmlDOMID","owner","id","StreamSoundMeter","_stream","_streamId","_streamCreateId","__create_id","__mediaSoundMeter","useCount","onSoundMeters","callback","emptyResult","subArgs","subSAudio","audioReceiver","receivers","getReceiversOfPeerConnection","kind","getContributingSources","source","rtpContributingSources","config","_printSoundData","logger","debug","csrc","_meter","meterWithTrackAudioLevel","closed","_rtcPeerConnection","getStats","then","stats","size","res","trackIdentifier","trackAudioLevel","audioLevel","trackTotalAudioEnergy","totalAudioEnergy","_remoteMediaSoundMeters","MouseTrigger","_scale","getTargetPageXY","_target","extend","getDomPageRect","onMouseTrack","position","lastPosition","lastTrigger","onMouseTrigger","trigger","_lastTrigger","_onMouseTrack","_onMouseTrigger","pos","pageXY","_elementPageXY","_calPosition","pageX","pageY","_lastPageXY","releaseTrigger","onReleaseTrigger","mousePos","_referenceVideo","Service","prototype","eventXYAtVideo","call","isFloat","width","height","isInt","Math","floor","__event","__url_seqno","DeployMore","default","Message","setSessId","sessId","setOp","op","clientType","ver","window","_emediaVersion","version","agent","userAgent","ops","acptOps","setTsxId","tsxId","setTicket","tkt","setSdp","sdp","setCands","cands","setSubSId","subSId","setMemId","memId","setPubS","pubS","thisPubS","ext","JSON","stringify","value","removeAttribute","setRtcId","rtcId","setCver","cver","setEndReason","endReason","setNickName","nickName","setResource","resource","setReason","reason","setConfrId","confrId","setVoff","setAoff","setFlag","flag","setExt","__session_globalCount","_connect","onConnected","onConnectFail","retry","connectFail","cause","_evt","onWebsocketEvent","WSClose","url","thisWsUri","online","event","session","post","message","connected","warn","wsMsg","_websocket","send","info","notifyNewMessage","_bufferedMessages","bufferedMessage","__array","shift","_bufferedMessage","push","Array","apply","_messageMap","_callbacks","tmp","msg","onMessage","result","readyState","close","WebSocket","onopen","evt","_url","WSConnected","onmessage","data","parse","onclose","code","onerror","WSError","_events","navigator","onLine","addEventListener","_reconnect","reconnect","__checkConnectIntervalId","clearTimeout","__retryConnectIntervalId","_nextWsUri","ticket","useDeployMore","mgr","rtc_url_config","rtcConfigUrl","replace_ws","replaceFunc","convertWebsocketURLOfTicket","oldUrl","startsWith","wsorigin","href","location","proto","startIndex","indexOf","endIndex","substring","enter","newMessage","_sessionId","memName","postMessage","rsp","onEvent","EnterSuccess","ip","onMembers","mems","onStreams","streams","EnterFail","me","RspFail","request","response","ServerRefuseEnter","failed","connect","setTimeout","reconnectDelay","__checkConnect","checkConnectIntervalMillis","nextUrl","wsUri","OPEN","register","listeners","bind","func","onFunc","getSessionId","cfg","__modifyMessage","parseJSON","toLowerCase","cctx","sdpMLineIndex","mlineindex","sdpMid","mid","isArray","_mems","index","_mem","name","baseAcptOps","_index","_oper","mem","_streams","servMessage","fun_name","onFunCallback","op2","onRequestToTalkerReply","onRequestToAdminReply","preIp","reqMessage","nowIp","yourIp","_session_ip","cattrs","cstate","onConfrAttrsUpdated","getMemberId","RecvResponse","__callback__","NetworkChanaged","__modifyMessageForPost","_cands","_cand","candidate","_sdp","toUpperCase","stringifyJSON","timeoutMillis","console","log","now","_cacheMembers","is_action_message","reqOps","_reqOps","_reqOp","oldMessage","unshift","enterTimeout","seqno","rtcconfig","get_rtcconfig","option","async","_this","$","ajax","success","Object","keys","ws","new_url","replace","_get_info_from_candifate","split","port","_can_replace","dst_obj","src","min_port","max_port","_replace_candidate","ip_and_port","rtc","candidate_map","map","item","new_ip","dst","port_difference_value","Number","new_port","cands_arr","replace_candidates","candidates","replace_trun_url","rtcCfg","turn","iceServers","new_turn","Member","Stream","Attendee","_session","sessionFactory","_cver","_cacheStreams","_streamAutomators","_mediaMeters","_openedRtcMediaStreams","_linkedStreams","_maybeNotExistStreams","_records","_ices","audioMixers","_nextStreamSeqno","getMediaMeterIntervalMillis","getCurrentMembers","members","_memId","_cacheMember","member","newStream","attendee","getRtcId","getConfrId","isCaller","isP2P","caller","isCallee","callee","isConfr","joined","joinError","requireTrustBeforeJoin","someBrowsersRequireGetUserMedia","_join","_memberId","onJoinError","_event_","enterRsp","reflushSupportVCodes","vcodes","setMemberId","role","__rtc_cfg","withpublish","localStream","openedStream","stopTracks","closeWebrtc","optimalVideoCodecs","getOptimalVideoCodecs","streamId","sysUserId","extObj","useIp","PushSuccess","hidden","ansC","tcklC","_service","_republish","offerOptions","offerToReceiveAudio","offerToReceiveVideo","subSVideo","createWebrtc","_rtcId","vbitrate","constaints","video","bitrate","abitrate","audio","iceRebuildCount","setLocalStream","doOffer","pushed","onPushError","autoPush","initC","_onPushError","PushFail","allowRepeatAudioMixerPublish","hasAudioMixers","pub","AudioMixerStreamRepeatPublish","pushRsp","retrying","resolution","w","exact","min","h","isSafari","successOpenMedia","failOpenMedia","youInSomeBrowsers","_yetGetUserMedia","__tryingOpenMedia","__tryingOpenMediaWaitSuceess","__tryingOpenMediaWaitFail","_user","__getUserMedia","createWebrtcAndSubscribeStream","callbacks","iceServerConfig","subStream","subMember","_onSubFail","preSubArgs","setSubArgs","SubFail","_onSubSuccess","pubStreamVCodes","pubMemberSupportVCodes","selfSupportVCodes","supportVCodes","_getOptimalVideoCodecsSubset","withoutVideo","createWebrtcAndInit","onGotMediaStream","remoteMediaStream","onGotRemote","offerCall","_orderVCodes","sVCode","subscribeStream","rspFail","onSub","subMessage","SubSuccess","_updateRemoteStream","unsubscribeStream","unsubMessage","onEnter","_tmpMap","vcode","onAddMember","_onFinally","openedMediaStreams","_openStream","_onRoleUpdate","roleToken","onRoleUpdate","onExit","rmMember","_onRemoveMember","Hangup","parnter","onMeExit","onPub","sver","onStreamControl","_onRepublishStream","_onAddStream","autoSub","onUnpub","sId","rmStream","_onRemovePubstream","onClose","onConfrClose","__getWebrtcFor","pubStreamId","_getWebrtc","enableAudioTracks","enableVideoTracks","_remoteStream","onUpdateStream","__id","subs","assign","__safari_subs","splice","_aoff","streamControl","_voff","startRecord","stopRecord","removedMembers","_member","addMembers","removedStreams","_pubSId","addStreams","unpubStreams","onRemoveMember","onAddStream","soundMeter","remotePlayAudioObject","document","body","removeChild","closeReason","_monitSoundChanagedStreams","onRemoveStream","finallyDo","_onRecvRemoteMessage","fromMemId","args","argsObject","fromMember","onRecvRemoteMessage","_onSoundChanage","meterData","toFixed","logVolumeWhenInstantGE","onSoundChanage","_judgeTalking","onTalking","_sendRequestMessage","admin_memberId","Role","ADMIN","get_admin_memberId","my_memberId","post_message","tsxTime","requestToTalker","_send_action_request_message","applicant_memberId","refuseRequestToTalker","refuseRequestToAdmin","requestToAdmin","_sendControlAudioMessage","memberId","muteBymemberId","unmuteBymemberId","SDPUtils","_SDPSection","headerSection","audioSection","videoSection","_parseHeaderSection","audioIndex","videoIndex","slice","_parseAudioSection","_parseVideoSection","spiltSection","_preSDP","_preAudioIndex","_preVideoIndex","setVideoBitrate","setBitrate","setVideoMinBitrate","minBitrate","setAllFmtpBitrate","setVideoMaxBitrate","maxBitrate","setVideoStartBitrate","startBitrate","fields","fmtpName","field","regex","RegExp","all","fmtp","fieldAndRegex","replacedFmtp","$$","$1","$2","$3","endsWith","setFmtpBitrate","setAudioBitrate","setBitrate0","section","bandwidth","modifier","isFirefox","updateVideoSection","regx","updateAudioSection","updateVideoSendonly","updateVideoRecvonly","updateAudioSendonly","updateAudioRecvonly","updateACodes","acodes","arr","vcodeMap","_parseLine","codeNum","numCodes","supportVCode","codeLineLastIndex","codeLine","newNumCodes","_map","ele","updateVCodes","h264_arr","removeSSRC","_arr","removeField_msid","updateHeaderMsidSemantic","wms","line","updateAudioSSRCSection","ssrc","cname","msid","label","ssrcSection","updateVideoSSRCSection","getUpdatedSDP","audioVideo","videoMid","audioMid","match","p1","bundleLine","parseMsidSemantic","header","msidSemantic","WMS","parseSSRC","regexp","lines","updateSSRCSection","str","exec","SDPSection","webrc","isAudioVideo","isVideoPreAudio","__rtc_globalCount","_WebRTC","sdpConstraints","optimalAudioCodecs","__setRemoteSDP","__tmpRemoteCands","__tmpLocalCands","forceUseVideoCodecs","forceUseAudioCodecs","forceVideoBitrate","forceMinVideoBitrate","vminBitrate","forceAudioBitrate","iceState","iceConnectionState","getReceivers","updateRemoteBySubArgs","createRtcPeerConnection","isEdge","rtcpMuxPolicy","bundlePolicy","relayOnly","iceTransportPolicy","reconfigRTCConfiguration","rtcPeerConnection","RTCPeerConnection","stateChange","connectionState","theState","lastIceConnectionState","onIceStateChange","__peerId","onicecandidate","protocol","test","_onIceCandidate","onconnectionstatechange","onicestatechange","oniceconnectionstatechange","onsignalingstatechange","signalingState","ontrack","_onTrack","onaddstream","_onGotRemoteStream","addTrack","tracks","_localStream","getTracks","enabled","addStream","videoTracks","audioTracks","getAudioTracks","removeStream","createOffer","onCreateOfferSuccess","onCreateOfferError","offerOptions_changeless","desc","offerDescription","fireFoxOfferVideoPreAudio","__offerVideoPreAudio","sdpSection","useDTX","num","setLocalDescription","_onSetLocalSessionDescriptionSuccess","_onSetSessionDescriptionError","_onCreateSessionDescriptionError","createPRAnswer","onCreatePRAnswerSuccess","onCreatePRAnswerError","createAnswer","__prAnswerDescription","onCreateAnswerSuccess","onCreateAnswerError","supportPRAnswer","ms","audioSSRC","videoSSRC","updateSDP","__answerDescription","_printStats","confrAttendee","remainLastStatsCount","_printTrackStats","trackStats","_trackStats","typeStats","subType","curIndex","stat","timestamp","toLocaleString","remainLocalStream","onlyPeerConnectionClosed","retryBuild","__iceWaitIntervalId","remoteStream","closePC","printStatsWhenPCClose","addIceCandidate","reChanageCandidate","candsChanaged","newCandidates","_addIceCandidate","oldLineIndex","parseInt","RTCIceCandidate","onAddIceCandidateSuccess","_onAddIceCandidateError","setRemoteDescription","_setRemoteDescription","__remoteDescription","RTCSessionDescription","_onSetRemoteSuccess","isConnected","state","__rtc_c_id","onGotRemoteStream","onSetRemoteSuccess","_onAnswerCodes","rtpParams","parseRtpParameters","codecs","_i","_param","finalVCodeChoices","onVCodeChoices","toString","onAddIceCandidateError","onIceCandidate","offerOptionsOrSDPConstraints","onCreateSessionDescriptionError","onSetSessionDescriptionError","iceWaitBuildMillis","onSetLocalSessionDescriptionSuccess","onCallback","rtcStatsTypeMath","_stat","PCStats","samplesDatas","gatherResults","_bysamples","_inbound_","_outbound_","_onGatherResult","trackId","subtype","current","subTypeStats","onGatherResult","selector","statsOfTrack","MediaStreamTrack","audioTrack","videoTrack","gatherTrack","mediaType","_stats","statsParms","samplings","statMediaType","_printDebugStats","items","packetsLost","packetsReceived","gatherWebrtcMediaStream","gatherWebrtc","_gather_inbound_rtp_packageLossRate","dataArray","sum","count","predata","packageLossRate","statsSeconds","_gatherBytesRate","time","parseFloat","_gather","_statsCount","_samples","trackGathers","_trackSamples","_data","typeGathers","gatherBySubtype","gatherByType","gather","intervalGather","intervalMillis","_intervalId","clearInterval","setInterval","stopIntervalGather","statsMap","echo","hxStreams","_k","pcstats","clearStats","_sid","intervalEcho","_typeIndex","gatherType","_trackTypeIndex","trackType","hxStream","onNotify","service","__intervalIds","XService","useCurrentXService","namespace","intervalId","cacheStream","getStreamById","DefaultMouseTrack","MouseTrack","_canvas","createElement","appendChild","style","cssText","offsetWidth","offsetHeight","initCanvas","_canvasContext","getContext","resizeCanvas","_draw","pixelCount","r","g","b","alpha","canvasContext","pixel","getImageData","imageData","rgb","color","putImageData","redraw","draw","EMPTYFN","_xmlrequest","crossDomain","temp","XMLHttpRequest","_createStandardXHR","ActiveXObject","_createActiveXHR","XDomainRequest","xhr","status","onreadystatechange","onload","xmlDoc","loadXML","responseText","responseXML","ontimeout","102","error_code","error_msg","10","15","20","25","30","35","40","45","50","99","_ajax","options","dataType","suc","json","requireNonComma","depth","utils","trim","token","comma","open","Function","_parseJSON","documentElement","responseType","mimeType","hasOverrideMimeType","overrideMimeType","tempData","o","hasOwnProperty","setRequestHeader","headers","whiteBoards","restApi","appKey","orgName","appName","dnsArr","dnsIndex","restIndex","restHosts","getRestFromHttpDNS","host","domain","apiUrl","getHttpDNS","options2","app_key","encodeURIComponent","rest","hosts","httpType","currentPost","create","_create","sucFun","errFun","err","opts","userId","userName","whiteBoardName","roomName","password","joinByRoomName","_joinByRoomName","joinByRoomId","_joinByRoomId","roomId","destroy","_destroy","adapter","singleWebrtcAdapter","util","documentMode","hasMatch","webrtcDetectedVersion","__browser","__browserVersion","_attachMediaStream","element","srcObject","pause","play","muted","volume","hxSetOnvolumechange","preonvolumechange","onvolumechange","hxSetOnstalled","preonstalled","onstalled","hxSetOnabort","preonabort","onabort","hxSetOncanplay","preOncanplay","oncanplay","getSettings","videoWidth","videoHeight","attachMediaStream","_wrapped","__attachMediaStream","_fun","mute","wrapAttachMediaStream","requireWebrtcAdapter","browserDetails","browser","n","t","f","u","a","Error","p","1","adapterFactory","2","defineProperty","_ref","shimChrome","shimFirefox","shimEdge","shimSafari","logging","detectBrowser","commonShim","extractVersion","disableLog","disableWarnings","chromeShim","shimPeerConnection","browserShim","shimGetUserMedia","shimMediaStream","shimOnTrack","shimAddTrackRemoveTrack","shimGetSendersWithDtmf","shimGetStats","shimSenderReceiverGetStats","fixNegotiationNeeded","shimRTCIceCandidate","shimConnectionState","shimMaxMessageSize","shimSendThrowTypeError","removeAllowExtmapMixed","firefoxShim","shimRemoveStream","shimSenderGetStats","shimReceiverGetStats","shimRTCDataChannel","shimAddTransceiver","shimCreateOffer","shimCreateAnswer","edgeShim","shimGetDisplayMedia","shimReplaceTrack","safariShim","shimRTCIceServerUrls","shimCreateOfferLegacy","shimCallbacksAPI","shimLocalStreamsAPI","shimRemoteStreamsAPI","shimTrackEventTransceiver","shimAudioContext","_interopRequireWildcard","obj","__esModule","newObj","3","_typeof","Symbol","iterator","constructor","_getusermedia","enumerable","get","_getdisplaymedia","MediaStream","webkitMediaStream","_ontrack","set","removeEventListener","configurable","origSetRemoteDescription","_ontrackpoly","te","receiver","find","Event","transceiver","dispatchEvent","wrapPeerConnectionEvent","shimSenderWithDtmf","pc","_dtmf","createDTMFSender","_pc","getSenders","_senders","origAddTrack","sender","origRemoveTrack","removeTrack","idx","origAddStream","_this2","origRemoveStream","_this3","s","RTCRtpSender","origGetSenders","_this4","senders","origGetStats","_this5","_arguments","onSucc","onErr","fixChromeStats_","standardReport","report","standardStats","localcandidate","remotecandidate","names","makeMapStats","Map","successCallbackWrapper_","Promise","resolve","reject","RTCRtpReceiver","_this6","filterStats","origGetReceivers","_this7","srcElement","DOMException","shimAddTrackRemoveTrackWithNative","origGetLocalStreams","getLocalStreams","_this11","nativeStreams","_reverseStreams","_this12","_this13","alreadyExists","oldStream","method","nativeMethod","methodObj","_defineProperty","_this14","isLegacyCall","description","replaceInternalStreamId","origSetLocalDescription","replaceExternalStreamId","origLocalDescription","getOwnPropertyDescriptor","_this15","streamid","internalId","externalStream","internalStream","webkitRTCPeerConnection","addIceCandidateNullSupported","nativeAddIceCandidate","target","getConfiguration","sdpSemantics","writable","_this8","_shimmedLocalStreams","_this9","existingSenders","newSenders","filter","newSender","concat","_this10","4","getSourceId","mediaDevices","getDisplayMedia","constraints","sourceId","widthSpecified","heightSpecified","frameRateSpecified","frameRate","mandatory","chromeMediaSource","chromeMediaSourceId","maxFrameRate","maxWidth","maxHeight","getUserMedia","5","constraintsToChrome_","c","optional","cc","ideal","max","oldname_","prefix","charAt","oc","mix","advanced","shimConstraints_","remap","face","facingMode","getSupportedFacingModeLies","getSupportedConstraints","matches","enumerateDevices","devices","dev","d","some","includes","deviceId","shimError_","PermissionDeniedError","PermissionDismissedError","InvalidStateError","DevicesNotFoundError","ConstraintNotSatisfiedError","TrackStartError","MediaDeviceFailedDueToShutdown","MediaDeviceKillSwitchOn","TabCaptureError","ScreenCaptureError","DeviceCaptureError","constraint","constraintName","onSuccess","onError","webkitGetUserMedia","origGetUserMedia","cs","6","NativeRTCIceCandidate","substr","nativeCandidate","parsedCandidate","_sdp2","parseCandidate","augmentedCandidate","toJSON","usernameFragment","_sctp","sctpInDescription","sections","splitSections","mediaSection","mLine","parseMLine","getRemoteFirefoxVersion","getCanSendMaxMessageSize","remoteIsFirefox","canSendMaxMessageSize","getMaxMessageSize","maxMessageSize","matchPrefix","_getConfiguration","canSendMMS","remoteMMS","POSITIVE_INFINITY","sctp","origCreateDataChannel","createDataChannel","dataChannel","wrapDcSend","channel","dc","origDataChannelSend","byteLength","TypeError","completed","checking","_onconnectionstatechange","cb","origMethod","_connectionstatechangepoly","_lastConnectionState","newEvent","nativeSRD","7","RTCIceGatherer","origMSTEnabled","ev","RTCDtmfSender","RTCDTMFSender","RTCPeerConnectionShim","_rtcpeerconnectionShim2","_filtericeservers","filterIceServers","replaceTrack","setTrack","_rtcpeerconnectionShim","8","edgeVersion","hasTurn","server","urls","deprecated","isString","validTurn","9","catch","11","RTCTrackEvent","mozRTCPeerConnection","modernStatsTypes","inboundrtp","outboundrtp","candidatepair","nativeGetStats","DataChannel","RTCDataChannel","origAddTransceiver","addTransceiver","setParametersPromises","initParameters","shouldPerformCheck","sendEncodings","encodingParam","rid","scaleResolutionDownBy","RangeError","maxFramerate","params","getParameters","encodings","setParameters","origCreateOffer","_arguments2","finally","origCreateAnswer","_arguments3","12","preferredMediaSource","mediaSource","13","nativeGetUserMedia","nativeGetSettings","applyConstraints","nativeApplyConstraints","14","_localStreams","_addTrack","_len","getRemoteStreams","_remoteStreams","_onaddstream","_onaddstreampoly","successCallback","failureCallback","promise","withCallback","_getUserMedia","shimConstraints","errcb","OrigPeerConnection","pcConfig","pcConstraints","newIceServers","generateCertificate","audioTransceiver","getTransceivers","direction","setDirection","videoTransceiver","AudioContext","webkitAudioContext","compactObject","eventNameToWrap","wrapper","nativeAddEventListener","nativeEventName","wrappedCallback","modifiedEvent","_eventMap","nativeRemoveEventListener","unwrappedCb","bool","logDisabled_","deprecationWarnings_","oldMethod","newMethod","mozGetUserMedia","isSecureContext","supportsUnifiedPlan","RTCRtpTransceiver","isObject","reduce","accumulator","isObj","isEmptyObject","walkStats","outbound","streamStatsType","filteredResult","trackStat","uastring","expr","val","base","resultSet","has","16","writeMediaSection","caps","dtlsRole","writeRtpDescription","writeIceParameters","iceGatherer","getLocalParameters","writeDtlsParameters","dtlsTransport","rtpSender","rtpReceiver","_initialTrackId","sendEncodingParameters","rtx","localCName","getCommonCapabilities","localCapabilities","remoteCapabilities","commonCapabilities","headerExtensions","fecMechanisms","findCodecByPayloadType","pt","payloadType","preferredPayloadType","rtxCapabilityMatches","lRtx","rRtx","lCodecs","rCodecs","lCodec","parameters","apt","rCodec","clockRate","numChannels","rtcpFeedback","fb","j","parameter","lHeaderExtension","rHeaderExtension","uri","isActionAllowedInSignalingState","action","offer","answer","maybeAddCandidate","iceTransport","alreadyAdded","getRemoteCandidates","remoteCandidate","foundation","priority","addRemoteCandidate","makeError","NotSupportedError","InvalidAccessError","OperationError","addTrackToStreamAndFireEvent","MediaStreamTrackEvent","fireAddTrack","trackEvent","_dispatchEvent","_eventTarget","createDocumentFragment","canTrickleIceCandidates","needNegotiation","localStreams","remoteStreams","_localDescription","_remoteDescription","iceGatheringState","usingBundle","_iceGatherers","iceCandidatePoolSize","gatherPolicy","_config","transceivers","_sdpSessionId","generateSessionId","_sdpSessionVersion","_dtlsRole","_isClosed","onremovestream","onicegatheringstatechange","onnegotiationneeded","ondatachannel","_emitGatheringStateChange","_createTransceiver","doNotAdd","hasBundleTransport","recvEncodingParameters","associatedRemoteMediaStreams","wantReceive","transports","_createIceAndDtlsTransports","_maybeFireNegotiationNeeded","clonedStream","clone","clonedTrack","_createIceGatherer","bufferedCandidateEvents","bufferCandidates","end","onlocalcandidate","cand","component","ufrag","serializedCandidate","writeCandidate","getMediaSections","getDescription","complete","every","RTCIceTransport","_updateIceConnectionState","_updateConnectionState","RTCDtlsTransport","ondtlsstatechange","_disposeIceAndDtlsTransports","_transceive","recv","rtcp","compound","rtcpParameters","receive","sessionpart","isIceLite","isRejected","rejected","remoteIceParameters","getIceParameters","remoteDtlsParameters","getDtlsParameters","start","_updateSignalingState","receiverList","iceOptions","splitLines","getKind","getDirection","remoteMsid","parseMsid","getMid","generateIdentifier","parseRtpEncodingParameters","parseRtcpParameters","isComplete","setTransport","setRemoteCandidates","getCapabilities","codec","isNewTrack","nativeTrack","removeTrackFromStreamAndFireEvent","sid","newState","states","disconnected","new","connecting","numAudioTracks","numVideoTracks","writeSessionBoilerplate","remoteCodec","hdrExt","rHdrExt","getLocalCandidates","mediaSectionsInOffer","localTrack","reducedSize","candidateString","senderOrReceiver","promises","allStats","results","ortcObjectName","nativeGetstats","nativeStats","mapStats","methods","17","random","blob","part","parts","address","relatedAddress","relatedPort","tcpType","parseIceOptions","parseRtpMap","parsed","channels","writeRtpMap","parseExtmap","writeExtmap","headerExtension","preferredId","parseFmtp","kv","writeFmtp","param","parseRtcpFb","writeRtcpFb","parseSsrcMedia","sp","colon","attribute","parseSsrcGroup","semantics","ssrcs","parseFingerprint","algorithm","fingerprints","setupType","fp","parseCryptoLine","tag","cryptoSuite","keyParams","sessionParams","writeCryptoLine","writeCryptoKeyParams","parseCryptoKeyParams","keyMethod","keySalt","lifeTime","mkiValue","mkiLength","getCryptoParameters","pwd","mline","rtpmapline","fmtps","maxptime","extension","secondarySsrc","encodingParameters","hasRed","hasUlpfec","primarySsrc","flows","encParam","codecPayloadType","fec","mechanism","remoteSsrc","rsize","mux","spec","planB","msidParts","parseSctpDescription","maxSizeLine","isNaN","sctpPort","fmt","writeSctpDescription","media","output","sessVer","sessUser","parseOLine","username","sessionId","sessionVersion","netType","addressType","isValidSDP","_","Session","EventHandler","__desktop","onExtLoaded","__Stream","urlLogLevel","parseURL","LOG_LEVEL","uuidFast","useRTCCfg","useRTCCfgIfServerReturn","inboundAudio","inboundVideo","outboundAudio","outboundVideo","_cache_receive_sessions","AVPubstream","maxVideoBitrate","maxAudioBitrate","AudioMixerPubstream","onGotRemoteMediaStream","_audioId","audioObject","querySelector","display","autoplay","playsinline","ShareDesktopPubstream","__assertCurrent","getMediaDevices","errorCallback","deviceInfos","resultDeviceInfos","deviceInfo","attachSinkId","videoObj","sinkId","setSinkId","errorMessage","_stopTracks","_enableVideoTracks","_enableAudioTracks","openUserMedia","_success","errCallback","oninactive","_onStreamInactive","onactive","_onStreamActive","_openCamera","_openSharedDesktop","getAudioStream","audioConstaints","openDesktopMedia","screenOptions","_event","OpenDesktopMedia","desktopStreamId","_me","ShareDesktopExtensionNotFound","__controlStream","_openstream","onFail","OpenMediaError","__sysGetUserMedia","_bindAttendee","_bindAttendeeId","onMediaInactive","onMediaActive","globalConstraints","audioStream","videoStream","setup","_lastSetupConfr","_lastSetupMemName","_lastSetupDate","_lastSetupTktId","tktId","__eventCalling","CurrentCalling","_Attendee","getCopyIntervalMillis","newSession","getStreamsByRtcId","getMemberById","exit","closeMyConfrIfICrtConfr","subscribe","subfail","sub","_onSub","shiftsub","next","_subfail","__subscribe","usePreRTCPeer","hasAudioTracks","hasVideoTracks","closePubstream","hungup","_hungup","onHungup","memberIdOrStreamId","fail","onRsp","theMessage","linkedStream","RemoteControlFail","torchRemote","torch","lastTorch","tor","freezeFrameRemote","freezeFrame","frz","base64Img2Blob","contentType","raw","atob","rawLength","uInt8Array","Uint8Array","charCodeAt","Blob","blob2URL","URL","createObjectURL","imagesPngContext2URL","downloadFile","fileName","content","blobs","aLink","blobUrl","download","rel","createEvent","initEvent","click","parentNode","revokeObjectURL","videoCaptureBase64Context2URL","getCaptureBase64Context","canvas","drawImage","toDataURL","captureVideo","storeLocal","filename","base64","capturePictureRemote","rspBase64Pic","pic","zoomRemote","multiples","_zoom","zoom","round","_getPosition","topValue","leftValue","offsetLeft","offsetTop","offsetParent","clientX","clientY","eventXYAtMedia","eventXY","videoTag","videoXY","mediaWidth","mediaHeight","isRadioX","isRadioY","clickXY","abs","mediaXY","getClickXY","clickEvent","scrollX","scrollLeft","scrollY","scrollTop","focusExpoRemote","_focusExpo","focus","expo","_pubS","stopAndRemoveAudioTracks","isRepublished","switchMobileCamera","preConstaints","_lastConstaints","chanageCamera","cameraIndex","_cameraIndex","videoCapabilities","device","lastDevice","deviceInfoLabel","chanageConstraints","isEqual","preConstraints","preVoff","preAoff","updateAndDisabled","oldVoff","preVideo","oldAoff","preAudio","iceing","recording","_onCapturePicture","htmlVideo","getHTMLVideo","onCapturePicture","onTcklC","onAcptC","onAnsC","onTermC","SwitchVCodes","useVCodes","SubFailNotSupportVCodes","onCallBack","onPubVideoTooMuch","onPubDesktopTooMuch","pubSId","onMems","onRemoteControl","_onRemotePannelControl","callBack","onMuted","onUnmuted","applicat_memId","onRequestToAdmin","agreeRequestToAdmin","onRequestToTalker","talker_is_full_callback","agreeRequestToTalker","cattrs_updated","target_array","array","catrrs","is_have","target_item","_item","object_to_array","onConfrStateUpdated","cstate_updated","onAdminChanged","onLivecfgsChanged","liveCfgs","meter","judgeTalkingByInstantGE","graffitiVideo","canvasTag","captureStream","resetCanvas","setAttribute","_random","millis","_cacheStream","_requestFrame","graffitiCanvas","withVoice","targetDOM","diy","setCanvas","_onpushed","_push","drawStream","blobRecorder","handleDataAvailable","handleStop","MediaRecorder","isTypeSupported","mediaRecorder","recordedBlobs","BlobRecorder","onstop","ondataavailable","secornds","playurl","superBuffer","_get_session_by_memberId_and_op_type","op_type","_delete_session_by_memberId_and_op_type","chanageRoles","WebRTC","memberCount","optimalVCode","maxSupportCount","webrtcCfg","rebuildCount","_rebuildCount","ICEConnectFail","ICEConnected","ICEClosed","ICEDisconnected","_onIceStateChange","ICERemoteMediaStream","AddIceCandError","_howDoWebrtcWhenCrtExsitsWebrtc","_iceCreateRtcPeerConnection","suceess","rtcState","ICEChanage","_initC","rspSuccess","_acptC","acptC","_ansCAndPubstream","_ansC","_termC","termC","onGotOffer","accept","answerCall","_iceSetRemoteSDP","serverClosed","_stopRecord","onWebrtcTermC","__close","__getCopyInterval","_closeMyConfr","closeConfr","_id","webrtcState","context","script","createScriptProcessor","that","onaudioprocess","input","inputBuffer","getChannelData","clipcount","sqrt","mic","createMediaStreamSource","destination","disconnect","Handler","upload_stats","upload_event","afterNotify","handleEvent","StreamState","onNotifyEvent","_onRecvResponse","onServerRefuseEnter","onNetworkChanaged","onEnterFail","onWSClose","onICEConnected","onICEConnectFail","onICEDisconnected","onICEClosed","onICERemoteMediaStream","_autoSubWhenPushStream","_removeStream","onNotSupportPublishVideoCodecs","onEnterSuccess","iceRebuild","rebuildPeerConnectionWhenNetworkChanaged","_failIcesRebuild","_sysCopy","_intervalGetMediaMeters","_start","__getMediaMetersIntervalFlag","cancelAnimationFrame","requestAnimationFrame","_flushMediaMetersByAudioContext","_updateMetersOrNewOne","delStreamSoundMeters","streamSoundMeter","pubAudioMixersStream","_oneAudioMixers","metersData","_newMediaMeters","_newAudioContext","__usingWebAudio","zeroStream","__networkWeakInterval","onNetworkWeak","problemStream","iceFail","iceRebuildIntervalMillis","removedWebrtc","webrtc22","_recordStream","rebuildIce","copyMessage","__shareDesktopMessageCount__","__RTC_PAGE_MSG_TYPE__","__RTC_EXT_MSG_TYPE__","__extLoaded","rsdExtLoaded","__onRsdExtLoad","exist","evname","__onMessage","existele","getElementById","isElectron","__sendMessage","openDesktopMediaInElectron","m","OpenDesktopMediaAccessDenied","getSourcesOptions","types","thumbnailSize","electron","desktopCapturer","getSources","sources","chooseElectronDesktopMedia","hxThumbDataURL","thumbnail","desktopCapturerSource","forceUseRTCCfgIfServerReturnWhenP2P","preOnTermC","preOnAnsC","onInitC","rejectAnswer","callerPub","sortedStreams","sort","OtherDeviceAnswer","__cache_","answered","ansCMember","addonsService","NewSession","_sentMessage","_cached_","cacheMessage","selfId","onP2PMessage","addonsSession","extIceRebuild","answerWebrtc","cacheMessages","_tmp","preWebrtc","__lastCalleePub","calleePub","channelSet","addonsAttendee","init","observerOrNext","subject","_onExit","onMemberJoin","addMemName","addMemId","onMemberLeave","removeMemName","removeMemId","onRemoteStream","streamBindVideo","_onAddMemberStream","streamType","confr","_confr","av","desktop","_videos","_onRemoveMemberStream","unloadVideo","hasAttribute","onMediaTransmission","zepto","_onMemberMediaChanaged","_onUpdateMemberStream","_onNotSupportMemberPublishVideoCodecs","_onMemberSoundChanaged","_onTalking","_confrs","AUDIENCE","_onRoleUpdated","_onStreamIceStateChanged","EventsObservable","Subject","Mouse","Keyboard","TotalBuffer","overrideOnRemoveMember","_overrideCount","overrideObj","override","overrideService","remoteControls","selectRemoteControlByMemId","ctrl","_ctrlStream","_controller","_free","onRemoteFreeControl","_cId","overrideOnRemoveStream","doCleanAfterStreamClose","disControlled","controls","getRemoteControl","control","__remoteControls","overrideOnHungup","overrideOnRemotePannelControl","handlePannelRemoteMessage","codeCtrlMessage","actions","sn","cId","remoteControlSeqno","RemoteControl","mouseTrack","keyboard","hasOtherControl","busy","preAcpt","preRemoteControls","preRC","controlling","rspRemoteControl","_reqevt","other","forceDisconnect","remoteControl","notAllowControl","controllerMemId","_remoteControlId","_remoteControl","controller","mouse","decodeCtrlMessage","ctrls","onHasRemoteControl","recvRemoteControl","__ctrl","_lastRecvTimestamp","triggers","maxSN","elem","onKeyDown","onKeyUp","onMouseEnter","videoTarget","_onMouseEnter","onCallbacks","onMouseExit","_onMouseExit","onMouseMove","_onMouseMove","sendPannelMessage","onMouseButton","_onMouseButton","onKeyboard","_onKeyboard","_buffer","__pannelBuffers","preUnclearSize","getUnclearSize","put","allowSendWhenLessThan","_getAndSend","evts","getUnread","_maxSN","clearRead","onNotAllowRemoteControl","_lastRspTimestamp","onRemoteControlTimeout","onBusy","onReject","buffer","__pannelMouses","__pannelKeyboards","ungrab","onDisControlled","messge","reqControlled","mirror","maskTarget","openKeyboard","_focused","grab","disableTrack","trackBufferSize","onKeyPress","keyValue","isPressed","_controlled","onAccept","__mouseTrack","checkTimeout","buffers","timeoutId","ctrlCheckIntervalMillis","ctrlId","ctrlTimeoutMillis","mirrorControlled","_func","controlled","graffiti","maskTag","referenceVideo","echoControl","disEchoControl","support","getController","_handlers","mousedown","_handleMouseDown","mouseup","_handleMouseUp","mousemove","_handleMouseMove","mousewheel","_handleMouseWheel","mousedisable","_handleMouseDisable","mouseover","_handleMouseOver","mouseout","_handleMouseOut","button","_captureMouse","setCapture","_mouseCaptured","_releaseMouse","releaseCapture","_resetDoubleClickTimer","_doubleClickTimer","_mouseExit","_handleMouseButton","getEventElementXY","wheel","detail","wheelDelta","stopEvent","realX","realY","touches","changedTouches","_lastTouchPos","distanceX","distanceY","devicePixelRatio","which","addEvent","layoutEngine","gecko","removeEvent","_eventHandlers","keyup","_handleKeyUp","keydown","_handleKeyDown","keypress","_handleKeyPress","blur","_allKeysUp","getKey","keyCode","_onKeyPress","_handleRfbEvent","shiftKey","ctrlKey","altKey","ascii","sync","EventBuffer","TrackBuffer","_trackBufferCompRadio","_sn","_eventBuffer","_nextsn","_trackBuffer","_compRadio","mouseTrackBufferSize","getUnread1","sortby","events","_getUnread","getUnreadSize","limitSN","_beginIndex","_readIndex","_endIndex","_mouseTrackBuffer","comp1","compRadio","span","_nextIndex","_currentIndex","put1","begin","compHalfOfUnread","_interval","read","SimpleCanvasRenderingContext2D","CanvasRenderingContext2D","attr","CompositeCanvas","compositeCanvasTag","globalAlpha","_globalAlpha","_compositeOperation","operation","source_over","globalCompositeOperation","getCanvasImageData","_composite","compositeOperation","composite","_requestAnimationFrameStart","_frameRate","requestOneFrame","stopRequestFrame","CompositeOperation","source_atop","source_in","source_out","destination_atop","destination_in","destination_out","destination_over","lighter","darker","xor","copy","compositeVideoOverCanvas","compositeCanvas","accessApproved","accessDenied","webpackContext","req","webpackContextResolve","__webpack_require__","day","execTime","hour","getHours","minute","getMinutes","second","getSeconds","__ICEEvent","_webrtcDesc","Exception","currentTarget","SubFailSafariNotAllowSubBeforePub","AudioMixerStreamNotAllowSub","AudioMixerStreamNotAllowOnlySubVideo","loglastConfrCount","_logContext","_logContextIndex","onlyEnter","_useRequestAnimationFrame","loglastStoreArray","consoleLogger","uploadStats","browserVersion","resume","fn","isWifi","wifi","ua","con","connection","mozConnection","webkitConnection","network","stopAudioTracks","enable","genReportName","date","getReportUploadUrl","uploadReport","commitData","addHeader","fileContent","genReport","formData","FormData","append","loadlogs","fileReport","exception","link","supportedConstraints","Webrtc","P2P","XServiceWithP2P","outer","pannel","KeyboardTrack","helper","intervalPcstats","isChrome","reg","unescape","replaceIpAndPortOfCandidate","$pre","$ip","$port","$after","replaceIpAndPort","newIpPort","replaceURL","wsUrl","$protocol","$host","$path","$query","$fragment","path","query","fragment","isWebRTC","axios","appkey","BASE","process","org_name","app_name","register_url","login_url","req_register","req_login","user","get_uuid","entities","activated","sessionStorage","setItem","login","grant_type","user_info","access_token","uuid","getItem","notification_show","notification","placement","className","requireContext","get_img_url_by_name","get_nickname","get_spliced_name","Item","Header","Content","Footer","ToAudienceList","checked_talker","show","handle_apply_talker_callback","setState","hide","onChange","confirm","props","user_room","grantRole","stream_list","closable","visible","mask","getContainer","destroyOnClose","background","onClick","textAlign","Group","is_me","StreamType","DESKTOP","headImage","Component","MuteAction","mute_all","mute_all_action","muteAll","unmute_all_action","unmuteAll","title","ManageTalker","unmute","more_action","appoint_as_admin","move_out","kickMembersById","menu","ref","overlay","getPopupContainer","refs","HeadImages","url_list","headimg_url_suffix","handleCancel","handleSubmit","headimg_change","get_url_json","headImageList","onOk","onCancel","footer","change","Setting","push_cdn","cdn","rec","recMerge","join_as_audience","reset","_get_setting_values","handleChange","checked","get_headimg_url","head_images","nextProps","onSubmit","text","placeholder","disabled","AdminChangeHandle","my_username","my_role","admin_number","apply_talker","NetworkStatus","network_status","0","RoomSetting","room_setting_modal_show","toggle_room_setting_modal","admins","get_admins","toast","div","ReactDOM","unmountComponentAtNode","render","onOk_handle","toast_msg_show","el_m","innerText","Exc_feed","handle_click","handleOk","confirmLoading","okText","TextArea","cancelText","rows","PureComponent","ChooseDesktopMedia","choosed_stream","screen_list","window_list","TabPane","maskClosable","share","okButtonProps","wrapClassName","top","defaultActiveKey","tab","choosed_style","borderColor","choose","getPageQuery","search","query_value","decodeURI","Room","join_handle","preventDefault","form","validateFields","values","_set_nickname","is_localStorage_nickName_admin","localStorage","video_change","close_audio","own_stream","pauseAudio","open_audio","resumeAudio","audio_change","control_talker_list","talker_list_show","close_talker_model","talker_is_full","own_desktop_stream","own_member","loading","talker_full_btn_disable","shared_desktop","set_nickname_modal_show","liveCfg","layoutStyle","bgclr","fps","bps","cdn_zorder","use_white_board","white_board_url","white_board_is_created","am_i_white_board_creator","not_visible_arr","leaveConfirmModal_show","prev_volumes","subed_v_els","join_btn_disable","main_loading","main_loading_text","toggle_main","talker_is_full_handle","leave","toggle_audio","toggle_video","apply_audience","stop_share_desktop","share_desktop","confirm_destory_white_board","create_white_board","talker_list_scroll","talker_list_scroll_stop","hide_leaveConfirmModal","leave_handle","joinRoom","startTime","_set_config_to_localStorage","hash","publish","err_o","whetherCanUse","init_emedia_callback","init_white_board","onbeforeunload","emit_white_board_is_destroyed","destroy_white_board","exitConference","_get_config_from_localStorage","_get_headimg_url_suffix_from_session","timeID","restPrefix","setIdentity","onStreamAdded","_on_stream_added","onStreamRemoved","_on_stream_removed","onMemberJoined","onConferenceExit","reason_text","get_failed_reason","reload","confr_attrs","confrAttrsUpdated","onRoleChanged","_on_role_changed","admin","admin_changed","unpublish","applicat","agreeCallback","refuseCallback","handle_apply_talker","onMuteAll","onUnMuteAll","onNetworkQuality","n_weak_ms_t","changed","choose_desktop_media","white_board","old_role","joinId","set_role_to_my_member","white_board_attr","creator","roomPswd","join_white_board_params","join_white_board","nickName_used","destroyConference","to_audience_modal","to_audience_list","degradeRole","shared_content","_check_has_shared","first_item","move_v_els","pauseVideo","t_el","cursor","resumeVideo","upload_stream_by_id","withAudio","stopSharedCallback","shareDesktopWithAudio","insert_video_by_stream","isCreator","_update_live_layout","el","w_el","loading_el","_get_video_loading_el","v_ls","querySelectorAll","sub_optioon","_on_media_chanaged_by_stream","v_wrappers","v_wrapper","getAttribute","v_el","prev_v_el","main_stream","check","set_stream_item_changed","sound_chanaged","onMediaChanaged","onSoundChanaged","layout_info","streamcounts","col_num","ceil","row_num","canvas_width","canvas_height","cell_width","cell_height","get_layout_info","regions","position_row","position_col","get_position_in_canvas","stream_id","updateLiveLayout","_get_tick","classList","add","innerHTML","fun","wait","timer","els","prev_not_visible","getItemBySid","par_node","talker_is_not_visble","visible_change","del_loading","body_height","getBoundingClientRect","el_height","footer_height","transform","talkers","get_talkers","onScroll","_get_video_item","_voff_show","talker_item","onDoubleClick","get_white_board_action_btn","invitees","encodeURI","readOnly","select","execCommand","inviteModal","opacity","setConferenceAttrs","deleteConferenceAttrs","whiteBoardUrl","emit_white_board_is_created","set_main_stream_to_talker_list","white_board_info","get_second","time_str","get_minute","tip","getFieldDecorator","backgroundSize","setting_modal","initialValue","REACT_APP_ROOMNAME","rules","required","pattern","maxLength","autoComplete","valuePropName","htmlType","centered","cancelButtonProps","_get_header_el","_get_loading_el","get_white_board_content_el","_get_main_el","_get_drawer_component","_get_action_el","get_leaveConfirmModal","showIcon","WrapRoom","App","UploadStats","_intervals_get","_intervals_upload","counterId","prev_obj","network_quality_obj","network_quality_threshold","RTT","aPLR","vPLR","re_timer_count","qoeUpUrl","ts","identityToken","_get_url","socket","ws_connected","re_connect","join_success","reconnection","reconnection_timer","connect_ws","upload","_get_init_data","errorInfo","push_stats_to_data","event_obj","_get_format_event_obj","_o","_get_ice_connect_state_obj","subMemId","subMemName","connState","isPub","sub_o","subVideo","subAudio","upload_obj","_get_format_upload_obj","currentXService","sdkVersion","osVersion","joinConfrTime","networkType","sdkOS","outbound_stats_obj","_get_outbound_stats","inbound_stats_obj","_get_inbound_stats","_calc_KBps_and_PLR","_set_stats_int","aP","packetsSent","aB","bytesSent","vW","frameWidth","vH","frameHeight","vP","vB","aPL","vPL","audioInputLevel","vFps","framesPerSecond","totalRoundTripTime","responsesReceived","bytesReceived","vFR","framesReceived","aKBps","_get_KBps_by_sId","vKBps","_get_PLR_by_sId","prev_time","network_quality","_get_w_quality","_set_prev_obj","need_int_keys","bytes","prev_info","increment","packets","packets_lost","prev_packets","packets_lost_increment","packets_lost_rate","is_weak","sId_info","frist_time","reset_weak_tiem","reset_dis_time","checks","weak","threshold","is_dis","Manager","_services","ConfrType","COMMUNICATION","COMMUNICATION_MIX","LIVE","INTERCOMM","TALKER","VIDEO","MIXVIDEO","_urls","createConfr","reqTkt","disbandConfr","kickMember","selectConfr","api","apiArgs","region","ajaxUrl","confrArgs","restURL","createUrl","observer","errorType","setUrlCreator","ZeroStream","identityName","extInfo","_terminalInfo","errorHandler","catchError","caught","rxCreateConfr","confrType","Observable","uid","terminal","pipe","mixed","serverConfrId","rxCreateConfrSptMnPrg","supportWechatMiniProgram","create_config","rxReqTkt","rxChanageRoles","uids","rxDisbandConfr","rxKickMember","rxSelectConfr","rxAfterJoinedConfr","joinMemberId","single","rxSubscribe","concatMap","of","throwError","rxSupportRemoteControl","controler","controlRequest","rxJoinUseTicket","confrEventsObserver","__current_confrId","join_fail","rxJoinUsePassword","rxJoinExistConfrUsePassword","openingStream","rxPublish","userStream","pushedStream","rxResumePauseVideo","videoConstaints","rxVoff","rxChanageVideoConstraints","upload_aoff_or_voff_event","rxResumePauseAudio","rxAoff","rxPublishMedia","rxSwitchMobileCamera","rxChanageCamera","rxShareDesktop","_videoTag","crtAndReturnVideo","$video","off","on","__constaints_video","constaintsVideo","freeRemoteControl","rxFocusExpoRemote","rxCapturePictureRemote","rxZoomRemote","rxTorchRemote","rxFreezeFrameRemote","_single","getBindVideoBy","toPromise","createConfrSptMnPrg","joinUsePassword","joinUseTicket","shareDesktopWithAudioNew","sharedCallback","desktopMedia","desktopStream","changeCamera","shareVideoWithAudio","onFocusExpoRemoteWhenClickVideo","offEventAtTag","hungeAv","targetDiv","zeptoTrigger","otherArgs","eventArgs","addVideoEventListener","flowWebrtc","onNotSupportVideoCodecs","onIceStateChanged","onFreeControl","each","triggerTorchRemote","triggerZoomRemote","triggerSubscribe","triggerRemoteControl","triggerCaptureVideo","_outer","_update_confr_attrs","_update_confr_state","inner","decodeMemeberName","onMemberExited","onStreamUpdated","joinConferenceWithTicket","joinConference","getConferenceTkt","unsubscribe","closedSelfConfr","getConferenceInfo","createConference","toRole","oldRole","confr_state","create_params","ajax_options","get_ticket","get_ticket_params","room","ticket_info","addLive","liveId","deleteLive","decodeMemeberNameString","globalName","WebIM","conn","onOpened","useIM","apiName","_onOpened","Util","CHARS","len","radix","chars","rnd","uuidCompact","String","searchString","Logger","LogLevel","LogLevelName","callLog","level","_args","_log","_callLog","_sdklog","contextIndex","logInfos","infoString","toISOString","stack","onSdkLog","sdklog","trace","fatal","jsonString","jsonObj","class2type","hasOwn","fnToString","ObjectFunctionString","Ctor","getPrototypeOf","copyIsArray","deep","isFunction","prototypeExtend_000","classExtend","lastConstructor","_Obj__","__proto__","_prototypeExtend","hasLocalStorage","toggleClass","node","hasClass","removeClass","addClass","setCookie","exp","setTime","cookie","escape","toGMTString","getCookie","attachEvent","detachEvent","stopPropagation","cancelBubble","returnValue","domRect","left","pageXOffset","pageYOffset","scale","touch","elementPageXY","relativeX","relativeY","engine","presto","opera","trident","webkit","taintEnabled","Features","xpath","getBoxObjectFor","mozInnerScreenX","getElementsByClassName","HTMLElement","nodeType","nodeName","cloneCSS","destElement","oStyle","getComputedStyle","currentStyle","v","canYield","eval"],"mappings":"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","file":"static/js/main.9cb1ae3c.chunk.js","sourcesContent":["var _util = require('../../../webrtc/src/components/Util');\nvar _logger = _util.tagLogger(\"MouseTrigger\");\n\nvar BTN = {\n    LEFT: 1,\n    WHEEL: 2,\n    RIGHT: 4,\n\n    WHEEL_ROLL_UP: 8,\n    WHEEL_ROLL_DOWN: 16,\n\n    KEY_UP: 0,\n    KEY_DOWN: 1,\n    MOVE: 2,\n\n    KEYBOARD_DOWN: 3,\n    KEYBOARD_UP: 4,\n}\n\n/**\n *\n * {\n *  xy: eventXY,\n *  oper: oper,\n *  btn: button,\n *  _time: _time\n * }\n *\n *\n */\nmodule.exports = _util.prototypeExtend({\n    _timeoutMillis: 500,\n    _time: (new Date()).getTime(),\n\n    isKeyup: function () {\n        return BTN.KEY_UP == this.oper;\n    },\n    isKeydown: function () {\n        return BTN.KEY_DOWN == this.oper;\n    },\n    isWheelup: function () {\n        return BTN.WHEEL_ROLL_UP == this.btn;\n    },\n    isWheeldown: function () {\n        return BTN.WHEEL_ROLL_DOWN == this.btn;\n    },\n    isLeftKey: function () {\n        return BTN.LEFT == this.btn;\n    },\n    isRightKey: function () {\n        return BTN.RIGHT == this.btn;\n    },\n    isWheelKey: function () {\n        return BTN.WHEEL == this.btn;\n    },\n    isWheelRoll: function () {\n        return this.isWheeldown() || this.isWheelup();\n    },\n    \n    timeout: function () {\n        var cur = (new Date()).getTime();\n        return cur - this._time >= this._timeoutMillis;\n    },\n\n    _toString: function () {\n        return _util.list(\"btn:\", this.btn, \", oper:\", this.oper, \", timeout:\", this.timeout(), \", at (\", this.xy.x, \", \", this.xy.y, \")\").join(\"\");\n    }\n});\n\nmodule.exports.BTN = BTN;","var _util = require('./Util');\n\nvar SoundMeter = require('../_adapter/SoundMeter');\n\n/**\n * {\n *  _located:\n *  _webrtc:\n *\n *  id:\n *  memId:\n *  name:\n *  voff:\n *  aoff:\n *  type: 0 1\n *  ext:\n *  owner: {\n *    id:\n *    nickName:\n *    name:\n *    ext:\n *  }\n *\n *  _localMediaStream:\n * }\n *\n *\n *\n */\n\nemedia.subscribed = function (stream) {\n    if(stream._located){\n        return true;\n    }\n\n    if(stream.type === 2){\n        return !!(!stream._located && stream._webrtc);\n    }\n\n    return (stream._webrtc !== undefined);\n};\n\n\nvar MediaSoundMeter = _util.prototypeExtend({\n    voff: 0,\n    aoff: 0,\n\n    __init__: function () {\n        var self = this;\n\n        if(!self._mediaStream){\n            _logger.error(\"_mediaStream empty\");\n            throw \"_mediaStream empty\";\n        }\n\n        if(!self.hasEnabledTracks(self._mediaStream)){\n            return;\n        }\n\n        if(!self.__audioContext){\n            _logger.error(\"require audioContext\");\n            throw \"require audioContext\";\n        }\n\n        self.__soundMeter = new SoundMeter(self.__audioContext);\n\n        self.__soundMeter.connectToSource(self._mediaStream, function(e) {\n            if (e) {\n                throw e;\n            }\n            self.__worked = self.__soundMeter.__worked = true;\n        });\n    },\n\n    hasEnabledTracks: function (mediaStream) {\n        return emedia.hasEnabledTracks(mediaStream);\n    },\n\n    getSoundMeters: function () {\n        var self = this;\n\n        if(!self.__soundMeter || !self.__worked){\n            return;\n        }\n\n        if(!self._mediaStream.active){\n            self.__worked && self._finally();\n            return;\n        }\n\n        if(!self.hasEnabledTracks(self._mediaStream)){\n            return;\n        }\n\n        return {\n            instant: self.__soundMeter.instant,\n            slow: self.__soundMeter.slow,\n            clip: self.__soundMeter.clip\n        }\n    },\n\n    _finally: function () {\n        var self = this;\n\n        if(self.__soundMeter){\n            self.__soundMeter.stop();\n            self.__worked = self.__soundMeter.__worked = false;\n        }\n    }\n});\n\nmodule.exports = _util.prototypeExtend({ //type 0 AVpub 1 Desktop 2 Sub\n    __undefinedEQDelete: true,\n\n    Update: _util.prototypeExtend({\n\n        ifAoff: function (update) {\n            this.if(\"aoff\", update);\n        },\n\n        ifVoff: function (update) {\n            this.if(\"voff\", update);\n        },\n\n        ifMediaStream: function (update) {\n            this.if(\"mediaStream\", update);\n        },\n\n        if: function (key, update) {\n            if(typeof this[key] === \"undefined\"){\n                return;\n            }\n\n            update(this[key]);\n        }\n    }),\n\n\n    located: function () {\n        return this._located || false;\n    },\n\n    webrtc: function (webrtc) {\n        webrtc && (this._webrtc = webrtc);\n        return this;\n    },\n\n    getMediaStream: function () {\n        if(typeof this.mediaStream !== \"undefined\"){\n            return this.mediaStream;\n        }\n\n        // if(this.type === 2 && this._webrtc && this._webrtc.getRemoteStream()){\n        //     return this._webrtc.getRemoteStream();\n        // }\n\n        if(this._located){\n            return this._localMediaStream;\n        }\n\n        return (this._webrtc && (this._webrtc.getRemoteStream() || this._webrtc.getLocalStream()));\n    },\n\n    requestFrame: function (){\n        this._localMediaStream && this._localMediaStream.getVideoTracks().forEach(function(track) {\n            typeof track.requestFrame === \"function\" && track.requestFrame();\n        });\n    },\n\n    getLocalMediaStream: function () {\n        return this._localMediaStream;\n    },\n\n    getRemoteMediaStream: function () {\n        if(this._webrtc && (typeof this._webrtc.getRemoteStream() !== \"undefined\")){\n            return this._webrtc.getRemoteStream();\n        }\n    },\n\n    mutedNeed: function () {\n        return this.mutedMuted || false;\n    },\n\n    ifMediaStream: function (update) {\n        if(typeof this.mediaStream !== \"undefined\"){\n            update(this.mediaStream);\n            return;\n        }\n\n        // if(this.type === 2 && this._webrtc && this._webrtc.getRemoteStream() !== \"undefined\"){\n        //     update(this._webrtc.getRemoteStream());\n        //     return;\n        // }\n\n        if(this._located && (typeof this._localMediaStream !== \"undefined\")){\n            update(this._localMediaStream);\n            return;\n        }\n\n        if(!this._located && this._webrtc && (typeof this._webrtc.getRemoteStream() !== \"undefined\")){\n            update(this._webrtc.getRemoteStream());\n            return;\n        }\n    },\n\n    subscribed: function () {\n        return emedia.subscribed(this);\n    },\n\n    updateAttributes: function(){\n        var self = this;\n        for (var i = 0; i < arguments.length; i++) {\n            var arg = arguments[i];\n            if(_util.isPlainObject(arg)){\n                for(var _key in arg){\n                    var _value = arg[_key];\n\n                    self[_key] = _value;\n                }\n            }\n        }\n    },\n\n    getHtmlDOMID: function () {\n        return \"_m_\" + this.owner.id + \"_s_\" + this.id;\n    },\n\n    MediaSoundMeter: MediaSoundMeter,\n\n    StreamSoundMeter: _util.prototypeExtend({\n        __init__: function () {\n            var self = this;\n\n            if(!self._stream || (typeof self._stream.getMediaStream !== 'function')){\n                _logger.error(\"_stream empty or not found method getMediaStream\");\n                throw \"_stream empty or not found method getMediaStream\";\n            }\n\n            self._streamId = self._stream.id;\n            self._streamCreateId = self._stream.__create_id;\n            self._mediaStream = self._mediaStream;\n\n            if(self._stream.type === 2 && !self._stream.located() && !self._webrtc){\n                _logger.error(\"require webrtc. when type = 2 and not located\");\n                throw \"require webrtc. when type = 2 and not located\";\n            }\n\n            self.__mediaSoundMeter = (self.__mediaSoundMeter || new MediaSoundMeter({\n                __audioContext: self.__audioContext,\n                _mediaStream: self._mediaStream\n            }));\n            self.__mediaSoundMeter.useCount = (self.__mediaSoundMeter.useCount || 0) + 1;\n        },\n\n        onSoundMeters: function (callback) {\n            var self = this;\n\n            var emptyResult = {\n                instant: 0,\n                slow: 0,\n                clip: 0\n            };\n\n            if(self._stream.aoff){\n                self._finally();\n                callback(emptyResult);\n                return emptyResult;\n            }\n\n            if(self._stream.type !== 2\n                && self._stream.subArgs\n                && self._stream.subArgs.subSAudio !== undefined\n                && !self._stream.subArgs.subSAudio){\n                self._finally();\n                callback(emptyResult);\n                return emptyResult;\n            }\n\n            if(self._stream.id == 0 ||\n                (self._stream.type === 2 && !self._stream.located() && (!self._stream.subArgs || !self._stream.subArgs.subSAudio))){\n                var receivers = self._webrtc.getReceiversOfPeerConnection();\n\n                if(!receivers || receivers.length === 0){\n                    callback(emptyResult);\n                    return emptyResult;\n                }\n\n                var audioReceiver;\n                for(var i in receivers){\n                    if(receivers[i].track.kind === 'audio'){\n                        audioReceiver = receivers[i];\n                    }\n                }\n\n                if(!audioReceiver){\n                    callback(emptyResult);\n                    return emptyResult;\n                }\n\n                if(typeof audioReceiver.getContributingSources === 'function') {\n                    var rtpContributingSources = audioReceiver.getContributingSources();\n                    if(emedia.config._printSoundData){\n                        _util.logger.debug(self._stream.id, self._stream.csrc, \"rtpContributingSources \", rtpContributingSources)\n                    }\n\n                    if (!rtpContributingSources || rtpContributingSources.length === 0) {\n                        callback(emptyResult);\n                        return emptyResult;\n                    }\n\n                    var source;\n                    for (var i in rtpContributingSources) {\n                        if (rtpContributingSources[i].source == self._stream.csrc) {\n                            source = self._stream.csrc;\n                        }\n                    }\n\n                    if(emedia.config._printSoundData){\n                        _util.logger.debug(self._stream.id, self._stream.csrc, \"source \", source)\n                    }\n\n                    if (source === undefined) {\n                        callback(emptyResult);\n                        return emptyResult;\n                    }\n                }\n            }\n\n            var _meter = self.__mediaSoundMeter.getSoundMeters() || emptyResult;\n\n            var webrtc = (self._stream.type === 2) ? self._webrtc : self._stream._webrtc;\n            if((emedia.meterWithTrackAudioLevel || _meter.instant === 0)\n                && webrtc\n                && !webrtc.closed\n                && webrtc._rtcPeerConnection){\n                webrtc._rtcPeerConnection.getStats().then(function(stats) {\n                    if(stats.size > 0){\n                        stats.forEach(function(res) {\n                            if(res.type === \"track\" && (res.kind === \"audio\" || res.trackIdentifier === \"audio\")){\n                                _meter.trackAudioLevel = res.audioLevel;\n                                //_meter.trackTotalAudioEnergy = 0;\n                                _meter.trackTotalAudioEnergy = res.totalAudioEnergy;\n                                callback(_meter);\n                            }\n                        });\n                    }\n                });\n            }\n\n            callback(_meter);\n        },\n\n        _finally: function () {\n            var self = this;\n\n            if(self._stream.type === 2 && self._stream.located() && self._remoteMediaSoundMeters){\n                 self._remoteMediaSoundMeters._finally();\n            }\n\n            self.__mediaSoundMeter.useCount--;\n\n            if(self.__mediaSoundMeter.useCount === 0){\n                self.__mediaSoundMeter._finally();\n            }\n        }\n    })\n});","var _util = require('../../../webrtc/src/components/Util');\nvar _logger = _util.tagLogger(\"MouseTrack\");\n\nvar MouseTrigger = require(\"./MouseTrigger\");\n\nmodule.exports = _util.prototypeExtend({\n    _scale: 1,\n    //_target\n    //_referenceVideo\n\n    __init__: function () {\n        var self = this;\n    },\n\n    getTargetPageXY: function () {\n        var self = this;\n        return self._target && _util.extend({}, (_util.getDomPageRect(self._target)));\n    },\n\n    onMouseTrack: function (position, lastPosition, lastTrigger) {\n        //_logger.warn(position.x, position.y);\n    },\n\n    onMouseTrigger: function (trigger, _lastTrigger) {\n\n    },\n\n    _onMouseTrack: function (position, lastPosition, _lastTrigger) {\n        this.onMouseTrack && this.onMouseTrack(position, lastPosition, _lastTrigger);\n    },\n\n    _onMouseTrigger: function (trigger, _lastTrigger) {\n        this.onMouseTrigger && this.onMouseTrigger(trigger, _lastTrigger);\n    },\n    \n    track: function(pos) {\n        var self = this;\n\n        var pageXY = pos = _util.extend({}, pos);\n\n        var _elementPageXY = self.getTargetPageXY();\n        _elementPageXY && (pos = self._calPosition(pos), pageXY = {\n            x: pos.x,\n            y: pos.y,\n            pageX: (_elementPageXY.x + pos.x),\n            pageY: (_elementPageXY.y + pos.y)\n        });\n\n        self._onMouseTrack(pageXY, self._lastPageXY, self._lastTrigger);\n        self._lastPageXY = pageXY;\n    },\n    \n    trigger: function (trigger) {\n        var self = this;\n\n        trigger = new MouseTrigger(trigger);\n\n        var _elementPageXY = self.getTargetPageXY();\n\n        var pos;\n        _elementPageXY && (pos = self._calPosition(trigger.xy), trigger.xy = {\n            x: pos.x,\n            y: pos.y,\n            pageX: (_elementPageXY.x + pos.x),\n            pageY: (_elementPageXY.y + pos.y)\n        });\n        trigger._time || (trigger._time = (new Date()).getTime());\n\n        self._onMouseTrigger(trigger, self._lastTrigger);\n        self._lastTrigger = trigger;\n    },\n\n    releaseTrigger: function () {\n        this._lastTrigger = undefined;\n        this._lastPageXY = undefined;\n\n        this.onReleaseTrigger && this.onReleaseTrigger(this._lastTrigger);\n    },\n\n    /**\n     *\n     *\n     * @param mousePos\n     * @private\n     */\n    _calPosition: function (mousePos) {\n        var self = this;\n\n        if(self._referenceVideo){\n            mousePos = emedia.Service.prototype.eventXYAtVideo.call(null, mousePos, self._referenceVideo);\n        }\n\n        var _elementPageXY = self.getTargetPageXY();\n        if(!_elementPageXY){\n            return mousePos;\n        }\n\n        if(_util.isFloat(mousePos.x) && mousePos.width !== undefined){ //比率\n            mousePos.x = (mousePos.x * mousePos.width) * self._scale * (_elementPageXY.width / mousePos.width);\n        }\n        if(_util.isFloat(mousePos.y) && mousePos.height !== undefined){ //比率\n            mousePos.y = (mousePos.y * mousePos.height) * self._scale * (_elementPageXY.height / mousePos.height);\n        }\n\n        if(_util.isFloat(mousePos.x) && mousePos.width === undefined){ //比率\n            mousePos.x = mousePos.x * self._scale * _elementPageXY.width;\n        }\n        if(_util.isFloat(mousePos.y) && mousePos.height === undefined){ //比率\n            mousePos.y = mousePos.y * self._scale * _elementPageXY.height;\n        }\n\n        if(_util.isInt(mousePos.x) && mousePos.width !== undefined){\n            mousePos.x = mousePos.x * self._scale * (_elementPageXY.width / mousePos.width);\n        }\n        if(_util.isInt(mousePos.y) && mousePos.height !== undefined){\n            mousePos.y = mousePos.y * self._scale * (_elementPageXY.height / mousePos.height);\n        }\n\n        if(_util.isInt(mousePos.x) && mousePos.width === undefined){\n            mousePos.x = mousePos.x * self._scale;\n        }\n        if(_util.isInt(mousePos.y) && mousePos.height === undefined){\n            mousePos.y = mousePos.y * self._scale;\n        }\n\n        var x = Math.floor(mousePos.x);\n        var y = Math.floor(mousePos.y);\n\n        if(x < 0){\n            x = _elementPageXY.width + x;\n        }\n        if(y < 0){\n            y = _elementPageXY.width + y;\n        }\n\n        return {x: x, y: y, width: _elementPageXY.width, height: _elementPageXY.height};\n    }\n});","\nvar _util = require('./Util');\nvar _logger = _util.tagLogger(\"Sess\");\n\nvar __event = require('./event');\n\nvar __url_seqno = 0;\nvar DeployMore = require('./mgr/DeployMore').default;// 多集群\n\nvar Message = _util.prototypeExtend({\n    setSessId: function (sessId) {\n        sessId && (this.sessId = sessId);\n        return this;\n    },\n    setOp: function (op) {\n        op && (this.op = op);\n\n        if(op === 200){\n            this.res = {\n                type: emedia.config.clientType,\n                ver: window._emediaVersion || emedia.config.version,\n                agent: emedia.config.userAgent,\n                ops: emedia.config.acptOps\n            };\n\n            //this.res = JSON.stringify(this.res);\n        }\n\n        return this;\n    },\n    setTsxId: function (tsxId) {\n        tsxId && (this.tsxId = tsxId);\n        return this;\n    },\n    setTicket: function (tkt) {\n        tkt && (this.tkt = tkt);\n        return this;\n    },\n    setSdp: function (sdp) {\n        sdp && (this.sdp = sdp);\n        return this;\n    },\n    setCands: function (cands) {\n        cands && (this.cands = cands);\n        return this;\n    },\n    setSubSId: function (subSId) {\n        subSId && (this.subSId = subSId);\n        return this;\n    },\n    setMemId: function (memId) {\n        memId && (this.memId = memId);\n        return this;\n    },\n    setPubS: function (pubS) {\n        pubS && (this.pubS = _util.extend(false, {}, pubS));\n\n        var thisPubS = this.pubS;\n        if(thisPubS.ext && _util.isPlainObject(thisPubS.ext)){\n            thisPubS.ext = JSON.stringify(thisPubS.ext);\n        }\n\n        thisPubS && _util.forEach(thisPubS, function (key, value) {\n            if(_util.isPlainObject(value) || typeof value === 'function'){\n                if(key != 'resolution') { //不能 删除分辨率参数\n                    _util.removeAttribute(thisPubS, key);\n                }\n            }\n        });\n\n        thisPubS && _util.removeAttribute(thisPubS, \"localStream\");\n        thisPubS && _util.removeAttribute(thisPubS, \"_localMediaStream\");\n        thisPubS && _util.removeAttribute(thisPubS, \"_webrtc\");\n\n        return this;\n    },\n    setRtcId: function (rtcId) {\n        rtcId && (this.rtcId = rtcId);\n        return this;\n    },\n    setCver: function (cver) {\n        cver && (this.cver = cver);\n        return this;\n    },\n    setEndReason: function (endReason) {\n        endReason && (this.endReason = endReason);\n        return this;\n    },\n    setNickName: function (nickName) {\n        nickName && (this.nickName = nickName);\n        return this;\n    },\n    setResource: function (resource){\n        resource && (this.resource = resource);\n        return this;\n    },\n    setReason: function (reason) {\n        reason && (this.reason = reason);\n        return this;\n    },\n    setConfrId: function (confrId) {\n        confrId && (this.confrId = confrId);\n        return this;\n    },\n    setVoff: function (voff) {\n        (typeof voff === \"undefined\") || (this.voff = (voff ? 1 : 0));\n        return this;\n    },\n    setAoff: function (aoff) {\n        (typeof aoff === \"undefined\") || (this.aoff = (aoff ? 1 : 0));\n        return this;\n    },\n    setFlag: function (flag) {\n        flag === 0 && (this.flag = 0);\n        flag === 1 && (this.flag = 1);\n\n        return this;\n    },\n    setExt: function (ext) {\n        if(ext && _util.isPlainObject(ext)){\n            ext = JSON.stringify(ext);\n        }\n        ext && (this.ext = ext);\n        return this;\n    }\n});\n\n\n/**\n * {\n *   websocket:\n *   onMessage:\n *   _postMessage(Message):\n *   onError:\n * }\n *\n * reconnectCount > 0 时不上报错误（调用onWebsocketEvent）。\n * 不存在或==0 调用调用onWebsocketEvent\n * 调用onWebsocketEvent WSClose时 将会关闭\n *\n * @returns {*}\n *\n */\n\nvar __session_globalCount = emedia.__session_globalCount = 0;\n\nfunction _connect(onConnected, onConnectFail, retry){\n    var self = this;\n\n    function connectFail(cause, _evt){\n        try{\n            self.onWebsocketEvent(new __event.WSClose({url: self.thisWsUri, retry: retry, online: self.online, cause: cause, event: _evt, session: self}));\n        } finally {\n            onConnectFail && onConnectFail(new __event.WSClose({url: self.thisWsUri, retry: retry, online: self.online, cause: cause, event: _evt, session: self}));\n        }\n    }\n\n    function post(message) {\n        if(!self.connected(self.thisWsUri)){\n            _logger.debug(\"current dont connect. the message = \", message);\n            return;\n        }\n\n        if(_util.isPlainObject(message) && !(message instanceof Message)){\n            _logger.error(\"message not a Messages\");\n            throw \"message not a Messages\";\n        }\n\n        if(self.sessId && message.sessId != self.sessId){\n            _logger.warn(\"self.sessId && message.sessId != self.sessId\", message);\n            return;\n        }\n\n        var wsMsg = JSON.stringify(message);\n\n        self.thisWsUri === self._websocket.url && self._websocket.send(wsMsg);\n        self.thisWsUri === self._websocket.url && _logger.debug(\"Done send req:\", wsMsg, self._websocket.url);\n        self.thisWsUri === self._websocket.url || _logger.debug(\"Donot send(url not equal): req:\", wsMsg, self._websocket.url);\n    }\n\n    function notifyNewMessage() {\n        \n        if(self.connected(self.thisWsUri)){\n            if(self._bufferedMessages.length === 0){\n                return;\n            }\n\n            var __array = [];\n\n            var bufferedMessage;\n            while((bufferedMessage = self._bufferedMessages.shift())){\n                if(!bufferedMessage.sessId && !self.sessId && bufferedMessage.op != 200){ //等待Enter\n                    __array.push(bufferedMessage);\n                    _logger.warn(\"tmp store message, util enter success!\", bufferedMessage);\n                    continue;\n                }\n\n                if(bufferedMessage.op === 200){ //200单独发送，有可能会修改session值\n                    post(bufferedMessage);\n                    break;\n                }\n\n                if(self.sessId && !bufferedMessage.sessId){\n                    bufferedMessage.sessId = self.sessId;\n                }\n\n                var _bufferedMessage = post(bufferedMessage);\n                _bufferedMessage && __array.push(_bufferedMessage);\n            }\n\n            if(__array.length > 0){\n                Array.prototype.push.apply(self._bufferedMessages, __array);\n            }\n            //} else if(!retry || !self.online){\n        } else if(retry === 0 || !self.online){\n            var _messageMap = _util.extend(false, {}, self._callbacks);\n\n            var tmp = [];\n            for(var tsxId in _messageMap){\n                var msg = _messageMap[tsxId];\n                //if(retry > 0 && !self.online && (msg.op === 107 || msg.op === 201 || msg.op === 204 || msg.op === 206 || msg.op === 400 || msg.op === 500)) {\n                if(retry > 0 && !self.online) { //缓存所有消息\n                    tmp.push(msg);\n                    continue;\n                }\n                self.onMessage({op: 1001, tsxId: tsxId, result: -9527, msg: \"sdk rsp fail. retry fail or online = \" + self.online});\n            }\n\n            self._bufferedMessages = (self._bufferedMessages || []);\n\n            tmp.length > 0 && (Array.prototype.push.apply(self._bufferedMessages, tmp));\n        }\n        else if(!self.connected()){\n            // var _messageMap = _util.extend(false, {}, self._callbacks);\n            //\n            // for(var tsxId in _messageMap){\n            //     var msg = _messageMap[tsxId];\n            //     if(msg.op !== 102 && msg.op !== 105 && msg.op !== 1000) {\n            //         continue;\n            //     }\n            //     self.onMessage({op: 1001, tsxId: tsxId, result: -9527, msg: \"websocket disconnect\", retrying: true});\n            // }\n        }\n    }\n\n\n    if(self.connected(self.thisWsUri)){\n        onConnected && onConnected(self);\n        _logger.info(\"Session connected. dont continue connect\");\n        self.notifyNewMessage && self.notifyNewMessage();\n\n        return;\n    }\n\n    if(!self.online){\n        connectFail();\n        return;\n    }\n\n    self.notifyNewMessage = notifyNewMessage;\n\n\n    _logger.info(\"Session begin connect.\");\n\n    var _websocket = self._websocket;\n    if(_websocket){\n        _logger.warn(\"will close. websocket state\", _websocket.readyState, _websocket.url, self.thisWsUri);\n        _websocket.close(1000);\n    }\n\n    try {\n        _logger.info(\"Connecting\", self.thisWsUri, retry);\n        _websocket = self._websocket = new WebSocket(self.thisWsUri);\n    } catch (e) {\n        _logger.warn(e);\n        connectFail(e);\n\n        return;\n    }\n\n    _websocket.onopen = function(evt) {\n        var _url = this.url;\n        if(_url !== self.thisWsUri){\n            _logger.warn(\"ignore the onopen. caused by websocket url not \", self.thisWsUri, _url);\n            return;\n\n        }\n\n        try{\n            _logger.info(\"websocket connected:\", _url);\n            onConnectFail && (onConnectFail = null);\n            onConnected && onConnected(self);\n            self.onWebsocketEvent(new __event.WSConnected({event: evt, session: self}));\n        }finally{\n            //self.notifyNewMessage();\n        }\n    };\n\n    _websocket.onmessage = function(evt) {\n\n\n        var _url = this.url;\n        if(_url !== self.thisWsUri){\n            _logger.warn(\"ignore recv data. caused by websocket url not \", self.thisWsUri, _url, evt.data);\n            return;\n\n        }\n\n        _logger.debug(\"recv data\", evt.data);\n\n        var data = JSON.parse(evt.data);\n        data && data.op == 1001 &&  _logger.debug(\"recv message: rsp:\", data);\n        data && data.op != 1001 &&  _logger.debug(\"recv message: evt:\", data);\n\n        self.onMessage(data);\n    };\n\n    _websocket.onclose = function(evt) {\n        var _url = this.url;\n        _logger.info(\"Disconnected:\", _url, self.thisWsUri, evt);\n        if(_url !== self.thisWsUri){\n            _logger.warn(\"ignore onclose. caused by websocket url not \", self.thisWsUri, _url);\n            return;\n\n        }\n\n        self.notifyNewMessage();\n\n        if(evt.code !== 1000){ //手动断开\n            connectFail(undefined, evt);\n        }\n    };\n\n    _websocket.onerror = function(evt) {\n        _logger.info(\"On error:\", evt);\n\n        self.onWebsocketEvent(new __event.WSError({event: evt, online: self.online, session: self, url: this.url}));\n    };\n}\n\n/**\n * {\n *   ticket:\n *   reconnectCount:\n *   onError:\n *\n *   onEnter:\n *   onExit:\n *   onPub:\n *   onUnpub:\n *   onMems:\n *   onClose:\n *\n *   onInitC:\n *   onTcklC:\n *\n *\n *   newMessage:\n *   postMessage:\n * }\n *\n *\n * @private\n */\nmodule.exports = _util.prototypeExtend({\n    _events: {\n        '0': 'onReqP2P',\n        '1': 'onNewCfr',\n        '2': 'onDelCfr',\n        '3': 'onReqTkt',\n\n        '100': 'onPing',\n        '101': 'onPong',\n        '102': 'onInitC',\n        '103': 'onReqC',\n        '104': 'onAcptC',\n        '105': 'onTcklC',\n        '106': 'onAnsC',\n        '107': 'onTermC',\n\n        '300': 'onEnter',\n        '301': 'onExit',\n        '302': 'onPub',\n        '303': 'onUnpub',\n        '304': 'onMems',\n        '204': 'onClose',\n        '400': 'onStreamControl',\n        '401': 'onJoin',\n        '412': 'onRoleUpdate',\n        '1002': 'onRemoteControl',\n        '1003': 'onRecvRemoteMessage',\n\n        //'onServerError': 'onServerError'\n        '402': 'onConfrAttrsUpdated',\n        '413': 'onAdminChanged',\n        '452': 'onLivecfgsChanged',\n    },\n\n    __init__: function(){\n        var self = this;\n\n        //self.owner = null;\n\n        self._bufferedMessages = [];\n        self._callbacks = {};\n\n        function nowline() {\n            if(navigator.onLine){\n                self.online = true;\n            }else{\n                self.online = false;\n            }\n        }\n\n        nowline();\n\n        // window.__hx_checkLineIntervalId_ && clearInterval(window.__hx_checkLineIntervalId_);\n        // window.__hx_checkLineIntervalId_ = setInterval(function () {\n        //     var lastOnline = self.online;\n        //     nowline();\n        //     if(!lastOnline && self.online){\n        //         online();\n        //     }\n        //     if(lastOnline && !self.online){\n        //         offline();\n        //     }\n        // }, 500);\n\n\n        function online(e) {\n            self.online = true;\n            _logger.warn(\"online online online\");\n\n            if(!self.closed){\n                self._reconnect(emedia.config.reconnect);\n            }\n        }\n\n        function offline(e) {\n            self.online = false;\n            _logger.warn(\"offline offline offline\");\n\n            self.__checkConnectIntervalId && clearTimeout(self.__checkConnectIntervalId);\n\n            self.__retryConnectIntervalId && clearTimeout(self.__retryConnectIntervalId);\n            self.__retryConnectIntervalId && delete self.__retryConnectIntervalId;\n\n            self._websocket && self._websocket.close(1000);\n        }\n\n        window.addEventListener(\"online\", online, true);\n\n        window.addEventListener(\"offline\", offline, true);\n\n        _logger.info(\"online status = \", self.online);\n    },\n\n    _nextWsUri: function () {\n        var self = this;\n\n        var url = self.ticket.url;\n\n        // var hostname = window.location.hostname;\n        // if(hostname.endsWith(\"paic.com.cn\")){ //pingan.com.cn -> paic.com.cn\n        //     url = url.replace(\"pingan.com.cn\", \"paic.com.cn\");\n        // }else if(hostname.endsWith(\"pingan.com.cn\")){ // paic.com.cn -> pingan.com.cn\n        //     url = url.replace(\"paic.com.cn\", \"pingan.com.cn\");\n        // }\n        // _logger.warn(\"ticket url modifiy. \", hostname, url);\n\n        // 如果使用多集群 加入之前 拿rtcconfig.json 重置 ws\n        if(emedia.config.useDeployMore) {\n            emedia.mgr.rtc_url_config = null\n            emedia.mgr.rtc_url_config = new DeployMore(emedia.config.rtcConfigUrl || '');\n            url = emedia.mgr.rtc_url_config.replace_ws(url);\n        }\n\n        var replaceFunc = (emedia.config && emedia.config.convertWebsocketURLOfTicket) || emedia.convertWebsocketURLOfTicket;\n        if(typeof replaceFunc === \"function\"){\n            var oldUrl = url;\n            url = replaceFunc(url);\n            _logger.warn(oldUrl, \"-->\", url);\n        }\n\n        if(url.startsWith('/')){ //通过地址栏 补齐url\n            if(emedia.config.wsorigin){\n                url = emedia.config.wsorigin + url;\n            }else{\n                var href = window.location.href;\n                var proto = href.startsWith(\"https\") ? \"wss://\" : \"ws://\";\n\n                var startIndex = href.indexOf(\"://\") + 3;\n                var endIndex = href.indexOf(\"/\", startIndex);\n                var wsorigin = href.substring(startIndex, endIndex);\n\n                url = proto + wsorigin + url;\n            }\n\n            _logger.warn(\"websocket url. update. {} -> {}\", self.ticket.url, url);\n        }else if(emedia.config.wsorigin){\n            _logger.warn(\"emedia.config.wsorigin invalidate. causeby server url {}\", url);\n        }\n\n        if(url.indexOf(\"?\") >= 0){\n            url += \"&\" + __url_seqno++;\n        }else{\n            url += \"?\" + __url_seqno++;\n        }\n\n        // if(self.ticket.confrId){\n        //     url += \"&\" + encodeURIComponent(self.ticket.confrId);\n        // }\n        return url;\n    },\n\n    _reconnect: function (retry) {\n        var self = this;\n\n        function connected() {\n            _logger.warn(\"Reconnected. at \", retry, self._websocket.url);\n            self.__retryConnectIntervalId && clearTimeout(self.__retryConnectIntervalId);\n            self.__retryConnectIntervalId && delete self.__retryConnectIntervalId;\n\n            var enter = self.newMessage()\n                .setOp(200)\n                .setSessId(self._sessionId)\n                .setTicket(self.ticket)\n                .setNickName(self.nickName || self.ticket.memName)\n                .setResource(self.resource)\n                .setExt(self.owner.ext);\n            self.postMessage(enter, function(rsp){\n                if(rsp.result != 0){\n                    try {\n                        self.onEvent(new __event.EnterFail({\n                            me: self.owner,\n                            cause: (new __event.RspFail({request: enter, response: rsp}))}));\n                    } finally {\n                        if(rsp.result !== -9527){ //-9527 客户端 自己返回，网络未通， 其他值服务端返回\n                            self.onEvent(new __event.ServerRefuseEnter({failed: rsp.result, msg: rsp.msg}));\n                        }\n                    }\n\n                    return;\n                }\n\n                self.onEvent(new __event.EnterSuccess({ip: self.owner.ip}));\n\n                self.owner.onMembers(rsp.cver, rsp.mems);\n                self.owner.onStreams(rsp.cver, rsp.streams);\n\n                self.notifyNewMessage();\n            });\n        }\n\n        function failed(evt) {\n            if(retry <= 0){\n                _logger.warn(\"Reconnect end. but fail.\", evt.url, retry);\n                self.__retryConnectIntervalId && delete self.__retryConnectIntervalId;\n\n                return;\n            }\n            retry && (self.__retryConnectIntervalId = setTimeout(function () {\n                self.connect(connected, failed, --retry);\n            }, emedia.config.reconnectDelay));\n        }\n\n        self.connect(connected, failed, --retry);\n    },\n\n    __checkConnect: function () {\n        var self = this;\n\n        self.__checkConnectIntervalId && clearTimeout(self.__checkConnectIntervalId);\n\n        emedia.config.checkConnectIntervalMillis && (self.__checkConnectIntervalId = setTimeout(function () {\n            //_logger.trace(\"Check connect..\");\n\n            try{\n                if(self.online && !self.connected()){\n                    self.__retryConnectIntervalId && _logger.debug(\"online, reconnecting...\");\n                    self.__retryConnectIntervalId || _logger.debug(\"online, but disconnect. will reconnect\");\n                    self.__retryConnectIntervalId || self._reconnect(emedia.config.reconnect);\n                } else {\n                    //self.notifyNewMessage && self.notifyNewMessage();\n                }\n            }finally{\n                self.__checkConnect();\n            }\n        }, emedia.config.checkConnectIntervalMillis));\n    },\n\n    connect: function(onConnected, onConnectFail, retry){\n        var self = this;\n\n        var nextUrl = self.thisWsUri = self._nextWsUri();\n\n        (typeof retry !== \"undefined\") && _logger.warn(\"begin connect... at retry = \", retry, nextUrl);\n\n        function connected() {\n            try{\n                onConnected.apply(self, arguments);\n            }finally{\n                self.__checkConnect();\n            }\n        }\n\n        function failed(evt) {\n            try{\n                onConnectFail.apply(self, arguments);\n            }finally{\n                retry || evt.url !== nextUrl\n                || self.onEvent(new __event.ServerRefuseEnter({\n                    failed: -95270, msg: \"sdk reconnect fail. \" + nextUrl + \"|\" + evt.url}));\n            }\n        }\n        _connect.call(self, connected, failed, retry);\n    },\n\n    connected: function (wsUri) {\n        var self = this;\n        var result = self.online && self._websocket && (!wsUri || wsUri === self._websocket.url) && self._websocket.readyState == WebSocket.OPEN;\n        //_logger.trace(\"Connected?\", result, self.online, wsUri, self._websocket && self._websocket.url, self._websocket && self._websocket.readyState);\n\n        return result;\n    },\n\n    onWebsocketEvent: function (evt) {\n        var self = this;\n        self.onEvent(evt);\n    },\n\n    register: function (listeners) {\n\n        \n        \n        if (typeof listeners === \"object\") {\n            for (var event in listeners) {\n                this.bind(event, listeners[event]);\n            }\n        }\n    },\n\n    bind: function (event, func) {\n        var self = this;\n        var onFunc;\n        if ((onFunc = self._events[event])) {\n            self[onFunc] = func;\n        } else {\n            _logger.error(\"Not supported event = \", event);\n            throw \"Not supported event = \" + event;\n        }\n    },\n\n    getSessionId: function(){\n        return this._sessionId;\n    },\n\n    newMessage: function(cfg) {\n        return new Message(cfg);\n    },\n\n    __modifyMessage: function (message) {\n        if (message && message.sdp) {\n            if (typeof message.sdp === 'string') {\n                message.sdp = _util.parseJSON(message.sdp);\n            }\n            message.sdp.type && ( message.sdp.type =  message.sdp.type.toLowerCase());\n            message.cctx && (message.sdp.cctx = message.cctx);\n        }\n        if (message && message.cands) {\n            if (typeof message.cands === 'string') {\n                message.cands = _util.parseJSON(message.cands);\n            }\n\n            for (var i = 0; i < message.cands.length; i++) {\n                typeof message.cands[i] === 'string' && (message.cands[i] = _util.parseJSON(message.cands[i]));\n\n                message.cands[i].sdpMLineIndex = message.cands[i].mlineindex;\n                message.cands[i].sdpMid = message.cands[i].mid;\n\n                delete message.cands[i].mlineindex;\n                delete message.cands[i].mid;\n\n                message.cctx && (message.cands[i].cctx = message.cctx);\n            }\n        }\n\n        if (message && message.mems) {\n            if (!_util.isArray(message.mems)) {\n                return;\n            }\n\n            var _mems = message.mems;\n            message.mems = {};\n\n            _util.forEach(_mems, function (index, _mem) {\n                _mem.name && (_mem.memName = _mem.name);\n                message.mems[_mem.id] = _mem;\n\n                var acptOps = _mem.acptOps = {};\n                _util.forEach(emedia.config.baseAcptOps, function (_index, _oper) {\n                    acptOps[_oper] = true;\n                });\n                if(_mem.res){\n                    _util.forEach(_mem.res.ops, function (_index, _oper) {\n                        acptOps[_oper] = true;\n                    })\n                }\n\n                if(_mem && _mem.ext){\n                    try{\n                        message.mems[_mem.id].ext = JSON.parse(_mem.ext);\n                    }catch(e){\n                        _logger.debug(e);\n                    }\n                }\n            })\n        }\n\n        if (message && message.mem) {\n            message.mem.name && (message.mem.memName = message.mem.name);\n\n            var acptOps = message.mem.acptOps = {};\n            _util.forEach(emedia.config.baseAcptOps, function (_index, _oper) {\n                acptOps[_oper] = true;\n            });\n            if(message.mem.res){\n                _util.forEach(message.mem.res.ops, function (_index, _oper) {\n                    acptOps[_oper] = true;\n                })\n            }\n\n            if(message.mem && message.mem.ext){\n                try{\n                    message.mem.ext = JSON.parse(message.mem.ext);\n                }catch(e){\n                    _logger.debug(e);\n                }\n            }\n        }\n\n        if (message && message.streams) {\n            if (!_util.isArray(message.streams)) {\n                return;\n            }\n\n            var _streams = message.streams;\n            message.streams = {};\n\n            _util.forEach(_streams, function (index, _stream) {\n                message.streams[_stream.id] = _stream;\n\n                if(_stream && _stream.ext){\n                    try{\n                        message.streams[_stream.id].ext = JSON.parse(_stream.ext);\n                    }catch(e){\n                        _logger.debug(e);\n                    }\n                }\n            })\n        }\n\n        if (message && message.pubS) {\n            if(message.pubS && message.pubS.ext){\n                try{\n                    message.pubS.ext = JSON.parse(message.pubS.ext);\n                }catch(e){\n                    _logger.debug(e);\n                }\n            }\n        }\n\n\n        if(message && message.ext){\n            try{\n                message.ext = JSON.parse(message.ext);\n            }catch(e){\n                _logger.debug(e);\n            }\n        }\n\n        return message;\n    },\n\n    onMessage: function(servMessage){\n\n        var self = this;\n\n        function onFunc(servMessage) {\n\n            let fun_name = self._events[servMessage.op];\n\n            let onFunCallback = self[fun_name];\n\n            if (onFunCallback) {\n\n                onFunCallback.call(self, servMessage)\n\n            } else {\n                //throw \"Not supported event = \" + servMessage;\n                _logger.warn(\"Not supported event = \", servMessage);\n                return;\n            }\n        }\n\n        if(servMessage.op != 1001 && !servMessage.sessId){\n            _logger.error(\"message sessId error. server evt data error\");\n            throw \"message sessId error. server evt data error\";\n        }\n\n        if(servMessage.op != 1001 && self._sessionId && self._sessionId != servMessage.sessId){\n            _logger.error(\"message sessId error. server and local not equal\");\n            throw \"message sessId error. server and local not equal\";\n        }\n\n        if(servMessage.op === 1004){\n            onFunc(servMessage);\n            return;\n        }\n        \n        // 上麦申请 和主持人申请的回复\n        if(servMessage.op == 1001 && servMessage.arg) {\n\n            let { op2 } = JSON.parse(servMessage.arg);\n\n            if(op2 == 21){ //上麦申请 code\n                let { result } = servMessage;\n                self.onRequestToTalkerReply(result);\n                return\n            } else if(op2 == 22) { // 主持人申请 code\n                let { result } = servMessage;\n                self.onRequestToAdminReply(result);\n                return\n            }\n\n        }\n\n        servMessage = self.__modifyMessage(servMessage);\n        \n        \n        var preIp;\n        var reqMessage = _util.removeAttribute(self._callbacks, servMessage.tsxId);\n        if(reqMessage && reqMessage.op === 200){\n            self._sessionId = servMessage.sessId;\n            var nowIp = (typeof servMessage.yourIp === \"string\") ? servMessage.yourIp : undefined;\n\n            if((typeof self._session_ip === \"string\") && nowIp != self._session_ip){\n                preIp = self._session_ip;\n            }\n\n            _logger.info(self._sessionId, \"ip is\", nowIp, preIp);\n            self._session_ip = nowIp;\n            self.owner.ip = nowIp;\n\n            if(servMessage.result === 0) { //enter 成功\n\n                for(var index in self._bufferedMessages){\n                    var message = self._bufferedMessages[index];\n\n                    if(!message.sessId && message.op !== 200){\n                        message.sessId = servMessage.sessId;\n                    }\n                }\n\n                setTimeout(function () {\n                    self.notifyNewMessage();\n                }, 100);\n\n\n                //用来回调会议属性监听函数\n                // 只在加入后（200） 和 有修改时（402）回调上去\n                if(servMessage.op == 1001 && (servMessage.cattrs || servMessage.cstate)) { \n                    self.onConfrAttrsUpdated(servMessage);\n                }\n\n            } else {\n                var bufferedMessage;\n                while((bufferedMessage = self._bufferedMessages.shift())){\n                    if(bufferedMessage.op === 200){\n                        continue;\n                    }\n\n                    self.onMessage({op: 1001, tsxId: bufferedMessage.tsxId, result: -9527, msg: \"sdk enter fail. sdk callback. enter result = \" + servMessage.result});\n                }\n            }\n        }\n\n        if(self.owner && self.owner.closed){\n            _logger.warn(\"self closed. me is \" + self.owner.getMemberId() + \", session_id = \" + self.getSessionId() + \". drop message\", servMessage);\n            return;\n        }\n\n        \n        self.onEvent(new __event.RecvResponse({request: reqMessage, response: servMessage}));\n\n        \n\n        if(reqMessage && reqMessage.__callback__ && servMessage.op !== 1004){\n            reqMessage.__callback__(servMessage);\n            preIp && self.onWebsocketEvent(new __event.NetworkChanaged({preIp: preIp, nowIp: self._session_ip}));\n            return;\n        }\n        \n        if(!servMessage.op || servMessage.op == 1001){\n            _logger.debug(\"Igron message. caused by op not found.\", servMessage);\n            return;\n        }\n\n\n        onFunc(servMessage);\n        preIp && self.onWebsocketEvent(new __event.NetworkChanaged({preIp: preIp, nowIp: self._session_ip}));\n    },\n\n    __modifyMessageForPost: function (message) {\n        if (message.cands) {\n            var _cands = [];\n\n            var cands = message.cands;\n            for (var i = 0; i < cands.length; i++){\n                var _cand;\n\n                if(i == 0){\n                    cands[i].cctx && (message.cctx = cands[i].cctx);\n                }\n\n                if(typeof cands[i] === \"string\"){\n                    _cand = {\n                        type: \"candidate\",\n                        candidate: cands[i],\n                        mlineindex: 0,\n                        mid: \"audio\"\n                        // seq: i\n                    };\n                }else {\n                    // if (cands[i].type && cands[i].type == \"candidate\") {\n                    //     _cands.push(cands[i]);\n                    //     continue;\n                    // }\n\n                    _cand = {\n                        type: \"candidate\",\n                        candidate: cands[i].candidate,\n                        mlineindex: cands[i].sdpMLineIndex,\n                        mid: cands[i].sdpMid\n                        // seq: i\n                    };\n                }\n\n                _cands.push(JSON.stringify(_cand));\n            }\n\n            message.cands = _cands;\n        }\n\n        if (message.sdp && (typeof message.sdp !== \"string\")) {\n            var _sdp = {\n                type: message.sdp.type,\n                sdp: message.sdp.sdp\n            };\n\n            message.sdp.cctx && (message.cctx = message.sdp.cctx);\n\n            message.sdp = _sdp;\n\n            message.sdp.type = message.sdp.type.toUpperCase();\n            message.sdp = _util.stringifyJSON(message.sdp);\n        }\n\n        // if(message.ext && _util.isPlainObject(message.ext)){\n        //     message.ext = JSON.stringify(message.ext);\n        // }\n\n        message.pubS && _util.removeAttribute(message.pubS, \"_located\");\n        message.pubS && _util.removeAttribute(message.pubS, \"mutedMuted\");\n        message.pubS && _util.removeAttribute(message.pubS, \"mediaStream\");\n        message.pubS && _util.removeAttribute(message.pubS, \"isRepublished\");\n        message.pubS && _util.removeAttribute(message.pubS, \"optimalVideoCodecs\");\n\n        typeof message.post === \"function\" && _util.removeAttribute(message, \"post\");\n\n        return message;\n    },\n\n    postMessage: function(message, callback, timeoutMillis) {\n\n        if(message.op == 1002) {\n            console.log('postMessage 1002', JSON.stringify(message));\n            \n        }\n        var self = this;\n\n        if (!message.tsxId) {\n            message.tsxId = (\"MSG\" + Date.now() + \"-\" + (__session_globalCount++));\n        }\n\n        if(message.memId){\n            var _mem = self.owner._cacheMembers[message.memId];\n\n\n            // 动作消息、不执行 _cacheMembers内查找\n            let { arg } = message;\n            let is_action_message = false;\n            if(arg) {\n                arg = JSON.parse(arg);\n                if(\n                    arg.op2 == 21 ||\n                    arg.op2 == 22 ||\n                    arg.op2 == 23 ||\n                    arg.op2 == 24 \n                ){\n                    is_action_message = true\n                }\n            }\n\n\n            if(!_mem && !is_action_message){\n                _logger.warn(\"Member not found at local. memberId = \" + message.memId, message);\n                callback && callback({op: 1001, tsxId: message.tsxId, result: -507, msg: \" member not found at local. memberId = \" + message.memId});\n                return;\n            }\n\n            var reqOps = message._reqOps;\n            if(!reqOps){\n                reqOps = [];\n                reqOps.push(message.op);\n            }\n\n            if(!is_action_message) {//动作消息 不走这里 \n                for(var index in reqOps){\n                    var _reqOp = reqOps[index];\n    \n                    if(!_mem.acptOps[_reqOp]){\n                        _logger.warn(\"Member not accept op \" + _reqOp + \", \" + message.memId, message);\n                        callback && callback({op: 1001, tsxId: message.tsxId, result: -507, msg: \" member not accept op \" + _reqOp + \", \" + message.memId});\n                        return;\n                    }\n                }\n            }\n        }\n        _util.removeAttribute(message, '_reqOps');\n\n        if (self._sessionId && self._sessionId != message.sessId) {\n            _logger.warn(\"sessionId not excepted. self._sessionId = \" + self._sessionId, message);\n            callback && callback({op: 1001, tsxId: message.tsxId, result: -9527, msg: \"sessionId not excepted.\"});\n            return;\n        }\n        if (self.closed) {\n            _logger.warn(\"session closed.\", message);\n            callback && callback({op: 1001, tsxId: message.tsxId, result: -9527, msg: \"session closed\"});\n            return;\n        }\n\n        var oldMessage = _util.extend({}, message);\n        message = self.__modifyMessageForPost(message);\n        if(!message){\n            _logger.warn(\"Message drop. callback success.\", message);\n            callback && callback({op: 1001, tsxId: oldMessage.tsxId, result: 0, msg: \"Message drop. callback success.\"});\n            return;\n        }\n\n        if(message.op === 200){ // enter 放在首位\n            self._bufferedMessages.unshift(message);\n\n            if(callback){\n                setTimeout(function () {\n                    if(!self._callbacks[message.tsxId]){\n                        return;\n                    }\n\n                    _logger.error(\"Enter timeout. fail.\");\n                    self.onMessage({op: 1001, tsxId: message.tsxId, result: -9527, msg: \"enter timeout. millis = \" + emedia.config.enterTimeout});\n                }, emedia.config.enterTimeout);\n            }\n        } else {\n            self._bufferedMessages.push(message);\n        }\n\n        callback && (self._callbacks[message.tsxId] =  _util.extend(message, {\n            __callback__: callback.bind(self.owner)\n        }));\n\n        self.notifyNewMessage && self.notifyNewMessage();\n\n        if(timeoutMillis && callback){\n            setTimeout(function () {\n                var message = self._callbacks[message.tsxId];\n\n                if(message && message.__callback__){\n                    message.__callback__({op: 1001, tsxId: oldMessage.tsxId, result: -408, msg: \"Message request timeout.\"});\n                }\n\n                _util.removeAttribute(self._callbacks, message.tsxId);\n            }, timeoutMillis);\n        }\n    },\n\n    close: function (reason) {\n        _logger.warn(\"sessiong closing, reason = \", reason);\n\n        var self = this;\n\n        self.notifyNewMessage && self.notifyNewMessage();\n\n        self.closed = true;\n\n        self.seqno = 0;\n\n        self._websocket && ((reason == 0 || reason == 100) ? self._websocket.close(1000) : self._websocket.close());\n\n        self.__retryConnectIntervalId && clearTimeout(self.__retryConnectIntervalId);\n        self.__retryConnectIntervalId && delete self.__retryConnectIntervalId;\n\n        self.__checkConnectIntervalId && clearTimeout(self.__checkConnectIntervalId);\n        self.__checkConnectIntervalId && delete self.__checkConnectIntervalId;\n\n        self.owner = null;\n        //self._sessionId = null;\n\n        self._bufferedMessages = [];\n        self._callbacks = {};\n\n        _logger.warn(\"session closed\");\n    }\n});\n\n","\nfunction DeployMore(rtcConfigUrl) {\n    this.rtcconfig = undefined;\n    this.rtcConfigUrl = rtcConfigUrl;\n    this.get_rtcconfig()\n}\n\nDeployMore.prototype = {\n    \n    get_rtcconfig() {\n\n        let option = {\n            url:'https://rs.easemob.com/easemob/rtcconfig.json',\n            async:false\n        }\n        if(this.rtcConfigUrl) {\n            option.url = this.rtcConfigUrl;\n        }\n        let _this = this;\n\n        let rtcconfig = undefined;\n\n        try {\n            $.ajax({\n                ...option,\n                success: data => {\n                    console.log('get_rtcconfig success');\n                    \n                    if(\n                        data &&\n                        Object.keys(data).length > 0\n                    ) {\n                        _this.rtcconfig = data;\n                        rtcconfig = data\n                    }\n                },\n\n                error: error => {\n                    console.error('DeployMore get error', error);\n                    return error\n                }\n            })\n        } catch (error) {\n            return\n        }\n        \n        \n        return rtcconfig;\n    },\n\n    replace_ws(url){\n        if(\n            this.rtcconfig && \n            this.rtcconfig.ws\n        ) {\n            let new_url = 'wss://' + this.rtcconfig.ws + '/';\n            let RegExp = /wss.*com\\//;\n\n            return url.replace(RegExp,new_url);\n        }\n\n        return url\n    },\n\n    _get_info_from_candifate (candidate) { //在candidate 中获取 ip port\n        if(!candidate){\n            return {}\n        }\n\n        let info = {};\n        candidate = candidate.split(' ');\n        info.ip = candidate[4]\n        info.port = candidate[5]\n\n        // candidate.replace(/(candidate:\\d+\\s+\\d+\\s+UDP\\s+\\d+\\s+)([\\d\\.]+)\\s+(\\d+)(\\s+.*)/g, \n        //                 function (all, $pre, $ip, $port, $after) {\n        //                     // console.log(all);\n        //                     // console.log(pre, ip, port, after);\n        //                     // return $pre + ip + \" \" + port + $after;\n        //                     info.ip = $ip;\n        //                     info.port = $port;\n        //                 }\n        // );\n\n        return info\n    },\n    // 判断是否可替换 \n    // dst_obj: rtcconfig 中的每一candidate 项，\n    // ip：待替换candidate ip\n    // port：待替换candidate port\n    _can_replace(dst_obj, ip, port) {\n        if(\n            !dst_obj ||\n            !ip ||\n            !port\n        ) {\n            return false\n        }\n\n        if(\n            !dst_obj.src.ip\n        ) {\n            return false\n        }\n\n        if(\n            dst_obj.src.ip != ip\n        ) {\n            return false\n        }\n\n        if(\n            dst_obj.src.min_port > port ||\n            dst_obj.src.max_port < port\n        ) {\n            return false\n        }\n        \n        return true\n\n    },\n    _replace_candidate(candidate) {\n\n        /*\n            * \"candidate_map\": [\n            *   {\n            *       \"dst\": {\n            *           \"ip\": \"10.66.204.222\",\n            *           \"min_port\": \"32355\",\n            *           \"max_port\": \"65535\"\n            *       },\n            *       \"src\": {\n            *           \"ip\": \"39.107.157.65\",\n            *           \"min_port\": \"32355\",\n            *           \"max_port\": \"65535\"\n            *       }\n            *   },\n            * ]\n            * \n            * candidate:3 1 UDP 2013266431 116.62.36.187 31574 typ host\n            * 匹配到 src 就会 替换成映射的 dst\n        */\n        let ip_and_port = this._get_info_from_candifate(candidate);\n        let {ip, port} = ip_and_port;\n\n        let _this = this;\n        this.rtcconfig.rtc.candidate_map.map(item => {\n            // 在 map 中查找 相同的ip 和 范围区间内的 port; 两者必须同时满足\n            // 将 src 映射到 dst\n\n            if(_this._can_replace(item, ip, port)){\n                let new_ip = item.dst.ip;\n\n                // 替换 port\n                let port_difference_value = Number(port) - Number(item.src.min_port); // 即将被替换的 candidate 的port 在最大和最小的port的范围\n                let new_port = Number(item.dst.min_port) + Number(port_difference_value);\n\n                let cands_arr = candidate.split(' ');\n                cands_arr[4] = new_ip;\n                cands_arr[5] = new_port;\n\n                candidate = cands_arr.join(' ');\n                // candidate = candidate.replace(/(candidate:\\d+\\s+\\d+\\s+UDP\\s+\\d+\\s+)([\\d\\.]+)\\s+(\\d+)(\\s+.*)/g, \n                // function (all, $pre, $ip, $port, $after) {\n                //     // console.log(all);\n                //     // console.log(pre, ip, port, after);\n                //     return ($pre + new_ip + \" \" + new_port + $after);\n                // });\n            }\n            \n        })\n\n        return candidate\n    },\n\n    replace_candidates(candidates) {\n\n        if(!this.rtcconfig) {\n            return candidates\n        }\n\n        let _this = this;\n        \n        // 循环 candidates 数组 去替换\n        candidates = candidates.map(item => {\n            \n            if(\n                item && \n                item.candidate\n            ) {\n                item.candidate = _this._replace_candidate(item.candidate);\n                return item\n            }\n\n            return item\n        })\n\n\n\n        return candidates\n    },\n\n    // 1v1 替换 turn 地址\n    replace_trun_url: function replace_trun_url(rtcCfg) {\n\n        // 解析替换\n        if (this.rtcconfig && this.rtcconfig.turn) {\n\n            let { iceServers } = rtcCfg;\n            if(!iceServers) {\n              return rtcCfg\n            }\n\n            if(iceServers instanceof Array == false) {\n              return rtcCfg\n            }\n\n            let new_turn = this.rtcconfig.turn\n            iceServers = iceServers.map(item => {\n                if(item.url) {\n                    item.url = 'turn:' + new_turn\n                }\n            })\n            return rtcCfg;\n        }\n\n        return rtcCfg; //如果没有不替换\n    }\n}\nexport default DeployMore;","var _util = require('./Util');\nvar _logger = _util.tagLogger(\"Me\");\n\nvar Member = require('./_Member');\n\nvar __event = require('./event');\n\nvar Stream = require('./_Stream');\n\n/**\n * 未体现 member 使用了 session。\n * 请 这样创建\n * Member({_session: sess})\n *\n *\n * close:\n * 1.服务端 踢掉\n * 2.手动点击 挂断\n * 3.enter失败！\n *\n * websocket 断开连接后，并不会 去close。因为发送消息可以实现重连，重新enter\n *\n *\n */\nvar Attendee = Member.extend({\n    __init__: function(){\n        var self = this;\n\n        self._session || (self.sessionFactory && (self._session = self.sessionFactory()));\n\n        if(!self._session) {\n            _logger.error(\"Require session\");\n            throw \"Require session\";\n        }\n\n        self._cver = 0;\n\n        self._cacheMembers = {};\n        self._cacheStreams = {};\n        self._streamAutomators = {};\n        self._mediaMeters = {};\n        self._openedRtcMediaStreams = {};\n\n        self._linkedStreams = {};\n        self._maybeNotExistStreams = {}; //与self._streams结构相同，用 存储 断网时，ice fail的stream对象。这个对象可能不存在了\n\n        self._records = {};\n\n        self._ices = {};\n        self.audioMixers = {};\n\n        self.closed = false;\n\n        self._nextStreamSeqno = 0;\n\n        self.getMediaMeterIntervalMillis = self.getMediaMeterIntervalMillis || emedia.config.getMediaMeterIntervalMillis;\n    },\n\n    getCurrentMembers: function () {\n        var self = this;\n\n        var members = [];\n        _util.forEach(self._cacheMembers, function (_memId, _cacheMember) {\n            var member = _util.extend(true, {}, _cacheMember);\n            members.push(member);\n        });\n\n        return members;\n    },\n\n    newStream: function(cfg){\n        var attendee = this;\n\n        return new Stream(cfg, {\n            __init__: function () {\n                var self = this;\n\n                self.rtcId || (self._webrtc && (self.rtcId = self._webrtc.getRtcId()));\n                self._webrtc || (self.rtcId && (self._webrtc = attendee._ices[self.rtcId]));\n\n                self.__create_id = attendee._nextStreamSeqno++;\n\n                if(self.memId && !self.owner){\n                    self.owner = _util.extend({}, attendee._cacheMembers[self.memId]);\n                    if(!self.owner && !self.located()){\n                        _logger.error(\"Remote stream, not owner. it = \", self.id);\n                        throw \"Remote stream, not owner. it = \" + self.id;\n                    }\n                }\n            }\n        });\n    },\n\n    getConfrId: function(){\n        return this.ticket.confrId;\n    },\n    isCaller: function () {\n        var self = this;\n        return self.isP2P() && self.ticket.caller == self.ticket.memName;\n    },\n    isCallee: function () {\n        var self = this;\n        return self.isP2P() && self.ticket.callee == self.ticket.memName;\n    },\n    isP2P: function () {\n        var self = this;\n        return self.ticket && (self.ticket.type == \"P2P\" || self.ticket.type == \"p2p\");\n    },\n    isConfr: function () {\n        var self = this;\n        return self.ticket && (self.ticket.type == \"CONFR\" || self.ticket.type == \"confr\");\n    },\n\n    onEvent: function (evt) {\n\n    },\n\n    join: function(joined, joinError){\n        var self = this;\n\n        if(!emedia.requireTrustBeforeJoin()){\n            self._join(joined, joinError);\n            return;\n        }\n\n        self.someBrowsersRequireGetUserMedia(function () {\n            self._join(joined, joinError);\n        }, joinError)\n    },\n    _join: function(joined, joinError){\n        _logger.debug(\"begin join ...\");\n\n\n\n        var self = this;\n        console.log('Attendee self', self);\n\n        var enter;\n\n        if(self._memberId){\n            _logger.warn(\"Had joined. igrone it\");\n            joined && joined(self.memId);\n            return;\n        }\n\n        function onJoinError(_event_) {\n            try{\n                if((_event_ instanceof __event.WSClose) && _event_.retry){\n                    return;\n                }\n\n                if(!(_event_ instanceof __event.EnterFail)){\n                    _event_ = new __event.EnterFail({ //可能是 websocket 链接未成功\n                        attendee: self,\n                        cause: _event_,\n                    });\n                }\n\n                self.onEvent(_event_);\n                joinError && joinError(_event_);\n            } finally {\n\n            }\n        }\n\n        function enterRsp(rsp) {\n            if(rsp.result != 0){\n                try{\n                    onJoinError(new __event.RspFail({request: enter, response: rsp}));\n                } finally {\n                    if(rsp.result !== -9527){ //-9527 客户端 自己返回，网络未通， 其他值服务端返回\n                        self.onEvent(new __event.ServerRefuseEnter({failed: rsp.result, msg: rsp.msg}));\n                    }\n                }\n\n                return;\n            }\n\n            self.reflushSupportVCodes(rsp.vcodes);\n\n            self.setMemberId(rsp.memId);\n            self.role = rsp.role;\n\n            self.onEvent(new __event.EnterSuccess({ip: self.ip}));\n\n            joined && joined(rsp.memId);\n\n            try{\n                self.__rtc_cfg = rsp.rtcCfg;\n                if(typeof rsp.rtcCfg === 'string'){\n                    self.__rtc_cfg = JSON.parse(rsp.rtcCfg);\n                }\n            }finally {\n                self.onMembers(rsp.cver, rsp.mems);\n                self.onStreams(rsp.cver, rsp.streams);\n            }\n        }\n\n        function onConnected() {\n            enter = self.newMessage()\n                .setOp(200)\n                .setTicket(self.ticket)\n                .setNickName(self.nickName || self.ticket.memName)\n                .setResource(self.resource)\n                .setExt(self.ext);\n            self.postMessage(enter, enterRsp);\n        }\n\n        self.connect(onConnected, onJoinError);\n        _logger.debug(\"join\", self.ticket.url);\n    },\n\n    withpublish: function (pubS) {\n        var self = this;\n\n        if(!pubS || !pubS.localStream){\n            _logger.error(\"pubS null or stream not open\");\n            throw \"pubS null or stream not open\";\n        }\n\n        var enter;\n\n        var openedStream = pubS && pubS.localStream;\n\n        var webrtc;\n\n        function then(joined, joinError) {\n            if(arguments.length === 1){\n                joinError = joined;\n                joined = undefined;\n            }\n\n            if(self._memberId){\n                _logger.warn(\"Had joined. igrone it\");\n                joined && joined(self.memId);\n                return;\n            }\n\n\n            function onJoinError(_event_) {\n                try{\n                    if((_event_ instanceof __event.WSClose) && _event_.retry){\n                        return;\n                    }\n\n                    if(!(_event_ instanceof __event.EnterFail)){\n                        _event_ = new __event.EnterFail({ //可能是 websocket 链接未成功\n                            attendee: self,\n                            cause: _event_,\n                        });\n                    }\n\n                    self.onEvent(_event_);\n                    joinError && joinError(_event_);\n                } finally {\n                    emedia.stopTracks(openedStream);\n\n                    webrtc && self.closeWebrtc(webrtc.getRtcId());\n                }\n            }\n\n\n            var optimalVideoCodecs = self.getOptimalVideoCodecs();\n\n            function enterRsp(rsp) {\n                if(rsp.result != 0){\n                    try{\n                        onJoinError(new __event.RspFail({request: enter, response: rsp}));\n                    } finally {\n                        if(rsp.result !== -9527){ //-9527 客户端 自己返回，网络未通， 其他值服务端返回\n                            self.onEvent(new __event.ServerRefuseEnter({failed: rsp.result, msg: rsp.msg}));\n                        }\n                    }\n\n                    return;\n                }\n\n                self.reflushSupportVCodes(rsp.vcodes);\n\n                self.setMemberId(rsp.memId);\n                self.role = rsp.role;\n\n                self.onEvent(new __event.EnterSuccess({ip: self.ip}));\n\n                var stream = self.newStream(pubS);\n                stream.updateAttributes({\n                    _localMediaStream: pubS.localStream,\n                    rtcId:  webrtc.getRtcId(),\n                    _webrtc:  webrtc,\n                    id:  rsp.streamId,\n                    csrc:  rsp.csrc,\n                    owner: {id: rsp.memId, nickName: self.nickName, name: self.sysUserId, ext: self.extObj},\n                    optimalVideoCodecs: optimalVideoCodecs\n                });\n\n                joined && joined(rsp.memId, stream);\n                webrtc.useIp = self.ip;\n                self.onEvent(new __event.PushSuccess({stream: stream, hidden: true})); //ice重连成功后 会 再次 onEvent PushSuccess\n\n                rsp.sdp && self.ansC(webrtc.getRtcId(), rsp.sdp);\n                rsp.cands && self.tcklC(webrtc.getRtcId(), rsp.cands)\n\n                try{\n                    self.__rtc_cfg = rsp.rtcCfg;\n                    if(typeof rsp.rtcCfg === 'string'){\n                        self.__rtc_cfg = JSON.parse(rsp.rtcCfg);\n                    }\n                    if(self.__rtc_cfg && self.__rtc_cfg.iceServers && self.__rtc_cfg.iceServers.length > 0){\n                        _logger.warn(\"Server rsp one rtc cfg. publish will republish\");\n\n                        self._service && setTimeout(function () {\n                            self._service._republish(stream);\n                        }, 200);\n                    }\n                }finally {\n                    self.onMembers(rsp.cver, rsp.mems);\n                    self.onStreams(rsp.cver, rsp.streams);\n                }\n            }\n\n            function onConnected() {\n                _logger.debug(\"enter and pubs\");\n\n                var stream = pubS.localStream;\n\n                var offerOptions, subArgs;\n                if(pubS.type === 2){\n                    offerOptions = {\n                        offerToReceiveAudio: true,\n                        offerToReceiveVideo: false\n                    };\n                    subArgs = {\n                        subSVideo: false,\n                        subSAudio: true\n                    };\n                }\n\n                webrtc = self.createWebrtc({\n                    _rtcId: pubS.rtcId,\n                    optimalVideoCodecs: optimalVideoCodecs,\n                    offerOptions: offerOptions,\n                    subArgs: subArgs,\n                    vbitrate: pubS.vbitrate || (pubS.constaints && pubS.constaints.video && pubS.constaints.video.bitrate),\n                    abitrate: pubS.abitrate || (pubS.constaints && pubS.constaints.audio && pubS.constaints.audio.bitrate)\n                }, pubS.iceRebuildCount);\n                self.setLocalStream(stream, webrtc.getRtcId());\n\n                self.doOffer(webrtc.getRtcId(), function (sdp) {\n                    enter = self.newMessage()\n                        .setOp(200)\n                        .setTicket(self.ticket)\n                        .setNickName(self.nickName || self.ticket.memName)\n                        .setResource(self.resource)\n                        .setSdp(sdp)\n                        .setRtcId(webrtc.getRtcId())\n                        .setPubS(pubS)\n                        .setExt(self.ext);\n                    self.postMessage(enter, enterRsp);\n                });\n            }\n\n            self.connect(onConnected, onJoinError);\n            _logger.debug(\"join\", self.ticket.url);\n        }\n\n        return {\n            join: then\n        }\n    },\n\n    push: function(pubS, pushed, onPushError, autoPush){\n        _logger.debug(\"begin push ...\");\n\n        var self = this;\n\n        if(arguments.length === 2){\n            onPushError = pushed;\n            pushed = undefined;\n        }\n\n\n        if(!pubS || !pubS.localStream){\n            _logger.error(\"pubS or stream open\");\n            throw \"pubS or stream open\";\n        }\n\n\n        var initC;\n\n        var openedStream = pubS.localStream;\n\n        var webrtc;\n\n        function _onPushError(_event_) {\n            try{\n                var stream = self.newStream(pubS);\n                stream.updateAttributes({\n                    _localMediaStream: pubS.localStream,\n                    _webrtc: webrtc,\n                    rtcId: webrtc && webrtc.getRtcId(),\n                    owner: {id: self.getMemberId(), nickName: self.nickName, name: self.sysUserId, ext: self.extObj}\n                });\n\n                var _event_ = new __event.PushFail({\n                    stream: stream,\n                    cause: _event_,\n                    hidden: (autoPush && _event_.hidden === true)\n                });\n\n                self.onEvent(_event_);\n                _event_.hidden || (onPushError && onPushError(_event_));\n            } finally {\n                if (openedStream && _event_.hidden !== true) {\n                    emedia.stopTracks(openedStream);\n                }\n\n                webrtc && self.closeWebrtc(webrtc.getRtcId(), _event_.hidden === true);\n            }\n        }\n\n        if(!pubS.rtcId && pubS.type === 2 && !emedia.config.allowRepeatAudioMixerPublish && self._service.hasAudioMixers()){\n            _onPushError(new __event.AudioMixerStreamRepeatPublish());\n            return;\n        }\n\n        var optimalVideoCodecs = pubS.optimalVideoCodecs || self.getOptimalVideoCodecs();\n\n        function pushRsp(webrtc, rsp) {\n            if(rsp.result != 0){\n                _onPushError(new __event.RspFail({request: initC, response: rsp, hidden: rsp.retrying === true}));\n\n                return;\n            }\n\n            var stream = self.newStream(pubS);\n\n            stream.updateAttributes({\n                _localMediaStream: pubS.localStream,\n                _webrtc: webrtc,\n                rtcId: webrtc.getRtcId(),\n                id: rsp.streamId,\n                csrc: rsp.csrc,\n                owner: {id: self.getMemberId(), nickName: self.nickName, name: self.sysUserId, ext: self.extObj},\n                optimalVideoCodecs: optimalVideoCodecs\n            });\n\n            stream.id && (stream.type === 2) && (self.audioMixers[stream.id] = stream);\n\n            try{\n                self.onEvent(new __event.PushSuccess({stream: stream, hidden: true})); //ice重连成功后 会 再次 onEvent PushSuccess\n            } finally {\n                rsp.sdp && self.ansC(webrtc.getRtcId(), rsp.sdp);\n                rsp.cands && self.tcklC(webrtc.getRtcId(), rsp.cands);\n\n                pushed && pushed(stream);\n            }\n        }\n\n        function pub(pubS) {\n            _logger.debug(\"pubs\");\n\n            var stream = pubS.localStream;\n\n            var offerOptions, subArgs;\n            if(pubS.type === 2){\n                offerOptions = {\n                    offerToReceiveAudio: true,\n                    offerToReceiveVideo: false\n                };\n                subArgs = {\n                    subSVideo: false,\n                    subSAudio: true\n                };\n            }\n\n            webrtc = self.createWebrtc({\n                _rtcId: pubS.rtcId,\n                optimalVideoCodecs: optimalVideoCodecs,\n                offerOptions: offerOptions,\n                subArgs: subArgs,\n                vbitrate: pubS.vbitrate || (pubS.constaints && pubS.constaints.video && pubS.constaints.video.bitrate),\n                abitrate: pubS.abitrate || (pubS.constaints && pubS.constaints.audio && pubS.constaints.audio.bitrate)\n            }, pubS.iceRebuildCount);\n\n            self.setLocalStream(stream, webrtc.getRtcId());\n\n            // 推流时增加分辨率参数 如果有\n            if( pubS.constaints && pubS.constaints.video ) {\n                // video = {\n                //     width: {\n                //         exact: 1280\n                //     },\n                //     height: {\n                //         exact: 720\n                //     }\n                // }\n                let { width, height } = pubS.constaints.video;\n                if( width && height ){\n                    let width_resolution = width.exact || width.min;\n                    let height_resolution = height.exact || height.min;\n\n                    let resolution = {\n                        w:width_resolution,\n                        h:height_resolution\n                    }\n                    pubS.resolution = resolution\n                }\n\n            }\n\n            self.doOffer(webrtc.getRtcId(), function (sdp) {\n                initC = self.newMessage()\n                    .setOp(102)\n                    .setRtcId(webrtc.getRtcId())\n                    .setSdp(sdp)\n                    .setPubS(pubS);\n\n                self.postMessage(initC, function (rsp) {\n                    pushRsp(webrtc, rsp);\n                });\n            });\n        }\n\n        pub(pubS);\n        _logger.debug(\"push\", self.ticket.url);\n    },\n\n    isSafari: function () {\n        //return /Safari/.test(navigator.userAgent) && !/Chrome/.test(navigator.userAgent);\n        return emedia.isSafari;\n    },\n\n    //有些机器必须得getUserMedia后才能够产生正常得cands\n    //比如 safair不调用getUserMedia，将不产生cands；window chrome75，则产生得cands中没有ip 而且 uuid.local\n    someBrowsersRequireGetUserMedia: function (successOpenMedia, failOpenMedia) {\n        var self = this;\n\n        if(emedia.youInSomeBrowsers() && !emedia._yetGetUserMedia){\n            if(self.__tryingOpenMedia === true){\n                self.__tryingOpenMediaWaitSuceess = (self.__tryingOpenMediaWaitSuceess || []);\n                self.__tryingOpenMediaWaitFail = (self.__tryingOpenMediaWaitFail || []);\n\n                if(typeof successOpenMedia === \"function\"){\n                    self.__tryingOpenMediaWaitSuceess.push(successOpenMedia);\n                }\n                if(typeof failOpenMedia === \"function\"){\n                    self.__tryingOpenMediaWaitFail.push(failOpenMedia);\n                }\n            }else {\n                self.__tryingOpenMedia = true;\n\n                function success(_user, mediaStream) {\n                    emedia._yetGetUserMedia = true;\n                    // setTimeout(function () {\n                    //     emedia.stopAudioTracks(mediaStream);\n                    // }, 700);\n                    emedia.stopTracks(mediaStream);\n\n                    setTimeout(function () {\n                        self.__tryingOpenMedia = false;\n                        successOpenMedia && successOpenMedia.apply(self);\n                        self.__tryingOpenMediaWaitSuceess && _util.forEach(self.__tryingOpenMediaWaitSuceess, function (index, func) {\n                            func.apply(self);\n                        });\n                        self.__tryingOpenMediaWaitSuceess = [];\n                        self.__tryingOpenMediaWaitFail = [];\n                    }, 300);\n                }\n\n                function error(event) {\n                    self.__tryingOpenMedia = false;\n                    _logger.error(\"Some browsers must getUserMedia, gather cands. now try get audio. fail. subfail\");\n\n                    failOpenMedia && failOpenMedia.call(self, event);\n                    self.__tryingOpenMediaWaitFail && _util.forEach(self.__tryingOpenMediaWaitFail, function (index, func) {\n                        func.call(self, event);\n                    });\n                    self.__tryingOpenMediaWaitSuceess = [];\n                    self.__tryingOpenMediaWaitFail = [];\n                }\n\n                self._service.__getUserMedia({audio: true}, success, function (event) {\n                    self._service.__getUserMedia({video: true}, success, error);\n                });\n            }\n            return true;\n        }\n\n        return false;\n    },\n\n    createWebrtcAndSubscribeStream: function (streamId, callbacks, iceServerConfig, subArgs) {\n        var self = this;\n\n        callbacks || (callbacks = {});\n\n        var subStream = self._cacheStreams[streamId];\n        var subMember = self._cacheMembers[subStream.memId];\n\n        //var stream = self.newStream(subStream);\n        var stream = subStream;\n        subArgs = subArgs || stream.subArgs || {subSVideo: true, subSAudio: (subStream.type !== 2)}; //混音自动订阅不要订阅音频\n\n        function _onSubFail(evt) {\n            _logger.warn(\"sub stream error\", streamId, evt);\n\n            preSubArgs && stream._webrtc && stream._webrtc.setSubArgs(preSubArgs);\n            preSubArgs && (stream.updateAttributes({subArgs: preSubArgs}));\n\n            evt = new __event.SubFail({\n                stream: stream,\n                hidden: evt.hidden === true,\n                cause: evt\n            });\n\n            callbacks && callbacks.onEvent && callbacks.onEvent(evt);\n            self.onEvent && self.onEvent(evt);\n        }\n        function _onSubSuccess() {\n            stream.updateAttributes(stream.subArgs);\n        }\n\n\n        var pubStreamVCodes = subStream.vcodes || [];\n        var pubMemberSupportVCodes = subMember && subMember.vcodes || [];\n        var selfSupportVCodes = self.supportVCodes;\n\n        var optimalVideoCodecs = self._getOptimalVideoCodecsSubset(pubStreamVCodes, pubMemberSupportVCodes, selfSupportVCodes);\n\n\n        // if(!stream.voff && subArgs.subSVideo && optimalVideoCodecs.length == 0){ // 订阅视频 但是 没有相同的 视频编码格式。失败\n        //     _onSubFail(_util.extend(new __event.SubFail(), new __event.SubFailNotSupportVCodes({\n        //         stream: stream\n        //     })));\n        //     return;\n        // }\n\n        subArgs = subArgs || stream.subArgs;\n\n        var preSubArgs = stream.subArgs;\n\n        var withoutVideo = !(stream.vcodes && stream.vcodes.length > 0);\n        emedia.isSafari && (withoutVideo = withoutVideo || !!stream.voff);\n\n        var offerOptions = {\n            offerToReceiveAudio: true,\n            offerToReceiveVideo: (subArgs.subSVideo && !withoutVideo)\n        };\n\n        if(!offerOptions.offerToReceiveAudio && !offerOptions.offerToReceiveVideo){\n            _logger.warn(\"offerToReceiveAudio == false and offerToReceiveVideo == false\");\n        }\n\n        function createWebrtcAndInit() {\n            var webrtc = self.createWebrtc({\n                iceServerConfig: iceServerConfig,\n                optimalVideoCodecs: optimalVideoCodecs,\n                offerOptions: offerOptions,\n\n                onGotMediaStream: function (remoteMediaStream) {\n                    callbacks.onGotRemote && callbacks.onGotRemote(stream);\n                    // self.onEvent && self.onEvent(new __event.SubSuccess({\n                    //     stream: stream,\n                    //     hidden: true\n                    // }));\n                }\n            }, stream.iceRebuildCount);\n            var rtcId = webrtc.getRtcId();\n\n            _logger.warn(rtcId, \" sub stream \", streamId, optimalVideoCodecs);\n\n            stream.updateAttributes({\n                _webrtc: webrtc,\n                rtcId: rtcId,\n                owner: _util.extend({}, subMember)\n            });\n\n            subArgs && stream._webrtc && stream._webrtc.setSubArgs(subArgs);\n            subArgs && (stream.updateAttributes({subArgs: subArgs}));\n        }\n\n        if(self.someBrowsersRequireGetUserMedia(function success() {\n            createWebrtcAndInit();\n            self.offerCall(stream.rtcId, null, streamId, _onSubFail, _onSubSuccess);\n        }, function (event) {\n            _logger.error(\"Some browsers must getUserMedia, gather cands. now try get audio. fail. subfail\", streamId);\n            _onSubFail(event);\n        })){ // safari 如果没有getUserMedia时，是不会生成cands的\n        }else{\n            createWebrtcAndInit();\n            self.offerCall(stream.rtcId, null, streamId, _onSubFail, _onSubSuccess);\n        }\n    },\n\n    _getOptimalVideoCodecsSubset: function (pubStreamVCodes, pubMemberSupportVCodes, selfSupportVCodes) {\n        var self = this;\n\n        var optimalVideoCodecs = [];\n\n        if(pubStreamVCodes && pubStreamVCodes.length > 0 && selfSupportVCodes[pubStreamVCodes[0]]){\n            optimalVideoCodecs.push(pubStreamVCodes[0]);\n        }\n        if(optimalVideoCodecs.length == 0){\n            for(var i = 0; i < self._orderVCodes.length; i ++){\n                _util.forEach(pubMemberSupportVCodes, function (index, sVCode) {\n                    if(sVCode == self._orderVCodes[i]){\n                        optimalVideoCodecs.push(sVCode);\n                    }\n                });\n            }\n        }\n\n        return optimalVideoCodecs;\n    },\n\n    subscribeStream: function (rtcId, streamId, rspFail, subArgs, onSub){\n        var self = this;\n\n        var webrtc = self._ices[rtcId];\n\n        var subStream = self._cacheStreams[streamId];\n        var subMember = self._cacheMembers[subStream.memId];\n\n        //var stream = self.newStream(subStream);\n        var stream = subStream;\n        stream.updateAttributes({\n            _webrtc: webrtc,\n            rtcId: rtcId,\n            owner: _util.extend({}, subMember)\n        });\n\n\n        var preSubArgs = stream.subArgs;\n\n        subArgs = subArgs || {subSVideo: true, subSAudio: true};\n        stream.updateAttributes({subArgs: stream.subArgs || {subSVideo: true, subSAudio: true}});\n        stream._webrtc && (stream._webrtc.setSubArgs(stream._webrtc.subArgs || {subSVideo: true, subSAudio: true}));\n\n        if(!stream.subArgs.subSVideo && subArgs.subSVideo && !stream.voff){\n            var pubStreamVCodes = subStream.vcodes;\n            var pubMemberSupportVCodes = subMember.vcodes;\n            var selfSupportVCodes = self.supportVCodes;\n\n            var optimalVideoCodecs = self._getOptimalVideoCodecsSubset(pubStreamVCodes, pubMemberSupportVCodes, selfSupportVCodes);\n\n            // if(optimalVideoCodecs.length == 0){ // 订阅视频 但是 没有相同的 视频编码格式。失败\n            //     preSubArgs && stream._webrtc && stream._webrtc.setSubArgs(preSubArgs);\n            //     preSubArgs && (stream.subArgs = preSubArgs);\n            //\n            //     var evt = _util.extend(new __event.SubFail(), new __event.SubFailNotSupportVCodes({\n            //         stream: stream\n            //     }));\n            //\n            //     rspFail && rspFail(evt);\n            //     self.onEvent(evt);\n            //\n            //     return;\n            // }\n        }\n\n\n        subArgs && stream._webrtc && stream._webrtc.setSubArgs(subArgs);\n        subArgs && (stream.updateAttributes({subArgs: subArgs}));\n\n\n        var subMessage = self.newMessage()\n            .setOp(205)\n            .setRtcId(rtcId)\n            .setSubSId(streamId);\n\n        subArgs && _util.extend(subMessage, subArgs);\n\n        self.postMessage(subMessage, function (rsp) {\n            if(rsp.result != 0){\n                preSubArgs && stream._webrtc && stream._webrtc.setSubArgs(preSubArgs);\n                preSubArgs && (stream.updateAttributes({subArgs: preSubArgs}));\n\n                var evt = new __event.SubFail({\n                    stream: stream,\n                    cause: (new __event.RspFail({request: subMessage, response: rsp}))\n                });\n\n                rspFail && rspFail(evt);\n                self.onEvent(evt);\n\n                return;\n            }\n\n\n            stream.updateAttributes(stream.subArgs);\n\n            var evt = new __event.SubSuccess({\n                stream: stream,\n                hidden: true\n            });\n            self._updateRemoteStream(stream, stream._webrtc.getRemoteStream());\n            self.onEvent(evt);\n\n            typeof onSub === 'function' && (onSub());\n        });\n    },\n\n    unsubscribeStream: function(streamId){\n        var self = this;\n\n        var stream = self._cacheStreams[streamId];\n        var rtcId = stream._webrtc && stream._webrtc.getRtcId();\n        if(!rtcId){\n            return;\n        }\n\n        try {\n            var unsubMessage = self.newMessage()\n                .setOp(206)\n                .setRtcId(rtcId)\n                .setSubSId(streamId);\n\n            self.postMessage(unsubMessage);\n        } finally {\n            self.closeWebrtc(rtcId);\n        }\n\n        return rtcId;\n    },\n\n    onEnter: function(cver, mem){\n        var self = this;\n\n        cver && (self._cver = cver);\n\n        if(!mem) return;\n        if(self._cacheMembers[mem.id]){\n            return;\n        }\n\n        self._cacheMembers[mem.id] = mem;\n\n        var _tmpMap = {};\n        if(mem.res && mem.res.vcodes && mem.res.vcodes.length > 0){\n            _util.forEach(mem.res.vcodes, function (index, vcode) {\n                if(_tmpMap[vcode]){\n                }else{\n                    _tmpMap[vcode] = true;\n                    self.supportVCodes[vcode] && self.supportVCodes[vcode]++;\n                }\n\n            });\n        }\n\n        // var hasOtherDevices;\n        // _util.forEach(self._cacheMembers, function (_memId, _member) {\n        //     if(!hasOtherDevices && _memId != mem.id && mem.memName === _member.memName){\n        //         hasOtherDevices = true;\n        //     }\n        // });\n        //\n        // if(hasOtherDevices){\n        //     return;\n        // }\n\n        self.onAddMember(_util.extend({}, mem));\n    },\n\n    _onFinally: function () {\n        var self = this;\n\n        self._cacheMembers = {}; // id, name, nickName, resource\n        self._cacheStreams = {}; // id, memId, name, voff, aoff, type\n        self._linkedStreams = {};\n        self._ices = {};\n        self._maybeNotExistStreams = {};\n\n        //self._session._sessionId = undefined;\n        //self._session = undefined;\n\n\n        //push stream时，由于异步，在未返回成功后，退出会议，摄像头不会被关闭问题\n        var openedMediaStreams = [];\n        _util.forEach(self._openedRtcMediaStreams, function (streamId, mediaStream) {\n            if(mediaStream.active !== false){ //还没有关闭的流\n                openedMediaStreams.push(mediaStream);\n            }\n        });\n        if(openedMediaStreams.length > 0){\n            for(var i = 0; i < openedMediaStreams.length; i++){\n                try{\n                    var _openStream = openedMediaStreams[i];\n                    _logger.info(\"exit, close stream = \", _openStream.id);\n                    emedia.stopTracks(_openStream);\n                }catch (e) {\n                    _logger.error(e);\n                }\n            }\n        }\n\n        _logger.warn(\"finally. all clean.\");\n    },\n\n    _onRoleUpdate: function(role, roleToken){\n        var self = this;\n\n        _logger.info(\"Role \", role, \" <-\", self.role);\n        _logger.info(roleToken);\n        self.role = role;\n        self.roleToken = roleToken;\n\n        self.onRoleUpdate && self.onRoleUpdate(role, roleToken);\n    },\n\n    onExit: function(cver, memId, reason){\n        var self = this;\n\n        cver && (self._cver = cver);\n\n        if(memId == self.getMemberId()){ //被服务器 强制 exit\n            _logger.warn(\"Me exit. \", reason, memId);\n\n            try{\n                self.closed || self.close(reason);\n            }catch (e){\n                self.onEvent(new __event.Hangup({reason: reason, self: {id: self._memberId}}));\n                self.onMeExit && self.onMeExit(reason);\n\n                _logger.warn(e);\n            }\n\n            return;\n        }\n\n        var rmMember = self._cacheMembers[memId];\n        if(rmMember){\n            if(rmMember.res && rmMember.res.vcodes && rmMember.res.vcodes.length > 0){\n                _util.forEach(rmMember.res.vcodes, function (index, vcode) {\n                    self.supportVCodes[vcode]--;\n                });\n            }\n\n            self._onRemoveMember(rmMember, reason);\n            self.onEvent(new __event.Hangup({reason: reason, parnter: rmMember}));\n        }\n    },\n\n    onPub: function(cver, memId, pubS){\n        var self = this;\n\n        if(!self._cacheMembers[memId]) {\n            _logger.error(\"No found member. when pub\");\n            throw \"No found member. when pub\";\n        }\n\n        // if(pubS.type === 2){ //强制 aoff = 1\n        //     pubS._1_aoff = pubS.aoff;\n        //     pubS.aoff = self._service.hasAudioMixers() ? 0 : 1;\n        // }\n\n        var newStream = self.newStream(pubS);\n        var _stream = self._cacheStreams[pubS.id];\n\n        cver && (self._cver = cver);\n\n        if(_stream && (newStream.sver !== _stream.sver)){\n            _logger.info(\"Onpub. the steam \", _stream.id, \" republish. sver \", _stream.sver, newStream.sver);\n\n            if(newStream && (newStream.aoff !== _stream.aoff || newStream.voff != _stream.voff)){\n                self.onStreamControl(undefined, pubS.id, newStream.voff, newStream.aoff);\n            }\n\n            _util.extend(_stream, newStream);\n            self._onRepublishStream(_stream);\n\n            return;\n        }\n\n        var stream = newStream;\n\n        stream.updateAttributes({owner: self._cacheMembers[memId]});\n        self._cacheStreams[pubS.id] = stream;\n\n        self._onAddStream(self.newStream(stream));\n\n        if(self.autoSub){\n            self.createWebrtcAndSubscribeStream(pubS.id, {\n                onGotRemote: function(stream) {\n                }\n            }); //, undefined, subArgs\n        }\n\n        return stream;\n    },\n\n    onUnpub: function(cver, memId, sId){\n        var self = this;\n\n        var rmStream = self._cacheStreams[sId];\n        self._onRemovePubstream(self._cacheMembers[memId], rmStream);\n\n        cver && (self._cver = cver);\n    },\n\n    onClose: function(cver, confrId, reason){\n        var self = this;\n\n        try{\n            self.close(reason || 0);\n        } finally {\n            self.onConfrClose && self.onConfrClose(confrId, reason);\n        }\n    },\n\n    __getWebrtcFor: function (pubStreamId) {\n        var self = this;\n\n        var webrtc = self._cacheStreams[pubStreamId] && self._cacheStreams[pubStreamId]._webrtc;\n        return webrtc && webrtc.getRtcId();\n    },\n    _getWebrtc: function (pubStreamId) {\n        var self = this;\n\n        var webrtc = self._cacheStreams[pubStreamId] && self._cacheStreams[pubStreamId]._webrtc;\n        return webrtc;\n    },\n\n    _updateRemoteStream: function (stream, remoteMediaStream) {\n        if(stream.located() && stream.type === 2){\n            emedia.enableAudioTracks(remoteMediaStream, true);\n        }else{\n            emedia.enableAudioTracks(remoteMediaStream, !stream.aoff && !(stream.subArgs && stream.subArgs.subSAudio === false));\n        }\n\n        emedia.enableVideoTracks(remoteMediaStream, !stream.voff && !(stream.subArgs && stream.subArgs.subSVideo === false));\n    },\n\n    onStreamControl: function(cver, streamId, voff, aoff, sver){\n        var self = this;\n\n        var stream = self._cacheStreams[streamId];\n\n        stream.updateAttributes({\n            voff: voff,\n            aoff: aoff\n        });\n\n        var webrtc = stream._webrtc;\n        webrtc && webrtc._remoteStream && self._updateRemoteStream(stream, webrtc._remoteStream);\n\n        var _stream = self.newStream(stream);\n        self.onUpdateStream && self.onUpdateStream(_stream, new _stream.Update({voff: voff, aoff: aoff}));\n\n        cver && (self._cver = cver);\n        sver && (stream.updateAttributes({sver: sver}));\n\n        //Safari12/13 先订阅一个 没有视频的流后，这个流重新打开视频，无法显示视频。\n        if(emedia.isSafari\n            && !voff\n            && webrtc && !webrtc.closed\n            && webrtc.offerOptions && !webrtc.offerOptions.offerToReceiveVideo){\n            _logger.warn(\"stream video turn on. but sub not video, will close it, repsub stream\",\n                webrtc.getRtcId(), webrtc.__id, streamId);\n\n            self.closeWebrtc(webrtc.getRtcId(), true, false);\n\n            self.createWebrtcAndSubscribeStream(streamId, {\n                onGotRemote: function(stream) {\n                    \n                    let subs = Object.assign(self._service.__safari_subs, {}); // 这里不会触发 subsuccess 清空一下 订阅过的流\n                    if(subs && subs instanceof Array) {\n                        subs.map((item, index) => {\n                            if(item.streamId == stream.id) subs.splice(index,1)\n                        })\n                    } \n                    self._service.__safari_subs = subs;\n                },\n                onEvent: evt => {\n                    let subs = Object.assign(self._service.__safari_subs, {}); // 这里不会触发 subsuccess 清空一下 订阅过的流\n                    if(subs && subs instanceof Array) {\n                        subs.map((item, index) => {\n                            if(item.streamId == stream.id) subs.splice(index,1)\n                        })\n                    } \n                    self._service.__safari_subs = subs;\n                }\n            }, undefined, stream.subArgs);\n        }\n    },\n\n    aoff: function(pubS, _aoff, callback){\n        var self = this;\n\n        var rtcId = self.__getWebrtcFor(pubS.id);\n        if(!rtcId){\n            _logger.error(\"pubS not publish\", pubS.id);\n            throw \"pubS not publish\" + pubS.id;\n        }\n\n        var linkedStream = self._linkedStreams[pubS.id];\n        linkedStream.updateAttributes({aoff: _aoff });\n        pubS.updateAttributes({aoff: _aoff });\n\n        var streamControl = self.newMessage()\n            .setOp(400)\n            .setRtcId(rtcId)\n            .setVoff(pubS.voff)\n            .setAoff(_aoff);\n        self.postMessage(streamControl, callback);\n        self.onUpdateStream && self.onUpdateStream(pubS, new pubS.Update({aoff: _aoff}));\n    },\n\n    voff: function(pubS, _voff, callback){\n        var self = this;\n\n        var rtcId = self.__getWebrtcFor(pubS.id);\n        if(!rtcId){\n            _logger.error(\"pubS not publish\", pubS.id);\n            throw \"pubS not publish\" + pubS.id;\n        }\n\n        var linkedStream = self._linkedStreams[pubS.id];\n        linkedStream.updateAttributes({voff: _voff });\n        pubS.updateAttributes({voff: _voff });\n\n        var streamControl = self.newMessage()\n            .setOp(400)\n            .setRtcId(rtcId)\n            .setVoff(_voff)\n            .setAoff(pubS.aoff);\n        self.postMessage(streamControl, callback);\n        self.onUpdateStream && self.onUpdateStream(pubS, new pubS.Update({voff: _voff}));\n    },\n\n    startRecord: function (_stream, success) {\n        var self = this;\n\n        var rtcId = _stream.rtcId;\n\n        var startRecord = self.newMessage()\n            .setOp(500)\n            .setRtcId(rtcId)\n            .setFlag(1);\n        self.postMessage(startRecord, function (rsp) {\n            _logger.warn(\"record \", rtcId, rsp.result, rsp.msg);\n            success && success(rsp.result === 0);\n            if(rsp.result === 0){\n                self._records[_stream.id] = _util.extend(false, {}, _stream);\n            }\n        });\n    },\n\n    stopRecord: function (_stream, success) {\n        var self = this;\n\n        var rtcId = _stream.rtcId;\n\n        var stopRecord = self.newMessage()\n            .setOp(500)\n            .setRtcId(rtcId)\n            .setFlag(0);\n        self.postMessage(stopRecord, function (rsp) {\n            _logger.warn(\"stop record \", rtcId, rsp.result, rsp.msg);\n            success && success(rsp.result === 0);\n        });\n\n        if(self._records[_stream.id]){\n            _util.removeAttribute(self._records, _stream.id);\n        }\n    },\n\n    onMembers: function(cver, members){\n        var self = this;\n\n        var removedMembers = [];\n        _util.forEach(self._cacheMembers, function (_memberId, _member) {\n            members[_memberId] || removedMembers.push(_member);\n        });\n        _util.forEach(removedMembers, function (_index, _member) {\n            self.onExit(undefined, _member.id);\n        });\n\n        var addMembers = [];\n        _util.forEach(members, function (_memberId, _member) {\n            //if(_memberId != self.getMemberId()){\n            if((_member.name && _member.name != self.memName)\n                || (!_member.name && _memberId != self.getMemberId())){\n                self._cacheMembers[_memberId] || addMembers.push(_member);\n                self._cacheMembers[_memberId] && _util.extend(self._cacheMembers[_memberId], _member);\n            }\n        });\n        _util.forEach(addMembers, function (_index, _member) {\n            self.onEnter(undefined, _member);\n        });\n\n        cver && (self._cver = cver);\n    },\n\n    onStreams: function(cver, streams){\n        var self = this;\n\n        var removedStreams = [];\n        _util.forEach(self._cacheStreams, function (_pubSId, _stream) {\n            _stream.located() || streams[_pubSId] || removedStreams.push(_stream);\n        });\n        _util.forEach(removedStreams, function (_index, _stream) {\n            self.onUnpub(undefined, _stream.memId, _stream.id);\n        });\n\n        var addStreams = [];\n        _util.forEach(streams, function (_pubSId, stream) {\n            // if(stream.type === 2){ //强制 aoff = 1\n            //     stream._1_aoff = stream.aoff;\n            //     stream.aoff = self._service.hasAudioMixers() ? 0 : 1;\n            // }\n\n            //if(stream.memId != self.getMemberId()){\n            if((stream.memName && stream.memName != self.memName)\n                || (!stream.memName && stream.memId != self.getMemberId())){\n                self._cacheStreams[_pubSId] || addStreams.push(stream);\n                self._cacheStreams[_pubSId] && _util.extend(self._cacheStreams[_pubSId], stream);\n            }\n        });\n        _util.forEach(addStreams, function (_index, _stream) {\n            self.onPub(undefined, _stream.memId, _stream)\n        });\n\n        _util.forEach(self._cacheStreams, function (_pubSId, _stream) {\n            var newStream;\n            _stream.located() || (newStream = streams[_pubSId]);\n            if(newStream && (newStream.aoff !== _stream.aoff || newStream.voff != _stream.voff)){\n                self.onStreamControl(undefined, _pubSId, newStream.voff, newStream.aoff);\n            }\n\n            if(newStream && (newStream.sver !== _stream.sver)){\n                _util.extend(_stream, newStream);\n                self._onRepublishStream(_stream);\n            }\n        });\n\n        cver && (self._cver = cver);\n    },\n\n    _onRemoveMember: function(member, reason){\n        var self = this;\n\n        _logger.info(\"remove\", member, reason);\n\n        var unpubStreams = [];\n        _util.forEach(self._cacheStreams, function (_pubSId, _stream) {\n            if((_stream.memId || (_stream.owner && _stream.owner.id)) === member.id){\n                unpubStreams.push(_stream);\n            }\n        });\n\n        _util.forEach(unpubStreams, function (index, stream) {\n            self._onRemovePubstream(stream.owner, stream, reason);\n        });\n\n        _util.removeAttribute(self._cacheMembers, member.id);\n\n        // var hasOtherDevices;\n        // _util.forEach(self._cacheMembers, function (_memId, _member) {\n        //     if(!hasOtherDevices && _memId != member.id && member.memName === _member.memName){\n        //         hasOtherDevices = true;\n        //     }\n        // });\n        //\n        // if(hasOtherDevices){\n        //     return;\n        // }\n\n        self.onRemoveMember && self.onRemoveMember(member, reason);\n    },\n\n\n    _onAddStream: function(stream){\n        _logger.info(\"add stream \", stream.id);\n        _logger.debug(\"add stream \", stream);\n\n        var self = this;\n        self.onAddStream(stream);\n    },\n\n    _onRemovePubstream: function(member, stream, reason){\n        var self = this;\n\n        if(!stream){\n            return;\n        }\n        if(stream.id == 0){\n            return;\n        }\n\n        function finallyDo(stream) {\n            if(stream.type === 2){\n                _util.removeAttribute(self.audioMixers, stream.id);\n\n                if(stream.remotePlayAudioObject){\n                    document.body.removeChild(stream.remotePlayAudioObject);\n                }\n            }\n\n            if(!reason){\n                reason = 'Unpub';\n            }\n\n            stream && !stream.closeReason && stream.updateAttributes({\n                closeReason: reason\n            });\n\n            var _rtcId = self.unsubscribeStream(stream.id);\n            var rmStream = _util.removeAttribute(self._cacheStreams, stream.id);\n            self._streamAutomators && _util.removeAttribute(self._streamAutomators, stream.id);\n            self._monitSoundChanagedStreams && _util.removeAttribute(self._monitSoundChanagedStreams, stream.id);\n\n            if(self.onRemoveStream){\n                var stream = self.newStream(stream);\n\n                self.onRemoveStream(stream);\n            }\n        }\n\n        try{\n            var soundMeter = _util.removeAttribute(self._mediaMeters, stream.id);\n            soundMeter && soundMeter._finally();\n        } finally {\n            finallyDo(stream);\n        }\n    },\n\n    _onRepublishStream: function (_stream) {\n        var self = this;\n\n        if((self._ices[_stream.rtcId] || emedia.subscribed(_stream)) && !self._maybeNotExistStreams[_stream.id]){\n            var _rtcId = self.unsubscribeStream(_stream.id);\n\n            self.createWebrtcAndSubscribeStream(_stream.id, {\n                onGotRemote: function(stream) {\n                    //self.onUpdateStream(_stream);\n                }\n            });\n        }else{\n            self.onUpdateStream(_stream);\n        }\n    },\n\n    _onRecvRemoteMessage: function (fromMemId, args, evt) {\n        var self = this;\n\n        _logger.debug(\"Recv remote message\", fromMemId, args);\n\n        var fromMember = self._cacheMembers[fromMemId];\n        var argsObject;\n        try{\n            argsObject = JSON.parse(args);\n        }catch(e){\n        }\n\n        self.onRecvRemoteMessage && self.onRecvRemoteMessage(fromMember || fromMemId, argsObject || args, evt);\n    },\n\n    _onSoundChanage: function (member, stream, meterData) {\n        if(emedia.config._printSoundData){\n            _logger.info(\"Stream id \" + stream.id + \", meter \" + (meterData && (meterData.instant.toFixed(2)\n                + \" \" + meterData.slow.toFixed(2)\n                + \" \" + meterData.clip.toFixed(2)\n                + \" \" + (meterData.trackAudioLevel || \"--\")\n                + \" \" + (meterData.trackTotalAudioEnergy || \"--\"))));\n        }\n\n        meterData || (meterData = {\n            instant: 0,\n            slow: 0,\n            clip: 0\n        });\n\n        if(emedia.config.logVolumeWhenInstantGE\n            && emedia.config.logVolumeWhenInstantGE > 0\n            && meterData.instant >= emedia.config.logVolumeWhenInstantGE\n            && meterData.instant < emedia.config.logVolumeWhenInstantGE * 3 //为了应对 混音时，移动端sdk audioLevel 问题。\n        ){\n            _logger.info(\"Stream id \" + stream.id\n                + \", webrtc = \" + (stream._webrtc ? stream._webrtc.getRtcId() : \"null\")\n                + \", media streamId = \" + (stream.getMediaStream() ? stream.getMediaStream().id: \"null\")\n                + \", instant >= \" + emedia.config.logVolumeWhenInstantGE\n                + \", meter instant=\" + meterData.instant\n                + \", slow=\" + meterData.slow\n                + \", clip=\" + meterData.clip);\n        }\n\n        var self = this;\n\n        if(meterData.instant === 0){\n            meterData.instant = meterData.trackAudioLevel || meterData.trackTotalAudioEnergy || 0;\n        }\n\n        self.onSoundChanage(member, stream, meterData);\n        if(self._service._judgeTalking(meterData)){\n            self.onTalking(member, stream, meterData);\n        }\n    },\n\n    onAddMember: function(member){\n\n    },\n    onRemoveMember: function(member, reason){\n\n    },\n    onAddStream: function(stream){ //stream undefined 表明 autoSub属性 空或false. autoSub = true时，自动订阅\n\n    },\n    onRemoveStream: function(stream){\n\n    },\n    onUpdateStream: function (stream, update) {\n\n    },\n    onRecvRemoteMessage: function (fromMember, argsObject) {\n\n    },\n\n    onSoundChanage: function (member, stream, meterData) {\n\n    },\n    onTalking: function (member, stream, meterData) {\n\n    },\n\n\n    // 以下为动作消息封装\n\n    /* 申请上麦和申请主持人\n    *  都向 websocket send message(结构相同)\n    *  文档链接 http://c1.private.easemob.com/pages/viewpage.action?pageId=12159600\n    *  type： 21 申请上麦、22 申请主持人\n    */\n    _sendRequestMessage:function(type) {\n\n        if(!type) {\n            return\n        }\n\n        let _this = this;\n        const get_admin_memberId = () => {\n            let admin_memberId = '';\n\n            for(var key in _this._cacheMembers) {\n                let item =  _this._cacheMembers[key];\n\n                if(item.role == emedia.mgr.Role.ADMIN) {\n                    admin_memberId = item.id\n                    break\n                }\n            }\n\n            return admin_memberId\n\n        }\n\n        let admin_memberId = get_admin_memberId();\n        if(!admin_memberId) {\n            console.warn('this confrence have not admin')\n            return\n        }\n\n        let { _memberId:my_memberId, memName, nickName } = this\n\n        let message = this.newMessage()\n        let post_message = {\n            op:1002,\n            memId : admin_memberId,\n            arg: JSON.stringify( { op2:type, memId: my_memberId, memName, nickName:nickName || memName } ),\n            tsxTime: new Date().getTime(),\n            _reqOps:[`1002${type}`] // entry.js --> emedia.config.baseAcptOps 配置相应的参数\n        }\n\n        Object.assign(message, post_message)\n\n        this.postMessage(message);\n\n    },\n    // 申请上麦\n    requestToTalker:function() {\n        this._sendRequestMessage(21)\n    },\n    // 同意上麦\n    // agreeRequestToTalker: function(arg){\n\n    //     console.log(' atten agreeRequestToTalker this', this);\n    //     console.log(' atten agreeRequestToTalker arg', arg);\n    //     console.log(' atten agreeRequestToTalker emedia', emedia);\n\n    //     let { memName } = arg;\n    //     if(!memName) {\n    //         console.warn('agreeRequestToTalker memName is required')\n    //         return\n    //     }\n\n\n    // },\n\n    // 发送对上麦申请和主持人申请的处理 type:21、上麦申请 22、主持人申请  result: 0、同意 1、拒绝\n    // session  请求上麦的session，给他回复\n    _send_action_request_message(type, session, result) {\n\n        if(!session || !type) {\n            return\n        }\n\n        if(result === undefined) {\n            return\n        }\n\n        let { tsxId, arg } = session;\n        let { memId:applicant_memberId } = arg;\n\n        let message = this.newMessage()\n        let post_message = {\n            op: 1001,\n            arg: JSON.stringify({ op2:type, memId:applicant_memberId }),\n            memId:applicant_memberId,\n            result,\n            tsxId,\n            _reqOps:[`1002${type}`]\n        }\n\n        Object.assign(message, post_message);\n        this.postMessage(message);\n    },\n    // 拒绝上麦\n    refuseRequestToTalker: function(session) {\n\n        this._send_action_request_message(21, session, 1)\n    },\n\n    // 拒绝主持人申请\n    refuseRequestToAdmin: function(session) {\n\n        this._send_action_request_message(22, session, 1)\n    },\n\n    // 申请主持人\n    requestToAdmin:function() {\n        this._sendRequestMessage(22)\n    },\n\n    /*\n    * 指定静音或取消指定静音，发送消息\n    * type: 23 静音、24 指定静音\n    * memberId: 被指定静音人的 memberId\n    */\n    _sendControlAudioMessage:function(memberId, type) {\n        if(\n            !memberId ||\n            !type\n        ) {\n            return\n        }\n\n        let message = this.newMessage()\n        let post_message = {\n            op:1002,\n            memId: memberId,\n            arg: JSON.stringify( { op2:type, memId: memberId } ),\n            tsxTime: new Date().getTime(),\n            _reqOps:[100223,100224]\n        }\n\n        Object.assign(message, post_message)\n\n        this.postMessage(message);\n    },\n    // 指定静音\n    muteBymemberId:function(memberId) {\n        this._sendControlAudioMessage(memberId, 23)\n    },\n    // 指定取消静音\n    unmuteBymemberId:function(memberId) {\n        this._sendControlAudioMessage(memberId, 24)\n    }\n\n    // 动作消息封装结束\n});\n\nmodule.exports = Attendee;\n","/**\n * WebRTC\n *\n *                              A                   |                                       B\n *                                                  |\n *   1.createMedia:got streamA                      | 1.createMedia:got streamB\n *   2.new RTCPeerConnection: APeerConnection       | 2.new RTCPeerConnection: BPeerConnection\n *   3.APeerConnection.createOffer:got offerA       |\n *      APeerConnection.setLocalDescription(offerA) |\n *      send offerA ---> ---> ---> --->        ---> |\n *                                                  | ---> 3.got offerA | offerA = new RTCSessionDescription(offerA);\n *                                                  | BPeerConnection.setRemoteDescription(offerA)\n *                                                  |\n *                                                  |\n *                                                  | 4.BPeerConnection.createAnswer: got answerB\n *                                                  | BPeerConnection.setLocalDescription(answerB)\n *                                                  | <---- send answerB\n *                                                  | 5.got answerB <--- <--- <--- <---\n *                                                  | answerB = new RTCSessionDescription(answerB)\n *                                                  |\n * APeerConnection.setRemoteDescription(answerB)    |\n *                                                  |\n * 6.got candidateA ---> --->  ---> --->            | ---> got candidateA\n *                                                  | BPeerConnection.addIceCandidate(new RTCIceCandidate(candidateA))\n *                                                  |\n *                                                  |\n *                                                  | got candidateB <--- <--- <--- <---\n *                                                  | <--- 6.got candidateB APeerConnection.addIceCandidate(candidateB)\n *                                                  |\n *                                                  |\n *                                                  | 7. APeerConnection.addStream(streamA)\n *                                                  | 7. BPeerConnection.addStream(streamB)\n *                                                  |\n *                              streamA >>>>>>>>>>> |  <<<<< see A\n *                              seeB <<<<<<<<<<<    | <<<<< streamB\n *                                                  |\n *\n */\n\n\n\nvar _util = require('./Util');\nvar _logger = _util.tagLogger(\"Webrtc\");\n\nvar SDPUtils = require('sdp'); //希望使用 SDPUtils 取代 SDPSection\n\nvar DeployMore = require('./mgr/DeployMore').default; //多集群部署 配置文件\n\nvar _SDPSection = {\n    headerSection: null,\n\n    audioSection: null,\n    videoSection: null,\n\n    _parseHeaderSection: function (sdp, audioIndex, videoIndex) {\n        var index = audioIndex;\n\n        if(videoIndex === -1){ //保持不变\n        }else if(audioIndex === -1){\n            index = videoIndex;\n        }else{\n            index = Math.min(audioIndex, videoIndex);\n        }\n\n        if (index >= 0) {\n            return sdp.slice(0, index);\n        }\n        return sdp;\n    },\n\n    _parseAudioSection: function (sdp, audioIndex, videoIndex) {\n        var index = audioIndex;\n        if (index >= 0) {\n            return sdp.slice(index, videoIndex < index ? sdp.length : videoIndex);\n        }\n    },\n\n    _parseVideoSection: function (sdp, audioIndex, videoIndex) {\n        var index = videoIndex;\n        if (index >= 0) {\n            return sdp.slice(index, audioIndex < index ? sdp.length : audioIndex);\n        }\n    },\n\n    spiltSection: function (sdp) {\n        var self = this;\n\n        self._preSDP = sdp;\n\n        var audioIndex = self._preAudioIndex = sdp.indexOf('m=audio');\n        var videoIndex = self._preVideoIndex = sdp.indexOf('m=video');\n\n        self.headerSection = self._parseHeaderSection(sdp, audioIndex, videoIndex);\n        self.audioSection = self._parseAudioSection(sdp, audioIndex, videoIndex);\n        self.videoSection = self._parseVideoSection(sdp, audioIndex, videoIndex);\n    },\n\n\n    setVideoBitrate: function (vbitrate) {\n        if(!vbitrate || !this.videoSection){\n            return;\n        }\n\n        this.videoSection = this.setBitrate(this.videoSection, vbitrate);\n    },\n\n    // setVideoMinBitrate: function (vminBitrate) {\n    //     if(!vminBitrate || !this.videoSection){\n    //         return;\n    //     }\n    //     //x-google-min-bitrate\n    //     this.videoSection = this.videoSection.replace(/(a=fmtp\\:\\d+\\sx-google-min-bitrate=)\\d+/g, \"$1\" + vminBitrate);\n    // },\n    setVideoMinBitrate: function (minBitrate) {\n        this.setAllFmtpBitrate({\"x-google-min-bitrate\": minBitrate});\n        // this.setAllFmtpBitrate({\n        //     \"x-google-min-bitrate\": minBitrate,\n        //     \"x-google-start-bitrate\": minBitrate + 100,\n        //     \"x-google-max-bitrate\": minBitrate + 100000,\n        // });\n    },\n    setVideoMaxBitrate: function (maxBitrate) {\n        this.setAllFmtpBitrate({\"x-google-max-bitrate\": maxBitrate});\n    },\n    setVideoStartBitrate: function (startBitrate) {\n        this.setAllFmtpBitrate({\"x-google-start-bitrate\": startBitrate});\n    },\n    setAllFmtpBitrate: function setFmtpBitrate (map) {\n        if(!this.videoSection){\n            return;\n        }\n\n        // var vp8H264H265=[];\n        // this.videoSection.replace(/a=rtpmap\\:(\\d+)\\s+(VP8|H264|H265)[^\\r\\n]+([\\r\\n]+)/g, function (all, code, name) {\n        //     //console.log(code, name);\n        //     vp8H264H265.push(code);\n        // });\n\n        var fields = {};\n        Object.keys(map).forEach(function(fmtpName) {\n            var bitrate = map[fmtpName];\n            var field = fmtpName + \"=\" + bitrate;\n            var regex = new RegExp('(a=fmtp\\\\:\\\\d+\\\\s\\\\S*;?)(' + fmtpName + '=\\\\d+)(;?\\\\S*)', 'g');\n\n            fields[fmtpName] = {field: field, regex: regex}\n        });\n\n        //(?:' + vp8H264H265.join('|') + '\n        ///(a=fmtp\\:\\d+)[^\\r\\n]+)([\\r\\n]+)/g\n        //new RegExp('(a=fmtp\\\\:(?:' + vp8H264H265.join('|') + ')[^\\\\r\\\\n]+)([\\\\r\\\\n]+)', 'g')\n\n        this.videoSection = this.videoSection.replace(/(a=fmtp\\:\\d+[^\\r\\n]+)([\\r\\n]+)/g, function (all, fmtp, enter) {\n            if(fmtp.indexOf(\"apt=\") >= 0){\n                return all;\n            }\n\n            Object.keys(fields).forEach(function(fmtpName){\n                var fieldAndRegex = fields[fmtpName];\n\n                var regex = fieldAndRegex.regex;\n                var field = fieldAndRegex.field;\n                var replacedFmtp = fmtp.replace(regex, function ($$, $1, $2, $3) {\n                    return $1 + field + $3;\n                });\n\n                if(replacedFmtp.indexOf(fmtpName) < 0){ //没有包含\n                    if(!replacedFmtp.endsWith(';')){\n                        replacedFmtp += \";\"\n                    }\n                    fmtp = replacedFmtp + field;\n                }else{\n                    fmtp = replacedFmtp;\n                }\n            });\n\n            return fmtp + enter;\n        });\n    },\n    setFmtpBitrate: function setFmtpBitrate (fmtpName, bitrate) {\n        if(!bitrate || !this.videoSection){\n            return;\n        }\n\n        var field = fmtpName + \"=\" + bitrate;\n        var regex = new RegExp('(a=fmtp\\\\:\\\\d+\\\\s\\\\S*;?)(' + fmtpName + '=\\\\d+)(;?\\\\S*)', 'g');\n        this.videoSection = this.videoSection.replace(/(a=fmtp\\:\\d+[^\\r\\n]+)([\\r\\n]+)/g, function (all, fmtp, enter) {\n            var replacedFmtp = fmtp.replace(regex, function ($$, $1, $2, $3) {\n                return $1 + field + $3;\n            });\n\n            if(replacedFmtp.indexOf(fmtpName) < 0){ //没有包含\n                if(!replacedFmtp.endsWith(';')){\n                    replacedFmtp += \";\"\n                }\n                replacedFmtp = replacedFmtp + field;\n            }\n\n            return replacedFmtp + enter;\n        });\n    },\n\n    setAudioBitrate: function (abitrate) {\n        if(!abitrate || !this.audioSection){\n            return;\n        }\n\n        this.audioSection = this.setBitrate(this.audioSection, abitrate);\n    },\n\n    setBitrate0: function (section, bitrate) {\n        section = section.replace(/(b=)(?:AS|TIAS)(\\:)\\d+/g, \"$1AS$2\" + bitrate);\n        if(section.indexOf('b=AS') < 0){\n            section = section.replace(/(m=(?:audio|video)[^\\r\\n]+)([\\r\\n]+)/g, \"$1$2b=AS:\" + bitrate + \"$2\")\n        }\n        return section;\n    },\n\n    setBitrate: function (section, bandwidth) {\n        let modifier = 'AS';\n        if (emedia.isFirefox) {\n            bandwidth = (bandwidth >>> 0) * 1000;\n            modifier = 'TIAS';\n        }\n        section = section.replace(/(b=)(?:AS|TIAS)(\\:)\\d+/g, \"$1\" + modifier + \"$2\" + bandwidth);\n        if(section.indexOf('b=' + modifier + ':') < 0){ //没有b行\n            if(section.indexOf('c=IN ') < 0){ // 没有C行\n                section = section.replace(/(m=(?:audio|video)[^\\r\\n]+)([\\r\\n]+)/g, \"$1$2b=\" + modifier  + \":\" + bandwidth + \"$2\")\n            }else{\n                // insert b= after c= line.\n                section = section.replace(/c=IN ([^\\r\\n]+)([\\r\\n]+)/, 'c=IN $1$2b=' + modifier + ':' + bandwidth + '$2');\n            }\n        }\n        return section;\n    },\n\n    updateVideoSection: function (regx, oper) {\n        var self = this;\n\n        if(!self.videoSection){\n            return;\n        }\n\n        self.videoSection = self.videoSection.replace(regx, oper);\n    },\n\n    updateAudioSection: function (regx, oper) {\n        var self = this;\n\n        if(!self.audioSection){\n            return;\n        }\n\n        self.audioSection = self.audioSection.replace(regx, oper);\n    },\n\n    updateVideoSendonly: function () {\n        var self = this;\n\n        if(!self.videoSection){\n            return;\n        }\n\n        self.videoSection = self.videoSection.replace(/sendrecv/g, \"sendonly\");\n    },\n\n    updateVideoRecvonly: function () {\n        var self = this;\n\n        if(!self.videoSection){\n            return;\n        }\n\n        self.videoSection = self.videoSection.replace(/sendrecv/g, \"recvonly\");\n    },\n\n    updateAudioSendonly: function () {\n        var self = this;\n\n        if(!self.audioSection){\n            return;\n        }\n\n        self.audioSection = self.audioSection.replace(/sendrecv/g, \"sendonly\");\n    },\n\n    updateAudioRecvonly: function () {\n        var self = this;\n\n        if(!self.audioSection){\n            return;\n        }\n\n        self.audioSection = self.audioSection.replace(/sendrecv/g, \"recvonly\");\n    },\n\n    updateACodes: function (acodes) {\n        var self = this;\n\n        if(!acodes){\n            return;\n        }\n        if(!self.audioSection){\n            return;\n        }\n\n        if(typeof acodes === \"string\"){\n            var arr = [];\n            arr.push(acodes);\n            acodes = arr;\n        }\n\n        var vcodeMap = {};\n        var regexp = /a=rtpmap:(\\d+) ([A-Za-z0-9]+)\\/.*/ig;\n        var arr = self._parseLine(self.audioSection, regexp);\n        for(var i = 0; i < arr.length; i++) {\n            var codeNum = arr[++i];\n            var code = arr[++i];\n            vcodeMap[code] = codeNum;\n        }\n\n        var numCodes = [];\n        for(var i = 0; i < acodes.length; i++){\n            var supportVCode = vcodeMap[acodes[i]];\n            supportVCode && numCodes.push(supportVCode);\n        }\n        if(numCodes.length == 0){\n            if(self._webrtc){\n                _logger.warn(\"Not found acodes map\", acodes, self._webrtc._rtcId, self._webrtc.__id);\n            }else{\n                _logger.warn(\"Not found acodes map\", acodes);\n            }\n        }\n\n        var codeLineLastIndex = self.audioSection.indexOf('\\r');\n        var codeLine = self.audioSection.substring(0, codeLineLastIndex);\n\n        var fields = codeLine.split(' ');\n\n        Array.prototype.push.apply(numCodes, fields.slice(3));\n\n        var newNumCodes = [];\n        var _map = {};\n        _util.forEach(numCodes, function (index, ele) {\n            if(newNumCodes.length == 0){\n                newNumCodes.push(ele);\n                _map[ele] = true;\n            } else {\n                if(!_map[ele]){\n                    newNumCodes.push(ele);\n                    _map[ele] = true;\n                }\n            }\n        });\n        //alert(numCodes.join(' '));\n\n        //fields.splice(3, 0, numCodes);\n        fields.splice(3, fields.length - 3, newNumCodes.join(' '));\n\n        codeLine = fields.join(' ');\n        //_logger.info(codeLine);\n        if(self._webrtc){\n            _logger.warn(codeLine, self._webrtc._rtcId, self._webrtc.__id);\n        }\n\n        self.audioSection = codeLine + self.audioSection.substring(codeLineLastIndex);\n    },\n\n    updateVCodes: function (vcodes) {\n        var self = this;\n\n        if(!vcodes){\n            return;\n        }\n        if(!self.videoSection){\n            return;\n        }\n\n        if(typeof vcodes === \"string\"){\n            var arr = [];\n            arr.push(vcodes);\n            vcodes = arr;\n        }\n\n        var vcodeMap = {};\n        var regexp = /a=rtpmap:(\\d+) ([A-Za-z0-9]+)\\/.*/ig;\n        var arr = self._parseLine(self.videoSection, regexp);\n        for(var i = 0; i < arr.length; i++) {\n            var codeNum = arr[++i];\n            var code = arr[++i];\n            vcodeMap[code] = codeNum;\n        }\n\n        //H264\n        //if(/Firefox/.test(navigator.userAgent) || /Chrome/.test(navigator.userAgent)){ //a=fmtp:126 profile-level-id=42e01f;level-asymmetry-allowed=1;packetization-mode=1\n        var h264_regexp = /a=fmtp:(\\d+) .*profile-level-id=42e01f;?.*/ig;\n        var h264_arr = self._parseLine(self.videoSection, h264_regexp);\n\n        if(h264_arr && h264_arr.length >= 2){\n            vcodeMap['H264'] = h264_arr[1];\n        }\n        //}\n\n        var numCodes = []\n        for(var i = 0; i < vcodes.length; i++){\n            var supportVCode = vcodeMap[vcodes[i]];\n            supportVCode && numCodes.push(supportVCode);\n        }\n        if(numCodes.length == 0){\n            if(self._webrtc){\n                _logger.warn(\"Not found vcodes map\", vcodes, self._webrtc._rtcId, self._webrtc.__id);\n            }else{\n                _logger.warn(\"Not found vcodes map\", vcodes);\n            }\n        }\n\n        var codeLineLastIndex = self.videoSection.indexOf('\\r');\n        var codeLine = self.videoSection.substring(0, codeLineLastIndex);\n\n        var fields = codeLine.split(' ');\n\n        Array.prototype.push.apply(numCodes, fields.slice(3));\n\n        var newNumCodes = [];\n        var _map = {};\n        _util.forEach(numCodes, function (index, ele) {\n            if(newNumCodes.length == 0){\n                newNumCodes.push(ele);\n                _map[ele] = true;\n            } else {\n                if(!_map[ele]){\n                    newNumCodes.push(ele);\n                    _map[ele] = true;\n                }\n            }\n        });\n        //alert(numCodes.join(' '));\n\n        //fields.splice(3, 0, numCodes);\n        fields.splice(3, fields.length - 3, newNumCodes.join(' '));\n\n        codeLine = fields.join(' ');\n        //_logger.info(codeLine);\n        if(self._webrtc){\n            _logger.warn(codeLine, self._webrtc._rtcId, self._webrtc.__id);\n        }\n\n        self.videoSection = codeLine + self.videoSection.substring(codeLineLastIndex);\n    },\n\n    removeSSRC: function (section) {\n        var arr = [];\n\n        var _arr = section.split(/a=ssrc:[^\\n]+/g);\n        for (var i = 0; i < _arr.length; i++) {\n            _arr[i] != '\\n' && arr.push(_arr[i]);\n        }\n        // arr.push('');\n\n        return arr.join('\\n');\n    },\n\n    removeField_msid: function (section) {\n        var arr = [];\n\n        var _arr = section.split(/a=msid:[^\\n]+/g);\n        for (var i = 0; i < _arr.length; i++) {\n            _arr[i] != '\\n' && arr.push(_arr[i]);\n        }\n        // arr.push('');\n\n        section = arr.join('\\n');\n        arr = [];\n\n        _arr = section.split(/[\\n]+/g);\n        for (var i = 0; i < _arr.length; i++) {\n            (_arr[i] != '\\n') && arr.push(_arr[i]);\n        }\n\n        return arr.join('\\n');\n    },\n\n    updateHeaderMsidSemantic: function (wms) {\n\n        var self = this;\n\n        var line = \"a=msid-semantic: WMS \" + wms;\n\n        var _arr = self.headerSection.split(/a=msid\\-semantic: WMS.*/g);\n        var arr = [];\n        switch (_arr.length) {\n            case 1:\n                arr.push(_arr[0]);\n                break;\n            case 2:\n                arr.push(_arr[0]);\n                arr.push(line);\n                arr.push('\\n');\n                break;\n            case 3:\n                arr.push(_arr[0]);\n                arr.push(line);\n                arr.push('\\n');\n                arr.push(_arr[2]);\n                arr.push('\\n');\n                break;\n        }\n\n        return self.headerSection = arr.join('');\n    },\n\n    updateAudioSSRCSection: function (ssrc, cname, msid, label) {\n        var self = this;\n\n        self.audioSection && (self.audioSection = self.removeSSRC(self.audioSection));\n        self.audioSection && (self.audioSection = self.removeField_msid(self.audioSection));\n        self.audioSection && (self.audioSection = self.audioSection + self.ssrcSection(ssrc, cname, msid, label));\n    },\n\n\n    updateVideoSSRCSection: function (ssrc, cname, msid, label) {\n        var self = this;\n\n        self.videoSection && (self.videoSection = self.removeSSRC(self.videoSection));\n        self.videoSection && (self.videoSection = self.removeField_msid(self.videoSection));\n        self.videoSection && (self.videoSection = self.videoSection + self.ssrcSection(ssrc, cname, msid, label))\n    },\n\n    getUpdatedSDP: function (audioVideo) {\n        var self = this;\n\n        // if(self._preAudioIndex < 0 || self._preVideoIndex < 0){\n        //     return this._preSDP;\n        // }\n        //\n        // audioVideo = (audioVideo === true || audioVideo === undefined);\n        // var sdpAudioVideo = self._preAudioIndex < self._preVideoIndex;\n        //\n        // if(audioVideo == sdpAudioVideo){\n        //     return this._preSDP;\n        // }\n\n        if(audioVideo === undefined || audioVideo == null){\n            audioVideo = self._preAudioIndex < self._preVideoIndex;\n        }\n\n        var videoMid;\n        self.videoSection && self.videoSection.replace(/a=mid:([^\\r\\n]+)/, function(match, p1){\n            videoMid = p1;\n            return match;\n        });\n\n        var audioMid;\n        self.audioSection && self.audioSection.replace(/a=mid:([^\\r\\n]+)/, function(match, p1){\n            audioMid = p1;\n            return match;\n        });\n\n        var sdp;\n        if(audioVideo){\n            var bundleLine = [\"a=group:BUNDLE\"];\n            self.audioSection && bundleLine.push(audioMid);\n            self.videoSection && bundleLine.push(videoMid);\n\n            sdp = self.headerSection.replace(/a=group:BUNDLE [^\\r\\n]+/, bundleLine.join(\" \"));\n\n            self.audioSection && (sdp += self.audioSection);\n            self.videoSection && (sdp += self.videoSection);\n        }else{\n            var bundleLine = [\"a=group:BUNDLE\"];\n            self.videoSection && bundleLine.push(videoMid);\n            self.audioSection && bundleLine.push(audioMid);\n\n            sdp = self.headerSection.replace(/a=group:BUNDLE [^\\r\\n]+/, bundleLine.join(\" \"));\n\n            self.videoSection && (sdp += self.videoSection);\n            self.audioSection && (sdp += self.audioSection);\n        }\n\n        return sdp;\n    },\n\n    parseMsidSemantic: function (header) {\n        var self = this;\n\n        var regexp = /a=msid\\-semantic:\\s*WMS (\\S+)/ig;\n        var arr = self._parseLine(header, regexp);\n\n        arr && arr.length == 2 && (self.msidSemantic = {\n            line: arr[0],\n            WMS: arr[1]\n        });\n\n        return self.msidSemantic;\n    },\n\n    ssrcSection: function (ssrc, cname, msid, label) {\n        var lines = [\n            'a=ssrc:' + ssrc + ' cname:' + cname,\n            'a=ssrc:' + ssrc + ' msid:' + msid + ' ' + label,\n            'a=ssrc:' + ssrc + ' mslabel:' + msid,\n            'a=ssrc:' + ssrc + ' label:' + label,\n            ''\n        ];\n\n        return lines.join('\\n');\n    },\n\n    parseSSRC: function (section) {\n        var self = this;\n\n        var regexp = new RegExp(\"a=(ssrc):(\\\\d+) (\\\\S+):(\\\\S+)\", \"ig\");\n\n        var arr = self._parseLine(section, regexp);\n        if (arr) {\n            var ssrc = {\n                lines: [],\n                updateSSRCSection: self.ssrcSection\n            };\n\n            for (var i = 0; i < arr.length; i++) {\n                var e = arr[i];\n                if (e.indexOf(\"a=ssrc\") >= 0) {\n                    ssrc.lines.push(e);\n                } else {\n                    switch (e) {\n                        case 'ssrc':\n                        case 'cname':\n                        case 'msid':\n                        case 'mslabel':\n                        case 'label':\n                            ssrc[e] = arr[++i];\n                    }\n                }\n            }\n\n            return ssrc;\n        }\n    },\n\n    _parseLine: function (str, regexp) {\n        var arr = [];\n\n        var _arr;\n        while ((_arr = regexp.exec(str)) != null) {\n            for (var i = 0; i < _arr.length; i++) {\n                arr.push(_arr[i]);\n            }\n        }\n\n        if (arr.length > 0) {\n            return arr;\n        }\n    }\n};\n\nvar SDPSection = function (sdp, webrc) {\n    _util.extend(this, _SDPSection);\n    this._webrtc = webrc;\n    this.spiltSection(sdp);\n};\n\nSDPSection.isAudioVideo = function (sdp) {\n    var audioIndex = sdp.indexOf('m=audio');\n    var videoIndex = sdp.indexOf('m=video');\n\n    return audioIndex < videoIndex;\n}\n\nSDPSection.isVideoPreAudio = function (sdp) {\n    var audioIndex = sdp.indexOf('m=audio');\n    var videoIndex = sdp.indexOf('m=video');\n\n    return audioIndex >= 0 && videoIndex>=0 && videoIndex < audioIndex;\n}\n\nvar __rtc_globalCount = emedia.__rtc_globalCount = 0;\n\n/**\n * Abstract\n * {\n *   onIceStateChange:\n *   onIceCandidate:\n *   onGotRemoteStream:\n *\n *   createRtcPeerConnection:\n *   createOffer:\n *   createPRAnswer:\n *   createAnswer:\n *   addIceCandidate:\n *   close:\n *   iceState:\n *\n *   setLocalStream:\n *   getRtcId:\n * }\n *\n */\n/**\n * ICE 通道失败：\n * 1.set sdp 失败\n * 2.set cands 失败\n * 但最终都是 ice fail\n *\n *\n * onSetSessionDescriptionError\n * onCreateSessionDescriptionError\n * onAddIceCandidateError\n *\n * onIceStateChange  ice fail\n *\n */\nvar _WebRTC = _util.prototypeExtend({\n    closed: false,\n    sdpConstraints: {\n        'mandatory': {\n            'OfferToReceiveAudio': true,\n            'OfferToReceiveVideo': true\n        }\n    },\n\n    /**\n     * offerToReceiveAudio false sendonly, or sendrecv\n     * offerToReceiveVideo false sendonly, or sendrecv\n     *\n     */\n    offerOptions: {\n        offerToReceiveAudio: true,\n        offerToReceiveVideo: true,\n        //voiceActivityDetection: false\n    },\n\n    optimalVideoCodecs: null,\n    optimalAudioCodecs: null,\n\n    __init__: function () {\n        var self = this;\n\n        self._rtcId || (self._rtcId = \"RTC\" + (__rtc_globalCount++));\n        self.__id = \"_i_\" + (__rtc_globalCount++);\n\n        self.__setRemoteSDP = false;\n        self.__tmpRemoteCands = [];\n        self.__tmpLocalCands = [];\n        self._rtcPeerConnection = null;\n\n        self.cctx = self.__id;\n\n        emedia && emedia.config && emedia.config.forceUseVideoCodecs && emedia.config.forceUseVideoCodecs.length > 0\n            && (self.optimalVideoCodecs = emedia.config.forceUseVideoCodecs);\n        emedia && emedia.config && emedia.config.forceUseAudioCodecs && emedia.config.forceUseAudioCodecs.length > 0\n            && (self.optimalAudioCodecs = emedia.config.forceUseAudioCodecs);\n        emedia && emedia.config && (typeof emedia.config.forceVideoBitrate === \"number\")\n            && (self.vbitrate = emedia.config.forceVideoBitrate);\n        emedia && emedia.config && (typeof emedia.config.forceMinVideoBitrate === \"number\")\n            && (self.vminBitrate = emedia.config.forceMinVideoBitrate);\n        emedia && emedia.config && (typeof emedia.config.forceAudioBitrate === \"number\")\n            && (self.abitrate = emedia.config.forceAudioBitrate);\n\n        _logger.info(\"Webrtc created. optimal video codecs:\", self.optimalVideoCodecs,\n            \"audio codecs:\", self.optimalAudioCodecs,\n            \"vbitrate:\", self.vbitrate,\n            \"vminBitrate:\", self.vminBitrate,\n            \"abitrate:\", self.abitrate, self._rtcId, self.__id);\n    },\n\n    getRtcId: function(){\n        return this._rtcId;\n    },\n\n    iceState: function () {\n        var self = this;\n        return self._rtcPeerConnection.iceConnectionState;\n    },\n\n    setSubArgs: function (subArgs) {\n        var self = this;\n        self.subArgs = subArgs;\n    },\n\n    getReceiversOfPeerConnection: function () {\n        var self = this;\n\n        if(!self._rtcPeerConnection){\n            return;\n        }\n\n        if(self._rtcPeerConnection.iceConnectionState == 'closed'){\n            return;\n        }\n\n        return self._rtcPeerConnection.getReceivers();\n    },\n\n    updateRemoteBySubArgs: function () {\n        var self = this;\n\n        if(!self.subArgs){\n            return;\n        }\n        if(!self._remoteStream){\n            return;\n        }\n\n        emedia.enableVideoTracks(self._remoteStream, !(self.subArgs && self.subArgs.subSVideo === false));\n        emedia.enableAudioTracks(self._remoteStream, !(self.subArgs && self.subArgs.subSAudio === false));\n\n        _logger.info(\"enable tracks remote stream\", self._remoteStream, self.subArgs, self._rtcId, self.__id,  self.closed);\n    },\n\n    createRtcPeerConnection: function (iceServerConfig) {\n        var self = this;\n        _logger.debug('begin create peer connection ......', self._rtcId, self.__id,  self.closed);\n\n        iceServerConfig || (iceServerConfig = self.iceServerConfig);\n\n        if (iceServerConfig || emedia.isEdge){ //reduce icecandidate number:add default value\n            iceServerConfig || (iceServerConfig = {});\n            !iceServerConfig.iceServers && (iceServerConfig.iceServers = []);\n\n            iceServerConfig.rtcpMuxPolicy = \"require\";\n            iceServerConfig.bundlePolicy = \"max-bundle\";\n\n            // iceServerConfig.iceTransportPolicy = 'relay';\n            if(iceServerConfig.relayOnly){\n                iceServerConfig.iceTransportPolicy = 'relay';\n            }\n        } else {\n            iceServerConfig = null;\n        }\n\n        // iceServerConfig = {\n        //     capAudio: true,\n        //     capVideo: true,\n        //     iceServers:[{\n        //         credential: \"+F34cGoWeMmwa+XtvibM7dr4Ccc=\",\n        //         url: \"turn:101.200.76.93:3478\",\n        //         username: \"hx-demo#chatdemoui_yss000@hx.com/webim_device_uuid%179310420104847360:1506431735\"\n        //     }],\n        //     recvAudio: true,\n        //     recvVideo: true,\n        //     relayOnly: false,\n        // };\n\n        if(emedia && emedia.config && typeof emedia.config.reconfigRTCConfiguration === 'function'){\n            iceServerConfig = emedia.config.reconfigRTCConfiguration(iceServerConfig);\n        }\n\n        if(emedia.config.useDeployMore) {// 读取rtcconfig 替换trun url 如果开启了使用多集群\n            if(!emedia.mgr.rtc_url_config){// 1v1 第一次呼叫可能还没请求 config.json\n                emedia.mgr.rtc_url_config = new DeployMore(emedia.config.rtcConfigUrl || '');\n            }\n            if(\n                iceServerConfig && iceServerConfig.iceServers\n            ) { // 多人时 iceServerConfig 为 null\n                iceServerConfig = emedia.mgr.rtc_url_config.replace_trun_url(iceServerConfig);\n            }\n        }\n\n        _logger.info('create pc, set config:', iceServerConfig, self._rtcId, self.__id,  self.closed);\n        \n        var rtcPeerConnection = self._rtcPeerConnection = new RTCPeerConnection(iceServerConfig);\n        rtcPeerConnection.__peerId = self._rtcId;\n        _logger.debug('created local peer connection object', rtcPeerConnection, self._rtcId);\n\n\n        rtcPeerConnection.onicecandidate = function (event) {\n            var candidate = event.candidate;\n\n            //reduce icecandidate number: don't deal with tcp, udp only\n            if (event.type == \"icecandidate\"\n                && ((!candidate)\n                    || (typeof candidate.protocol === 'string' && candidate.protocol.toLowerCase() === 'tcp')\n                    || / TCP /.test(candidate.candidate))) {\n                _logger.debug(\"On ICE candidate: drop\", candidate, self._rtcId, self.__id,  self.closed);\n                return;\n            }\n\n            if(!candidate.candidate){\n                _logger.error(\"Not found candidate. candidate is error\");\n                throw \"Not found candidate. candidate is error,\";\n            }\n\n            candidate.cctx = self.cctx;\n            if(!self.__setRemoteSDP){\n                (self.__tmpLocalCands || (self.__tmpLocalCands = {})).push(candidate);\n                _logger.debug('On ICE candidate ok: but tmp buffer caused by not set remote sdp: ', candidate,\n                    self._rtcId, self.__id,  self.closed);\n                return;\n            }else{\n                _logger.debug('On ICE candidate ok: ', candidate, self._rtcId, self.__id,  self.closed);\n            }\n            self._onIceCandidate(candidate);\n        };\n\n        self.lastIceConnectionState = '';\n        function stateChange(event) {\n            _logger.info(\"states: connectionState\", rtcPeerConnection.connectionState, \", iceConnectionState\",\n                rtcPeerConnection.iceConnectionState, \"@\", self._rtcId, self.__id, self.closed);\n            try {\n                //var theState = rtcPeerConnection.connectionState || rtcPeerConnection.iceConnectionState;\n                var theState = rtcPeerConnection.iceConnectionState || rtcPeerConnection.connectionState;\n                if('failed' == rtcPeerConnection.connectionState\n                    || 'failed' == rtcPeerConnection.iceConnectionState){\n                    theState = \"failed\";\n                }\n                if (self.lastIceConnectionState !== theState) {\n                    self.lastIceConnectionState = theState;\n                    self.onIceStateChange(theState);\n                }\n            } finally {}\n        }\n\n        rtcPeerConnection.onconnectionstatechange = stateChange.bind(self);\n        rtcPeerConnection.onicestatechange =  stateChange.bind(self);\n        rtcPeerConnection.oniceconnectionstatechange =  stateChange.bind(self);\n        rtcPeerConnection.onsignalingstatechange = function (event) {\n            _logger.info(\"states: signaling\", rtcPeerConnection.signalingState, \"@\", self._rtcId, self.__id,  self.closed);\n        }\n\n        if(rtcPeerConnection.ontrack === null){\n            self._onTrack && (rtcPeerConnection.ontrack = function (event) {\n                self._onTrack(event);\n            });\n        }\n\n        rtcPeerConnection.onaddstream = function (event) {\n            self._onGotRemoteStream(event);\n        };\n    },\n\n    addTrack: function(tracks, stream){\n        var self = this;\n\n        tracks.forEach(function(track) {\n            self._rtcPeerConnection.addTrack(track, stream);\n            _logger.debug('Added track(', track.id, track.kind, track.label,') of stream(', stream.id, ') to RtcPeerConnection',\n                 self._rtcId, self.__id, self.closed);\n        });\n    },\n    setLocalStream: function (localStream) {\n        var self = this;\n\n        self._localStream = localStream;\n\n        if(self._rtcPeerConnection.addTrack){\n            localStream.getTracks().forEach(function(track) {\n                self._rtcPeerConnection.addTrack(track, localStream);\n                _logger.debug('Added track(', track.enabled, track.id, track.kind, track.label,') of localStream(', localStream.id, ') to RtcPeerConnection',\n                    self._rtcId, self.__id, self.closed);\n            });\n        }else{\n            self._rtcPeerConnection.addStream(localStream);\n\n            var videoTracks = localStream.getVideoTracks();\n            var audioTracks = localStream.getAudioTracks();\n\n            if (videoTracks && videoTracks.length > 0) {\n                _logger.debug('RtcPeerConnection video: ',\n                    videoTracks[0].enabled, videoTracks[0].id, videoTracks[0].kind, videoTracks[0].label,\n                    self._rtcId, self.__id, self.closed);\n            }\n            if (audioTracks && audioTracks.length > 0) {\n                _logger.debug('RtcPeerConnection audio: ',\n                    audioTracks[0].enabled, audioTracks[0].id, audioTracks[0].kind, audioTracks[0].label,\n                    self._rtcId, self.__id, self.closed);\n            }\n        }\n        _logger.debug('Added local stream to RtcPeerConnection',\n            localStream.id, localStream.active, self._rtcId, self.__id, this.closed);\n    },\n\n    removeStream: function (mediaStream) {\n        this._rtcPeerConnection.removeStream(mediaStream);\n        _logger.debug('Remove stream from RtcPeerConnection', mediaStream, self._rtcId, self.__id, this.closed);\n    },\n\n    getLocalStream: function () {\n        return this._localStream;\n    },\n    getRemoteStream: function () {\n        return this._remoteStream;\n    },\n\n    createOffer: function (onCreateOfferSuccess, onCreateOfferError) {\n        //offerToReceiveAudio = false时，chrome没有video段；safari却这个块。需要将sendrecv改为sendonly\n        //由于手机没有视频发布时，sdp中有video字段，而 web以offerToReceiveVideo = false去订阅时，导致订阅流中没有video块，会引发重协商。进而导致 始终无法看到对方视频\n        //所以 订阅流时 无论offerToReceiveVideo = false，都生成offer sdp；其中都有video块。即 offerToReceiveVideo = true；但要将sdp修改为recvonly\n        \n        // if(self.subArgs){\n        //     c_offerOptions = {\n        //         offerToReceiveAudio: true,\n        //         offerToReceiveVideo: true\n        //     }\n        // }\n        \n        _logger.info('start create offer... self.offerOption str', JSON.stringify(this.offerOptions))\n        _logger.info('start create offer... self.offerOption', this.offerOptions)\n        \n        var self = this;\n\n        var offerOptions_changeless = _util.extend({}, self.offerOptions); // 固定下来的 options， createoffer 异步后不固化，可能会变\n                \n        let offerOptions = self.subArgs ? {offerToReceiveAudio: true, offerToReceiveVideo: true} : \n                            JSON.parse(JSON.stringify(self.offerOptions)); //  createoffer options\n\n        return self._rtcPeerConnection.createOffer(offerOptions).then(\n            function (desc) {\n\n                _logger.info('original offer sdp', desc)\n\n                self.offerDescription = desc;\n\n                if(emedia.isEdge){\n                    desc.sdp = desc.sdp.replace(/profile-level-id=[^;]+/, \"profile-level-id=42e01f\");\n                }\n                if(emedia.isFirefox){\n                    //需要交换 cand answer\n                    self.fireFoxOfferVideoPreAudio = self.__offerVideoPreAudio = SDPSection.isVideoPreAudio(desc.sdp);\n                }else{\n                    self.__offerVideoPreAudio = SDPSection.isVideoPreAudio(desc.sdp); // video在audio前时，xswitch的answer是 audio在前。set answer时需要 变换answer\n                }\n\n                desc.sdp = desc.sdp.replace(/m=video 0/g, \"m=video 9\");\n                _logger.warn(\"setLocalDescription. modify offer. if 'm=video 0' -> 'm=video 9'; if H264, 'profile-level-id=42e01f'\", self._rtcId, self.__id);\n\n                if((self.optimalVideoCodecs && self.optimalVideoCodecs.length > 0) //数组或字符串\n                    || (self.optimalAudioCodecs && self.optimalAudioCodecs.length > 0) //数组或字符串\n                    // || (self.offerOptions && (self.offerOptions.offerToReceiveVideo === false || self.offerOptions.offerToReceiveAudio === false))\n                    || (offerOptions_changeless && (offerOptions_changeless.offerToReceiveVideo === false || offerOptions_changeless.offerToReceiveAudio === false))\n                ){\n                    var sdpSection = new SDPSection(desc.sdp, self);\n                    self.optimalVideoCodecs && sdpSection.updateVCodes(self.optimalVideoCodecs);\n                    self.optimalAudioCodecs && sdpSection.updateACodes(self.optimalAudioCodecs);\n\n                    // self.offerOptions && self.offerOptions.offerToReceiveVideo === false\n                    //     && sdpSection.updateVideoSection(/a=sendrecv|a=recvonly/g, \"a=sendonly\");\n                    // self.offerOptions && self.offerOptions.offerToReceiveAudio === false\n                    //     && sdpSection.updateAudioSection(/a=sendrecv|a=recvonly/g, \"a=sendonly\");\n\n                    offerOptions && offerOptions_changeless.offerToReceiveVideo === false\n                        && sdpSection.updateVideoSection(/a=sendrecv|a=recvonly/g, \"a=sendonly\");\n                    offerOptions && offerOptions_changeless.offerToReceiveAudio === false\n                        && sdpSection.updateAudioSection(/a=sendrecv|a=recvonly/g, \"a=sendonly\");\n\n                    desc.sdp = sdpSection.getUpdatedSDP(); //保持顺序\n                }\n\n                _logger.debug('setLocalDescription start', self._rtcId, self.__id,  self.closed, self.optimalVideoCodecs, self.optimalAudioCodecs);\n                if(emedia.config.useDTX){\n                    // 1. 先删除 带 CN/ 的行\n                    desc.sdp = desc.sdp.replace(/a=rtpmap:(.*)CN\\/(.*)\\r\\n/g, '')\n                    // 2. 拿到 音频编码的 数字\n                    let num = desc.sdp.match(/a=rtpmap:(.*)\\sopus/)[1];\n                    // 3. 在a=fmtp:${num} 结尾添加 ;usedtx=1\n                    desc.sdp = desc.sdp.replace(new RegExp(`a=fmtp:${num}(.*)\\\\r\\\\n`),`a=fmtp:${num}$1;usedtx=1\\r\\n`);\n                }\n                self._rtcPeerConnection.setLocalDescription(desc).then(\n                    self._onSetLocalSessionDescriptionSuccess.bind(self),\n                    self._onSetSessionDescriptionError.bind(self, desc)\n                ).then(function () {\n                    desc.cctx = self.cctx;\n                    (onCreateOfferSuccess || self.onCreateOfferSuccess.bind(self))(desc);\n                });\n            },\n            (onCreateOfferError || self._onCreateSessionDescriptionError.bind(self, offerOptions))\n        );\n    },\n\n    createPRAnswer: function (onCreatePRAnswerSuccess, onCreatePRAnswerError) {\n        var self = this;\n\n        _logger.info(' createPRAnswer start',  self.closed, self.sdpConstraints);\n        // Since the 'remote' side has no media stream we need\n        // to pass in the right constraints in order for it to\n        // accept the incoming offer of audio and video.\n        return self._rtcPeerConnection.createAnswer(self.sdpConstraints).then(\n            function (desc) {\n                _logger.debug('_____________PRAnswer ', desc.sdp, self._rtcId, self.__id,  self.closed);//_logger.debug('from :\\n' + desc.sdp);\n\n                desc.type = \"pranswer\";\n                desc.sdp = desc.sdp.replace(/a=recvonly/g, 'a=inactive');\n\n                var sdpSection = new SDPSection(desc.sdp, self);\n                self.optimalVideoCodecs && sdpSection.updateVCodes(self.optimalVideoCodecs);\n                self.optimalAudioCodecs && sdpSection.updateACodes(self.optimalAudioCodecs);\n\n                desc.sdp = sdpSection.getUpdatedSDP(); //保持顺序\n\n                self.__prAnswerDescription = desc;\n\n                _logger.debug('inactive PRAnswer ', desc.sdp, self._rtcId, self.__id,  self.closed);//_logger.debug('from :\\n' + desc.sdp);\n                _logger.debug('setLocalDescription start', desc, self._rtcId, self.__id,  self.closed);\n\n                self._rtcPeerConnection.setLocalDescription(desc).then(\n                    self._onSetLocalSessionDescriptionSuccess.bind(self),\n                    self._onSetSessionDescriptionError.bind(self, desc)\n                ).then(function () {\n                    sdpSection.updateHeaderMsidSemantic(\"MS_0000\");\n                    sdpSection.updateAudioSSRCSection(1000, \"CHROME0000\", \"MS_0000\", \"LABEL_AUDIO_1000\");\n                    sdpSection.updateVideoSSRCSection(2000, \"CHROME0000\", \"MS_0000\", \"LABEL_VIDEO_2000\");\n\n                    desc.sdp = sdpSection.getUpdatedSDP();\n\n                    _logger.debug('Send PRAnswer ', desc.sdp, self._rtcId, self.__id,  self.closed);//_logger.debug('from :\\n' + desc.sdp);\n\n                    self.cctx && (desc.cctx = self.cctx);\n                    (onCreatePRAnswerSuccess || self.onCreatePRAnswerSuccess.bind(self))(desc);\n                });\n            },\n            (onCreatePRAnswerError || self._onCreateSessionDescriptionError.bind(self, self.sdpConstraints))\n        );\n    },\n\n    createAnswer: function (onCreateAnswerSuccess, onCreateAnswerError) {\n        var self = this;\n\n        _logger.info('createAnswer start',  self.closed, self.sdpConstraints);\n        // Since the 'remote' side has no media stream we need\n        // to pass in the right constraints in order for it to\n        // accept the incoming offer of audio and video.\n        return self._rtcPeerConnection.createAnswer(self.sdpConstraints).then(\n            function (desc) {\n                _logger.debug('_____________________Answer ', self._rtcId, self.__id,  self.closed);//_logger.debug('from :\\n' + desc.sdp);\n\n                desc.type = 'answer';\n\n                function updateSDP(sdpSection) {\n                    var ms = sdpSection.parseMsidSemantic(sdpSection.headerSection);\n                    if(!ms){\n                        return;\n                    }\n\n                    if(ms.WMS == '*') {\n                        sdpSection.updateHeaderMsidSemantic(ms.WMS = \"MS_0000\");\n                    }\n                    var audioSSRC = sdpSection.parseSSRC(sdpSection.audioSection);\n                    var videoSSRC = sdpSection.parseSSRC(sdpSection.videoSection);\n\n                    audioSSRC && sdpSection.updateAudioSSRCSection(1000, \"CHROME0000\", ms.WMS, audioSSRC.label || \"LABEL_AUDIO_1000\");\n                    if(videoSSRC){\n                        sdpSection.updateVideoSSRCSection(2000, \"CHROME0000\", ms.WMS, videoSSRC.label || \"LABEL_VIDEO_2000\");\n                    }\n                    // mslabel cname\n\n                    desc.sdp = sdpSection.getUpdatedSDP();\n                }\n\n                var sdpSection = new SDPSection(desc.sdp, self);\n                self.optimalVideoCodecs && sdpSection.updateVCodes(self.optimalVideoCodecs);\n                self.optimalAudioCodecs && sdpSection.updateACodes(self.optimalAudioCodecs);\n\n                if(emedia.supportPRAnswer){\n                    updateSDP(sdpSection);\n                }else{\n                    desc.sdp = sdpSection.getUpdatedSDP(); //保持顺序\n                }\n\n                self.__answerDescription = desc;\n\n                _logger.debug('Answer ', self._rtcId, self.__id,  self.closed);//_logger.debug('from :\\n' + desc.sdp);\n                _logger.debug('setLocalDescription start', desc, self._rtcId, self.__id,  self.closed);\n\n                self._rtcPeerConnection.setLocalDescription(desc).then(\n                    self._onSetLocalSessionDescriptionSuccess.bind(self),\n                    self._onSetSessionDescriptionError.bind(self, desc)\n                ).then(function () {\n                    if(emedia.supportPRAnswer){\n                        sdpSection.updateHeaderMsidSemantic(\"MS_0000\");\n                        sdpSection.updateAudioSSRCSection(1000, \"CHROME0000\", \"MS_0000\", \"LABEL_AUDIO_1000\");\n                        sdpSection.updateVideoSSRCSection(2000, \"CHROME0000\", \"MS_0000\", \"LABEL_VIDEO_2000\");\n\n                        desc.sdp = sdpSection.getUpdatedSDP();\n                    }\n\n                    _logger.debug('Send Answer ', self._rtcId, self.__id, self.closed);//_logger.debug('from :\\n' + desc.sdp);\n\n                    self.cctx && (desc.cctx = self.cctx);\n                    (onCreateAnswerSuccess || self.onCreateAnswerSuccess.bind(self))(desc);\n                });\n            },\n            (onCreateAnswerError || self._onCreateSessionDescriptionError.bind(self, self.sdpConstraints))\n        );\n    },\n\n    _printStats: function(mediaStream){\n        var self = this;\n        if(!self.confrAttendee || !emedia.config.remainLastStatsCount){\n            return;\n        }\n\n        mediaStream && mediaStream.getTracks().forEach(function (track) {\n            self._printTrackStats(track);\n        })\n    },\n\n    _printTrackStats: function(track){\n        var self = this;\n        if(!self.confrAttendee || !emedia.config.remainLastStatsCount){\n            return;\n        }\n\n        var trackStats = self.confrAttendee._trackStats && self.confrAttendee._trackStats[track.id];\n        if(!trackStats){\n            return;\n        }\n\n        for(var type in trackStats){\n            var typeStats = trackStats[type];\n\n            for(var subType in typeStats){\n                var stats = typeStats[subType];\n\n                if(!stats){\n                    continue;\n                }\n\n                var index = stats.curIndex;\n                for(var i = 0; i < emedia.config.remainLastStatsCount; i++){\n                    index = (index - 1) % emedia.config.remainLastStatsCount;\n                    var stat = stats[index];\n                    if(!stat || stat.data === undefined){\n                        break;\n                    }\n                    _logger.info(\"[track]\", self._rtcId, self.__id, track.kind, track.id, type, subType, stat.data, stat.timestamp.toLocaleString());\n                }\n            }\n        }\n\n        _util.removeAttribute(self.confrAttendee._trackStats, track.id);\n    },\n\n    close: function (remainLocalStream, onlyPeerConnectionClosed, retryBuild) {\n        var self = this;\n        _logger.warn(\"webrtc closing\",  self._rtcId, self.__id, self.closed);\n\n        self.__iceWaitIntervalId && clearTimeout(self.__iceWaitIntervalId);\n\n        if(self.closed){\n            return;\n        }\n\n        onlyPeerConnectionClosed = (onlyPeerConnectionClosed === true);\n\n        self.closed = true;\n\n        try {\n            //self._rtcPeerConnection && self._rtcPeerConnection.close();\n            var localStream = self._localStream;\n            var remoteStream = self._remoteStream;\n\n            function closePC() {\n                self._rtcPeerConnection && self._rtcPeerConnection.close();\n                _logger.info(\"peer connection close. it is\", self._rtcPeerConnection && self._rtcPeerConnection.__peerId);\n\n                if(!retryBuild && emedia.isSafari){ //safari close peer connection, not notify state closed\n                    var theState = self._rtcPeerConnection.iceConnectionState || self._rtcPeerConnection.connectionState;\n                    setTimeout(function () {\n                        var nowState = self._rtcPeerConnection.iceConnectionState || self._rtcPeerConnection.connectionState;\n                        // if(nowState !== 'closed' && theState !== 'closed'){\n                        //     self.onIceStateChange && self.onIceStateChange('closed');\n                        // }\n                        self.onIceStateChange && self.onIceStateChange('closed');\n                    }, 200);\n                }\n            }\n\n            if(emedia.config.printStatsWhenPCClose){\n                self.getStats(()=>{\n                    closePC();\n\n                    localStream && self._printStats(localStream);\n                    remoteStream && self._printStats(remoteStream);\n                });\n            }else{\n                closePC();\n            }\n        } catch (e) {\n            _logger.warn(e);\n        } finally {\n            if(self._localStream && remainLocalStream === false){ //localstream存在，不保留localstream\n                emedia.stopTracks(self._localStream);\n            }\n\n            if (self._remoteStream) {\n                emedia.stopTracks(self._remoteStream);\n            }\n            self._remoteStream = null;\n\n            if(!onlyPeerConnectionClosed){\n                self.onClose && self.onClose();\n            }\n\n            if(retryBuild === true){\n                _logger.info(\"Webrtc close. but retry build. will onIceStateChange(failed). eg. emedia.config iceWaitBuildMillis\", self._rtcId, self.__id);\n                self.onIceStateChange && self.onIceStateChange('failed');\n            }\n\n            _logger.warn(\"webrtc closed. closed:\", self._rtcId, self.__id, self.closed);\n        }\n    },\n\n    addIceCandidate: function (candidate) {\n        console.log('addIceCandidate candidate', JSON.stringify(candidate));\n\n        var self = this;\n\n        var _cands = _util.isArray(candidate) ? candidate : [candidate];\n\n        if(emedia.mgr.rtc_url_config) {// 读取rtcconfig 替换cands 如果开启了使用多集群\n            _cands = emedia.mgr.rtc_url_config.replace_candidates(_cands);\n        }\n\n        if(emedia && emedia.config && (typeof emedia.config.reChanageCandidate === \"function\")){\n            var candsChanaged = [];\n            for (var i = 0; i < _cands.length; i++) {\n                candidate = _cands[i];\n\n                var newCandidates = emedia.config.reChanageCandidate(candidate);\n                if(newCandidates){\n                    _logger.info(\"Candidate rechanage. addons. it =\", candidate, \"->\", newCandidates);\n\n                    if(_util.isArray(newCandidates)){\n                        Array.prototype.push.apply(candsChanaged, newCandidates);\n                    }else{\n                        candsChanaged.push(newCandidates);\n                    }\n                }\n            }\n            _cands = candsChanaged;\n        }\n\n        self._addIceCandidate(_cands);\n    },\n\n    _addIceCandidate: function (candidate) {\n        var self = this;\n\n        if (!self._rtcPeerConnection) {\n            return;\n        }\n\n        _logger.debug('Add ICE candidate: ', candidate, self._rtcId, self.__id,  self.closed);\n\n        var _cands = _util.isArray(candidate) ? candidate : [candidate];\n        //!_util.isArray(candidate) && _cands.push(candidate);\n\n        if(!self.__setRemoteSDP){\n            Array.prototype.push.apply((self.__tmpRemoteCands || (self.__tmpRemoteCands = {})), _cands);\n\n            _logger.debug('Add ICE candidate but tmp buffer caused by not set remote sdp: ', candidate, self._rtcId, self.__id,  self.closed);\n            return;\n        }\n\n        for (var i = 0; i < _cands.length; i++) {\n            candidate = _cands[i];\n\n            if(candidate.cctx && candidate.cctx != self.cctx){\n                _logger.warn('addIceCandidate fail drop. cctx not equal. ', candidate, self._rtcId, self.__id,  self.closed);\n                continue;\n            }\n\n            //candidate.candidate = candidate.candidate.replace(\"172.17.2.130\", \"10.121.63.1\");\n            if(self.fireFoxOfferVideoPreAudio === true){\n                //candidate.sdpMid = \"sdparta_0\";\n                var oldLineIndex = candidate.sdpMLineIndex;\n                candidate.sdpMLineIndex = parseInt(candidate.sdpMid.replace(/[^0-9]*/, ''));\n                _logger.warn(\"Firefox sdp section video pre audio, sdp mline index update \", oldLineIndex, \"->\", candidate.sdpMLineIndex);\n            }\n\n            if(candidate.candidate && candidate.candidate !== \"\"){\n                self._rtcPeerConnection.addIceCandidate(new RTCIceCandidate(candidate)).then(\n                    self.onAddIceCandidateSuccess.bind(self),\n                    self._onAddIceCandidateError.bind(self, candidate)\n                );\n            }else{\n                _logger.warn(\"Add ICE candidate fail. drop it \", candidate, self._rtcId, self.__id,  self.closed);\n            }\n        }\n    },\n\n    setRemoteDescription: function (desc) {\n        var self = this;\n        //setTimeout(self._setRemoteDescription.bind(this, desc), 1000);\n        return self._setRemoteDescription(desc);\n    },\n\n    _setRemoteDescription: function (desc) {\n        var self = this;\n\n        if(self.__iceWaitIntervalId){\n            clearTimeout(self.__iceWaitIntervalId);\n            self.__iceWaitIntervalId = null;\n            _logger.info(\"emedia.config iceWaitBuildMillis, clear ice wait interval id\", self._rtcId, self.__id);\n        }\n\n        _logger.debug('setRemoteDescription start. ', self._rtcId, self.__id,  self.closed);\n\n        // 生成offer的\n        // 会议模式，也是设置的是 pranswer 和 answer 会有服务器传回。\n        // p2p模式下的主叫。此时设置的是 pranswer 和 answer。这个应该有p2p模式下传回。因此，需要如果有的话，需要判断\n        if(self.offerDescription){\n            if(desc.cctx && desc.cctx != self.cctx){\n                _logger.warn('setRemoteDescription fail drop. cctx not equal. ', desc, self._rtcId, self.__id,  self.closed);\n                return;\n            }\n\n            if(self.fireFoxOfferVideoPreAudio === true || self.__offerVideoPreAudio === true){\n                //_logger.debug(\"Remote sdp.1\", desc.sdp);\n\n                var sdpSection = new SDPSection(desc.sdp, self);\n                desc.sdp = sdpSection.getUpdatedSDP(false);\n                _logger.info(\"Remote sdp.2. switch audio video\", desc.sdp);\n            }\n        }else{//被叫 p2p模式，覆盖\n            desc.cctx && (self.cctx = desc.cctx);\n        }\n\n        desc.sdp = desc.sdp.replace(/UDP\\/TLS\\/RTP\\/SAVPF/g, \"RTP/SAVPF\");\n        _logger.warn('setRemoteDescription. UDP/TLS/RTP/SAVPF -> RTP/SAVPF; if firefox: switch audio video;', self._rtcId, self.__id);\n        //_logger.debug('setRemoteDescription.', desc, self._rtcId, self.__id);\n\n        // https://webrtchacks.com/limit-webrtc-bandwidth-sdp/\n        // bitrate\n        if(self.vbitrate || self.abitrate || self.vminBitrate){\n            var sdpSection = new SDPSection(desc.sdp, self);\n\n            self.vbitrate && sdpSection.setVideoBitrate(self.vbitrate);\n            self.vminBitrate && sdpSection.setVideoMinBitrate(self.vminBitrate);\n            self.abitrate && sdpSection.setAudioBitrate(self.abitrate);\n\n            _logger.warn(\"vbitrate = \", self.vbitrate, \"vminBitrate = \", this.vminBitrate, \", abitrate = \", self.abitrate, self._rtcId, self.__id);\n            desc.sdp = sdpSection.getUpdatedSDP(\n                ((typeof self.__offerVideoPreAudio === 'undefined') || self.__offerVideoPreAudio === null) ? undefined : !self.__offerVideoPreAudio);\n        }\n\n        _logger.debug(\"final remote sdp =\", desc.sdp, self._rtcId, self.__id);\n\n        desc = self.__remoteDescription = new RTCSessionDescription(desc);\n\n        return self._rtcPeerConnection.setRemoteDescription(desc).then(\n            function() {\n                self.__setRemoteSDP = true;\n                self._onSetRemoteSuccess.apply(self, arguments);\n\n                if(self.__tmpLocalCands && self.__tmpLocalCands.length > 0){\n                    _logger.debug('After setRemoteDescription. send cands', self._rtcId, self.__id,  self.closed);\n                    self._onIceCandidate(self.__tmpLocalCands);\n\n                    self.__tmpLocalCands = [];\n                }\n\n                if(self.__tmpRemoteCands && self.__tmpRemoteCands.length > 0){\n                    _logger.debug('After setRemoteDescription. add tmp cands', self._rtcId, self.__id,  self.closed);\n                    self._addIceCandidate(self.__tmpRemoteCands);\n\n                    self.__tmpRemoteCands = [];\n                }\n            },\n            self._onSetSessionDescriptionError.bind(self, desc)\n        );\n    },\n\n    iceConnectionState: function () {\n        var self = this;\n\n        return self._rtcPeerConnection.iceConnectionState;\n    },\n\n    isConnected: function () {\n        var self = this;\n\n        var state = self.lastIceConnectionState;\n\n        return \"connected\" === state || \"completed\" === state;\n    },\n\n    _onGotRemoteStream: function (event) {\n        var self = this;\n\n        self._remoteStream = event.stream || event.streams[0];\n        self._remoteStream._rtcId = self._rtcId;\n        self._remoteStream.__rtc_c_id = self.__id;\n        _logger.debug('On got remote stream',\n            self._remoteStream ? self._remoteStream.id + \"_\" + self._remoteStream.active : \"null\",\n            self._rtcId, self.__id);\n\n        self._remoteStream && self._remoteStream.getTracks().forEach(function(track) {\n            // if(typeof track.getSettings === 'function'){\n            //     _logger.debug('remote stream', self._remoteStream.id,\n            //         \" track setting =\", track.enabled, track.id, track.kind, track.label, track.getSettings(), self._rtcId, self.__id);\n            // }else{\n                _logger.debug('remote stream', self._remoteStream.id,\n                    \" track =\", track.enabled, track.id, track.kind, track.label, self._rtcId, self.__id);\n            // }\n        });\n\n        self.updateRemoteBySubArgs();\n\n        this.onGotRemoteStream(this._remoteStream, event);\n\n        _logger.debug('received remote stream, you will see the other.', self._rtcId, self.__id,  this.closed);\n    },\n\n    _onSetRemoteSuccess: function () {\n        _logger.info('onSetRemoteSuccess success', this._rtcId, this.__id);\n        this.onSetRemoteSuccess.apply(this, arguments);\n\n        if(this.offerDescription && this.__remoteDescription && this.__remoteDescription.sdp){\n            this._onAnswerCodes(this.__remoteDescription.sdp);\n        }\n    },\n\n    _onAnswerCodes: function (sdp) {\n        var self = this;\n        var section = new SDPSection(sdp, this);\n        if(section.videoSection){\n            var rtpParams = SDPUtils.parseRtpParameters(section.videoSection);\n\n            if(!rtpParams.codecs || rtpParams.codecs.length === 0){\n                _logger.info(\"not found any video codes. @ \", self._rtcId, self.__id);\n                return;\n            }\n\n            var vcodes = [];\n            var flag = {};\n            _util.forEach(rtpParams.codecs, function (_i, _param) {\n                if(flag[_param.name] !== true){\n                    flag[_param.name] = true;\n                    vcodes.push(_param.name);\n                }\n            });\n\n            self.finalVCodeChoices = vcodes;\n\n            self.onVCodeChoices && self.onVCodeChoices(vcodes);\n        }\n    },\n\n    onSetRemoteSuccess: function () {\n    },\n\n    onAddIceCandidateSuccess: function () {\n        _logger.debug('addIceCandidate success', this._rtcId, this.__id);\n    },\n\n    _onAddIceCandidateError: function (candidate, error) {\n        _logger.error('failed to add ICE Candidate: ' + error.toString(), \", error candidate:\", candidate, this._rtcId, this.__id);\n        this.onAddIceCandidateError(error);\n    },\n    onAddIceCandidateError: function (error) {\n    },\n\n    _onIceCandidate: function (candidate) {\n        _logger.debug('onIceCandidate:', candidate, this._rtcId, this.__id);\n        this.onIceCandidate(candidate);\n    },\n    onIceCandidate: function (candidate) {\n    },\n\n    onIceStateChange: function (state) {\n        _logger.debug('onIceStateChange : ICE state ', state);\n    },\n\n    _onCreateSessionDescriptionError: function (offerOptionsOrSDPConstraints, error) {\n        _logger.error('Failed to create session description: ' + error.toString(), \" offerOptionsOrSDPConstraints:\", offerOptionsOrSDPConstraints, this._rtcId, this.__id);\n        this.onCreateSessionDescriptionError(error);\n    },\n    onCreateSessionDescriptionError: function (error) {\n    },\n\n    onCreateOfferSuccess: function (desc) {\n        _logger.debug('create offer success', this._rtcId, this.__id);\n    },\n\n    onCreatePRAnswerSuccess: function (desc) {\n        _logger.debug('create answer success', this._rtcId, this.__id);\n    },\n\n    onCreateAnswerSuccess: function (desc) {\n        _logger.debug('create answer success', this._rtcId, this.__id);\n    },\n\n    _onSetSessionDescriptionError: function (sdp, error) {\n        _logger.error('onSetSessionDescriptionError : Failed to set session description: ', error.toString(), this._rtcId, this.__id);\n        sdp && sdp.type && sdp.sdp && _logger.error('error sdp: type=', sdp.type, \"sdp=\", sdp.sdp, this._rtcId, this.__id);\n        this.onSetSessionDescriptionError(error);\n    },\n    onSetSessionDescriptionError: function (error) {\n    },\n    _onSetLocalSessionDescriptionSuccess: function () {\n        var self = this;\n        _logger.debug('onSetLocalSessionDescriptionSuccess : setLocalDescription complete', this._rtcId, this.__id);\n\n        if(emedia.config.iceWaitBuildMillis){\n            this.__iceWaitIntervalId && clearTimeout(this.__iceWaitIntervalId);\n            this.__iceWaitIntervalId = setTimeout(function () {\n                _logger.info(\"emedia.config iceWaitBuildMillis, timeout, will close webrtc, will retry build by onIceStateChange(failed)\",\n                    self._rtcId, self.__id);\n                //self.close(true, true, true);\n                self.onIceStateChange && self.onIceStateChange('failed');\n            }, emedia.config.iceWaitBuildMillis);\n            _logger.info(\"emedia.config iceWaitBuildMillis, start timeout\", self._rtcId, self.__id);\n        }\n\n        this.onSetLocalSessionDescriptionSuccess();\n\n        if(this.__answerDescription && this.__answerDescription.sdp){\n            this._onAnswerCodes(this.__answerDescription.sdp);\n        }\n    },\n    onSetLocalSessionDescriptionSuccess: function () {\n\n    },\n\n    onGotRemoteStream: function(remoteStream){\n        _logger.debug(\"Got remote stream. \", remoteStream, this._rtcId, this.__id);\n    },\n\n    getStats: function (onCallback) {\n        var self = this;\n\n        if(!self._rtcPeerConnection){\n            _logger.warn(\"Get stats, but peer connection not exsits, \", this._rtcId, this.__id);\n            onCallback && onCallback();\n            return;\n        }\n\n        if(typeof emedia.config.rtcStatsTypeMath !== 'function'){\n            _logger.warn(\"Get stats, but config rtcStatsTypeMather, \", this._rtcId, this.__id);\n            onCallback && onCallback();\n            return;\n        }\n\n        self._rtcPeerConnection\n            .getStats(null)\n            .then(function (stats) {\n                stats.forEach(function(_stat, name){\n                    if(emedia.config.rtcStatsTypeMath(_stat, name)){\n                        _logger.info(\"Rtc stats\", _stat, self._rtcId, self.__id);\n                    }\n                });\n                onCallback && onCallback(stats);\n            })\n    }\n});\n\nmodule.exports = _WebRTC;\n","var _util = require('./Util');\nvar _logger = _util.tagLogger(\"PCStats\");\n\n/**\n * outbound-rtp\n *  bytesSent\n *  packetsSent\n *  qpSum\n *  pliCount\n * inbound-rtp\n *  bytesReceived\n *  framesDecoded\n *  packetsLost\n *  packetsReceived\n *  pliCount\n * track\n *  framesDecoded\n *  framesReceived\n *  framesDropped\n * transport\n *  bytesReceived\n *  bytesSent\n * candidate-pair\n *  bytesReceived\n *  bytesSent\n *  totalRoundTripTime\n *  requestsReceived\n *  responsesSent\n *  requestsSent\n *  responsesReceived\n * local-candidate\n *  networkType\n *  protocol\n *  port\n * remote-candidate\n *  ip\n * codec\n *  clockRate\n *  mimeType\n *\n *\n */\n\nvar PCStats;\nmodule.exports = PCStats = _util.prototypeExtend({\n    //_webrtc:\n    //_stream:\n\n    __init__: function () {\n        if(!this._webrtc){\n            this._stream && (this._webrtc = this._stream._webrtc);\n        }\n\n        this.samplesDatas = {};\n        this.gatherResults = {};\n\n        this._bysamples = {};\n        if(this._inbound_ !== false){\n            this._bysamples[\"inbound-rtp\"] = [\"bytesRateReceived\", \"packageLossRate\", \"bytesReceived\", \"packetsLost\", \"packetsReceived\", \"pliCount\", \"framesDecoded\"];\n            //this._bysamples[\"inbound-rtp\"] = [\"bytesReceived\", \"packetsLost\", \"packetsReceived\", \"packageLossRate\"];\n        }\n        if(this._outbound_ !== false){\n            this._bysamples[\"outbound-rtp\"] = [\"bytesRateSent\", \"bytesSent\", \"packetsSent\", \"qpSum\", \"pliCount\"];\n            //this._bysamples[\"outbound-rtp\"] = [\"bytesSent\"];\n        }\n    },\n\n    _onGatherResult: function (trackId, type, subtype, data) {\n        //_logger.info(trackId, type, subtype, data);\n        //_logger.debug(trackId, type, subtype, data);\n\n        var self = this;\n\n        if(self._service\n            && self._service.current\n            && emedia.config.remainLastStatsCount){\n            var trackStats = self._service.current._trackStats;\n            if(!trackStats){\n                trackStats = self._service.current._trackStats = {};\n            }\n            var typeStats = (trackStats[trackId] || (trackStats[trackId] = {}))[type];\n            if(!typeStats){\n                typeStats = trackStats[trackId][type] = {};\n            }\n\n            var subTypeStats = typeStats[subtype];\n            if(!subTypeStats){\n                subTypeStats= typeStats[subtype] = new Array(emedia.config.remainLastStatsCount);\n            }\n\n            subTypeStats.curIndex === undefined && (subTypeStats.curIndex = 0);\n            subTypeStats[subTypeStats.curIndex] = {\n                data: data,\n                timestamp: new Date()\n            };\n            subTypeStats.curIndex = (subTypeStats.curIndex + 1) % emedia.config.remainLastStatsCount;\n        }\n        typeof this.onGatherResult === \"function\" && this.onGatherResult(trackId, type, subtype, data);\n    },\n\n    stats: function (selector) {\n        if(!this._webrtc || !this._webrtc._rtcPeerConnection){\n            _logger.warn(\"not found webrtc or peer connection\");\n            return;\n        }\n\n        return this._webrtc._rtcPeerConnection.getStats(selector);\n    },\n\n    statsOfTrack: function (selector) {\n        if(!selector instanceof window.MediaStreamTrack){\n            _logger.error(\"selector not a MediaStreamTrack\");\n            throw \"selector not a MediaStreamTrack\";\n        }\n\n        return this.stats(selector);\n    },\n\n    audioTrack: function (mediaStream) {\n        var tracks = mediaStream && mediaStream.getAudioTracks();\n        return tracks && tracks.length ? tracks[0] : undefined;\n    },\n\n    videoTrack: function (mediaStream) {\n        var tracks = mediaStream && mediaStream.getVideoTracks();\n        return tracks && tracks.length ? tracks[0] : undefined;\n    },\n\n    // samplingTrack: function (track) {\n    //     var self = this;\n    //\n    //     var trackId = track.id;\n    //     this.statsOfTrack(track).then(function(_stats){\n    //         self._trackSamples[trackId] || (self._trackSamples[trackId] = []);\n    //\n    //         var statsParms = self._trackSamples[trackId];\n    //\n    //         _stats.forEach(function(_stat, name){\n    //             var samplings = _bysamples[_stat.type];\n    //\n    //             var tmp;\n    //             if(samplings && samplings.length){\n    //                 var statParms = (tmp || (tmp = {}))[_stat.type] = {type:_stat.type, timestamp: _stat.timestamp};\n    //\n    //                 samplings.forEach(function(_param){\n    //                     statParms[_param] = _stat[_param];\n    //                 });\n    //             }\n    //             tmp && statsParms.push(tmp);\n    //         });\n    //     });\n    // },\n\n    gatherTrack: function (track, mediaType) {\n        var self = this;\n\n        mediaType = track.kind || mediaType;\n        mediaType = mediaType && mediaType.toLowerCase();\n\n        var trackId = track.id;\n        this.statsOfTrack(track).then(function(_stats){\n            self.samplesDatas[trackId] || (self.samplesDatas[trackId] = {});\n\n            var statsParms = self.samplesDatas[trackId];\n\n            _stats.forEach(function(_stat, name){\n                var samplings = self._bysamples[_stat.type];\n\n                var statMediaType = _stat.mediaType\n                    || (name.indexOf(\"ideo\") >= 0 && \"video\")\n                    || (name.indexOf(\"udio\") >= 0 && \"audio\")\n                    || undefined;\n\n                if(samplings && samplings.length){\n                    if(emedia.config._printDebugStats === true){\n                        _logger.debug(name, _stat, track, statMediaType, mediaType);\n                    }\n\n                    if(!statMediaType || statMediaType === mediaType){\n                        var tmp = statsParms[_stat.type] || (statsParms[_stat.type] = {});\n\n                        samplings.forEach(function(_param){\n                            var items = (tmp[_param] || (tmp[_param] = []));\n\n                            var item = {timestamp: _stat.timestamp, kind: _stat.mediaType || track.kind || mediaType};\n                            if(\"packageLossRate\" === _param){\n                                item[_param] = {packetsLost: _stat[\"packetsLost\"], packetsReceived: _stat[\"packetsReceived\"]};\n                            }else if(\"bytesRateReceived\" === _param){\n                                item[_param] = _stat[\"bytesReceived\"];\n                            }else if(\"bytesRateSent\" === _param){\n                                item[_param] = _stat[\"bytesSent\"];\n                            }else{\n                                item[_param] = _stat[_param];\n                            }\n\n                            items.push(item);\n                        });\n                    }\n                }\n            });\n        });\n    },\n\n    gatherWebrtcMediaStream: function (_mediaStream, type) {\n        var self = this;\n\n        if(!type){\n            _mediaStream.getTracks().forEach(function (track) {\n                self.gatherTrack(track);\n            });\n            return;\n        }\n\n        if(\"audio\" === type.toLowerCase()){\n            _mediaStream.getAudioTracks().forEach(function (track) {\n                self.gatherTrack(track, track.kind || type.toLowerCase());\n            });\n            return;\n        }\n\n        if(\"video\" === type.toLowerCase()){\n            _mediaStream.getVideoTracks().forEach(function (track) {\n                self.gatherTrack(track, track.kind || type.toLowerCase());\n            });\n            return;\n        }\n    },\n\n    gatherWebrtc: function () {\n        this._webrtc._localStream && this.gatherWebrtcMediaStream(this._webrtc._localStream);\n        this._webrtc._remoteStream && this.gatherWebrtcMediaStream(this._webrtc._remoteStream);\n    },\n\n    _gather_inbound_rtp_packageLossRate: function (dataArray) {\n        if(!dataArray || dataArray.length === 0){\n            return 0;\n        }\n\n        var sum = 0;\n        var count = 0;\n\n        if(dataArray.length > 1){\n            for(var i = 1; i < dataArray.length; i++){\n                var data = dataArray[i];\n                var predata = dataArray[i - 1];\n                if(data.packageLossRate.packetsReceived == predata.packageLossRate.packetsReceived) {\n                    sum = 0;\n                    count = 0;\n                    continue;\n                }\n\n                sum = sum + ((data.packageLossRate.packetsLost - predata.packageLossRate.packetsLost)/(data.packageLossRate.packetsReceived - predata.packageLossRate.packetsReceived));\n                count ++;\n            }\n        }\n\n        if(dataArray.length >= emedia.config.statsSeconds){\n            dataArray.shift();\n        }\n\n        return count == 0 ? 0 : (sum / count);\n    },\n\n    _gatherBytesRate: function (type, subtype, dataArray) {\n        if(!dataArray || dataArray.length === 0){\n            return 0;\n        }\n\n        var data = dataArray[dataArray.length - 1][subtype] - dataArray[0][subtype]; //byte 字节，不是位\n        var time = dataArray[dataArray.length - 1].timestamp - dataArray[0].timestamp;\n\n        if(dataArray.length >= emedia.config.statsSeconds){\n            dataArray.shift();\n        }\n\n        return (time === 0) ? 0 : (parseFloat(data * 1000 / time).toFixed(2));\n    },\n    _gather: function (type, subtype, dataArray) {\n        type = type.replace(/[^\\w]/g, \"_\");\n        subtype = subtype.replace(/[^\\w]/g, \"_\");\n\n        var func = _util.list(\"_gather\", type, subtype).join(\"_\");\n        if(typeof this[func] === \"function\"){\n            return this[func](dataArray);\n        }\n\n        if(subtype.startsWith('bytesRate')){\n            return this._gatherBytesRate(type, subtype, dataArray);\n        }\n\n\n        var data = dataArray.shift();\n        return data && data[subtype] || 0;\n    },\n\n    _statsCount: function () {\n        var self = this;\n\n        function gatherByTrack() {\n            _util.forEach(self.samplesDatas, function (trackId, _samples) {\n                var trackGathers = self.gatherResults[trackId] = self.gatherResults[trackId] || {};\n                gatherByType(trackId, trackGathers, _samples);\n            });\n        }\n\n        function gatherByType(trackId, trackGathers, _trackSamples) {\n            _util.forEach(_trackSamples, function (type, _data) {\n                var typeGathers = (trackGathers[type] || (trackGathers[type] = {}));\n                gatherBySubtype(trackId, typeGathers, type, _data);\n            });\n        }\n\n        function gatherBySubtype(trackId, typeGathers, type, _data) {\n            _util.forEach(_data, function (subtype, dataArray) {\n                var result = typeGathers[subtype] = self._gather(type, subtype, dataArray);\n                self._onGatherResult(trackId, type, subtype, result);\n            });\n        }\n\n        gatherByTrack();\n    },\n\n    gather: function () {\n        this.gatherWebrtc();\n        this._statsCount();\n    },\n\n    intervalGather: function (intervalMillis) {\n        this._intervalId && clearInterval(this._intervalId);\n        this._intervalId = setInterval(this.gather.bind(this), intervalMillis || 1000);\n    },\n\n    stopIntervalGather: function () {\n        this._intervalId && clearInterval(this._intervalId);\n    }\n});\n\nvar statsMap = {};\nvar echo = PCStats.echo = function(hxStreams){\n    _util.forEach(hxStreams, function (_k, _stream) {\n        if(!statsMap[_stream.id]\n            && _stream._webrtc\n            && !_stream._webrtc.closed\n            && _stream.getMediaStream()){\n\n            var pcstats;\n            statsMap[_stream.id] = pcstats = new PCStats({_webrtc: _stream._webrtc});\n            pcstats._mediaStream = _stream.getMediaStream();\n        }else if(statsMap[_stream.id] && (!_stream._webrtc || _stream._webrtc.closed || !_stream.getMediaStream())){\n            _util.removeAttribute(statsMap, _stream.id);\n        }\n    });\n\n    var clearStats = [];\n    _util.forEach(statsMap, function (_sid, stats) {\n        if(!hxStreams || !hxStreams[_sid]){\n            clearStats.push(_sid);\n        }else{\n            stats.gatherWebrtcMediaStream(stats._mediaStream);\n            stats._statsCount();\n        }\n    });\n\n    _util.forEach(clearStats, function (_index, _sid) {\n        _util.removeAttribute(statsMap, _sid);\n    });\n};\n\nPCStats.intervalEcho = function(hxStreams, intervalMillis){\n    return setInterval(function () {\n        echo(hxStreams);\n    }, intervalMillis)\n};\n\n\n_util.forEach([\"inbound\", \"outbound\"], function (_typeIndex, gatherType) {\n    _util.forEach([\"Audio\", \"Video\"], function (_trackTypeIndex, trackType) {\n        (function gather(gatherType, trackType) {\n            var gatherTrack;\n            PCStats[gatherType + trackType] = gatherTrack = function (hxStream, onNotify, intervalMillis) {\n                gatherTrack.__intervalIds || (gatherTrack.__intervalIds = {});\n\n                var service;\n                if(this instanceof emedia.XService){\n                    service = this;\n                }else{\n                    service = emedia.useCurrentXService;\n                }\n\n                var index = hxStream.id + \"___\" + service.namespace;\n\n                var intervalId = gatherTrack.__intervalIds && gatherTrack.__intervalIds[index];\n                intervalId && clearInterval(intervalId);\n\n                intervalId = setInterval(function () {\n                    var pcstats = gatherTrack[index];\n                    if(!pcstats\n                        && hxStream\n                        && hxStream._webrtc\n                        && !hxStream._webrtc.closed\n                        && hxStream.getMediaStream()){\n\n                        gatherTrack[index] = pcstats = new PCStats({\n                            _webrtc: hxStream._webrtc,\n                            _inbound_: gatherType === \"inbound\",\n                            _outbound_: gatherType === \"outbound\"\n                        });\n                        pcstats._service = service;\n                        onNotify && (pcstats.onGatherResult = onNotify);\n                        pcstats._mediaStream = hxStream.getMediaStream();\n\n                    } else if(pcstats\n                        && (!hxStream\n                            || !hxStream._webrtc\n                            || hxStream._webrtc.closed\n                            || hxStream._webrtc.__id !== pcstats._webrtc.__id\n                            || !hxStream.getMediaStream()\n                            || !pcstats._mediaStream\n                            || pcstats._mediaStream.id !== hxStream.getMediaStream().id\n                        )){\n                        _util.removeAttribute(gatherTrack, index);\n                        pcstats = null;\n                    }\n\n                    if(!pcstats){\n                        var cacheStream;\n                        if(hxStream\n                            && service\n                            && (cacheStream = service.getStreamById(hxStream.id))){\n                            hxStream = cacheStream;\n                        }else{\n                            intervalId && clearInterval(intervalId);\n                        }\n\n                        return;\n                    }\n\n                    pcstats.gatherWebrtcMediaStream(pcstats._mediaStream, trackType);\n                    pcstats._statsCount();\n                }, intervalMillis);\n\n                gatherTrack.__intervalIds[index] = intervalId;\n\n                return intervalId;\n            }\n        })(gatherType, trackType);\n    });\n});","var _util = require('../../../webrtc/src/components/Util');\nvar _logger = _util.tagLogger(\"DefaultTrack\");\n\nvar MouseTrack = require(\"./MouseTrack\");\n\nfunction zoomCanvas(canvas, width, height) {\n    var canvasContext = canvas.getContext(\"2d\");\n\n    var _width = canvas.width,\n        _height = canvas.height;\n\n    canvasContext.scale(_width / width, _height / height);\n    _logger.warn(\"Canvas scale\", _width / width, _height / height, width, height);\n    var imageData = canvasContext.getImageData(0, 0, _width, _height);\n\n    canvas.width = width;\n    canvas.height = height;\n\n    canvasContext.putImageData(imageData, 0, 0);\n}\n\nfunction initCanvas(_target) {\n    var _canvas;\n    _canvas = document.createElement(\"canvas\");\n    _target.appendChild(_canvas);\n\n    _canvas.style.cssText = \"position: absolute; background: transparent; width: 100%; height: 100%\";\n\n    _canvas.width = _target.offsetWidth;\n    _canvas.height = _target.offsetHeight;\n    _logger.warn(\"Canvas\", _canvas.width, _canvas.height);\n\n    // if(initCanvas.timeoutId === undefined){\n    //     var targetElement = _target.onresize ? _target : window;\n    //     _util.addEvent(targetElement, \"resize\", function () {\n    //         if(initCanvas.timeoutId){\n    //             clearTimeout(initCanvas.timeoutId);\n    //         }\n    //\n    //         initCanvas.timeoutId = setTimeout(function () {\n    //             initCanvas();\n    //             initCanvas.timeoutId = null;\n    //         }, 500);\n    //     });\n    // }\n\n    return _canvas;\n}\n\nvar DefaultMouseTrack;\nmodule.exports = DefaultMouseTrack = MouseTrack.extend({\n    __init__: function () {\n        this._canvas || (this._canvas = initCanvas(this._target));\n        this._canvasContext || (this._canvasContext = this._canvas.getContext(\"2d\"));\n    },\n\n    resizeCanvas: function () {\n    },\n\n    _calPosition: function () {\n        var xy = MouseTrack.prototype._calPosition.apply(this, arguments);\n        xy.x = Math.floor(xy.x * this._canvas.width / xy.width);\n        xy.y = Math.floor(xy.y * this._canvas.height / xy.height);\n\n        return xy;\n    },\n\n    _draw: function (position, pixelCount, r, g, b, alpha) {\n        var self = this;\n        //_logger.warn(self._canvas.width, self._canvas.height);\n\n        var canvasContext = self._canvasContext;\n\n        if(!pixelCount || pixelCount <= 1){\n            pixelCount = 2;\n        }\n\n        var pixel = canvasContext.getImageData(position.x - pixelCount/2, position.y - pixelCount/2, pixelCount, pixelCount);\n        var color = function(imageData, r, g, b, alpha) {\n            for (var i = 0, data = imageData.data; i < data.length; i += 4) {\n                var rgb = {\n                    r: (r === undefined ? data[i] : r),\n                    g: (g === undefined ? data[i + 1] : g),\n                    b: (b === undefined ? data[i + 2] : b),\n                    alpha: (alpha === undefined ? data[i + 3] : alpha)};\n\n                data[i]     = rgb.r; // red\n                data[i + 1] = rgb.g; // green\n                data[i + 2] = rgb.b; // blue\n                data[i + 3] = rgb.alpha;\n\n                //_logger.debug(rgb);\n            }\n        };\n        pixel && color(pixel, r, g, b, alpha);\n\n        canvasContext.putImageData(pixel, position.x, position.y);\n    },\n\n    redraw: function (x, y, r, g, b, alpha) {\n        var self = this;\n        var draw = DefaultMouseTrack.prototype._draw.bind(self);\n        draw({x: x, y: y}, 2);\n    },\n\n    onMouseTrigger: function (trigger, _lastTrigger) {\n        trigger.isLeftKey() && this._draw(trigger.xy, 8, 189, 56, 51, 255);\n        trigger.isRightKey() && this._draw(trigger.xy, 8, 45, 23, 189, 255);\n        trigger.isWheelKey() && this._draw(trigger.xy, 8, 58, 189, 76, 255);\n    },\n\n    onMouseTrack: function (position, lastPosition, lastTrigger) {\n        this._draw(position, 2, 227, 18, 247, 255);\n    },\n\n    // onMouseTrack2: function (position, lastPosition, lastTrigger) {\n    //     var self = this;\n    //     //_logger.warn(self._canvas.width, self._canvas.height);\n    //\n    //     self._canvasContext || (self._canvasContext = self._canvas.getContext(\"2d\"));\n    //\n    //     var canvasContext = self._canvasContext;\n    //\n    //     var pixel = canvasContext.getImageData(position.x - 1, position.y - 1, 3, 3);\n    //     var rgb;\n    //     var color = function(imageData, r, g, b, alpha) {\n    //         rgb = {r: r, g: g, b: b, alpha: alpha};\n    //         for (var i = 0, data = imageData.data; i < data.length; i += 4) {\n    //             data[i]     = r === undefined ? 0 : r; // red\n    //             data[i + 1] = g === undefined ? 0 : g; // green\n    //             data[i + 2] = b === undefined ? 0 : b; // blue\n    //             data[i + 3] = alpha === undefined ? 255 : alpha;\n    //         }\n    //     };\n    //     pixel && color(pixel, 189, 56, 51);\n    //     lastTrigger.isRightKey() && pixel && color(pixel, 45, 23, 189);\n    //     lastTrigger.isWheelKey() && pixel && color(pixel, 58, 189, 76);\n    //\n    //     if(!lastPosition){\n    //         canvasContext.putImageData(pixel, position.x, position.y);\n    //     }\n    //\n    //\n    //     function line() {\n    //         canvasContext.lineWidth = 2;\n    //         canvasContext.beginPath();\n    //         canvasContext.strokeStyle = _util.list('rgb(', rgb.r, \",\", rgb.g, \",\", rgb.b, \")\").join(\"\");\n    //         canvasContext.moveTo(lastPosition ? lastPosition.x : position.x, lastPosition ? lastPosition.y : position.y);\n    //         canvasContext.lineTo(position.x, position.y);\n    //\n    //         canvasContext.stroke();\n    //         canvasContext.closePath();\n    //     }\n    //\n    //     if(lastPosition){\n    //         line();\n    //     }\n    // }\n});","var EMPTYFN = function(){}\nvar _createStandardXHR = function () {\n    try {\n        return new window.XMLHttpRequest();\n    } catch (e) {\n        return false;\n    }\n};\n\nvar _createActiveXHR = function () {\n    try {\n        return new window.ActiveXObject('Microsoft.XMLHTTP');\n    } catch (e) {\n        return false;\n    }\n};\n\nvar _xmlrequest = function (crossDomain) {\n    crossDomain = crossDomain || true;\n    var temp = _createStandardXHR() || _createActiveXHR();\n\n    if ('withCredentials' in temp) {\n        return temp;\n    }\n    if (!crossDomain) {\n        return temp;\n    }\n    if (typeof window.XDomainRequest === 'undefined') {\n        return temp;\n    }\n    var xhr = new XDomainRequest();\n    xhr.readyState = 0;\n    xhr.status = 100;\n    xhr.onreadystatechange = EMPTYFN;\n    xhr.onload = function () {\n        xhr.readyState = 4;\n        xhr.status = 200;\n\n        var xmlDoc = new ActiveXObject('Microsoft.XMLDOM');\n        xmlDoc.async = 'false';\n        xmlDoc.loadXML(xhr.responseText);\n        xhr.responseXML = xmlDoc;\n        xhr.response = xhr.responseText;\n        xhr.onreadystatechange();\n    };\n    xhr.ontimeout = xhr.onerror = function () {\n        xhr.readyState = 4;\n        xhr.status = 500;\n        xhr.onreadystatechange();\n    };\n    return xhr;\n};\nvar _parseJSON = function (data) {\n\n    if (window.JSON && window.JSON.parse) {\n        return window.JSON.parse(data + '');\n    }\n\n    var requireNonComma,\n        depth = null,\n        str = utils.trim(data + '');\n\n    return str && !utils.trim(\n        str.replace(/(,)|(\\[|{)|(}|])|\"(?:[^\"\\\\\\r\\n]|\\\\[\"\\\\\\/bfnrt]|\\\\u[\\da-fA-F]{4})*\"\\s*:?|true|false|null|-?(?!0\\d)\\d+(?:\\.\\d+|)(?:[eE][+-]?\\d+|)/g\n            , function (token, comma, open, close) {\n\n                if (requireNonComma && comma) {\n                    depth = 0;\n                }\n\n                if (depth === 0) {\n                    return token;\n                }\n\n                requireNonComma = open || comma;\n                depth += !close - !open;\n                return '';\n            })\n    )\n        ? (Function('return ' + str))()\n        : (Function('Invalid JSON: ' + data))();\n}\n\nvar code = {\n    102: {error_code: 102, error_msg: 'Server disconnect'},\n    10: {error_code: 10, error_msg: \"Whiteboards don't exist\"},\n    15: {error_code: 15, error_msg: \"Wrong roomname or password\"},\n    20: {error_code: 20, error_msg: \"Token authentication failed\"},\n    25: {error_code: 25, error_msg: \"Whiteboard creation failed\"},\n    30: {error_code: 30, error_msg: \"Whiteboard name can't be null\"},\n    35: {error_code: 35, error_msg: \"Permission Denied\"},\n    40: {error_code: 40, error_msg: \"Wrong roomname or password\"},\n    45: {error_code: 45, error_msg: \"The whiteboard name has been used\"},\n    50: {error_code: 50, error_msg: \"Wrong data, please login again\"},\n    99: {error_code: 99, error_msg: 'Unpredictable error'}\n}\nvar _ajax = function (options) {\n    var dataType = options.dataType || 'text';\n    var suc = options.success || EMPTYFN;\n    var error = options.error || EMPTYFN;\n    var xhr = _xmlrequest();\n\n    xhr.onreadystatechange = function () {\n        if (xhr.readyState === 4) {\n            var status = xhr.status || 0;\n            if (status === 200) {\n                try {\n                    switch (dataType) {\n                        case 'text':\n                            suc(xhr.responseText);\n                            break;\n                        case 'json':\n                            var json = _parseJSON(xhr.responseText);\n                            if (json.status == false && json.error_code) {\n                                return error(Object.assign({status: 0}, code[json.error_code]))\n                            }\n                            suc(json, xhr);\n                            break;\n                        case 'xml':\n                            if (xhr.responseXML && xhr.responseXML.documentElement) {\n                                suc(xhr.responseXML.documentElement, xhr);\n                            } else {\n                                error({\n                                    // type: _code.WEBIM_CONNCTION_AJAX_ERROR,\n                                    data: xhr.responseText\n                                });\n                            }\n                            break;\n                        default: \n                            suc(xhr.response || xhr.responseText, xhr);\n                    }\n                } catch (e) {\n                    console.warn(e)\n                    error(Object.assign({status: 0},code['99']));\n                }\n            } else {\n                error({\n                    data: xhr.responseText\n                });\n                return;\n            }\n        }\n        if (xhr.readyState === 0) {\n            error({\n                data: xhr.responseText\n            });\n        }\n    };\n\n    if (options.responseType) {\n        if (xhr.responseType) {\n            xhr.responseType = options.responseType;\n        }\n    }\n    if (options.mimeType) {\n        if (utils.hasOverrideMimeType) {\n            xhr.overrideMimeType(options.mimeType);\n        }\n    }\n\n    var type = options.type || 'POST',\n        data = options.data || null,\n        tempData = '';\n\n    if (type.toLowerCase() === 'get' && data) {\n        for (var o in data) {\n            if (data.hasOwnProperty(o)) {\n                tempData += o + '=' + data[o] + '&';\n            }\n        }\n        tempData = tempData ? tempData.slice(0, -1) : tempData;\n        options.url += (options.url.indexOf('?') > 0 ? '&' : '?') + (tempData ? tempData + '&' : tempData) + '_v=' + new Date().getTime();\n        data = null;\n        tempData = null;\n    }\n    xhr.open(type, options.url, xhr.setRequestHeader);\n\n    if (xhr.setRequestHeader) {\n        var headers = options.headers || {};\n        for (var key in headers) {\n            if (headers.hasOwnProperty(key)) {\n                xhr.setRequestHeader(key, headers[key]);\n            }\n        }\n    }\n    // fix: ie8 status error\n    window.XDomainRequest && (xhr.readyState = 2)\n    xhr.send(data);\n    return xhr;\n}\n\nvar whiteBoards = function(options){\n    if(options.restApi == 'http:' || options.restApi == 'https:'){\n       options.restApi = '' \n    }\n    this.restApi = options.restApi;\n    this.appKey = options.appKey;\n    this.orgName = options.appKey.split(\"#\")[0];\n    this.appName = options.appKey.split(\"#\")[1];\n\n    this.dnsArr = ['https://rs.easemob.com', 'http://182.92.174.78', 'http://112.126.66.111']; \n    this.dnsIndex = 0\n    this.restIndex = 0\n    this.restHosts = []\n}\n\nwhiteBoards.prototype.getRestFromHttpDNS = function (options) {\n    if (this.restIndex >= this.restHosts.length) {\n        return false;\n    }\n\n    var url = '';\n    var host = this.restHosts[this.restIndex];\n    var domain = host.domain;\n    var ip = host.ip;\n    if (ip) {\n        var port = host.port;\n        url = (location.protocol === 'https:' ? 'https:' : 'http:') + '//' + ip + ':' + port;\n    } else {\n        url = (location.protocol === 'https:' ? 'https:' : 'http:') + '//' + domain;\n    }\n\n    if (url != '') {\n        this.apiUrl = url;\n    }\n    return url\n};\n\nwhiteBoards.prototype.getHttpDNS = function (options) {\n    var self = this;\n    if(!this.appKey) {\n        console.warn('appKey illegal')\n        return\n    }\n    var suc = function (data, xhr) {\n        var restHosts = data.rest.hosts;\n        if (!restHosts) {\n            return;\n        }\n        var httpType = location.protocol;\n\n        for(var i = 0; i< restHosts.length; i++){\n            if( restHosts[i].protocol === httpType ){\n                var currentPost = restHosts[i];\n                restHosts.splice(i,1);\n                restHosts.unshift(currentPost);\n            }\n        }\n        self.restHosts = restHosts;\n        options.suc({restHosts: restHosts})\n\n    };\n    var error = function (res, xhr, msg) {\n        self.dnsIndex++;\n        if (self.dnsIndex < self.dnsArr.length) {\n            return self.getHttpDNS.call(self, options);\n        }\n        options.error(res)\n    };\n\n    var options2 = {\n        url: this.dnsArr[this.dnsIndex] + '/easemob/server.json',\n        dataType: 'json',\n        type: 'GET',\n        data: {app_key: encodeURIComponent(this.appKey)},\n        success: suc,\n        error: error\n    };\n    _ajax(options2);\n};\n\n\n//options.userName   - 用户名\n//options.roomName   - 房间名\n//options.password -房间密码\n//options.token   - im的token\n//options.suc - 成功的回调\n//options.error - 失败的回调\nwhiteBoards.prototype.create = function(options){\n    if (!this.restApi) {\n        var me = this\n        var sucFun = function(res){\n            me.restApi = me.getRestFromHttpDNS()\n            _create.call(me)\n        }\n\n        var errFun = function(err){\n            me.restIndex ++;\n            if(me.getRestFromHttpDNS()){\n                return sucFun()\n            }\n            options.error(err)\n        }\n\n        this.getHttpDNS({suc: sucFun, error: errFun})\n    }else{\n        _create.call(this)\n    }\n\n    function _create(){\n        var opts = {\n            url: this.restApi + '/' + this.orgName + '/' + this.appName + '/whiteboards/',\n            dataType: 'json',\n            type: 'POST',\n            data: JSON.stringify({\n                userId: options.userName,\n                whiteBoardName: options.roomName,\n                password: options.password\n            }),\n            headers: {\n                'Authorization': 'Bearer ' + options.token,\n                'Content-Type': 'application/json'\n            },\n            success: options.suc,\n            error: errFun\n        }\n\n        _ajax(opts);\n    }\n\t\n}\n\n/**\n * 加入房间 有房间加入，没有房间创建\n * options.userName   - 用户名\n * options.roomName   - 加入房间名\n * options.password -房间密码\n * options.token   - im的token\n * options.suc - 成功的回调\n * options.error - 失败的回调\n*/\nwhiteBoards.prototype.join = function(options){\n    if (!this.restApi) {\n        var me = this\n        var sucFun = function(res){\n            me.restApi = me.getRestFromHttpDNS()\n            _join.call(me)\n        }\n\n        var errFun = function(err){\n            me.restIndex ++;\n            if(me.getRestFromHttpDNS()){\n                return sucFun()\n            }\n            options.error(err)\n        }\n\n        this.getHttpDNS({suc: sucFun, error: errFun})\n    }else{\n        _join.call(this)\n    }\n\n    function _join(){\n        var opts = {\n            url: this.restApi + '/' + this.orgName + '/' + this.appName + '/whiteboards/joinorcreate/byname/',\n            dataType: 'json',\n            type: 'POST',\n            data: JSON.stringify({\n                userId: options.userName,\n                whiteBoardName: options.roomName,\n                password: options.password\n            }),\n            headers: {\n                'Authorization': 'Bearer ' + options.token,\n                'Content-Type': 'application/json'\n            },\n            success: options.suc,\n            error: errFun\n        }\n\n        _ajax(opts);\n    }\n}\n\n\n//options.userName   - 用户名\n//options.roomName   - 加入房间名\n//options.password -房间密码\n//options.token   - im的token\n//options.suc - 成功的回调\n//options.error - 失败的回调\nwhiteBoards.prototype.joinByRoomName= function(options){\n    if (!this.restApi) {\n        var me = this\n        var sucFun = function(res){\n            me.restApi = me.getRestFromHttpDNS()\n            _joinByRoomName.call(me)\n        }\n\n        var errFun = function(err){\n            me.restIndex ++;\n            if(me.getRestFromHttpDNS()){\n                return sucFun()\n            }\n            options.error(err)\n        }\n\n        this.getHttpDNS({suc: sucFun, error: errFun})\n    }else{\n        _joinByRoomName.call(this)\n    }\n\n    function _joinByRoomName(){\n        var opts = {\n            url: this.restApi + '/' + this.orgName + '/' + this.appName + '/whiteboards/url-by-name/',\n            dataType: 'json',\n            type: 'POST',\n            data: JSON.stringify({\n                userId: options.userName,\n                whiteBoardName: options.roomName,\n                password: options.password\n            }),\n            headers: {\n                'Authorization': 'Bearer ' + options.token,\n                'Content-Type': 'application/json'\n            },\n            success: options.suc,\n            error: errFun\n        }\n\n        _ajax(opts);\n    }\n}\n\n//options.userName   - 用户名\n//options.roomId   - 加入房间id\n//options.password -房间密码\n//options.token   - im的token\n//options.suc - 成功的回调\n//options.error - 失败的回调\nwhiteBoards.prototype.joinByRoomId= function(options){\n    if (!this.restApi) {\n        var me = this\n        var sucFun = function(res){\n            me.restApi = me.getRestFromHttpDNS()\n            _joinByRoomId.call(me)\n        }\n\n        var errFun = function(err){\n            me.restIndex ++;\n            if(me.getRestFromHttpDNS()){\n                return sucFun()\n            }\n            options.error(err)\n        }\n\n        this.getHttpDNS({suc: sucFun, error: errFun})\n    }else{\n        _joinByRoomId.call(this)\n    }\n\n    function _joinByRoomId(){\n        var opts = {\n            url: this.restApi + '/' + this.orgName + '/' + this.appName + '/whiteboards/' + options.roomId + '/url/',\n            dataType: 'json',\n            type: 'POST',\n            data: JSON.stringify({\n                userId: options.userName,\n                roomId: options.roomId,\n                password: options.password\n            }),\n            headers: {\n                'Authorization': 'Bearer ' + options.token,\n                'Content-Type': 'application/json'\n            },\n            success: options.suc,\n            error: errFun\n        }\n\n        _ajax(opts);\n    }\n}\n\n//options.roomId   - 删除房间ID\n//options.token   - im的token\n//options.userName - 用户名\n//options.suc - 成功的回调\n//options.error - 失败的回调\nwhiteBoards.prototype.destroy= function(options){\n    if (!this.restApi) {\n        var me = this\n        var sucFun = function(res){\n            me.restApi = me.getRestFromHttpDNS()\n            _destroy.call(me)\n        }\n\n        var errFun = function(err){\n            me.restIndex ++;\n            if(me.getRestFromHttpDNS()){\n                return sucFun()\n            }\n            options.error(err)\n        }\n\n        this.getHttpDNS({suc: sucFun, error: errFun})\n    }else{\n        _destroy.call(this)\n    }\n\n    function _destroy(){\n        var opts = {\n            url: this.restApi + '/' + this.orgName + '/' + this.appName + '/whiteboards/' + options.roomId + '/',\n            dataType: 'json',\n            type: 'DELETE',\n            data: JSON.stringify({\n                userId: options.userName\n            }),\n            headers: {\n                'Authorization': 'Bearer ' + options.token,\n                'Content-Type': 'application/json'\n            },\n            success: options.suc,\n            error: errFun\n        }\n\n        _ajax(opts); \n    }\n}\n\n\nmodule.exports = whiteBoards;\n\n\n\n\n","// import adapter from 'webrtc-adapter';\n// console.error(\"webrtc-adapter load\");\n\nvar adapter = emedia.singleWebrtcAdapter;\n\nfunction warn() {\n    emedia.util.logger.warn(\"webrtc-adapter must load once. if more, safari may initC sdp error(too many audio video, easemob server dont work)\");\n}\n\nfunction requireWebrtcAdapter() {\n    if (!!document.documentMode) { // Detect IE (6-11)\n        var hasMatch = /\\brv[ :]+(\\d+)/g.exec(navigator.userAgent) || [];\n\n        var webrtcDetectedBrowser   = 'IE';\n        var webrtcDetectedVersion   = parseInt(hasMatch[1], 10);\n        var webrtcMinimumVersion    = 9;\n        var webrtcDetectedType      = 'plugin';\n        var webrtcDetectedDCSupport = 'SCTP';\n\n        if (!webrtcDetectedVersion) {\n            hasMatch = /\\bMSIE[ :]+(\\d+)/g.exec(navigator.userAgent) || [];\n\n            webrtcDetectedVersion = parseInt(hasMatch[1] || '0', 10);\n        }\n\n        //adapter = require('./adapter.ie');\n        emedia.util.logger.error(\"adapter.ie not required\");\n\n        adapter.__browser = webrtcDetectedBrowser;\n        adapter.__browserVersion = webrtcDetectedVersion;\n\n        //adapter = require('./Temasys.wrapper'); //6.0.3\n    }else{\n        //adapter = require('./adapter-6.2.0'); //6.2.0\n        //adapter = require('webrtc-adapter').default; //webim demo minify 时 util报错\n        adapter = require('./adapter-7.6.1');\n        emedia.util.logger.info(\"webrtc-adapter load first\");\n\n        wrapAttachMediaStream();\n    }\n\n    emedia.singleWebrtcAdapter = adapter;\n}\n\nwarn();\nif(!adapter){\n    requireWebrtcAdapter();\n}else{\n    emedia.util.logger.error(\"webrtc-adapter repeated load, safari may dont work\");\n}\n\nadapter.__browser = adapter.__browser || adapter.browserDetails.browser; // firefox chrome safari\nadapter.__browserVersion = adapter.__browserVersion || adapter.browserDetails.version;\n\nemedia.util.logger.info(\"Current browser\", adapter.__browser, adapter.__browserVersion);\n\nif(\"Not a supported browser.\" === adapter.__browser){\n    emedia.util.logger.error(\"Not a supported browser\");\n}\n\n//module.exports = adapter;\nexport default adapter;\n\nfunction wrapAttachMediaStream() {\n    function _attachMediaStream(element, stream) {\n        element.srcObject = stream;\n\n        if(emedia.isSafari){\n            // var hasActivedTrack = false;\n            // stream.getVideoTracks().forEach((track)=>{\n            //     if(!hasActivedTrack){\n            //         hasActivedTrack = track.enabled;\n            //     }\n            // });\n            //\n            // if(!hasActivedTrack){\n            //     element.pause();\n            //     element.play();\n            // }\n\n            element.pause();\n            element.play();\n        }\n\n        var logger = emedia.util.logger || window.console || console;\n\n        if(logger){\n            stream && logger.info(\"stream attach videoTag.\", stream.id, stream._located, \">>\",\n                element.id, element.muted, element.volume, element);\n            stream || logger.info(\"stream(null) attach videoTag.\", element.id, element.muted, element.volume, element);\n\n            if(!element.hxSetOnvolumechange){\n                var preonvolumechange = element.onvolumechange;\n                element.onvolumechange = function(){\n                    logger.debug(\"stream attach detail: video tag volume chanage\", element.volume, stream ? stream.id : stream);\n                    preonvolumechange && preonvolumechange.apply(element, arguments);\n                };\n                element.hxSetOnvolumechange = true;\n            }\n\n            if(!element.hxSetOnstalled){\n                var preonstalled = element.onstalled;\n                element.onstalled = function () {\n                    logger.debug(\"stream attach detail: video tag onstalled\", stream ? stream.id : stream);\n                    preonstalled && preonstalled.apply(element, arguments);\n                };\n                element.hxSetOnstalled = true;\n            }\n\n            if(!element.hxSetOnabort){\n                var preonabort = element.onabort;\n                element.onabort = function () {\n                    logger.debug(\"stream attach detail: video tag onabort\", stream ? stream.id : stream);\n                    preonabort && preonabort.apply(element, arguments);\n                };\n                element.hxSetOnabort = true;\n            }\n\n            if(!element.hxSetOncanplay){\n                var preOncanplay = element.oncanplay;\n                element.oncanplay = function(){\n                    stream && stream.getTracks().forEach(function(track) {\n                        if(typeof track.getSettings === 'function'){\n                            logger.debug('stream attach detail', stream.id,\n                                \" track setting =\", track.enabled, track.id, track.kind, track.label, track.getSettings());\n                        }\n                    });\n\n                    logger.debug(\"stream attach detail: video tag\", element.videoWidth, \"x\", element.videoHeight, stream ? stream.id : stream);\n\n                    preOncanplay && preOncanplay.apply(element, arguments);\n                };\n                element.hxSetOncanplay = true;\n            }\n        }\n    }\n\n    /**\n     * muted undefined, stream _located true 时muted\n     *\n     * @param element\n     * @param stream\n     * @param muted\n     * @returns {*}\n     */\n    function hxbAttachMediaStream(element, stream, muted, _fun) {\n        function mute() {\n            muted = !!(muted === undefined ? stream._located : muted);\n\n            //为了解决某些手机mute造成本地图像卡的问题\n            element.muted = false;\n            if(muted !== element.muted){\n                element.muted = true;\n            }\n        }\n\n        _fun || (_fun = window.__attachMediaStream) || (_fun = _attachMediaStream.bind(this));\n\n        if(!element){\n            return;\n        }\n\n        if(!stream){\n            _fun(element, stream);\n            return;\n        }\n\n        if(!element.srcObject){\n            mute();\n            _fun(element, stream);\n            return element;\n        }\n\n        if(element.srcObject._located //old stream 也是 _located\n            && stream._located\n            && element.srcObject.id === stream.id){\n            return element.srcObject;\n        }\n\n        mute();\n        _fun(element, stream);\n\n        return element;\n    }\n\n    if(window.attachMediaStream && window.attachMediaStream._wrapped !== true){\n        window.__attachMediaStream = window.attachMediaStream;\n    }\n\n    window.attachMediaStream = hxbAttachMediaStream;\n    window.attachMediaStream._wrapped = true;\n    console && typeof console.info === \"function\" && console.info(\"Wrap the attachMediaStream \", adapter.__browser, adapter.__browserVersion);\n}\n\n\n","(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.adapter = f()}})(function(){var define,module,exports;return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n\n'use strict';\n\nconsole.warn(\"webrtc adapter version: 7.6.1\");\n\nvar _adapter_factory = require('./adapter_factory.js');\n\nvar adapter = (0, _adapter_factory.adapterFactory)({ window: window });\nmodule.exports = adapter; // this is the difference from adapter_core.\n\n},{\"./adapter_factory.js\":2}],2:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.adapterFactory = adapterFactory;\n\nvar _utils = require('./utils');\n\nvar utils = _interopRequireWildcard(_utils);\n\nvar _chrome_shim = require('./chrome/chrome_shim');\n\nvar chromeShim = _interopRequireWildcard(_chrome_shim);\n\nvar _edge_shim = require('./edge/edge_shim');\n\nvar edgeShim = _interopRequireWildcard(_edge_shim);\n\nvar _firefox_shim = require('./firefox/firefox_shim');\n\nvar firefoxShim = _interopRequireWildcard(_firefox_shim);\n\nvar _safari_shim = require('./safari/safari_shim');\n\nvar safariShim = _interopRequireWildcard(_safari_shim);\n\nvar _common_shim = require('./common_shim');\n\nvar commonShim = _interopRequireWildcard(_common_shim);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\n// Shimming starts here.\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\nfunction adapterFactory() {\n  var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      window = _ref.window;\n\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {\n    shimChrome: true,\n    shimFirefox: true,\n    shimEdge: true,\n    shimSafari: true\n  };\n\n  // Utils.\n  var logging = utils.log;\n  var browserDetails = utils.detectBrowser(window);\n\n  var adapter = {\n    browserDetails: browserDetails,\n    commonShim: commonShim,\n    extractVersion: utils.extractVersion,\n    disableLog: utils.disableLog,\n    disableWarnings: utils.disableWarnings\n  };\n\n  // Shim browser if found.\n  switch (browserDetails.browser) {\n    case 'chrome':\n      if (!chromeShim || !chromeShim.shimPeerConnection || !options.shimChrome) {\n        logging('Chrome shim is not included in this adapter release.');\n        return adapter;\n      }\n      if (browserDetails.version === null) {\n        logging('Chrome shim can not determine version, not shimming.');\n        return adapter;\n      }\n      logging('adapter.js shimming chrome.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = chromeShim;\n\n      chromeShim.shimGetUserMedia(window);\n      chromeShim.shimMediaStream(window);\n      chromeShim.shimPeerConnection(window);\n      chromeShim.shimOnTrack(window);\n      chromeShim.shimAddTrackRemoveTrack(window);\n      chromeShim.shimGetSendersWithDtmf(window);\n      chromeShim.shimGetStats(window);\n      chromeShim.shimSenderReceiverGetStats(window);\n      chromeShim.fixNegotiationNeeded(window);\n\n      commonShim.shimRTCIceCandidate(window);\n      commonShim.shimConnectionState(window);\n      commonShim.shimMaxMessageSize(window);\n      commonShim.shimSendThrowTypeError(window);\n      commonShim.removeAllowExtmapMixed(window);\n      break;\n    case 'firefox':\n      if (!firefoxShim || !firefoxShim.shimPeerConnection || !options.shimFirefox) {\n        logging('Firefox shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming firefox.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = firefoxShim;\n\n      firefoxShim.shimGetUserMedia(window);\n      firefoxShim.shimPeerConnection(window);\n      firefoxShim.shimOnTrack(window);\n      firefoxShim.shimRemoveStream(window);\n      firefoxShim.shimSenderGetStats(window);\n      firefoxShim.shimReceiverGetStats(window);\n      firefoxShim.shimRTCDataChannel(window);\n      firefoxShim.shimAddTransceiver(window);\n      firefoxShim.shimCreateOffer(window);\n      firefoxShim.shimCreateAnswer(window);\n\n      commonShim.shimRTCIceCandidate(window);\n      commonShim.shimConnectionState(window);\n      commonShim.shimMaxMessageSize(window);\n      commonShim.shimSendThrowTypeError(window);\n      break;\n    case 'edge':\n      if (!edgeShim || !edgeShim.shimPeerConnection || !options.shimEdge) {\n        logging('MS edge shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming edge.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = edgeShim;\n\n      edgeShim.shimGetUserMedia(window);\n      edgeShim.shimGetDisplayMedia(window);\n      edgeShim.shimPeerConnection(window);\n      edgeShim.shimReplaceTrack(window);\n\n      // the edge shim implements the full RTCIceCandidate object.\n\n      commonShim.shimMaxMessageSize(window);\n      commonShim.shimSendThrowTypeError(window);\n      break;\n    case 'safari':\n      if (!safariShim || !options.shimSafari) {\n        logging('Safari shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming safari.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = safariShim;\n\n      safariShim.shimRTCIceServerUrls(window);\n      safariShim.shimCreateOfferLegacy(window);\n      safariShim.shimCallbacksAPI(window);\n      safariShim.shimLocalStreamsAPI(window);\n      safariShim.shimRemoteStreamsAPI(window);\n      safariShim.shimTrackEventTransceiver(window);\n      safariShim.shimGetUserMedia(window);\n      safariShim.shimAudioContext(window);\n\n      commonShim.shimRTCIceCandidate(window);\n      commonShim.shimMaxMessageSize(window);\n      commonShim.shimSendThrowTypeError(window);\n      commonShim.removeAllowExtmapMixed(window);\n      break;\n    default:\n      logging('Unsupported browser!');\n      break;\n  }\n\n  return adapter;\n}\n\n// Browser shims.\n\n},{\"./chrome/chrome_shim\":3,\"./common_shim\":6,\"./edge/edge_shim\":7,\"./firefox/firefox_shim\":11,\"./safari/safari_shim\":14,\"./utils\":15}],3:[function(require,module,exports){\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.shimGetDisplayMedia = exports.shimGetUserMedia = undefined;\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _getusermedia = require('./getusermedia');\n\nObject.defineProperty(exports, 'shimGetUserMedia', {\n  enumerable: true,\n  get: function get() {\n    return _getusermedia.shimGetUserMedia;\n  }\n});\n\nvar _getdisplaymedia = require('./getdisplaymedia');\n\nObject.defineProperty(exports, 'shimGetDisplayMedia', {\n  enumerable: true,\n  get: function get() {\n    return _getdisplaymedia.shimGetDisplayMedia;\n  }\n});\nexports.shimMediaStream = shimMediaStream;\nexports.shimOnTrack = shimOnTrack;\nexports.shimGetSendersWithDtmf = shimGetSendersWithDtmf;\nexports.shimGetStats = shimGetStats;\nexports.shimSenderReceiverGetStats = shimSenderReceiverGetStats;\nexports.shimAddTrackRemoveTrackWithNative = shimAddTrackRemoveTrackWithNative;\nexports.shimAddTrackRemoveTrack = shimAddTrackRemoveTrack;\nexports.shimPeerConnection = shimPeerConnection;\nexports.fixNegotiationNeeded = fixNegotiationNeeded;\n\nvar _utils = require('../utils.js');\n\nvar utils = _interopRequireWildcard(_utils);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction shimMediaStream(window) {\n  window.MediaStream = window.MediaStream || window.webkitMediaStream;\n}\n\nfunction shimOnTrack(window) {\n  if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection && !('ontrack' in window.RTCPeerConnection.prototype)) {\n    Object.defineProperty(window.RTCPeerConnection.prototype, 'ontrack', {\n      get: function get() {\n        return this._ontrack;\n      },\n      set: function set(f) {\n        if (this._ontrack) {\n          this.removeEventListener('track', this._ontrack);\n        }\n        this.addEventListener('track', this._ontrack = f);\n      },\n\n      enumerable: true,\n      configurable: true\n    });\n    var origSetRemoteDescription = window.RTCPeerConnection.prototype.setRemoteDescription;\n    window.RTCPeerConnection.prototype.setRemoteDescription = function setRemoteDescription() {\n      var _this = this;\n\n      if (!this._ontrackpoly) {\n        this._ontrackpoly = function (e) {\n          // onaddstream does not fire when a track is added to an existing\n          // stream. But stream.onaddtrack is implemented so we use that.\n          e.stream.addEventListener('addtrack', function (te) {\n            var receiver = void 0;\n            if (window.RTCPeerConnection.prototype.getReceivers) {\n              receiver = _this.getReceivers().find(function (r) {\n                return r.track && r.track.id === te.track.id;\n              });\n            } else {\n              receiver = { track: te.track };\n            }\n\n            var event = new Event('track');\n            event.track = te.track;\n            event.receiver = receiver;\n            event.transceiver = { receiver: receiver };\n            event.streams = [e.stream];\n            _this.dispatchEvent(event);\n          });\n          e.stream.getTracks().forEach(function (track) {\n            var receiver = void 0;\n            if (window.RTCPeerConnection.prototype.getReceivers) {\n              receiver = _this.getReceivers().find(function (r) {\n                return r.track && r.track.id === track.id;\n              });\n            } else {\n              receiver = { track: track };\n            }\n            var event = new Event('track');\n            event.track = track;\n            event.receiver = receiver;\n            event.transceiver = { receiver: receiver };\n            event.streams = [e.stream];\n            _this.dispatchEvent(event);\n          });\n        };\n        this.addEventListener('addstream', this._ontrackpoly);\n      }\n      return origSetRemoteDescription.apply(this, arguments);\n    };\n  } else {\n    // even if RTCRtpTransceiver is in window, it is only used and\n    // emitted in unified-plan. Unfortunately this means we need\n    // to unconditionally wrap the event.\n    utils.wrapPeerConnectionEvent(window, 'track', function (e) {\n      if (!e.transceiver) {\n        Object.defineProperty(e, 'transceiver', { value: { receiver: e.receiver } });\n      }\n      return e;\n    });\n  }\n}\n\nfunction shimGetSendersWithDtmf(window) {\n  // Overrides addTrack/removeTrack, depends on shimAddTrackRemoveTrack.\n  if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection && !('getSenders' in window.RTCPeerConnection.prototype) && 'createDTMFSender' in window.RTCPeerConnection.prototype) {\n    var shimSenderWithDtmf = function shimSenderWithDtmf(pc, track) {\n      return {\n        track: track,\n        get dtmf() {\n          if (this._dtmf === undefined) {\n            if (track.kind === 'audio') {\n              this._dtmf = pc.createDTMFSender(track);\n            } else {\n              this._dtmf = null;\n            }\n          }\n          return this._dtmf;\n        },\n        _pc: pc\n      };\n    };\n\n    // augment addTrack when getSenders is not available.\n    if (!window.RTCPeerConnection.prototype.getSenders) {\n      window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n        this._senders = this._senders || [];\n        return this._senders.slice(); // return a copy of the internal state.\n      };\n      var origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n      window.RTCPeerConnection.prototype.addTrack = function addTrack(track, stream) {\n        var sender = origAddTrack.apply(this, arguments);\n        if (!sender) {\n          sender = shimSenderWithDtmf(this, track);\n          this._senders.push(sender);\n        }\n        return sender;\n      };\n\n      var origRemoveTrack = window.RTCPeerConnection.prototype.removeTrack;\n      window.RTCPeerConnection.prototype.removeTrack = function removeTrack(sender) {\n        origRemoveTrack.apply(this, arguments);\n        var idx = this._senders.indexOf(sender);\n        if (idx !== -1) {\n          this._senders.splice(idx, 1);\n        }\n      };\n    }\n    var origAddStream = window.RTCPeerConnection.prototype.addStream;\n    window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n      var _this2 = this;\n\n      this._senders = this._senders || [];\n      origAddStream.apply(this, [stream]);\n      stream.getTracks().forEach(function (track) {\n        _this2._senders.push(shimSenderWithDtmf(_this2, track));\n      });\n    };\n\n    var origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n    window.RTCPeerConnection.prototype.removeStream = function removeStream(stream) {\n      var _this3 = this;\n\n      this._senders = this._senders || [];\n      origRemoveStream.apply(this, [stream]);\n\n      stream.getTracks().forEach(function (track) {\n        var sender = _this3._senders.find(function (s) {\n          return s.track === track;\n        });\n        if (sender) {\n          // remove sender\n          _this3._senders.splice(_this3._senders.indexOf(sender), 1);\n        }\n      });\n    };\n  } else if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection && 'getSenders' in window.RTCPeerConnection.prototype && 'createDTMFSender' in window.RTCPeerConnection.prototype && window.RTCRtpSender && !('dtmf' in window.RTCRtpSender.prototype)) {\n    var origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n    window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n      var _this4 = this;\n\n      var senders = origGetSenders.apply(this, []);\n      senders.forEach(function (sender) {\n        return sender._pc = _this4;\n      });\n      return senders;\n    };\n\n    Object.defineProperty(window.RTCRtpSender.prototype, 'dtmf', {\n      get: function get() {\n        if (this._dtmf === undefined) {\n          if (this.track.kind === 'audio') {\n            this._dtmf = this._pc.createDTMFSender(this.track);\n          } else {\n            this._dtmf = null;\n          }\n        }\n        return this._dtmf;\n      }\n    });\n  }\n}\n\nfunction shimGetStats(window) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n\n  var origGetStats = window.RTCPeerConnection.prototype.getStats;\n  window.RTCPeerConnection.prototype.getStats = function getStats() {\n    var _this5 = this;\n\n    var _arguments = Array.prototype.slice.call(arguments),\n        selector = _arguments[0],\n        onSucc = _arguments[1],\n        onErr = _arguments[2];\n\n    // If selector is a function then we are in the old style stats so just\n    // pass back the original getStats format to avoid breaking old users.\n\n\n    if (arguments.length > 0 && typeof selector === 'function') {\n      return origGetStats.apply(this, arguments);\n    }\n\n    // When spec-style getStats is supported, return those when called with\n    // either no arguments or the selector argument is null.\n    if (origGetStats.length === 0 && (arguments.length === 0 || typeof selector !== 'function')) {\n      return origGetStats.apply(this, []);\n    }\n\n    var fixChromeStats_ = function fixChromeStats_(response) {\n      var standardReport = {};\n      var reports = response.result();\n      reports.forEach(function (report) {\n        var standardStats = {\n          id: report.id,\n          timestamp: report.timestamp,\n          type: {\n            localcandidate: 'local-candidate',\n            remotecandidate: 'remote-candidate'\n          }[report.type] || report.type\n        };\n        report.names().forEach(function (name) {\n          standardStats[name] = report.stat(name);\n        });\n        standardReport[standardStats.id] = standardStats;\n      });\n\n      return standardReport;\n    };\n\n    // shim getStats with maplike support\n    var makeMapStats = function makeMapStats(stats) {\n      return new Map(Object.keys(stats).map(function (key) {\n        return [key, stats[key]];\n      }));\n    };\n\n    if (arguments.length >= 2) {\n      var successCallbackWrapper_ = function successCallbackWrapper_(response) {\n        onSucc(makeMapStats(fixChromeStats_(response)));\n      };\n\n      return origGetStats.apply(this, [successCallbackWrapper_, selector]);\n    }\n\n    // promise-support\n    return new Promise(function (resolve, reject) {\n      origGetStats.apply(_this5, [function (response) {\n        resolve(makeMapStats(fixChromeStats_(response)));\n      }, reject]);\n    }).then(onSucc, onErr);\n  };\n}\n\nfunction shimSenderReceiverGetStats(window) {\n  if (!((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection && window.RTCRtpSender && window.RTCRtpReceiver)) {\n    return;\n  }\n\n  // shim sender stats.\n  if (!('getStats' in window.RTCRtpSender.prototype)) {\n    var origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n    if (origGetSenders) {\n      window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n        var _this6 = this;\n\n        var senders = origGetSenders.apply(this, []);\n        senders.forEach(function (sender) {\n          return sender._pc = _this6;\n        });\n        return senders;\n      };\n    }\n\n    var origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n    if (origAddTrack) {\n      window.RTCPeerConnection.prototype.addTrack = function addTrack() {\n        var sender = origAddTrack.apply(this, arguments);\n        sender._pc = this;\n        return sender;\n      };\n    }\n    window.RTCRtpSender.prototype.getStats = function getStats() {\n      var sender = this;\n      return this._pc.getStats().then(function (result) {\n        return (\n          /* Note: this will include stats of all senders that\n           *   send a track with the same id as sender.track as\n           *   it is not possible to identify the RTCRtpSender.\n           */\n          utils.filterStats(result, sender.track, true)\n        );\n      });\n    };\n  }\n\n  // shim receiver stats.\n  if (!('getStats' in window.RTCRtpReceiver.prototype)) {\n    var origGetReceivers = window.RTCPeerConnection.prototype.getReceivers;\n    if (origGetReceivers) {\n      window.RTCPeerConnection.prototype.getReceivers = function getReceivers() {\n        var _this7 = this;\n\n        var receivers = origGetReceivers.apply(this, []);\n        receivers.forEach(function (receiver) {\n          return receiver._pc = _this7;\n        });\n        return receivers;\n      };\n    }\n    utils.wrapPeerConnectionEvent(window, 'track', function (e) {\n      e.receiver._pc = e.srcElement;\n      return e;\n    });\n    window.RTCRtpReceiver.prototype.getStats = function getStats() {\n      var receiver = this;\n      return this._pc.getStats().then(function (result) {\n        return utils.filterStats(result, receiver.track, false);\n      });\n    };\n  }\n\n  if (!('getStats' in window.RTCRtpSender.prototype && 'getStats' in window.RTCRtpReceiver.prototype)) {\n    return;\n  }\n\n  // shim RTCPeerConnection.getStats(track).\n  var origGetStats = window.RTCPeerConnection.prototype.getStats;\n  window.RTCPeerConnection.prototype.getStats = function getStats() {\n    if (arguments.length > 0 && arguments[0] instanceof window.MediaStreamTrack) {\n      var track = arguments[0];\n      var sender = void 0;\n      var receiver = void 0;\n      var err = void 0;\n      this.getSenders().forEach(function (s) {\n        if (s.track === track) {\n          if (sender) {\n            err = true;\n          } else {\n            sender = s;\n          }\n        }\n      });\n      this.getReceivers().forEach(function (r) {\n        if (r.track === track) {\n          if (receiver) {\n            err = true;\n          } else {\n            receiver = r;\n          }\n        }\n        return r.track === track;\n      });\n      if (err || sender && receiver) {\n        return Promise.reject(new DOMException('There are more than one sender or receiver for the track.', 'InvalidAccessError'));\n      } else if (sender) {\n        return sender.getStats();\n      } else if (receiver) {\n        return receiver.getStats();\n      }\n      return Promise.reject(new DOMException('There is no sender or receiver for the track.', 'InvalidAccessError'));\n    }\n    return origGetStats.apply(this, arguments);\n  };\n}\n\nfunction shimAddTrackRemoveTrackWithNative(window) {\n  // shim addTrack/removeTrack with native variants in order to make\n  // the interactions with legacy getLocalStreams behave as in other browsers.\n  // Keeps a mapping stream.id => [stream, rtpsenders...]\n  window.RTCPeerConnection.prototype.getLocalStreams = function getLocalStreams() {\n    var _this8 = this;\n\n    this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n    return Object.keys(this._shimmedLocalStreams).map(function (streamId) {\n      return _this8._shimmedLocalStreams[streamId][0];\n    });\n  };\n\n  var origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n  window.RTCPeerConnection.prototype.addTrack = function addTrack(track, stream) {\n    if (!stream) {\n      return origAddTrack.apply(this, arguments);\n    }\n    this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n\n    var sender = origAddTrack.apply(this, arguments);\n    if (!this._shimmedLocalStreams[stream.id]) {\n      this._shimmedLocalStreams[stream.id] = [stream, sender];\n    } else if (this._shimmedLocalStreams[stream.id].indexOf(sender) === -1) {\n      this._shimmedLocalStreams[stream.id].push(sender);\n    }\n    return sender;\n  };\n\n  var origAddStream = window.RTCPeerConnection.prototype.addStream;\n  window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n    var _this9 = this;\n\n    this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n\n    stream.getTracks().forEach(function (track) {\n      var alreadyExists = _this9.getSenders().find(function (s) {\n        return s.track === track;\n      });\n      if (alreadyExists) {\n        throw new DOMException('Track already exists.', 'InvalidAccessError');\n      }\n    });\n    var existingSenders = this.getSenders();\n    origAddStream.apply(this, arguments);\n    var newSenders = this.getSenders().filter(function (newSender) {\n      return existingSenders.indexOf(newSender) === -1;\n    });\n    this._shimmedLocalStreams[stream.id] = [stream].concat(newSenders);\n  };\n\n  var origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n  window.RTCPeerConnection.prototype.removeStream = function removeStream(stream) {\n    this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n    delete this._shimmedLocalStreams[stream.id];\n    return origRemoveStream.apply(this, arguments);\n  };\n\n  var origRemoveTrack = window.RTCPeerConnection.prototype.removeTrack;\n  window.RTCPeerConnection.prototype.removeTrack = function removeTrack(sender) {\n    var _this10 = this;\n\n    this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n    if (sender) {\n      Object.keys(this._shimmedLocalStreams).forEach(function (streamId) {\n        var idx = _this10._shimmedLocalStreams[streamId].indexOf(sender);\n        if (idx !== -1) {\n          _this10._shimmedLocalStreams[streamId].splice(idx, 1);\n        }\n        if (_this10._shimmedLocalStreams[streamId].length === 1) {\n          delete _this10._shimmedLocalStreams[streamId];\n        }\n      });\n    }\n    return origRemoveTrack.apply(this, arguments);\n  };\n}\n\nfunction shimAddTrackRemoveTrack(window) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  var browserDetails = utils.detectBrowser(window);\n  // shim addTrack and removeTrack.\n  if (window.RTCPeerConnection.prototype.addTrack && browserDetails.version >= 65) {\n    return shimAddTrackRemoveTrackWithNative(window);\n  }\n\n  // also shim pc.getLocalStreams when addTrack is shimmed\n  // to return the original streams.\n  var origGetLocalStreams = window.RTCPeerConnection.prototype.getLocalStreams;\n  window.RTCPeerConnection.prototype.getLocalStreams = function getLocalStreams() {\n    var _this11 = this;\n\n    var nativeStreams = origGetLocalStreams.apply(this);\n    this._reverseStreams = this._reverseStreams || {};\n    return nativeStreams.map(function (stream) {\n      return _this11._reverseStreams[stream.id];\n    });\n  };\n\n  var origAddStream = window.RTCPeerConnection.prototype.addStream;\n  window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n    var _this12 = this;\n\n    this._streams = this._streams || {};\n    this._reverseStreams = this._reverseStreams || {};\n\n    stream.getTracks().forEach(function (track) {\n      var alreadyExists = _this12.getSenders().find(function (s) {\n        return s.track === track;\n      });\n      if (alreadyExists) {\n        throw new DOMException('Track already exists.', 'InvalidAccessError');\n      }\n    });\n    // Add identity mapping for consistency with addTrack.\n    // Unless this is being used with a stream from addTrack.\n    if (!this._reverseStreams[stream.id]) {\n      var newStream = new window.MediaStream(stream.getTracks());\n      this._streams[stream.id] = newStream;\n      this._reverseStreams[newStream.id] = stream;\n      stream = newStream;\n    }\n    origAddStream.apply(this, [stream]);\n  };\n\n  var origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n  window.RTCPeerConnection.prototype.removeStream = function removeStream(stream) {\n    this._streams = this._streams || {};\n    this._reverseStreams = this._reverseStreams || {};\n\n    origRemoveStream.apply(this, [this._streams[stream.id] || stream]);\n    delete this._reverseStreams[this._streams[stream.id] ? this._streams[stream.id].id : stream.id];\n    delete this._streams[stream.id];\n  };\n\n  window.RTCPeerConnection.prototype.addTrack = function addTrack(track, stream) {\n    var _this13 = this;\n\n    if (this.signalingState === 'closed') {\n      throw new DOMException('The RTCPeerConnection\\'s signalingState is \\'closed\\'.', 'InvalidStateError');\n    }\n    var streams = [].slice.call(arguments, 1);\n    if (streams.length !== 1 || !streams[0].getTracks().find(function (t) {\n      return t === track;\n    })) {\n      // this is not fully correct but all we can manage without\n      // [[associated MediaStreams]] internal slot.\n      throw new DOMException('The adapter.js addTrack polyfill only supports a single ' + ' stream which is associated with the specified track.', 'NotSupportedError');\n    }\n\n    var alreadyExists = this.getSenders().find(function (s) {\n      return s.track === track;\n    });\n    if (alreadyExists) {\n      throw new DOMException('Track already exists.', 'InvalidAccessError');\n    }\n\n    this._streams = this._streams || {};\n    this._reverseStreams = this._reverseStreams || {};\n    var oldStream = this._streams[stream.id];\n    if (oldStream) {\n      // this is using odd Chrome behaviour, use with caution:\n      // https://bugs.chromium.org/p/webrtc/issues/detail?id=7815\n      // Note: we rely on the high-level addTrack/dtmf shim to\n      // create the sender with a dtmf sender.\n      oldStream.addTrack(track);\n\n      // Trigger ONN async.\n      Promise.resolve().then(function () {\n        _this13.dispatchEvent(new Event('negotiationneeded'));\n      });\n    } else {\n      var newStream = new window.MediaStream([track]);\n      this._streams[stream.id] = newStream;\n      this._reverseStreams[newStream.id] = stream;\n      this.addStream(newStream);\n    }\n    return this.getSenders().find(function (s) {\n      return s.track === track;\n    });\n  };\n\n  // replace the internal stream id with the external one and\n  // vice versa.\n  function replaceInternalStreamId(pc, description) {\n    var sdp = description.sdp;\n    Object.keys(pc._reverseStreams || []).forEach(function (internalId) {\n      var externalStream = pc._reverseStreams[internalId];\n      var internalStream = pc._streams[externalStream.id];\n      sdp = sdp.replace(new RegExp(internalStream.id, 'g'), externalStream.id);\n    });\n    return new RTCSessionDescription({\n      type: description.type,\n      sdp: sdp\n    });\n  }\n  function replaceExternalStreamId(pc, description) {\n    var sdp = description.sdp;\n    Object.keys(pc._reverseStreams || []).forEach(function (internalId) {\n      var externalStream = pc._reverseStreams[internalId];\n      var internalStream = pc._streams[externalStream.id];\n      sdp = sdp.replace(new RegExp(externalStream.id, 'g'), internalStream.id);\n    });\n    return new RTCSessionDescription({\n      type: description.type,\n      sdp: sdp\n    });\n  }\n  ['createOffer', 'createAnswer'].forEach(function (method) {\n    var nativeMethod = window.RTCPeerConnection.prototype[method];\n    var methodObj = _defineProperty({}, method, function () {\n      var _this14 = this;\n\n      var args = arguments;\n      var isLegacyCall = arguments.length && typeof arguments[0] === 'function';\n      if (isLegacyCall) {\n        return nativeMethod.apply(this, [function (description) {\n          var desc = replaceInternalStreamId(_this14, description);\n          args[0].apply(null, [desc]);\n        }, function (err) {\n          if (args[1]) {\n            args[1].apply(null, err);\n          }\n        }, arguments[2]]);\n      }\n      return nativeMethod.apply(this, arguments).then(function (description) {\n        return replaceInternalStreamId(_this14, description);\n      });\n    });\n    window.RTCPeerConnection.prototype[method] = methodObj[method];\n  });\n\n  var origSetLocalDescription = window.RTCPeerConnection.prototype.setLocalDescription;\n  window.RTCPeerConnection.prototype.setLocalDescription = function setLocalDescription() {\n    if (!arguments.length || !arguments[0].type) {\n      return origSetLocalDescription.apply(this, arguments);\n    }\n    arguments[0] = replaceExternalStreamId(this, arguments[0]);\n    return origSetLocalDescription.apply(this, arguments);\n  };\n\n  // TODO: mangle getStats: https://w3c.github.io/webrtc-stats/#dom-rtcmediastreamstats-streamidentifier\n\n  var origLocalDescription = Object.getOwnPropertyDescriptor(window.RTCPeerConnection.prototype, 'localDescription');\n  Object.defineProperty(window.RTCPeerConnection.prototype, 'localDescription', {\n    get: function get() {\n      var description = origLocalDescription.get.apply(this);\n      if (description.type === '') {\n        return description;\n      }\n      return replaceInternalStreamId(this, description);\n    }\n  });\n\n  window.RTCPeerConnection.prototype.removeTrack = function removeTrack(sender) {\n    var _this15 = this;\n\n    if (this.signalingState === 'closed') {\n      throw new DOMException('The RTCPeerConnection\\'s signalingState is \\'closed\\'.', 'InvalidStateError');\n    }\n    // We can not yet check for sender instanceof RTCRtpSender\n    // since we shim RTPSender. So we check if sender._pc is set.\n    if (!sender._pc) {\n      throw new DOMException('Argument 1 of RTCPeerConnection.removeTrack ' + 'does not implement interface RTCRtpSender.', 'TypeError');\n    }\n    var isLocal = sender._pc === this;\n    if (!isLocal) {\n      throw new DOMException('Sender was not created by this connection.', 'InvalidAccessError');\n    }\n\n    // Search for the native stream the senders track belongs to.\n    this._streams = this._streams || {};\n    var stream = void 0;\n    Object.keys(this._streams).forEach(function (streamid) {\n      var hasTrack = _this15._streams[streamid].getTracks().find(function (track) {\n        return sender.track === track;\n      });\n      if (hasTrack) {\n        stream = _this15._streams[streamid];\n      }\n    });\n\n    if (stream) {\n      if (stream.getTracks().length === 1) {\n        // if this is the last track of the stream, remove the stream. This\n        // takes care of any shimmed _senders.\n        this.removeStream(this._reverseStreams[stream.id]);\n      } else {\n        // relying on the same odd chrome behaviour as above.\n        stream.removeTrack(sender.track);\n      }\n      this.dispatchEvent(new Event('negotiationneeded'));\n    }\n  };\n}\n\nfunction shimPeerConnection(window) {\n  var browserDetails = utils.detectBrowser(window);\n\n  if (!window.RTCPeerConnection && window.webkitRTCPeerConnection) {\n    // very basic support for old versions.\n    window.RTCPeerConnection = window.webkitRTCPeerConnection;\n  }\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n\n  var addIceCandidateNullSupported = window.RTCPeerConnection.prototype.addIceCandidate.length === 0;\n\n  // shim implicit creation of RTCSessionDescription/RTCIceCandidate\n  if (browserDetails.version < 53) {\n    ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate'].forEach(function (method) {\n      var nativeMethod = window.RTCPeerConnection.prototype[method];\n      var methodObj = _defineProperty({}, method, function () {\n        arguments[0] = new (method === 'addIceCandidate' ? window.RTCIceCandidate : window.RTCSessionDescription)(arguments[0]);\n        return nativeMethod.apply(this, arguments);\n      });\n      window.RTCPeerConnection.prototype[method] = methodObj[method];\n    });\n  }\n\n  // support for addIceCandidate(null or undefined)\n  var nativeAddIceCandidate = window.RTCPeerConnection.prototype.addIceCandidate;\n  window.RTCPeerConnection.prototype.addIceCandidate = function addIceCandidate() {\n    if (!addIceCandidateNullSupported && !arguments[0]) {\n      if (arguments[1]) {\n        arguments[1].apply(null);\n      }\n      return Promise.resolve();\n    }\n    // Firefox 68+ emits and processes {candidate: \"\", ...}, ignore\n    // in older versions. Native support planned for Chrome M77.\n    if (browserDetails.version < 78 && arguments[0] && arguments[0].candidate === '') {\n      return Promise.resolve();\n    }\n    return nativeAddIceCandidate.apply(this, arguments);\n  };\n}\n\n// Attempt to fix ONN in plan-b mode.\nfunction fixNegotiationNeeded(window) {\n  var browserDetails = utils.detectBrowser(window);\n  utils.wrapPeerConnectionEvent(window, 'negotiationneeded', function (e) {\n    var pc = e.target;\n    if (browserDetails.version < 72 || pc.getConfiguration && pc.getConfiguration().sdpSemantics === 'plan-b') {\n      if (pc.signalingState !== 'stable') {\n        return;\n      }\n    }\n    return e;\n  });\n}\n\n},{\"../utils.js\":15,\"./getdisplaymedia\":4,\"./getusermedia\":5}],4:[function(require,module,exports){\n/*\n *  Copyright (c) 2018 The adapter.js project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.shimGetDisplayMedia = shimGetDisplayMedia;\nfunction shimGetDisplayMedia(window, getSourceId) {\n  if (window.navigator.mediaDevices && 'getDisplayMedia' in window.navigator.mediaDevices) {\n    return;\n  }\n  if (!window.navigator.mediaDevices) {\n    return;\n  }\n  // getSourceId is a function that returns a promise resolving with\n  // the sourceId of the screen/window/tab to be shared.\n  if (typeof getSourceId !== 'function') {\n    console.error('shimGetDisplayMedia: getSourceId argument is not ' + 'a function');\n    return;\n  }\n  window.navigator.mediaDevices.getDisplayMedia = function getDisplayMedia(constraints) {\n    return getSourceId(constraints).then(function (sourceId) {\n      var widthSpecified = constraints.video && constraints.video.width;\n      var heightSpecified = constraints.video && constraints.video.height;\n      var frameRateSpecified = constraints.video && constraints.video.frameRate;\n      constraints.video = {\n        mandatory: {\n          chromeMediaSource: 'desktop',\n          chromeMediaSourceId: sourceId,\n          maxFrameRate: frameRateSpecified || 3\n        }\n      };\n      if (widthSpecified) {\n        constraints.video.mandatory.maxWidth = widthSpecified;\n      }\n      if (heightSpecified) {\n        constraints.video.mandatory.maxHeight = heightSpecified;\n      }\n      return window.navigator.mediaDevices.getUserMedia(constraints);\n    });\n  };\n}\n\n},{}],5:[function(require,module,exports){\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nexports.shimGetUserMedia = shimGetUserMedia;\n\nvar _utils = require('../utils.js');\n\nvar utils = _interopRequireWildcard(_utils);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nvar logging = utils.log;\n\nfunction shimGetUserMedia(window) {\n  var navigator = window && window.navigator;\n\n  if (!navigator.mediaDevices) {\n    return;\n  }\n\n  var browserDetails = utils.detectBrowser(window);\n\n  var constraintsToChrome_ = function constraintsToChrome_(c) {\n    if ((typeof c === 'undefined' ? 'undefined' : _typeof(c)) !== 'object' || c.mandatory || c.optional) {\n      return c;\n    }\n    var cc = {};\n    Object.keys(c).forEach(function (key) {\n      if (key === 'require' || key === 'advanced' || key === 'mediaSource') {\n        return;\n      }\n      var r = _typeof(c[key]) === 'object' ? c[key] : { ideal: c[key] };\n      if (r.exact !== undefined && typeof r.exact === 'number') {\n        r.min = r.max = r.exact;\n      }\n      var oldname_ = function oldname_(prefix, name) {\n        if (prefix) {\n          return prefix + name.charAt(0).toUpperCase() + name.slice(1);\n        }\n        return name === 'deviceId' ? 'sourceId' : name;\n      };\n      if (r.ideal !== undefined) {\n        cc.optional = cc.optional || [];\n        var oc = {};\n        if (typeof r.ideal === 'number') {\n          oc[oldname_('min', key)] = r.ideal;\n          cc.optional.push(oc);\n          oc = {};\n          oc[oldname_('max', key)] = r.ideal;\n          cc.optional.push(oc);\n        } else {\n          oc[oldname_('', key)] = r.ideal;\n          cc.optional.push(oc);\n        }\n      }\n      if (r.exact !== undefined && typeof r.exact !== 'number') {\n        cc.mandatory = cc.mandatory || {};\n        cc.mandatory[oldname_('', key)] = r.exact;\n      } else {\n        ['min', 'max'].forEach(function (mix) {\n          if (r[mix] !== undefined) {\n            cc.mandatory = cc.mandatory || {};\n            cc.mandatory[oldname_(mix, key)] = r[mix];\n          }\n        });\n      }\n    });\n    if (c.advanced) {\n      cc.optional = (cc.optional || []).concat(c.advanced);\n    }\n    return cc;\n  };\n\n  var shimConstraints_ = function shimConstraints_(constraints, func) {\n    if (browserDetails.version >= 61) {\n      return func(constraints);\n    }\n    constraints = JSON.parse(JSON.stringify(constraints));\n    if (constraints && _typeof(constraints.audio) === 'object') {\n      var remap = function remap(obj, a, b) {\n        if (a in obj && !(b in obj)) {\n          obj[b] = obj[a];\n          delete obj[a];\n        }\n      };\n      constraints = JSON.parse(JSON.stringify(constraints));\n      remap(constraints.audio, 'autoGainControl', 'googAutoGainControl');\n      remap(constraints.audio, 'noiseSuppression', 'googNoiseSuppression');\n      constraints.audio = constraintsToChrome_(constraints.audio);\n    }\n    if (constraints && _typeof(constraints.video) === 'object') {\n      // Shim facingMode for mobile & surface pro.\n      var face = constraints.video.facingMode;\n      face = face && ((typeof face === 'undefined' ? 'undefined' : _typeof(face)) === 'object' ? face : { ideal: face });\n      var getSupportedFacingModeLies = browserDetails.version < 66;\n\n      if (face && (face.exact === 'user' || face.exact === 'environment' || face.ideal === 'user' || face.ideal === 'environment') && !(navigator.mediaDevices.getSupportedConstraints && navigator.mediaDevices.getSupportedConstraints().facingMode && !getSupportedFacingModeLies)) {\n        delete constraints.video.facingMode;\n        var matches = void 0;\n        if (face.exact === 'environment' || face.ideal === 'environment') {\n          matches = ['back', 'rear'];\n        } else if (face.exact === 'user' || face.ideal === 'user') {\n          matches = ['front'];\n        }\n        if (matches) {\n          // Look for matches in label, or use last cam for back (typical).\n          return navigator.mediaDevices.enumerateDevices().then(function (devices) {\n            devices = devices.filter(function (d) {\n              return d.kind === 'videoinput';\n            });\n            var dev = devices.find(function (d) {\n              return matches.some(function (match) {\n                return d.label.toLowerCase().includes(match);\n              });\n            });\n            if (!dev && devices.length && matches.includes('back')) {\n              dev = devices[devices.length - 1]; // more likely the back cam\n            }\n            if (dev) {\n              constraints.video.deviceId = face.exact ? { exact: dev.deviceId } : { ideal: dev.deviceId };\n            }\n            constraints.video = constraintsToChrome_(constraints.video);\n            logging('chrome: ' + JSON.stringify(constraints));\n            return func(constraints);\n          });\n        }\n      }\n      constraints.video = constraintsToChrome_(constraints.video);\n    }\n    logging('chrome: ' + JSON.stringify(constraints));\n    return func(constraints);\n  };\n\n  var shimError_ = function shimError_(e) {\n    if (browserDetails.version >= 64) {\n      return e;\n    }\n    return {\n      name: {\n        PermissionDeniedError: 'NotAllowedError',\n        PermissionDismissedError: 'NotAllowedError',\n        InvalidStateError: 'NotAllowedError',\n        DevicesNotFoundError: 'NotFoundError',\n        ConstraintNotSatisfiedError: 'OverconstrainedError',\n        TrackStartError: 'NotReadableError',\n        MediaDeviceFailedDueToShutdown: 'NotAllowedError',\n        MediaDeviceKillSwitchOn: 'NotAllowedError',\n        TabCaptureError: 'AbortError',\n        ScreenCaptureError: 'AbortError',\n        DeviceCaptureError: 'AbortError'\n      }[e.name] || e.name,\n      message: e.message,\n      constraint: e.constraint || e.constraintName,\n      toString: function toString() {\n        return this.name + (this.message && ': ') + this.message;\n      }\n    };\n  };\n\n  var getUserMedia_ = function getUserMedia_(constraints, onSuccess, onError) {\n    shimConstraints_(constraints, function (c) {\n      navigator.webkitGetUserMedia(c, onSuccess, function (e) {\n        if (onError) {\n          onError(shimError_(e));\n        }\n      });\n    });\n  };\n  navigator.getUserMedia = getUserMedia_.bind(navigator);\n\n  // Even though Chrome 45 has navigator.mediaDevices and a getUserMedia\n  // function which returns a Promise, it does not accept spec-style\n  // constraints.\n  if (navigator.mediaDevices.getUserMedia) {\n    var origGetUserMedia = navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);\n    navigator.mediaDevices.getUserMedia = function (cs) {\n      return shimConstraints_(cs, function (c) {\n        return origGetUserMedia(c).then(function (stream) {\n          if (c.audio && !stream.getAudioTracks().length || c.video && !stream.getVideoTracks().length) {\n            stream.getTracks().forEach(function (track) {\n              track.stop();\n            });\n            throw new DOMException('', 'NotFoundError');\n          }\n          return stream;\n        }, function (e) {\n          return Promise.reject(shimError_(e));\n        });\n      });\n    };\n  }\n}\n\n},{\"../utils.js\":15}],6:[function(require,module,exports){\n/*\n *  Copyright (c) 2017 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nexports.shimRTCIceCandidate = shimRTCIceCandidate;\nexports.shimMaxMessageSize = shimMaxMessageSize;\nexports.shimSendThrowTypeError = shimSendThrowTypeError;\nexports.shimConnectionState = shimConnectionState;\nexports.removeAllowExtmapMixed = removeAllowExtmapMixed;\n\nvar _sdp = require('sdp');\n\nvar _sdp2 = _interopRequireDefault(_sdp);\n\nvar _utils = require('./utils');\n\nvar utils = _interopRequireWildcard(_utils);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction shimRTCIceCandidate(window) {\n  // foundation is arbitrarily chosen as an indicator for full support for\n  // https://w3c.github.io/webrtc-pc/#rtcicecandidate-interface\n  if (!window.RTCIceCandidate || window.RTCIceCandidate && 'foundation' in window.RTCIceCandidate.prototype) {\n    return;\n  }\n\n  var NativeRTCIceCandidate = window.RTCIceCandidate;\n  window.RTCIceCandidate = function RTCIceCandidate(args) {\n    // Remove the a= which shouldn't be part of the candidate string.\n    if ((typeof args === 'undefined' ? 'undefined' : _typeof(args)) === 'object' && args.candidate && args.candidate.indexOf('a=') === 0) {\n      args = JSON.parse(JSON.stringify(args));\n      args.candidate = args.candidate.substr(2);\n    }\n\n    if (args.candidate && args.candidate.length) {\n      // Augment the native candidate with the parsed fields.\n      var nativeCandidate = new NativeRTCIceCandidate(args);\n      var parsedCandidate = _sdp2.default.parseCandidate(args.candidate);\n      var augmentedCandidate = Object.assign(nativeCandidate, parsedCandidate);\n\n      // Add a serializer that does not serialize the extra attributes.\n      augmentedCandidate.toJSON = function toJSON() {\n        return {\n          candidate: augmentedCandidate.candidate,\n          sdpMid: augmentedCandidate.sdpMid,\n          sdpMLineIndex: augmentedCandidate.sdpMLineIndex,\n          usernameFragment: augmentedCandidate.usernameFragment\n        };\n      };\n      return augmentedCandidate;\n    }\n    return new NativeRTCIceCandidate(args);\n  };\n  window.RTCIceCandidate.prototype = NativeRTCIceCandidate.prototype;\n\n  // Hook up the augmented candidate in onicecandidate and\n  // addEventListener('icecandidate', ...)\n  utils.wrapPeerConnectionEvent(window, 'icecandidate', function (e) {\n    if (e.candidate) {\n      Object.defineProperty(e, 'candidate', {\n        value: new window.RTCIceCandidate(e.candidate),\n        writable: 'false'\n      });\n    }\n    return e;\n  });\n}\n\nfunction shimMaxMessageSize(window) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  var browserDetails = utils.detectBrowser(window);\n\n  if (!('sctp' in window.RTCPeerConnection.prototype)) {\n    Object.defineProperty(window.RTCPeerConnection.prototype, 'sctp', {\n      get: function get() {\n        return typeof this._sctp === 'undefined' ? null : this._sctp;\n      }\n    });\n  }\n\n  var sctpInDescription = function sctpInDescription(description) {\n    if (!description || !description.sdp) {\n      return false;\n    }\n    var sections = _sdp2.default.splitSections(description.sdp);\n    sections.shift();\n    return sections.some(function (mediaSection) {\n      var mLine = _sdp2.default.parseMLine(mediaSection);\n      return mLine && mLine.kind === 'application' && mLine.protocol.indexOf('SCTP') !== -1;\n    });\n  };\n\n  var getRemoteFirefoxVersion = function getRemoteFirefoxVersion(description) {\n    // TODO: Is there a better solution for detecting Firefox?\n    var match = description.sdp.match(/mozilla...THIS_IS_SDPARTA-(\\d+)/);\n    if (match === null || match.length < 2) {\n      return -1;\n    }\n    var version = parseInt(match[1], 10);\n    // Test for NaN (yes, this is ugly)\n    return version !== version ? -1 : version;\n  };\n\n  var getCanSendMaxMessageSize = function getCanSendMaxMessageSize(remoteIsFirefox) {\n    // Every implementation we know can send at least 64 KiB.\n    // Note: Although Chrome is technically able to send up to 256 KiB, the\n    //       data does not reach the other peer reliably.\n    //       See: https://bugs.chromium.org/p/webrtc/issues/detail?id=8419\n    var canSendMaxMessageSize = 65536;\n    if (browserDetails.browser === 'firefox') {\n      if (browserDetails.version < 57) {\n        if (remoteIsFirefox === -1) {\n          // FF < 57 will send in 16 KiB chunks using the deprecated PPID\n          // fragmentation.\n          canSendMaxMessageSize = 16384;\n        } else {\n          // However, other FF (and RAWRTC) can reassemble PPID-fragmented\n          // messages. Thus, supporting ~2 GiB when sending.\n          canSendMaxMessageSize = 2147483637;\n        }\n      } else if (browserDetails.version < 60) {\n        // Currently, all FF >= 57 will reset the remote maximum message size\n        // to the default value when a data channel is created at a later\n        // stage. :(\n        // See: https://bugzilla.mozilla.org/show_bug.cgi?id=1426831\n        canSendMaxMessageSize = browserDetails.version === 57 ? 65535 : 65536;\n      } else {\n        // FF >= 60 supports sending ~2 GiB\n        canSendMaxMessageSize = 2147483637;\n      }\n    }\n    return canSendMaxMessageSize;\n  };\n\n  var getMaxMessageSize = function getMaxMessageSize(description, remoteIsFirefox) {\n    // Note: 65536 bytes is the default value from the SDP spec. Also,\n    //       every implementation we know supports receiving 65536 bytes.\n    var maxMessageSize = 65536;\n\n    // FF 57 has a slightly incorrect default remote max message size, so\n    // we need to adjust it here to avoid a failure when sending.\n    // See: https://bugzilla.mozilla.org/show_bug.cgi?id=1425697\n    if (browserDetails.browser === 'firefox' && browserDetails.version === 57) {\n      maxMessageSize = 65535;\n    }\n\n    var match = _sdp2.default.matchPrefix(description.sdp, 'a=max-message-size:');\n    if (match.length > 0) {\n      maxMessageSize = parseInt(match[0].substr(19), 10);\n    } else if (browserDetails.browser === 'firefox' && remoteIsFirefox !== -1) {\n      // If the maximum message size is not present in the remote SDP and\n      // both local and remote are Firefox, the remote peer can receive\n      // ~2 GiB.\n      maxMessageSize = 2147483637;\n    }\n    return maxMessageSize;\n  };\n\n  var origSetRemoteDescription = window.RTCPeerConnection.prototype.setRemoteDescription;\n  window.RTCPeerConnection.prototype.setRemoteDescription = function setRemoteDescription() {\n    this._sctp = null;\n    // Chrome decided to not expose .sctp in plan-b mode.\n    // As usual, adapter.js has to do an 'ugly worakaround'\n    // to cover up the mess.\n    if (browserDetails.browser === 'chrome' && browserDetails.version >= 76) {\n      var _getConfiguration = this.getConfiguration(),\n          sdpSemantics = _getConfiguration.sdpSemantics;\n\n      if (sdpSemantics === 'plan-b') {\n        Object.defineProperty(this, 'sctp', {\n          get: function get() {\n            return typeof this._sctp === 'undefined' ? null : this._sctp;\n          },\n\n          enumerable: true,\n          configurable: true\n        });\n      }\n    }\n\n    if (sctpInDescription(arguments[0])) {\n      // Check if the remote is FF.\n      var isFirefox = getRemoteFirefoxVersion(arguments[0]);\n\n      // Get the maximum message size the local peer is capable of sending\n      var canSendMMS = getCanSendMaxMessageSize(isFirefox);\n\n      // Get the maximum message size of the remote peer.\n      var remoteMMS = getMaxMessageSize(arguments[0], isFirefox);\n\n      // Determine final maximum message size\n      var maxMessageSize = void 0;\n      if (canSendMMS === 0 && remoteMMS === 0) {\n        maxMessageSize = Number.POSITIVE_INFINITY;\n      } else if (canSendMMS === 0 || remoteMMS === 0) {\n        maxMessageSize = Math.max(canSendMMS, remoteMMS);\n      } else {\n        maxMessageSize = Math.min(canSendMMS, remoteMMS);\n      }\n\n      // Create a dummy RTCSctpTransport object and the 'maxMessageSize'\n      // attribute.\n      var sctp = {};\n      Object.defineProperty(sctp, 'maxMessageSize', {\n        get: function get() {\n          return maxMessageSize;\n        }\n      });\n      this._sctp = sctp;\n    }\n\n    return origSetRemoteDescription.apply(this, arguments);\n  };\n}\n\nfunction shimSendThrowTypeError(window) {\n  if (!(window.RTCPeerConnection && 'createDataChannel' in window.RTCPeerConnection.prototype)) {\n    return;\n  }\n\n  // Note: Although Firefox >= 57 has a native implementation, the maximum\n  //       message size can be reset for all data channels at a later stage.\n  //       See: https://bugzilla.mozilla.org/show_bug.cgi?id=1426831\n\n  function wrapDcSend(dc, pc) {\n    var origDataChannelSend = dc.send;\n    dc.send = function send() {\n      var data = arguments[0];\n      var length = data.length || data.size || data.byteLength;\n      if (dc.readyState === 'open' && pc.sctp && length > pc.sctp.maxMessageSize) {\n        throw new TypeError('Message too large (can send a maximum of ' + pc.sctp.maxMessageSize + ' bytes)');\n      }\n      return origDataChannelSend.apply(dc, arguments);\n    };\n  }\n  var origCreateDataChannel = window.RTCPeerConnection.prototype.createDataChannel;\n  window.RTCPeerConnection.prototype.createDataChannel = function createDataChannel() {\n    var dataChannel = origCreateDataChannel.apply(this, arguments);\n    wrapDcSend(dataChannel, this);\n    return dataChannel;\n  };\n  utils.wrapPeerConnectionEvent(window, 'datachannel', function (e) {\n    wrapDcSend(e.channel, e.target);\n    return e;\n  });\n}\n\n/* shims RTCConnectionState by pretending it is the same as iceConnectionState.\n * See https://bugs.chromium.org/p/webrtc/issues/detail?id=6145#c12\n * for why this is a valid hack in Chrome. In Firefox it is slightly incorrect\n * since DTLS failures would be hidden. See\n * https://bugzilla.mozilla.org/show_bug.cgi?id=1265827\n * for the Firefox tracking bug.\n */\nfunction shimConnectionState(window) {\n  if (!window.RTCPeerConnection || 'connectionState' in window.RTCPeerConnection.prototype) {\n    return;\n  }\n  var proto = window.RTCPeerConnection.prototype;\n  Object.defineProperty(proto, 'connectionState', {\n    get: function get() {\n      return {\n        completed: 'connected',\n        checking: 'connecting'\n      }[this.iceConnectionState] || this.iceConnectionState;\n    },\n\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(proto, 'onconnectionstatechange', {\n    get: function get() {\n      return this._onconnectionstatechange || null;\n    },\n    set: function set(cb) {\n      if (this._onconnectionstatechange) {\n        this.removeEventListener('connectionstatechange', this._onconnectionstatechange);\n        delete this._onconnectionstatechange;\n      }\n      if (cb) {\n        this.addEventListener('connectionstatechange', this._onconnectionstatechange = cb);\n      }\n    },\n\n    enumerable: true,\n    configurable: true\n  });\n\n  ['setLocalDescription', 'setRemoteDescription'].forEach(function (method) {\n    var origMethod = proto[method];\n    proto[method] = function () {\n      if (!this._connectionstatechangepoly) {\n        this._connectionstatechangepoly = function (e) {\n          var pc = e.target;\n          if (pc._lastConnectionState !== pc.connectionState) {\n            pc._lastConnectionState = pc.connectionState;\n            var newEvent = new Event('connectionstatechange', e);\n            pc.dispatchEvent(newEvent);\n          }\n          return e;\n        };\n        this.addEventListener('iceconnectionstatechange', this._connectionstatechangepoly);\n      }\n      return origMethod.apply(this, arguments);\n    };\n  });\n}\n\nfunction removeAllowExtmapMixed(window) {\n  /* remove a=extmap-allow-mixed for Chrome < M71 */\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  var browserDetails = utils.detectBrowser(window);\n  if (browserDetails.browser === 'chrome' && browserDetails.version >= 71) {\n    return;\n  }\n  var nativeSRD = window.RTCPeerConnection.prototype.setRemoteDescription;\n  window.RTCPeerConnection.prototype.setRemoteDescription = function setRemoteDescription(desc) {\n    if (desc && desc.sdp && desc.sdp.indexOf('\\na=extmap-allow-mixed') !== -1) {\n      desc.sdp = desc.sdp.split('\\n').filter(function (line) {\n        return line.trim() !== 'a=extmap-allow-mixed';\n      }).join('\\n');\n    }\n    return nativeSRD.apply(this, arguments);\n  };\n}\n\n},{\"./utils\":15,\"sdp\":17}],7:[function(require,module,exports){\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.shimGetDisplayMedia = exports.shimGetUserMedia = undefined;\n\nvar _getusermedia = require('./getusermedia');\n\nObject.defineProperty(exports, 'shimGetUserMedia', {\n  enumerable: true,\n  get: function get() {\n    return _getusermedia.shimGetUserMedia;\n  }\n});\n\nvar _getdisplaymedia = require('./getdisplaymedia');\n\nObject.defineProperty(exports, 'shimGetDisplayMedia', {\n  enumerable: true,\n  get: function get() {\n    return _getdisplaymedia.shimGetDisplayMedia;\n  }\n});\nexports.shimPeerConnection = shimPeerConnection;\nexports.shimReplaceTrack = shimReplaceTrack;\n\nvar _utils = require('../utils');\n\nvar utils = _interopRequireWildcard(_utils);\n\nvar _filtericeservers = require('./filtericeservers');\n\nvar _rtcpeerconnectionShim = require('rtcpeerconnection-shim');\n\nvar _rtcpeerconnectionShim2 = _interopRequireDefault(_rtcpeerconnectionShim);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction shimPeerConnection(window) {\n  var browserDetails = utils.detectBrowser(window);\n\n  if (window.RTCIceGatherer) {\n    if (!window.RTCIceCandidate) {\n      window.RTCIceCandidate = function RTCIceCandidate(args) {\n        return args;\n      };\n    }\n    if (!window.RTCSessionDescription) {\n      window.RTCSessionDescription = function RTCSessionDescription(args) {\n        return args;\n      };\n    }\n    // this adds an additional event listener to MediaStrackTrack that signals\n    // when a tracks enabled property was changed. Workaround for a bug in\n    // addStream, see below. No longer required in 15025+\n    if (browserDetails.version < 15025) {\n      var origMSTEnabled = Object.getOwnPropertyDescriptor(window.MediaStreamTrack.prototype, 'enabled');\n      Object.defineProperty(window.MediaStreamTrack.prototype, 'enabled', {\n        set: function set(value) {\n          origMSTEnabled.set.call(this, value);\n          var ev = new Event('enabled');\n          ev.enabled = value;\n          this.dispatchEvent(ev);\n        }\n      });\n    }\n  }\n\n  // ORTC defines the DTMF sender a bit different.\n  // https://github.com/w3c/ortc/issues/714\n  if (window.RTCRtpSender && !('dtmf' in window.RTCRtpSender.prototype)) {\n    Object.defineProperty(window.RTCRtpSender.prototype, 'dtmf', {\n      get: function get() {\n        if (this._dtmf === undefined) {\n          if (this.track.kind === 'audio') {\n            this._dtmf = new window.RTCDtmfSender(this);\n          } else if (this.track.kind === 'video') {\n            this._dtmf = null;\n          }\n        }\n        return this._dtmf;\n      }\n    });\n  }\n  // Edge currently only implements the RTCDtmfSender, not the\n  // RTCDTMFSender alias. See http://draft.ortc.org/#rtcdtmfsender2*\n  if (window.RTCDtmfSender && !window.RTCDTMFSender) {\n    window.RTCDTMFSender = window.RTCDtmfSender;\n  }\n\n  var RTCPeerConnectionShim = (0, _rtcpeerconnectionShim2.default)(window, browserDetails.version);\n  window.RTCPeerConnection = function RTCPeerConnection(config) {\n    if (config && config.iceServers) {\n      config.iceServers = (0, _filtericeservers.filterIceServers)(config.iceServers, browserDetails.version);\n      utils.log('ICE servers after filtering:', config.iceServers);\n    }\n    return new RTCPeerConnectionShim(config);\n  };\n  window.RTCPeerConnection.prototype = RTCPeerConnectionShim.prototype;\n}\n\nfunction shimReplaceTrack(window) {\n  // ORTC has replaceTrack -- https://github.com/w3c/ortc/issues/614\n  if (window.RTCRtpSender && !('replaceTrack' in window.RTCRtpSender.prototype)) {\n    window.RTCRtpSender.prototype.replaceTrack = window.RTCRtpSender.prototype.setTrack;\n  }\n}\n\n},{\"../utils\":15,\"./filtericeservers\":8,\"./getdisplaymedia\":9,\"./getusermedia\":10,\"rtcpeerconnection-shim\":16}],8:[function(require,module,exports){\n/*\n *  Copyright (c) 2018 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.filterIceServers = filterIceServers;\n\nvar _utils = require('../utils');\n\nvar utils = _interopRequireWildcard(_utils);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\n// Edge does not like\n// 1) stun: filtered after 14393 unless ?transport=udp is present\n// 2) turn: that does not have all of turn:host:port?transport=udp\n// 3) turn: with ipv6 addresses\n// 4) turn: occurring muliple times\nfunction filterIceServers(iceServers, edgeVersion) {\n  var hasTurn = false;\n  iceServers = JSON.parse(JSON.stringify(iceServers));\n  return iceServers.filter(function (server) {\n    if (server && (server.urls || server.url)) {\n      var urls = server.urls || server.url;\n      if (server.url && !server.urls) {\n        utils.deprecated('RTCIceServer.url', 'RTCIceServer.urls');\n      }\n      var isString = typeof urls === 'string';\n      if (isString) {\n        urls = [urls];\n      }\n      urls = urls.filter(function (url) {\n        // filter STUN unconditionally.\n        if (url.indexOf('stun:') === 0) {\n          return false;\n        }\n\n        var validTurn = url.startsWith('turn') && !url.startsWith('turn:[') && url.includes('transport=udp');\n        if (validTurn && !hasTurn) {\n          hasTurn = true;\n          return true;\n        }\n        return validTurn && !hasTurn;\n      });\n\n      delete server.url;\n      server.urls = isString ? urls[0] : urls;\n      return !!urls.length;\n    }\n  });\n}\n\n},{\"../utils\":15}],9:[function(require,module,exports){\n/*\n *  Copyright (c) 2018 The adapter.js project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.shimGetDisplayMedia = shimGetDisplayMedia;\nfunction shimGetDisplayMedia(window) {\n  if (!('getDisplayMedia' in window.navigator)) {\n    return;\n  }\n  if (!window.navigator.mediaDevices) {\n    return;\n  }\n  if (window.navigator.mediaDevices && 'getDisplayMedia' in window.navigator.mediaDevices) {\n    return;\n  }\n  window.navigator.mediaDevices.getDisplayMedia = window.navigator.getDisplayMedia.bind(window.navigator);\n}\n\n},{}],10:[function(require,module,exports){\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.shimGetUserMedia = shimGetUserMedia;\nfunction shimGetUserMedia(window) {\n  var navigator = window && window.navigator;\n\n  var shimError_ = function shimError_(e) {\n    return {\n      name: { PermissionDeniedError: 'NotAllowedError' }[e.name] || e.name,\n      message: e.message,\n      constraint: e.constraint,\n      toString: function toString() {\n        return this.name;\n      }\n    };\n  };\n\n  // getUserMedia error shim.\n  var origGetUserMedia = navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);\n  navigator.mediaDevices.getUserMedia = function (c) {\n    return origGetUserMedia(c).catch(function (e) {\n      return Promise.reject(shimError_(e));\n    });\n  };\n}\n\n},{}],11:[function(require,module,exports){\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.shimGetDisplayMedia = exports.shimGetUserMedia = undefined;\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _getusermedia = require('./getusermedia');\n\nObject.defineProperty(exports, 'shimGetUserMedia', {\n  enumerable: true,\n  get: function get() {\n    return _getusermedia.shimGetUserMedia;\n  }\n});\n\nvar _getdisplaymedia = require('./getdisplaymedia');\n\nObject.defineProperty(exports, 'shimGetDisplayMedia', {\n  enumerable: true,\n  get: function get() {\n    return _getdisplaymedia.shimGetDisplayMedia;\n  }\n});\nexports.shimOnTrack = shimOnTrack;\nexports.shimPeerConnection = shimPeerConnection;\nexports.shimSenderGetStats = shimSenderGetStats;\nexports.shimReceiverGetStats = shimReceiverGetStats;\nexports.shimRemoveStream = shimRemoveStream;\nexports.shimRTCDataChannel = shimRTCDataChannel;\nexports.shimAddTransceiver = shimAddTransceiver;\nexports.shimCreateOffer = shimCreateOffer;\nexports.shimCreateAnswer = shimCreateAnswer;\n\nvar _utils = require('../utils');\n\nvar utils = _interopRequireWildcard(_utils);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction shimOnTrack(window) {\n  if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCTrackEvent && 'receiver' in window.RTCTrackEvent.prototype && !('transceiver' in window.RTCTrackEvent.prototype)) {\n    Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {\n      get: function get() {\n        return { receiver: this.receiver };\n      }\n    });\n  }\n}\n\nfunction shimPeerConnection(window) {\n  var browserDetails = utils.detectBrowser(window);\n\n  if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) !== 'object' || !(window.RTCPeerConnection || window.mozRTCPeerConnection)) {\n    return; // probably media.peerconnection.enabled=false in about:config\n  }\n  if (!window.RTCPeerConnection && window.mozRTCPeerConnection) {\n    // very basic support for old versions.\n    window.RTCPeerConnection = window.mozRTCPeerConnection;\n  }\n\n  if (browserDetails.version < 53) {\n    // shim away need for obsolete RTCIceCandidate/RTCSessionDescription.\n    ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate'].forEach(function (method) {\n      var nativeMethod = window.RTCPeerConnection.prototype[method];\n      var methodObj = _defineProperty({}, method, function () {\n        arguments[0] = new (method === 'addIceCandidate' ? window.RTCIceCandidate : window.RTCSessionDescription)(arguments[0]);\n        return nativeMethod.apply(this, arguments);\n      });\n      window.RTCPeerConnection.prototype[method] = methodObj[method];\n    });\n  }\n\n  // support for addIceCandidate(null or undefined)\n  // as well as ignoring {sdpMid, candidate: \"\"}\n  if (browserDetails.version < 68) {\n    var nativeAddIceCandidate = window.RTCPeerConnection.prototype.addIceCandidate;\n    window.RTCPeerConnection.prototype.addIceCandidate = function addIceCandidate() {\n      if (!arguments[0]) {\n        if (arguments[1]) {\n          arguments[1].apply(null);\n        }\n        return Promise.resolve();\n      }\n      // Firefox 68+ emits and processes {candidate: \"\", ...}, ignore\n      // in older versions.\n      if (arguments[0] && arguments[0].candidate === '') {\n        return Promise.resolve();\n      }\n      return nativeAddIceCandidate.apply(this, arguments);\n    };\n  }\n\n  var modernStatsTypes = {\n    inboundrtp: 'inbound-rtp',\n    outboundrtp: 'outbound-rtp',\n    candidatepair: 'candidate-pair',\n    localcandidate: 'local-candidate',\n    remotecandidate: 'remote-candidate'\n  };\n\n  var nativeGetStats = window.RTCPeerConnection.prototype.getStats;\n  window.RTCPeerConnection.prototype.getStats = function getStats() {\n    var _arguments = Array.prototype.slice.call(arguments),\n        selector = _arguments[0],\n        onSucc = _arguments[1],\n        onErr = _arguments[2];\n\n    return nativeGetStats.apply(this, [selector || null]).then(function (stats) {\n      if (browserDetails.version < 53 && !onSucc) {\n        // Shim only promise getStats with spec-hyphens in type names\n        // Leave callback version alone; misc old uses of forEach before Map\n        try {\n          stats.forEach(function (stat) {\n            stat.type = modernStatsTypes[stat.type] || stat.type;\n          });\n        } catch (e) {\n          if (e.name !== 'TypeError') {\n            throw e;\n          }\n          // Avoid TypeError: \"type\" is read-only, in old versions. 34-43ish\n          stats.forEach(function (stat, i) {\n            stats.set(i, Object.assign({}, stat, {\n              type: modernStatsTypes[stat.type] || stat.type\n            }));\n          });\n        }\n      }\n      return stats;\n    }).then(onSucc, onErr);\n  };\n}\n\nfunction shimSenderGetStats(window) {\n  if (!((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection && window.RTCRtpSender)) {\n    return;\n  }\n  if (window.RTCRtpSender && 'getStats' in window.RTCRtpSender.prototype) {\n    return;\n  }\n  var origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n  if (origGetSenders) {\n    window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n      var _this = this;\n\n      var senders = origGetSenders.apply(this, []);\n      senders.forEach(function (sender) {\n        return sender._pc = _this;\n      });\n      return senders;\n    };\n  }\n\n  var origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n  if (origAddTrack) {\n    window.RTCPeerConnection.prototype.addTrack = function addTrack() {\n      var sender = origAddTrack.apply(this, arguments);\n      sender._pc = this;\n      return sender;\n    };\n  }\n  window.RTCRtpSender.prototype.getStats = function getStats() {\n    return this.track ? this._pc.getStats(this.track) : Promise.resolve(new Map());\n  };\n}\n\nfunction shimReceiverGetStats(window) {\n  if (!((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection && window.RTCRtpSender)) {\n    return;\n  }\n  if (window.RTCRtpSender && 'getStats' in window.RTCRtpReceiver.prototype) {\n    return;\n  }\n  var origGetReceivers = window.RTCPeerConnection.prototype.getReceivers;\n  if (origGetReceivers) {\n    window.RTCPeerConnection.prototype.getReceivers = function getReceivers() {\n      var _this2 = this;\n\n      var receivers = origGetReceivers.apply(this, []);\n      receivers.forEach(function (receiver) {\n        return receiver._pc = _this2;\n      });\n      return receivers;\n    };\n  }\n  utils.wrapPeerConnectionEvent(window, 'track', function (e) {\n    e.receiver._pc = e.srcElement;\n    return e;\n  });\n  window.RTCRtpReceiver.prototype.getStats = function getStats() {\n    return this._pc.getStats(this.track);\n  };\n}\n\nfunction shimRemoveStream(window) {\n  if (!window.RTCPeerConnection || 'removeStream' in window.RTCPeerConnection.prototype) {\n    return;\n  }\n  window.RTCPeerConnection.prototype.removeStream = function removeStream(stream) {\n    var _this3 = this;\n\n    utils.deprecated('removeStream', 'removeTrack');\n    this.getSenders().forEach(function (sender) {\n      if (sender.track && stream.getTracks().includes(sender.track)) {\n        _this3.removeTrack(sender);\n      }\n    });\n  };\n}\n\nfunction shimRTCDataChannel(window) {\n  // rename DataChannel to RTCDataChannel (native fix in FF60):\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1173851\n  if (window.DataChannel && !window.RTCDataChannel) {\n    window.RTCDataChannel = window.DataChannel;\n  }\n}\n\nfunction shimAddTransceiver(window) {\n  // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n  // Firefox ignores the init sendEncodings options passed to addTransceiver\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n  if (!((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection)) {\n    return;\n  }\n  var origAddTransceiver = window.RTCPeerConnection.prototype.addTransceiver;\n  if (origAddTransceiver) {\n    window.RTCPeerConnection.prototype.addTransceiver = function addTransceiver() {\n      this.setParametersPromises = [];\n      var initParameters = arguments[1];\n      var shouldPerformCheck = initParameters && 'sendEncodings' in initParameters;\n      if (shouldPerformCheck) {\n        // If sendEncodings params are provided, validate grammar\n        initParameters.sendEncodings.forEach(function (encodingParam) {\n          if ('rid' in encodingParam) {\n            var ridRegex = /^[a-z0-9]{0,16}$/i;\n            if (!ridRegex.test(encodingParam.rid)) {\n              throw new TypeError('Invalid RID value provided.');\n            }\n          }\n          if ('scaleResolutionDownBy' in encodingParam) {\n            if (!(parseFloat(encodingParam.scaleResolutionDownBy) >= 1.0)) {\n              throw new RangeError('scale_resolution_down_by must be >= 1.0');\n            }\n          }\n          if ('maxFramerate' in encodingParam) {\n            if (!(parseFloat(encodingParam.maxFramerate) >= 0)) {\n              throw new RangeError('max_framerate must be >= 0.0');\n            }\n          }\n        });\n      }\n      var transceiver = origAddTransceiver.apply(this, arguments);\n      if (shouldPerformCheck) {\n        // Check if the init options were applied. If not we do this in an\n        // asynchronous way and save the promise reference in a global object.\n        // This is an ugly hack, but at the same time is way more robust than\n        // checking the sender parameters before and after the createOffer\n        // Also note that after the createoffer we are not 100% sure that\n        // the params were asynchronously applied so we might miss the\n        // opportunity to recreate offer.\n        var sender = transceiver.sender;\n\n        var params = sender.getParameters();\n        if (!('encodings' in params)) {\n          params.encodings = initParameters.sendEncodings;\n          this.setParametersPromises.push(sender.setParameters(params).catch(function () {}));\n        }\n      }\n      return transceiver;\n    };\n  }\n}\n\nfunction shimCreateOffer(window) {\n  // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n  // Firefox ignores the init sendEncodings options passed to addTransceiver\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n  if (!((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection)) {\n    return;\n  }\n  var origCreateOffer = window.RTCPeerConnection.prototype.createOffer;\n  window.RTCPeerConnection.prototype.createOffer = function createOffer() {\n    var _this4 = this,\n        _arguments2 = arguments;\n\n    if (this.setParametersPromises && this.setParametersPromises.length) {\n      return Promise.all(this.setParametersPromises).then(function () {\n        return origCreateOffer.apply(_this4, _arguments2);\n      }).finally(function () {\n        _this4.setParametersPromises = [];\n      });\n    }\n    return origCreateOffer.apply(this, arguments);\n  };\n}\n\nfunction shimCreateAnswer(window) {\n  // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n  // Firefox ignores the init sendEncodings options passed to addTransceiver\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n  if (!((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection)) {\n    return;\n  }\n  var origCreateAnswer = window.RTCPeerConnection.prototype.createAnswer;\n  window.RTCPeerConnection.prototype.createAnswer = function createAnswer() {\n    var _this5 = this,\n        _arguments3 = arguments;\n\n    if (this.setParametersPromises && this.setParametersPromises.length) {\n      return Promise.all(this.setParametersPromises).then(function () {\n        return origCreateAnswer.apply(_this5, _arguments3);\n      }).finally(function () {\n        _this5.setParametersPromises = [];\n      });\n    }\n    return origCreateAnswer.apply(this, arguments);\n  };\n}\n\n},{\"../utils\":15,\"./getdisplaymedia\":12,\"./getusermedia\":13}],12:[function(require,module,exports){\n/*\n *  Copyright (c) 2018 The adapter.js project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.shimGetDisplayMedia = shimGetDisplayMedia;\nfunction shimGetDisplayMedia(window, preferredMediaSource) {\n  if (window.navigator.mediaDevices && 'getDisplayMedia' in window.navigator.mediaDevices) {\n    return;\n  }\n  if (!window.navigator.mediaDevices) {\n    return;\n  }\n  window.navigator.mediaDevices.getDisplayMedia = function getDisplayMedia(constraints) {\n    if (!(constraints && constraints.video)) {\n      var err = new DOMException('getDisplayMedia without video ' + 'constraints is undefined');\n      err.name = 'NotFoundError';\n      // from https://heycam.github.io/webidl/#idl-DOMException-error-names\n      err.code = 8;\n      return Promise.reject(err);\n    }\n    if (constraints.video === true) {\n      constraints.video = { mediaSource: preferredMediaSource };\n    } else {\n      constraints.video.mediaSource = preferredMediaSource;\n    }\n    return window.navigator.mediaDevices.getUserMedia(constraints);\n  };\n}\n\n},{}],13:[function(require,module,exports){\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nexports.shimGetUserMedia = shimGetUserMedia;\n\nvar _utils = require('../utils');\n\nvar utils = _interopRequireWildcard(_utils);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction shimGetUserMedia(window) {\n  var browserDetails = utils.detectBrowser(window);\n  var navigator = window && window.navigator;\n  var MediaStreamTrack = window && window.MediaStreamTrack;\n\n  navigator.getUserMedia = function (constraints, onSuccess, onError) {\n    // Replace Firefox 44+'s deprecation warning with unprefixed version.\n    utils.deprecated('navigator.getUserMedia', 'navigator.mediaDevices.getUserMedia');\n    navigator.mediaDevices.getUserMedia(constraints).then(onSuccess, onError);\n  };\n\n  if (!(browserDetails.version > 55 && 'autoGainControl' in navigator.mediaDevices.getSupportedConstraints())) {\n    var remap = function remap(obj, a, b) {\n      if (a in obj && !(b in obj)) {\n        obj[b] = obj[a];\n        delete obj[a];\n      }\n    };\n\n    var nativeGetUserMedia = navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);\n    navigator.mediaDevices.getUserMedia = function (c) {\n      if ((typeof c === 'undefined' ? 'undefined' : _typeof(c)) === 'object' && _typeof(c.audio) === 'object') {\n        c = JSON.parse(JSON.stringify(c));\n        remap(c.audio, 'autoGainControl', 'mozAutoGainControl');\n        remap(c.audio, 'noiseSuppression', 'mozNoiseSuppression');\n      }\n      return nativeGetUserMedia(c);\n    };\n\n    if (MediaStreamTrack && MediaStreamTrack.prototype.getSettings) {\n      var nativeGetSettings = MediaStreamTrack.prototype.getSettings;\n      MediaStreamTrack.prototype.getSettings = function () {\n        var obj = nativeGetSettings.apply(this, arguments);\n        remap(obj, 'mozAutoGainControl', 'autoGainControl');\n        remap(obj, 'mozNoiseSuppression', 'noiseSuppression');\n        return obj;\n      };\n    }\n\n    if (MediaStreamTrack && MediaStreamTrack.prototype.applyConstraints) {\n      var nativeApplyConstraints = MediaStreamTrack.prototype.applyConstraints;\n      MediaStreamTrack.prototype.applyConstraints = function (c) {\n        if (this.kind === 'audio' && (typeof c === 'undefined' ? 'undefined' : _typeof(c)) === 'object') {\n          c = JSON.parse(JSON.stringify(c));\n          remap(c, 'autoGainControl', 'mozAutoGainControl');\n          remap(c, 'noiseSuppression', 'mozNoiseSuppression');\n        }\n        return nativeApplyConstraints.apply(this, [c]);\n      };\n    }\n  }\n}\n\n},{\"../utils\":15}],14:[function(require,module,exports){\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nexports.shimLocalStreamsAPI = shimLocalStreamsAPI;\nexports.shimRemoteStreamsAPI = shimRemoteStreamsAPI;\nexports.shimCallbacksAPI = shimCallbacksAPI;\nexports.shimGetUserMedia = shimGetUserMedia;\nexports.shimConstraints = shimConstraints;\nexports.shimRTCIceServerUrls = shimRTCIceServerUrls;\nexports.shimTrackEventTransceiver = shimTrackEventTransceiver;\nexports.shimCreateOfferLegacy = shimCreateOfferLegacy;\nexports.shimAudioContext = shimAudioContext;\n\nvar _utils = require('../utils');\n\nvar utils = _interopRequireWildcard(_utils);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction shimLocalStreamsAPI(window) {\n  if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) !== 'object' || !window.RTCPeerConnection) {\n    return;\n  }\n  if (!('getLocalStreams' in window.RTCPeerConnection.prototype)) {\n    window.RTCPeerConnection.prototype.getLocalStreams = function getLocalStreams() {\n      if (!this._localStreams) {\n        this._localStreams = [];\n      }\n      return this._localStreams;\n    };\n  }\n  if (!('addStream' in window.RTCPeerConnection.prototype)) {\n    var _addTrack = window.RTCPeerConnection.prototype.addTrack;\n    window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n      var _this = this;\n\n      if (!this._localStreams) {\n        this._localStreams = [];\n      }\n      if (!this._localStreams.includes(stream)) {\n        this._localStreams.push(stream);\n      }\n      // Try to emulate Chrome's behaviour of adding in audio-video order.\n      // Safari orders by track id.\n      stream.getAudioTracks().forEach(function (track) {\n        return _addTrack.call(_this, track, stream);\n      });\n      stream.getVideoTracks().forEach(function (track) {\n        return _addTrack.call(_this, track, stream);\n      });\n    };\n\n    window.RTCPeerConnection.prototype.addTrack = function addTrack(track) {\n      var _this2 = this;\n\n      for (var _len = arguments.length, streams = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        streams[_key - 1] = arguments[_key];\n      }\n\n      if (streams) {\n        streams.forEach(function (stream) {\n          if (!_this2._localStreams) {\n            _this2._localStreams = [stream];\n          } else if (!_this2._localStreams.includes(stream)) {\n            _this2._localStreams.push(stream);\n          }\n        });\n      }\n      return _addTrack.apply(this, arguments);\n    };\n  }\n  if (!('removeStream' in window.RTCPeerConnection.prototype)) {\n    window.RTCPeerConnection.prototype.removeStream = function removeStream(stream) {\n      var _this3 = this;\n\n      if (!this._localStreams) {\n        this._localStreams = [];\n      }\n      var index = this._localStreams.indexOf(stream);\n      if (index === -1) {\n        return;\n      }\n      this._localStreams.splice(index, 1);\n      var tracks = stream.getTracks();\n      this.getSenders().forEach(function (sender) {\n        if (tracks.includes(sender.track)) {\n          _this3.removeTrack(sender);\n        }\n      });\n    };\n  }\n}\n\nfunction shimRemoteStreamsAPI(window) {\n  if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) !== 'object' || !window.RTCPeerConnection) {\n    return;\n  }\n  if (!('getRemoteStreams' in window.RTCPeerConnection.prototype)) {\n    window.RTCPeerConnection.prototype.getRemoteStreams = function getRemoteStreams() {\n      return this._remoteStreams ? this._remoteStreams : [];\n    };\n  }\n  if (!('onaddstream' in window.RTCPeerConnection.prototype)) {\n    Object.defineProperty(window.RTCPeerConnection.prototype, 'onaddstream', {\n      get: function get() {\n        return this._onaddstream;\n      },\n      set: function set(f) {\n        var _this4 = this;\n\n        if (this._onaddstream) {\n          this.removeEventListener('addstream', this._onaddstream);\n          this.removeEventListener('track', this._onaddstreampoly);\n        }\n        this.addEventListener('addstream', this._onaddstream = f);\n        this.addEventListener('track', this._onaddstreampoly = function (e) {\n          e.streams.forEach(function (stream) {\n            if (!_this4._remoteStreams) {\n              _this4._remoteStreams = [];\n            }\n            if (_this4._remoteStreams.includes(stream)) {\n              return;\n            }\n            _this4._remoteStreams.push(stream);\n            var event = new Event('addstream');\n            event.stream = stream;\n            _this4.dispatchEvent(event);\n          });\n        });\n      }\n    });\n    var origSetRemoteDescription = window.RTCPeerConnection.prototype.setRemoteDescription;\n    window.RTCPeerConnection.prototype.setRemoteDescription = function setRemoteDescription() {\n      var pc = this;\n      if (!this._onaddstreampoly) {\n        this.addEventListener('track', this._onaddstreampoly = function (e) {\n          e.streams.forEach(function (stream) {\n            if (!pc._remoteStreams) {\n              pc._remoteStreams = [];\n            }\n            if (pc._remoteStreams.indexOf(stream) >= 0) {\n              return;\n            }\n            pc._remoteStreams.push(stream);\n            var event = new Event('addstream');\n            event.stream = stream;\n            pc.dispatchEvent(event);\n          });\n        });\n      }\n      return origSetRemoteDescription.apply(pc, arguments);\n    };\n  }\n}\n\nfunction shimCallbacksAPI(window) {\n  if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) !== 'object' || !window.RTCPeerConnection) {\n    return;\n  }\n  var prototype = window.RTCPeerConnection.prototype;\n  var origCreateOffer = prototype.createOffer;\n  var origCreateAnswer = prototype.createAnswer;\n  var setLocalDescription = prototype.setLocalDescription;\n  var setRemoteDescription = prototype.setRemoteDescription;\n  var addIceCandidate = prototype.addIceCandidate;\n\n  prototype.createOffer = function createOffer(successCallback, failureCallback) {\n    var options = arguments.length >= 2 ? arguments[2] : arguments[0];\n    var promise = origCreateOffer.apply(this, [options]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n\n  prototype.createAnswer = function createAnswer(successCallback, failureCallback) {\n    var options = arguments.length >= 2 ? arguments[2] : arguments[0];\n    var promise = origCreateAnswer.apply(this, [options]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n\n  var withCallback = function withCallback(description, successCallback, failureCallback) {\n    var promise = setLocalDescription.apply(this, [description]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n  prototype.setLocalDescription = withCallback;\n\n  withCallback = function withCallback(description, successCallback, failureCallback) {\n    var promise = setRemoteDescription.apply(this, [description]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n  prototype.setRemoteDescription = withCallback;\n\n  withCallback = function withCallback(candidate, successCallback, failureCallback) {\n    var promise = addIceCandidate.apply(this, [candidate]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n  prototype.addIceCandidate = withCallback;\n}\n\nfunction shimGetUserMedia(window) {\n  var navigator = window && window.navigator;\n\n  if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n    // shim not needed in Safari 12.1\n    var mediaDevices = navigator.mediaDevices;\n    var _getUserMedia = mediaDevices.getUserMedia.bind(mediaDevices);\n    navigator.mediaDevices.getUserMedia = function (constraints) {\n      return _getUserMedia(shimConstraints(constraints));\n    };\n  }\n\n  if (!navigator.getUserMedia && navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n    navigator.getUserMedia = function getUserMedia(constraints, cb, errcb) {\n      navigator.mediaDevices.getUserMedia(constraints).then(cb, errcb);\n    }.bind(navigator);\n  }\n}\n\nfunction shimConstraints(constraints) {\n  if (constraints && constraints.video !== undefined) {\n    return Object.assign({}, constraints, { video: utils.compactObject(constraints.video) });\n  }\n\n  return constraints;\n}\n\nfunction shimRTCIceServerUrls(window) {\n  // migrate from non-spec RTCIceServer.url to RTCIceServer.urls\n  var OrigPeerConnection = window.RTCPeerConnection;\n  window.RTCPeerConnection = function RTCPeerConnection(pcConfig, pcConstraints) {\n    if (pcConfig && pcConfig.iceServers) {\n      var newIceServers = [];\n      for (var i = 0; i < pcConfig.iceServers.length; i++) {\n        var server = pcConfig.iceServers[i];\n        if (!server.hasOwnProperty('urls') && server.hasOwnProperty('url')) {\n          utils.deprecated('RTCIceServer.url', 'RTCIceServer.urls');\n          server = JSON.parse(JSON.stringify(server));\n          server.urls = server.url;\n          delete server.url;\n          newIceServers.push(server);\n        } else {\n          newIceServers.push(pcConfig.iceServers[i]);\n        }\n      }\n      pcConfig.iceServers = newIceServers;\n    }\n    return new OrigPeerConnection(pcConfig, pcConstraints);\n  };\n  window.RTCPeerConnection.prototype = OrigPeerConnection.prototype;\n  // wrap static methods. Currently just generateCertificate.\n  if ('generateCertificate' in window.RTCPeerConnection) {\n    Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {\n      get: function get() {\n        return OrigPeerConnection.generateCertificate;\n      }\n    });\n  }\n}\n\nfunction shimTrackEventTransceiver(window) {\n  // Add event.transceiver member over deprecated event.receiver\n  if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCTrackEvent && 'receiver' in window.RTCTrackEvent.prototype && !('transceiver' in window.RTCTrackEvent.prototype)) {\n    Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {\n      get: function get() {\n        return { receiver: this.receiver };\n      }\n    });\n  }\n}\n\nfunction shimCreateOfferLegacy(window) {\n  var origCreateOffer = window.RTCPeerConnection.prototype.createOffer;\n  window.RTCPeerConnection.prototype.createOffer = function createOffer(offerOptions) {\n    if (offerOptions) {\n      if (typeof offerOptions.offerToReceiveAudio !== 'undefined') {\n        // support bit values\n        offerOptions.offerToReceiveAudio = !!offerOptions.offerToReceiveAudio;\n      }\n      var audioTransceiver = this.getTransceivers().find(function (transceiver) {\n        return transceiver.receiver.track.kind === 'audio';\n      });\n      if (offerOptions.offerToReceiveAudio === false && audioTransceiver) {\n        if (audioTransceiver.direction === 'sendrecv') {\n          if (audioTransceiver.setDirection) {\n            audioTransceiver.setDirection('sendonly');\n          } else {\n            audioTransceiver.direction = 'sendonly';\n          }\n        } else if (audioTransceiver.direction === 'recvonly') {\n          if (audioTransceiver.setDirection) {\n            audioTransceiver.setDirection('inactive');\n          } else {\n            audioTransceiver.direction = 'inactive';\n          }\n        }\n      } else if (offerOptions.offerToReceiveAudio === true && !audioTransceiver) {\n        this.addTransceiver('audio');\n      }\n\n      if (typeof offerOptions.offerToReceiveVideo !== 'undefined') {\n        // support bit values\n        offerOptions.offerToReceiveVideo = !!offerOptions.offerToReceiveVideo;\n      }\n      var videoTransceiver = this.getTransceivers().find(function (transceiver) {\n        return transceiver.receiver.track.kind === 'video';\n      });\n      if (offerOptions.offerToReceiveVideo === false && videoTransceiver) {\n        if (videoTransceiver.direction === 'sendrecv') {\n          if (videoTransceiver.setDirection) {\n            videoTransceiver.setDirection('sendonly');\n          } else {\n            videoTransceiver.direction = 'sendonly';\n          }\n        } else if (videoTransceiver.direction === 'recvonly') {\n          if (videoTransceiver.setDirection) {\n            videoTransceiver.setDirection('inactive');\n          } else {\n            videoTransceiver.direction = 'inactive';\n          }\n        }\n      } else if (offerOptions.offerToReceiveVideo === true && !videoTransceiver) {\n        this.addTransceiver('video');\n      }\n    }\n    return origCreateOffer.apply(this, arguments);\n  };\n}\n\nfunction shimAudioContext(window) {\n  if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) !== 'object' || window.AudioContext) {\n    return;\n  }\n  window.AudioContext = window.webkitAudioContext;\n}\n\n},{\"../utils\":15}],15:[function(require,module,exports){\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nexports.extractVersion = extractVersion;\nexports.wrapPeerConnectionEvent = wrapPeerConnectionEvent;\nexports.disableLog = disableLog;\nexports.disableWarnings = disableWarnings;\nexports.log = log;\nexports.deprecated = deprecated;\nexports.detectBrowser = detectBrowser;\nexports.compactObject = compactObject;\nexports.walkStats = walkStats;\nexports.filterStats = filterStats;\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nvar logDisabled_ = true;\nvar deprecationWarnings_ = true;\n\n/**\n * Extract browser version out of the provided user agent string.\n *\n * @param {!string} uastring userAgent string.\n * @param {!string} expr Regular expression used as match criteria.\n * @param {!number} pos position in the version string to be returned.\n * @return {!number} browser version.\n */\nfunction extractVersion(uastring, expr, pos) {\n  var match = uastring.match(expr);\n  return match && match.length >= pos && parseInt(match[pos], 10);\n}\n\n// Wraps the peerconnection event eventNameToWrap in a function\n// which returns the modified event object (or false to prevent\n// the event).\nfunction wrapPeerConnectionEvent(window, eventNameToWrap, wrapper) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  var proto = window.RTCPeerConnection.prototype;\n  var nativeAddEventListener = proto.addEventListener;\n  proto.addEventListener = function (nativeEventName, cb) {\n    if (nativeEventName !== eventNameToWrap) {\n      return nativeAddEventListener.apply(this, arguments);\n    }\n    var wrappedCallback = function wrappedCallback(e) {\n      var modifiedEvent = wrapper(e);\n      if (modifiedEvent) {\n        cb(modifiedEvent);\n      }\n    };\n    this._eventMap = this._eventMap || {};\n    this._eventMap[cb] = wrappedCallback;\n    return nativeAddEventListener.apply(this, [nativeEventName, wrappedCallback]);\n  };\n\n  var nativeRemoveEventListener = proto.removeEventListener;\n  proto.removeEventListener = function (nativeEventName, cb) {\n    if (nativeEventName !== eventNameToWrap || !this._eventMap || !this._eventMap[cb]) {\n      return nativeRemoveEventListener.apply(this, arguments);\n    }\n    var unwrappedCb = this._eventMap[cb];\n    delete this._eventMap[cb];\n    return nativeRemoveEventListener.apply(this, [nativeEventName, unwrappedCb]);\n  };\n\n  Object.defineProperty(proto, 'on' + eventNameToWrap, {\n    get: function get() {\n      return this['_on' + eventNameToWrap];\n    },\n    set: function set(cb) {\n      if (this['_on' + eventNameToWrap]) {\n        this.removeEventListener(eventNameToWrap, this['_on' + eventNameToWrap]);\n        delete this['_on' + eventNameToWrap];\n      }\n      if (cb) {\n        this.addEventListener(eventNameToWrap, this['_on' + eventNameToWrap] = cb);\n      }\n    },\n\n    enumerable: true,\n    configurable: true\n  });\n}\n\nfunction disableLog(bool) {\n  if (typeof bool !== 'boolean') {\n    return new Error('Argument type: ' + (typeof bool === 'undefined' ? 'undefined' : _typeof(bool)) + '. Please use a boolean.');\n  }\n  logDisabled_ = bool;\n  return bool ? 'adapter.js logging disabled' : 'adapter.js logging enabled';\n}\n\n/**\n * Disable or enable deprecation warnings\n * @param {!boolean} bool set to true to disable warnings.\n */\nfunction disableWarnings(bool) {\n  if (typeof bool !== 'boolean') {\n    return new Error('Argument type: ' + (typeof bool === 'undefined' ? 'undefined' : _typeof(bool)) + '. Please use a boolean.');\n  }\n  deprecationWarnings_ = !bool;\n  return 'adapter.js deprecation warnings ' + (bool ? 'disabled' : 'enabled');\n}\n\nfunction log() {\n  if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object') {\n    if (logDisabled_) {\n      return;\n    }\n    if (typeof console !== 'undefined' && typeof console.log === 'function') {\n      console.log.apply(console, arguments);\n    }\n  }\n}\n\n/**\n * Shows a deprecation warning suggesting the modern and spec-compatible API.\n */\nfunction deprecated(oldMethod, newMethod) {\n  if (!deprecationWarnings_) {\n    return;\n  }\n  console.warn(oldMethod + ' is deprecated, please use ' + newMethod + ' instead.');\n}\n\n/**\n * Browser detector.\n *\n * @return {object} result containing browser and version\n *     properties.\n */\nfunction detectBrowser(window) {\n  var navigator = window.navigator;\n\n  // Returned result object.\n\n  var result = { browser: null, version: null };\n\n  // Fail early if it's not a browser\n  if (typeof window === 'undefined' || !window.navigator) {\n    result.browser = 'Not a browser.';\n    return result;\n  }\n\n  if (navigator.mozGetUserMedia) {\n    // Firefox.\n    result.browser = 'firefox';\n    result.version = extractVersion(navigator.userAgent, /Firefox\\/(\\d+)\\./, 1);\n  } else if (navigator.webkitGetUserMedia || window.isSecureContext === false && window.webkitRTCPeerConnection && !window.RTCIceGatherer) {\n    // Chrome, Chromium, Webview, Opera.\n    // Version matches Chrome/WebRTC version.\n    // Chrome 74 removed webkitGetUserMedia on http as well so we need the\n    // more complicated fallback to webkitRTCPeerConnection.\n    result.browser = 'chrome';\n    result.version = extractVersion(navigator.userAgent, /Chrom(e|ium)\\/(\\d+)\\./, 2);\n  } else if (navigator.mediaDevices && navigator.userAgent.match(/Edge\\/(\\d+).(\\d+)$/)) {\n    // Edge.\n    result.browser = 'edge';\n    result.version = extractVersion(navigator.userAgent, /Edge\\/(\\d+).(\\d+)$/, 2);\n  } else if (window.RTCPeerConnection && navigator.userAgent.match(/AppleWebKit\\/(\\d+)\\./)) {\n    // Safari.\n    result.browser = 'safari';\n    result.version = extractVersion(navigator.userAgent, /AppleWebKit\\/(\\d+)\\./, 1);\n    result.supportsUnifiedPlan = window.RTCRtpTransceiver && 'currentDirection' in window.RTCRtpTransceiver.prototype;\n  } else {\n    // Default fallthrough: not supported.\n    result.browser = 'Not a supported browser.';\n    return result;\n  }\n\n  return result;\n}\n\n/**\n * Checks if something is an object.\n *\n * @param {*} val The something you want to check.\n * @return true if val is an object, false otherwise.\n */\nfunction isObject(val) {\n  return Object.prototype.toString.call(val) === '[object Object]';\n}\n\n/**\n * Remove all empty objects and undefined values\n * from a nested object -- an enhanced and vanilla version\n * of Lodash's `compact`.\n */\nfunction compactObject(data) {\n  if (!isObject(data)) {\n    return data;\n  }\n\n  return Object.keys(data).reduce(function (accumulator, key) {\n    var isObj = isObject(data[key]);\n    var value = isObj ? compactObject(data[key]) : data[key];\n    var isEmptyObject = isObj && !Object.keys(value).length;\n    if (value === undefined || isEmptyObject) {\n      return accumulator;\n    }\n    return Object.assign(accumulator, _defineProperty({}, key, value));\n  }, {});\n}\n\n/* iterates the stats graph recursively. */\nfunction walkStats(stats, base, resultSet) {\n  if (!base || resultSet.has(base.id)) {\n    return;\n  }\n  resultSet.set(base.id, base);\n  Object.keys(base).forEach(function (name) {\n    if (name.endsWith('Id')) {\n      walkStats(stats, stats.get(base[name]), resultSet);\n    } else if (name.endsWith('Ids')) {\n      base[name].forEach(function (id) {\n        walkStats(stats, stats.get(id), resultSet);\n      });\n    }\n  });\n}\n\n/* filter getStats for a sender/receiver track. */\nfunction filterStats(result, track, outbound) {\n  var streamStatsType = outbound ? 'outbound-rtp' : 'inbound-rtp';\n  var filteredResult = new Map();\n  if (track === null) {\n    return filteredResult;\n  }\n  var trackStats = [];\n  result.forEach(function (value) {\n    if (value.type === 'track' && value.trackIdentifier === track.id) {\n      trackStats.push(value);\n    }\n  });\n  trackStats.forEach(function (trackStat) {\n    result.forEach(function (stats) {\n      if (stats.type === streamStatsType && stats.trackId === trackStat.id) {\n        walkStats(result, stats, filteredResult);\n      }\n    });\n  });\n  return filteredResult;\n}\n\n},{}],16:[function(require,module,exports){\n/*\n *  Copyright (c) 2017 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nvar SDPUtils = require('sdp');\n\nfunction fixStatsType(stat) {\n  return {\n    inboundrtp: 'inbound-rtp',\n    outboundrtp: 'outbound-rtp',\n    candidatepair: 'candidate-pair',\n    localcandidate: 'local-candidate',\n    remotecandidate: 'remote-candidate'\n  }[stat.type] || stat.type;\n}\n\nfunction writeMediaSection(transceiver, caps, type, stream, dtlsRole) {\n  var sdp = SDPUtils.writeRtpDescription(transceiver.kind, caps);\n\n  // Map ICE parameters (ufrag, pwd) to SDP.\n  sdp += SDPUtils.writeIceParameters(\n      transceiver.iceGatherer.getLocalParameters());\n\n  // Map DTLS parameters to SDP.\n  sdp += SDPUtils.writeDtlsParameters(\n      transceiver.dtlsTransport.getLocalParameters(),\n      type === 'offer' ? 'actpass' : dtlsRole || 'active');\n\n  sdp += 'a=mid:' + transceiver.mid + '\\r\\n';\n\n  if (transceiver.rtpSender && transceiver.rtpReceiver) {\n    sdp += 'a=sendrecv\\r\\n';\n  } else if (transceiver.rtpSender) {\n    sdp += 'a=sendonly\\r\\n';\n  } else if (transceiver.rtpReceiver) {\n    sdp += 'a=recvonly\\r\\n';\n  } else {\n    sdp += 'a=inactive\\r\\n';\n  }\n\n  if (transceiver.rtpSender) {\n    var trackId = transceiver.rtpSender._initialTrackId ||\n        transceiver.rtpSender.track.id;\n    transceiver.rtpSender._initialTrackId = trackId;\n    // spec.\n    var msid = 'msid:' + (stream ? stream.id : '-') + ' ' +\n        trackId + '\\r\\n';\n    sdp += 'a=' + msid;\n    // for Chrome. Legacy should no longer be required.\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n        ' ' + msid;\n\n    // RTX\n    if (transceiver.sendEncodingParameters[0].rtx) {\n      sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n          ' ' + msid;\n      sdp += 'a=ssrc-group:FID ' +\n          transceiver.sendEncodingParameters[0].ssrc + ' ' +\n          transceiver.sendEncodingParameters[0].rtx.ssrc +\n          '\\r\\n';\n    }\n  }\n  // FIXME: this should be written by writeRtpDescription.\n  sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n      ' cname:' + SDPUtils.localCName + '\\r\\n';\n  if (transceiver.rtpSender && transceiver.sendEncodingParameters[0].rtx) {\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n        ' cname:' + SDPUtils.localCName + '\\r\\n';\n  }\n  return sdp;\n}\n\n// Edge does not like\n// 1) stun: filtered after 14393 unless ?transport=udp is present\n// 2) turn: that does not have all of turn:host:port?transport=udp\n// 3) turn: with ipv6 addresses\n// 4) turn: occurring muliple times\nfunction filterIceServers(iceServers, edgeVersion) {\n  var hasTurn = false;\n  iceServers = JSON.parse(JSON.stringify(iceServers));\n  return iceServers.filter(function(server) {\n    if (server && (server.urls || server.url)) {\n      var urls = server.urls || server.url;\n      if (server.url && !server.urls) {\n        console.warn('RTCIceServer.url is deprecated! Use urls instead.');\n      }\n      var isString = typeof urls === 'string';\n      if (isString) {\n        urls = [urls];\n      }\n      urls = urls.filter(function(url) {\n        var validTurn = url.indexOf('turn:') === 0 &&\n            url.indexOf('transport=udp') !== -1 &&\n            url.indexOf('turn:[') === -1 &&\n            !hasTurn;\n\n        if (validTurn) {\n          hasTurn = true;\n          return true;\n        }\n        return url.indexOf('stun:') === 0 && edgeVersion >= 14393 &&\n            url.indexOf('?transport=udp') === -1;\n      });\n\n      delete server.url;\n      server.urls = isString ? urls[0] : urls;\n      return !!urls.length;\n    }\n  });\n}\n\n// Determines the intersection of local and remote capabilities.\nfunction getCommonCapabilities(localCapabilities, remoteCapabilities) {\n  var commonCapabilities = {\n    codecs: [],\n    headerExtensions: [],\n    fecMechanisms: []\n  };\n\n  var findCodecByPayloadType = function(pt, codecs) {\n    pt = parseInt(pt, 10);\n    for (var i = 0; i < codecs.length; i++) {\n      if (codecs[i].payloadType === pt ||\n          codecs[i].preferredPayloadType === pt) {\n        return codecs[i];\n      }\n    }\n  };\n\n  var rtxCapabilityMatches = function(lRtx, rRtx, lCodecs, rCodecs) {\n    var lCodec = findCodecByPayloadType(lRtx.parameters.apt, lCodecs);\n    var rCodec = findCodecByPayloadType(rRtx.parameters.apt, rCodecs);\n    return lCodec && rCodec &&\n        lCodec.name.toLowerCase() === rCodec.name.toLowerCase();\n  };\n\n  localCapabilities.codecs.forEach(function(lCodec) {\n    for (var i = 0; i < remoteCapabilities.codecs.length; i++) {\n      var rCodec = remoteCapabilities.codecs[i];\n      if (lCodec.name.toLowerCase() === rCodec.name.toLowerCase() &&\n          lCodec.clockRate === rCodec.clockRate) {\n        if (lCodec.name.toLowerCase() === 'rtx' &&\n            lCodec.parameters && rCodec.parameters.apt) {\n          // for RTX we need to find the local rtx that has a apt\n          // which points to the same local codec as the remote one.\n          if (!rtxCapabilityMatches(lCodec, rCodec,\n              localCapabilities.codecs, remoteCapabilities.codecs)) {\n            continue;\n          }\n        }\n        rCodec = JSON.parse(JSON.stringify(rCodec)); // deepcopy\n        // number of channels is the highest common number of channels\n        rCodec.numChannels = Math.min(lCodec.numChannels,\n            rCodec.numChannels);\n        // push rCodec so we reply with offerer payload type\n        commonCapabilities.codecs.push(rCodec);\n\n        // determine common feedback mechanisms\n        rCodec.rtcpFeedback = rCodec.rtcpFeedback.filter(function(fb) {\n          for (var j = 0; j < lCodec.rtcpFeedback.length; j++) {\n            if (lCodec.rtcpFeedback[j].type === fb.type &&\n                lCodec.rtcpFeedback[j].parameter === fb.parameter) {\n              return true;\n            }\n          }\n          return false;\n        });\n        // FIXME: also need to determine .parameters\n        //  see https://github.com/openpeer/ortc/issues/569\n        break;\n      }\n    }\n  });\n\n  localCapabilities.headerExtensions.forEach(function(lHeaderExtension) {\n    for (var i = 0; i < remoteCapabilities.headerExtensions.length;\n         i++) {\n      var rHeaderExtension = remoteCapabilities.headerExtensions[i];\n      if (lHeaderExtension.uri === rHeaderExtension.uri) {\n        commonCapabilities.headerExtensions.push(rHeaderExtension);\n        break;\n      }\n    }\n  });\n\n  // FIXME: fecMechanisms\n  return commonCapabilities;\n}\n\n// is action=setLocalDescription with type allowed in signalingState\nfunction isActionAllowedInSignalingState(action, type, signalingState) {\n  return {\n    offer: {\n      setLocalDescription: ['stable', 'have-local-offer'],\n      setRemoteDescription: ['stable', 'have-remote-offer']\n    },\n    answer: {\n      setLocalDescription: ['have-remote-offer', 'have-local-pranswer'],\n      setRemoteDescription: ['have-local-offer', 'have-remote-pranswer']\n    }\n  }[type][action].indexOf(signalingState) !== -1;\n}\n\nfunction maybeAddCandidate(iceTransport, candidate) {\n  // Edge's internal representation adds some fields therefore\n  // not all fieldѕ are taken into account.\n  var alreadyAdded = iceTransport.getRemoteCandidates()\n      .find(function(remoteCandidate) {\n        return candidate.foundation === remoteCandidate.foundation &&\n            candidate.ip === remoteCandidate.ip &&\n            candidate.port === remoteCandidate.port &&\n            candidate.priority === remoteCandidate.priority &&\n            candidate.protocol === remoteCandidate.protocol &&\n            candidate.type === remoteCandidate.type;\n      });\n  if (!alreadyAdded) {\n    iceTransport.addRemoteCandidate(candidate);\n  }\n  return !alreadyAdded;\n}\n\n\nfunction makeError(name, description) {\n  var e = new Error(description);\n  e.name = name;\n  // legacy error codes from https://heycam.github.io/webidl/#idl-DOMException-error-names\n  e.code = {\n    NotSupportedError: 9,\n    InvalidStateError: 11,\n    InvalidAccessError: 15,\n    TypeError: undefined,\n    OperationError: undefined\n  }[name];\n  return e;\n}\n\nmodule.exports = function(window, edgeVersion) {\n  // https://w3c.github.io/mediacapture-main/#mediastream\n  // Helper function to add the track to the stream and\n  // dispatch the event ourselves.\n  function addTrackToStreamAndFireEvent(track, stream) {\n    stream.addTrack(track);\n    stream.dispatchEvent(new window.MediaStreamTrackEvent('addtrack',\n        {track: track}));\n  }\n\n  function removeTrackFromStreamAndFireEvent(track, stream) {\n    stream.removeTrack(track);\n    stream.dispatchEvent(new window.MediaStreamTrackEvent('removetrack',\n        {track: track}));\n  }\n\n  function fireAddTrack(pc, track, receiver, streams) {\n    var trackEvent = new Event('track');\n    trackEvent.track = track;\n    trackEvent.receiver = receiver;\n    trackEvent.transceiver = {receiver: receiver};\n    trackEvent.streams = streams;\n    window.setTimeout(function() {\n      pc._dispatchEvent('track', trackEvent);\n    });\n  }\n\n  var RTCPeerConnection = function(config) {\n    var pc = this;\n\n    var _eventTarget = document.createDocumentFragment();\n    ['addEventListener', 'removeEventListener', 'dispatchEvent']\n        .forEach(function(method) {\n          pc[method] = _eventTarget[method].bind(_eventTarget);\n        });\n\n    this.canTrickleIceCandidates = null;\n\n    this.needNegotiation = false;\n\n    this.localStreams = [];\n    this.remoteStreams = [];\n\n    this._localDescription = null;\n    this._remoteDescription = null;\n\n    this.signalingState = 'stable';\n    this.iceConnectionState = 'new';\n    this.connectionState = 'new';\n    this.iceGatheringState = 'new';\n\n    config = JSON.parse(JSON.stringify(config || {}));\n\n    this.usingBundle = config.bundlePolicy === 'max-bundle';\n    if (config.rtcpMuxPolicy === 'negotiate') {\n      throw(makeError('NotSupportedError',\n          'rtcpMuxPolicy \\'negotiate\\' is not supported'));\n    } else if (!config.rtcpMuxPolicy) {\n      config.rtcpMuxPolicy = 'require';\n    }\n\n    switch (config.iceTransportPolicy) {\n      case 'all':\n      case 'relay':\n        break;\n      default:\n        config.iceTransportPolicy = 'all';\n        break;\n    }\n\n    switch (config.bundlePolicy) {\n      case 'balanced':\n      case 'max-compat':\n      case 'max-bundle':\n        break;\n      default:\n        config.bundlePolicy = 'balanced';\n        break;\n    }\n\n    config.iceServers = filterIceServers(config.iceServers || [], edgeVersion);\n\n    this._iceGatherers = [];\n    if (config.iceCandidatePoolSize) {\n      for (var i = config.iceCandidatePoolSize; i > 0; i--) {\n        this._iceGatherers.push(new window.RTCIceGatherer({\n          iceServers: config.iceServers,\n          gatherPolicy: config.iceTransportPolicy\n        }));\n      }\n    } else {\n      config.iceCandidatePoolSize = 0;\n    }\n\n    this._config = config;\n\n    // per-track iceGathers, iceTransports, dtlsTransports, rtpSenders, ...\n    // everything that is needed to describe a SDP m-line.\n    this.transceivers = [];\n\n    this._sdpSessionId = SDPUtils.generateSessionId();\n    this._sdpSessionVersion = 0;\n\n    this._dtlsRole = undefined; // role for a=setup to use in answers.\n\n    this._isClosed = false;\n  };\n\n  Object.defineProperty(RTCPeerConnection.prototype, 'localDescription', {\n    configurable: true,\n    get: function() {\n      return this._localDescription;\n    }\n  });\n  Object.defineProperty(RTCPeerConnection.prototype, 'remoteDescription', {\n    configurable: true,\n    get: function() {\n      return this._remoteDescription;\n    }\n  });\n\n  // set up event handlers on prototype\n  RTCPeerConnection.prototype.onicecandidate = null;\n  RTCPeerConnection.prototype.onaddstream = null;\n  RTCPeerConnection.prototype.ontrack = null;\n  RTCPeerConnection.prototype.onremovestream = null;\n  RTCPeerConnection.prototype.onsignalingstatechange = null;\n  RTCPeerConnection.prototype.oniceconnectionstatechange = null;\n  RTCPeerConnection.prototype.onconnectionstatechange = null;\n  RTCPeerConnection.prototype.onicegatheringstatechange = null;\n  RTCPeerConnection.prototype.onnegotiationneeded = null;\n  RTCPeerConnection.prototype.ondatachannel = null;\n\n  RTCPeerConnection.prototype._dispatchEvent = function(name, event) {\n    if (this._isClosed) {\n      return;\n    }\n    this.dispatchEvent(event);\n    if (typeof this['on' + name] === 'function') {\n      this['on' + name](event);\n    }\n  };\n\n  RTCPeerConnection.prototype._emitGatheringStateChange = function() {\n    var event = new Event('icegatheringstatechange');\n    this._dispatchEvent('icegatheringstatechange', event);\n  };\n\n  RTCPeerConnection.prototype.getConfiguration = function() {\n    return this._config;\n  };\n\n  RTCPeerConnection.prototype.getLocalStreams = function() {\n    return this.localStreams;\n  };\n\n  RTCPeerConnection.prototype.getRemoteStreams = function() {\n    return this.remoteStreams;\n  };\n\n  // internal helper to create a transceiver object.\n  // (which is not yet the same as the WebRTC 1.0 transceiver)\n  RTCPeerConnection.prototype._createTransceiver = function(kind, doNotAdd) {\n    var hasBundleTransport = this.transceivers.length > 0;\n    var transceiver = {\n      track: null,\n      iceGatherer: null,\n      iceTransport: null,\n      dtlsTransport: null,\n      localCapabilities: null,\n      remoteCapabilities: null,\n      rtpSender: null,\n      rtpReceiver: null,\n      kind: kind,\n      mid: null,\n      sendEncodingParameters: null,\n      recvEncodingParameters: null,\n      stream: null,\n      associatedRemoteMediaStreams: [],\n      wantReceive: true\n    };\n    if (this.usingBundle && hasBundleTransport) {\n      transceiver.iceTransport = this.transceivers[0].iceTransport;\n      transceiver.dtlsTransport = this.transceivers[0].dtlsTransport;\n    } else {\n      var transports = this._createIceAndDtlsTransports();\n      transceiver.iceTransport = transports.iceTransport;\n      transceiver.dtlsTransport = transports.dtlsTransport;\n    }\n    if (!doNotAdd) {\n      this.transceivers.push(transceiver);\n    }\n    return transceiver;\n  };\n\n  RTCPeerConnection.prototype.addTrack = function(track, stream) {\n    if (this._isClosed) {\n      throw makeError('InvalidStateError',\n          'Attempted to call addTrack on a closed peerconnection.');\n    }\n\n    var alreadyExists = this.transceivers.find(function(s) {\n      return s.track === track;\n    });\n\n    if (alreadyExists) {\n      throw makeError('InvalidAccessError', 'Track already exists.');\n    }\n\n    var transceiver;\n    for (var i = 0; i < this.transceivers.length; i++) {\n      if (!this.transceivers[i].track &&\n          this.transceivers[i].kind === track.kind) {\n        transceiver = this.transceivers[i];\n      }\n    }\n    if (!transceiver) {\n      transceiver = this._createTransceiver(track.kind);\n    }\n\n    this._maybeFireNegotiationNeeded();\n\n    if (this.localStreams.indexOf(stream) === -1) {\n      this.localStreams.push(stream);\n    }\n\n    transceiver.track = track;\n    transceiver.stream = stream;\n    transceiver.rtpSender = new window.RTCRtpSender(track,\n        transceiver.dtlsTransport);\n    return transceiver.rtpSender;\n  };\n\n  RTCPeerConnection.prototype.addStream = function(stream) {\n    var pc = this;\n    if (edgeVersion >= 15025) {\n      stream.getTracks().forEach(function(track) {\n        pc.addTrack(track, stream);\n      });\n    } else {\n      // Clone is necessary for local demos mostly, attaching directly\n      // to two different senders does not work (build 10547).\n      // Fixed in 15025 (or earlier)\n      var clonedStream = stream.clone();\n      stream.getTracks().forEach(function(track, idx) {\n        var clonedTrack = clonedStream.getTracks()[idx];\n        track.addEventListener('enabled', function(event) {\n          clonedTrack.enabled = event.enabled;\n        });\n      });\n      clonedStream.getTracks().forEach(function(track) {\n        pc.addTrack(track, clonedStream);\n      });\n    }\n  };\n\n  RTCPeerConnection.prototype.removeTrack = function(sender) {\n    if (this._isClosed) {\n      throw makeError('InvalidStateError',\n          'Attempted to call removeTrack on a closed peerconnection.');\n    }\n\n    if (!(sender instanceof window.RTCRtpSender)) {\n      throw new TypeError('Argument 1 of RTCPeerConnection.removeTrack ' +\n          'does not implement interface RTCRtpSender.');\n    }\n\n    var transceiver = this.transceivers.find(function(t) {\n      return t.rtpSender === sender;\n    });\n\n    if (!transceiver) {\n      throw makeError('InvalidAccessError',\n          'Sender was not created by this connection.');\n    }\n    var stream = transceiver.stream;\n\n    transceiver.rtpSender.stop();\n    transceiver.rtpSender = null;\n    transceiver.track = null;\n    transceiver.stream = null;\n\n    // remove the stream from the set of local streams\n    var localStreams = this.transceivers.map(function(t) {\n      return t.stream;\n    });\n    if (localStreams.indexOf(stream) === -1 &&\n        this.localStreams.indexOf(stream) > -1) {\n      this.localStreams.splice(this.localStreams.indexOf(stream), 1);\n    }\n\n    this._maybeFireNegotiationNeeded();\n  };\n\n  RTCPeerConnection.prototype.removeStream = function(stream) {\n    var pc = this;\n    stream.getTracks().forEach(function(track) {\n      var sender = pc.getSenders().find(function(s) {\n        return s.track === track;\n      });\n      if (sender) {\n        pc.removeTrack(sender);\n      }\n    });\n  };\n\n  RTCPeerConnection.prototype.getSenders = function() {\n    return this.transceivers.filter(function(transceiver) {\n      return !!transceiver.rtpSender;\n    })\n    .map(function(transceiver) {\n      return transceiver.rtpSender;\n    });\n  };\n\n  RTCPeerConnection.prototype.getReceivers = function() {\n    return this.transceivers.filter(function(transceiver) {\n      return !!transceiver.rtpReceiver;\n    })\n    .map(function(transceiver) {\n      return transceiver.rtpReceiver;\n    });\n  };\n\n\n  RTCPeerConnection.prototype._createIceGatherer = function(sdpMLineIndex,\n      usingBundle) {\n    var pc = this;\n    if (usingBundle && sdpMLineIndex > 0) {\n      return this.transceivers[0].iceGatherer;\n    } else if (this._iceGatherers.length) {\n      return this._iceGatherers.shift();\n    }\n    var iceGatherer = new window.RTCIceGatherer({\n      iceServers: this._config.iceServers,\n      gatherPolicy: this._config.iceTransportPolicy\n    });\n    Object.defineProperty(iceGatherer, 'state',\n        {value: 'new', writable: true}\n    );\n\n    this.transceivers[sdpMLineIndex].bufferedCandidateEvents = [];\n    this.transceivers[sdpMLineIndex].bufferCandidates = function(event) {\n      var end = !event.candidate || Object.keys(event.candidate).length === 0;\n      // polyfill since RTCIceGatherer.state is not implemented in\n      // Edge 10547 yet.\n      iceGatherer.state = end ? 'completed' : 'gathering';\n      if (pc.transceivers[sdpMLineIndex].bufferedCandidateEvents !== null) {\n        pc.transceivers[sdpMLineIndex].bufferedCandidateEvents.push(event);\n      }\n    };\n    iceGatherer.addEventListener('localcandidate',\n      this.transceivers[sdpMLineIndex].bufferCandidates);\n    return iceGatherer;\n  };\n\n  // start gathering from an RTCIceGatherer.\n  RTCPeerConnection.prototype._gather = function(mid, sdpMLineIndex) {\n    var pc = this;\n    var iceGatherer = this.transceivers[sdpMLineIndex].iceGatherer;\n    if (iceGatherer.onlocalcandidate) {\n      return;\n    }\n    var bufferedCandidateEvents =\n      this.transceivers[sdpMLineIndex].bufferedCandidateEvents;\n    this.transceivers[sdpMLineIndex].bufferedCandidateEvents = null;\n    iceGatherer.removeEventListener('localcandidate',\n      this.transceivers[sdpMLineIndex].bufferCandidates);\n    iceGatherer.onlocalcandidate = function(evt) {\n      if (pc.usingBundle && sdpMLineIndex > 0) {\n        // if we know that we use bundle we can drop candidates with\n        // ѕdpMLineIndex > 0. If we don't do this then our state gets\n        // confused since we dispose the extra ice gatherer.\n        return;\n      }\n      var event = new Event('icecandidate');\n      event.candidate = {sdpMid: mid, sdpMLineIndex: sdpMLineIndex};\n\n      var cand = evt.candidate;\n      // Edge emits an empty object for RTCIceCandidateComplete‥\n      var end = !cand || Object.keys(cand).length === 0;\n      if (end) {\n        // polyfill since RTCIceGatherer.state is not implemented in\n        // Edge 10547 yet.\n        if (iceGatherer.state === 'new' || iceGatherer.state === 'gathering') {\n          iceGatherer.state = 'completed';\n        }\n      } else {\n        if (iceGatherer.state === 'new') {\n          iceGatherer.state = 'gathering';\n        }\n        // RTCIceCandidate doesn't have a component, needs to be added\n        cand.component = 1;\n        // also the usernameFragment. TODO: update SDP to take both variants.\n        cand.ufrag = iceGatherer.getLocalParameters().usernameFragment;\n\n        var serializedCandidate = SDPUtils.writeCandidate(cand);\n        event.candidate = Object.assign(event.candidate,\n            SDPUtils.parseCandidate(serializedCandidate));\n\n        event.candidate.candidate = serializedCandidate;\n        event.candidate.toJSON = function() {\n          return {\n            candidate: event.candidate.candidate,\n            sdpMid: event.candidate.sdpMid,\n            sdpMLineIndex: event.candidate.sdpMLineIndex,\n            usernameFragment: event.candidate.usernameFragment\n          };\n        };\n      }\n\n      // update local description.\n      var sections = SDPUtils.getMediaSections(pc._localDescription.sdp);\n      if (!end) {\n        sections[event.candidate.sdpMLineIndex] +=\n            'a=' + event.candidate.candidate + '\\r\\n';\n      } else {\n        sections[event.candidate.sdpMLineIndex] +=\n            'a=end-of-candidates\\r\\n';\n      }\n      pc._localDescription.sdp =\n          SDPUtils.getDescription(pc._localDescription.sdp) +\n          sections.join('');\n      var complete = pc.transceivers.every(function(transceiver) {\n        return transceiver.iceGatherer &&\n            transceiver.iceGatherer.state === 'completed';\n      });\n\n      if (pc.iceGatheringState !== 'gathering') {\n        pc.iceGatheringState = 'gathering';\n        pc._emitGatheringStateChange();\n      }\n\n      // Emit candidate. Also emit null candidate when all gatherers are\n      // complete.\n      if (!end) {\n        pc._dispatchEvent('icecandidate', event);\n      }\n      if (complete) {\n        pc._dispatchEvent('icecandidate', new Event('icecandidate'));\n        pc.iceGatheringState = 'complete';\n        pc._emitGatheringStateChange();\n      }\n    };\n\n    // emit already gathered candidates.\n    window.setTimeout(function() {\n      bufferedCandidateEvents.forEach(function(e) {\n        iceGatherer.onlocalcandidate(e);\n      });\n    }, 0);\n  };\n\n  // Create ICE transport and DTLS transport.\n  RTCPeerConnection.prototype._createIceAndDtlsTransports = function() {\n    var pc = this;\n    var iceTransport = new window.RTCIceTransport(null);\n    iceTransport.onicestatechange = function() {\n      pc._updateIceConnectionState();\n      pc._updateConnectionState();\n    };\n\n    var dtlsTransport = new window.RTCDtlsTransport(iceTransport);\n    dtlsTransport.ondtlsstatechange = function() {\n      pc._updateConnectionState();\n    };\n    dtlsTransport.onerror = function() {\n      // onerror does not set state to failed by itself.\n      Object.defineProperty(dtlsTransport, 'state',\n          {value: 'failed', writable: true});\n      pc._updateConnectionState();\n    };\n\n    return {\n      iceTransport: iceTransport,\n      dtlsTransport: dtlsTransport\n    };\n  };\n\n  // Destroy ICE gatherer, ICE transport and DTLS transport.\n  // Without triggering the callbacks.\n  RTCPeerConnection.prototype._disposeIceAndDtlsTransports = function(\n      sdpMLineIndex) {\n    var iceGatherer = this.transceivers[sdpMLineIndex].iceGatherer;\n    if (iceGatherer) {\n      delete iceGatherer.onlocalcandidate;\n      delete this.transceivers[sdpMLineIndex].iceGatherer;\n    }\n    var iceTransport = this.transceivers[sdpMLineIndex].iceTransport;\n    if (iceTransport) {\n      delete iceTransport.onicestatechange;\n      delete this.transceivers[sdpMLineIndex].iceTransport;\n    }\n    var dtlsTransport = this.transceivers[sdpMLineIndex].dtlsTransport;\n    if (dtlsTransport) {\n      delete dtlsTransport.ondtlsstatechange;\n      delete dtlsTransport.onerror;\n      delete this.transceivers[sdpMLineIndex].dtlsTransport;\n    }\n  };\n\n  // Start the RTP Sender and Receiver for a transceiver.\n  RTCPeerConnection.prototype._transceive = function(transceiver,\n      send, recv) {\n    var params = getCommonCapabilities(transceiver.localCapabilities,\n        transceiver.remoteCapabilities);\n    if (send && transceiver.rtpSender) {\n      params.encodings = transceiver.sendEncodingParameters;\n      params.rtcp = {\n        cname: SDPUtils.localCName,\n        compound: transceiver.rtcpParameters.compound\n      };\n      if (transceiver.recvEncodingParameters.length) {\n        params.rtcp.ssrc = transceiver.recvEncodingParameters[0].ssrc;\n      }\n      transceiver.rtpSender.send(params);\n    }\n    if (recv && transceiver.rtpReceiver && params.codecs.length > 0) {\n      // remove RTX field in Edge 14942\n      if (transceiver.kind === 'video'\n          && transceiver.recvEncodingParameters\n          && edgeVersion < 15019) {\n        transceiver.recvEncodingParameters.forEach(function(p) {\n          delete p.rtx;\n        });\n      }\n      if (transceiver.recvEncodingParameters.length) {\n        params.encodings = transceiver.recvEncodingParameters;\n      } else {\n        params.encodings = [{}];\n      }\n      params.rtcp = {\n        compound: transceiver.rtcpParameters.compound\n      };\n      if (transceiver.rtcpParameters.cname) {\n        params.rtcp.cname = transceiver.rtcpParameters.cname;\n      }\n      if (transceiver.sendEncodingParameters.length) {\n        params.rtcp.ssrc = transceiver.sendEncodingParameters[0].ssrc;\n      }\n      transceiver.rtpReceiver.receive(params);\n    }\n  };\n\n  RTCPeerConnection.prototype.setLocalDescription = function(description) {\n    var pc = this;\n\n    // Note: pranswer is not supported.\n    if (['offer', 'answer'].indexOf(description.type) === -1) {\n      return Promise.reject(makeError('TypeError',\n          'Unsupported type \"' + description.type + '\"'));\n    }\n\n    if (!isActionAllowedInSignalingState('setLocalDescription',\n        description.type, pc.signalingState) || pc._isClosed) {\n      return Promise.reject(makeError('InvalidStateError',\n          'Can not set local ' + description.type +\n          ' in state ' + pc.signalingState));\n    }\n\n    var sections;\n    var sessionpart;\n    if (description.type === 'offer') {\n      // VERY limited support for SDP munging. Limited to:\n      // * changing the order of codecs\n      sections = SDPUtils.splitSections(description.sdp);\n      sessionpart = sections.shift();\n      sections.forEach(function(mediaSection, sdpMLineIndex) {\n        var caps = SDPUtils.parseRtpParameters(mediaSection);\n        pc.transceivers[sdpMLineIndex].localCapabilities = caps;\n      });\n\n      pc.transceivers.forEach(function(transceiver, sdpMLineIndex) {\n        pc._gather(transceiver.mid, sdpMLineIndex);\n      });\n    } else if (description.type === 'answer') {\n      sections = SDPUtils.splitSections(pc._remoteDescription.sdp);\n      sessionpart = sections.shift();\n      var isIceLite = SDPUtils.matchPrefix(sessionpart,\n          'a=ice-lite').length > 0;\n      sections.forEach(function(mediaSection, sdpMLineIndex) {\n        var transceiver = pc.transceivers[sdpMLineIndex];\n        var iceGatherer = transceiver.iceGatherer;\n        var iceTransport = transceiver.iceTransport;\n        var dtlsTransport = transceiver.dtlsTransport;\n        var localCapabilities = transceiver.localCapabilities;\n        var remoteCapabilities = transceiver.remoteCapabilities;\n\n        // treat bundle-only as not-rejected.\n        var rejected = SDPUtils.isRejected(mediaSection) &&\n            SDPUtils.matchPrefix(mediaSection, 'a=bundle-only').length === 0;\n\n        if (!rejected && !transceiver.rejected) {\n          var remoteIceParameters = SDPUtils.getIceParameters(\n              mediaSection, sessionpart);\n          var remoteDtlsParameters = SDPUtils.getDtlsParameters(\n              mediaSection, sessionpart);\n          if (isIceLite) {\n            remoteDtlsParameters.role = 'server';\n          }\n\n          if (!pc.usingBundle || sdpMLineIndex === 0) {\n            pc._gather(transceiver.mid, sdpMLineIndex);\n            if (iceTransport.state === 'new') {\n              iceTransport.start(iceGatherer, remoteIceParameters,\n                  isIceLite ? 'controlling' : 'controlled');\n            }\n            if (dtlsTransport.state === 'new') {\n              dtlsTransport.start(remoteDtlsParameters);\n            }\n          }\n\n          // Calculate intersection of capabilities.\n          var params = getCommonCapabilities(localCapabilities,\n              remoteCapabilities);\n\n          // Start the RTCRtpSender. The RTCRtpReceiver for this\n          // transceiver has already been started in setRemoteDescription.\n          pc._transceive(transceiver,\n              params.codecs.length > 0,\n              false);\n        }\n      });\n    }\n\n    pc._localDescription = {\n      type: description.type,\n      sdp: description.sdp\n    };\n    if (description.type === 'offer') {\n      pc._updateSignalingState('have-local-offer');\n    } else {\n      pc._updateSignalingState('stable');\n    }\n\n    return Promise.resolve();\n  };\n\n  RTCPeerConnection.prototype.setRemoteDescription = function(description) {\n    var pc = this;\n\n    // Note: pranswer is not supported.\n    if (['offer', 'answer'].indexOf(description.type) === -1) {\n      return Promise.reject(makeError('TypeError',\n          'Unsupported type \"' + description.type + '\"'));\n    }\n\n    if (!isActionAllowedInSignalingState('setRemoteDescription',\n        description.type, pc.signalingState) || pc._isClosed) {\n      return Promise.reject(makeError('InvalidStateError',\n          'Can not set remote ' + description.type +\n          ' in state ' + pc.signalingState));\n    }\n\n    var streams = {};\n    pc.remoteStreams.forEach(function(stream) {\n      streams[stream.id] = stream;\n    });\n    var receiverList = [];\n    var sections = SDPUtils.splitSections(description.sdp);\n    var sessionpart = sections.shift();\n    var isIceLite = SDPUtils.matchPrefix(sessionpart,\n        'a=ice-lite').length > 0;\n    var usingBundle = SDPUtils.matchPrefix(sessionpart,\n        'a=group:BUNDLE ').length > 0;\n    pc.usingBundle = usingBundle;\n    var iceOptions = SDPUtils.matchPrefix(sessionpart,\n        'a=ice-options:')[0];\n    if (iceOptions) {\n      pc.canTrickleIceCandidates = iceOptions.substr(14).split(' ')\n          .indexOf('trickle') >= 0;\n    } else {\n      pc.canTrickleIceCandidates = false;\n    }\n\n    sections.forEach(function(mediaSection, sdpMLineIndex) {\n      var lines = SDPUtils.splitLines(mediaSection);\n      var kind = SDPUtils.getKind(mediaSection);\n      // treat bundle-only as not-rejected.\n      var rejected = SDPUtils.isRejected(mediaSection) &&\n          SDPUtils.matchPrefix(mediaSection, 'a=bundle-only').length === 0;\n      var protocol = lines[0].substr(2).split(' ')[2];\n\n      var direction = SDPUtils.getDirection(mediaSection, sessionpart);\n      var remoteMsid = SDPUtils.parseMsid(mediaSection);\n\n      var mid = SDPUtils.getMid(mediaSection) || SDPUtils.generateIdentifier();\n\n      // Reject datachannels which are not implemented yet.\n      if (rejected || (kind === 'application' && (protocol === 'DTLS/SCTP' ||\n          protocol === 'UDP/DTLS/SCTP'))) {\n        // TODO: this is dangerous in the case where a non-rejected m-line\n        //     becomes rejected.\n        pc.transceivers[sdpMLineIndex] = {\n          mid: mid,\n          kind: kind,\n          protocol: protocol,\n          rejected: true\n        };\n        return;\n      }\n\n      if (!rejected && pc.transceivers[sdpMLineIndex] &&\n          pc.transceivers[sdpMLineIndex].rejected) {\n        // recycle a rejected transceiver.\n        pc.transceivers[sdpMLineIndex] = pc._createTransceiver(kind, true);\n      }\n\n      var transceiver;\n      var iceGatherer;\n      var iceTransport;\n      var dtlsTransport;\n      var rtpReceiver;\n      var sendEncodingParameters;\n      var recvEncodingParameters;\n      var localCapabilities;\n\n      var track;\n      // FIXME: ensure the mediaSection has rtcp-mux set.\n      var remoteCapabilities = SDPUtils.parseRtpParameters(mediaSection);\n      var remoteIceParameters;\n      var remoteDtlsParameters;\n      if (!rejected) {\n        remoteIceParameters = SDPUtils.getIceParameters(mediaSection,\n            sessionpart);\n        remoteDtlsParameters = SDPUtils.getDtlsParameters(mediaSection,\n            sessionpart);\n        remoteDtlsParameters.role = 'client';\n      }\n      recvEncodingParameters =\n          SDPUtils.parseRtpEncodingParameters(mediaSection);\n\n      var rtcpParameters = SDPUtils.parseRtcpParameters(mediaSection);\n\n      var isComplete = SDPUtils.matchPrefix(mediaSection,\n          'a=end-of-candidates', sessionpart).length > 0;\n      var cands = SDPUtils.matchPrefix(mediaSection, 'a=candidate:')\n          .map(function(cand) {\n            return SDPUtils.parseCandidate(cand);\n          })\n          .filter(function(cand) {\n            return cand.component === 1;\n          });\n\n      // Check if we can use BUNDLE and dispose transports.\n      if ((description.type === 'offer' || description.type === 'answer') &&\n          !rejected && usingBundle && sdpMLineIndex > 0 &&\n          pc.transceivers[sdpMLineIndex]) {\n        pc._disposeIceAndDtlsTransports(sdpMLineIndex);\n        pc.transceivers[sdpMLineIndex].iceGatherer =\n            pc.transceivers[0].iceGatherer;\n        pc.transceivers[sdpMLineIndex].iceTransport =\n            pc.transceivers[0].iceTransport;\n        pc.transceivers[sdpMLineIndex].dtlsTransport =\n            pc.transceivers[0].dtlsTransport;\n        if (pc.transceivers[sdpMLineIndex].rtpSender) {\n          pc.transceivers[sdpMLineIndex].rtpSender.setTransport(\n              pc.transceivers[0].dtlsTransport);\n        }\n        if (pc.transceivers[sdpMLineIndex].rtpReceiver) {\n          pc.transceivers[sdpMLineIndex].rtpReceiver.setTransport(\n              pc.transceivers[0].dtlsTransport);\n        }\n      }\n      if (description.type === 'offer' && !rejected) {\n        transceiver = pc.transceivers[sdpMLineIndex] ||\n            pc._createTransceiver(kind);\n        transceiver.mid = mid;\n\n        if (!transceiver.iceGatherer) {\n          transceiver.iceGatherer = pc._createIceGatherer(sdpMLineIndex,\n              usingBundle);\n        }\n\n        if (cands.length && transceiver.iceTransport.state === 'new') {\n          if (isComplete && (!usingBundle || sdpMLineIndex === 0)) {\n            transceiver.iceTransport.setRemoteCandidates(cands);\n          } else {\n            cands.forEach(function(candidate) {\n              maybeAddCandidate(transceiver.iceTransport, candidate);\n            });\n          }\n        }\n\n        localCapabilities = window.RTCRtpReceiver.getCapabilities(kind);\n\n        // filter RTX until additional stuff needed for RTX is implemented\n        // in adapter.js\n        if (edgeVersion < 15019) {\n          localCapabilities.codecs = localCapabilities.codecs.filter(\n              function(codec) {\n                return codec.name !== 'rtx';\n              });\n        }\n\n        sendEncodingParameters = transceiver.sendEncodingParameters || [{\n          ssrc: (2 * sdpMLineIndex + 2) * 1001\n        }];\n\n        // TODO: rewrite to use http://w3c.github.io/webrtc-pc/#set-associated-remote-streams\n        var isNewTrack = false;\n        if (direction === 'sendrecv' || direction === 'sendonly') {\n          isNewTrack = !transceiver.rtpReceiver;\n          rtpReceiver = transceiver.rtpReceiver ||\n              new window.RTCRtpReceiver(transceiver.dtlsTransport, kind);\n\n          if (isNewTrack) {\n            var stream;\n            track = rtpReceiver.track;\n            // FIXME: does not work with Plan B.\n            if (remoteMsid && remoteMsid.stream === '-') {\n              // no-op. a stream id of '-' means: no associated stream.\n            } else if (remoteMsid) {\n              if (!streams[remoteMsid.stream]) {\n                streams[remoteMsid.stream] = new window.MediaStream();\n                Object.defineProperty(streams[remoteMsid.stream], 'id', {\n                  get: function() {\n                    return remoteMsid.stream;\n                  }\n                });\n              }\n              Object.defineProperty(track, 'id', {\n                get: function() {\n                  return remoteMsid.track;\n                }\n              });\n              stream = streams[remoteMsid.stream];\n            } else {\n              if (!streams.default) {\n                streams.default = new window.MediaStream();\n              }\n              stream = streams.default;\n            }\n            if (stream) {\n              addTrackToStreamAndFireEvent(track, stream);\n              transceiver.associatedRemoteMediaStreams.push(stream);\n            }\n            receiverList.push([track, rtpReceiver, stream]);\n          }\n        } else if (transceiver.rtpReceiver && transceiver.rtpReceiver.track) {\n          transceiver.associatedRemoteMediaStreams.forEach(function(s) {\n            var nativeTrack = s.getTracks().find(function(t) {\n              return t.id === transceiver.rtpReceiver.track.id;\n            });\n            if (nativeTrack) {\n              removeTrackFromStreamAndFireEvent(nativeTrack, s);\n            }\n          });\n          transceiver.associatedRemoteMediaStreams = [];\n        }\n\n        transceiver.localCapabilities = localCapabilities;\n        transceiver.remoteCapabilities = remoteCapabilities;\n        transceiver.rtpReceiver = rtpReceiver;\n        transceiver.rtcpParameters = rtcpParameters;\n        transceiver.sendEncodingParameters = sendEncodingParameters;\n        transceiver.recvEncodingParameters = recvEncodingParameters;\n\n        // Start the RTCRtpReceiver now. The RTPSender is started in\n        // setLocalDescription.\n        pc._transceive(pc.transceivers[sdpMLineIndex],\n            false,\n            isNewTrack);\n      } else if (description.type === 'answer' && !rejected) {\n        transceiver = pc.transceivers[sdpMLineIndex];\n        iceGatherer = transceiver.iceGatherer;\n        iceTransport = transceiver.iceTransport;\n        dtlsTransport = transceiver.dtlsTransport;\n        rtpReceiver = transceiver.rtpReceiver;\n        sendEncodingParameters = transceiver.sendEncodingParameters;\n        localCapabilities = transceiver.localCapabilities;\n\n        pc.transceivers[sdpMLineIndex].recvEncodingParameters =\n            recvEncodingParameters;\n        pc.transceivers[sdpMLineIndex].remoteCapabilities =\n            remoteCapabilities;\n        pc.transceivers[sdpMLineIndex].rtcpParameters = rtcpParameters;\n\n        if (cands.length && iceTransport.state === 'new') {\n          if ((isIceLite || isComplete) &&\n              (!usingBundle || sdpMLineIndex === 0)) {\n            iceTransport.setRemoteCandidates(cands);\n          } else {\n            cands.forEach(function(candidate) {\n              maybeAddCandidate(transceiver.iceTransport, candidate);\n            });\n          }\n        }\n\n        if (!usingBundle || sdpMLineIndex === 0) {\n          if (iceTransport.state === 'new') {\n            iceTransport.start(iceGatherer, remoteIceParameters,\n                'controlling');\n          }\n          if (dtlsTransport.state === 'new') {\n            dtlsTransport.start(remoteDtlsParameters);\n          }\n        }\n\n        // If the offer contained RTX but the answer did not,\n        // remove RTX from sendEncodingParameters.\n        var commonCapabilities = getCommonCapabilities(\n          transceiver.localCapabilities,\n          transceiver.remoteCapabilities);\n\n        var hasRtx = commonCapabilities.codecs.filter(function(c) {\n          return c.name.toLowerCase() === 'rtx';\n        }).length;\n        if (!hasRtx && transceiver.sendEncodingParameters[0].rtx) {\n          delete transceiver.sendEncodingParameters[0].rtx;\n        }\n\n        pc._transceive(transceiver,\n            direction === 'sendrecv' || direction === 'recvonly',\n            direction === 'sendrecv' || direction === 'sendonly');\n\n        // TODO: rewrite to use http://w3c.github.io/webrtc-pc/#set-associated-remote-streams\n        if (rtpReceiver &&\n            (direction === 'sendrecv' || direction === 'sendonly')) {\n          track = rtpReceiver.track;\n          if (remoteMsid) {\n            if (!streams[remoteMsid.stream]) {\n              streams[remoteMsid.stream] = new window.MediaStream();\n            }\n            addTrackToStreamAndFireEvent(track, streams[remoteMsid.stream]);\n            receiverList.push([track, rtpReceiver, streams[remoteMsid.stream]]);\n          } else {\n            if (!streams.default) {\n              streams.default = new window.MediaStream();\n            }\n            addTrackToStreamAndFireEvent(track, streams.default);\n            receiverList.push([track, rtpReceiver, streams.default]);\n          }\n        } else {\n          // FIXME: actually the receiver should be created later.\n          delete transceiver.rtpReceiver;\n        }\n      }\n    });\n\n    if (pc._dtlsRole === undefined) {\n      pc._dtlsRole = description.type === 'offer' ? 'active' : 'passive';\n    }\n\n    pc._remoteDescription = {\n      type: description.type,\n      sdp: description.sdp\n    };\n    if (description.type === 'offer') {\n      pc._updateSignalingState('have-remote-offer');\n    } else {\n      pc._updateSignalingState('stable');\n    }\n    Object.keys(streams).forEach(function(sid) {\n      var stream = streams[sid];\n      if (stream.getTracks().length) {\n        if (pc.remoteStreams.indexOf(stream) === -1) {\n          pc.remoteStreams.push(stream);\n          var event = new Event('addstream');\n          event.stream = stream;\n          window.setTimeout(function() {\n            pc._dispatchEvent('addstream', event);\n          });\n        }\n\n        receiverList.forEach(function(item) {\n          var track = item[0];\n          var receiver = item[1];\n          if (stream.id !== item[2].id) {\n            return;\n          }\n          fireAddTrack(pc, track, receiver, [stream]);\n        });\n      }\n    });\n    receiverList.forEach(function(item) {\n      if (item[2]) {\n        return;\n      }\n      fireAddTrack(pc, item[0], item[1], []);\n    });\n\n    // check whether addIceCandidate({}) was called within four seconds after\n    // setRemoteDescription.\n    window.setTimeout(function() {\n      if (!(pc && pc.transceivers)) {\n        return;\n      }\n      pc.transceivers.forEach(function(transceiver) {\n        if (transceiver.iceTransport &&\n            transceiver.iceTransport.state === 'new' &&\n            transceiver.iceTransport.getRemoteCandidates().length > 0) {\n          console.warn('Timeout for addRemoteCandidate. Consider sending ' +\n              'an end-of-candidates notification');\n          transceiver.iceTransport.addRemoteCandidate({});\n        }\n      });\n    }, 4000);\n\n    return Promise.resolve();\n  };\n\n  RTCPeerConnection.prototype.close = function() {\n    this.transceivers.forEach(function(transceiver) {\n      /* not yet\n      if (transceiver.iceGatherer) {\n        transceiver.iceGatherer.close();\n      }\n      */\n      if (transceiver.iceTransport) {\n        transceiver.iceTransport.stop();\n      }\n      if (transceiver.dtlsTransport) {\n        transceiver.dtlsTransport.stop();\n      }\n      if (transceiver.rtpSender) {\n        transceiver.rtpSender.stop();\n      }\n      if (transceiver.rtpReceiver) {\n        transceiver.rtpReceiver.stop();\n      }\n    });\n    // FIXME: clean up tracks, local streams, remote streams, etc\n    this._isClosed = true;\n    this._updateSignalingState('closed');\n  };\n\n  // Update the signaling state.\n  RTCPeerConnection.prototype._updateSignalingState = function(newState) {\n    this.signalingState = newState;\n    var event = new Event('signalingstatechange');\n    this._dispatchEvent('signalingstatechange', event);\n  };\n\n  // Determine whether to fire the negotiationneeded event.\n  RTCPeerConnection.prototype._maybeFireNegotiationNeeded = function() {\n    var pc = this;\n    if (this.signalingState !== 'stable' || this.needNegotiation === true) {\n      return;\n    }\n    this.needNegotiation = true;\n    window.setTimeout(function() {\n      if (pc.needNegotiation) {\n        pc.needNegotiation = false;\n        var event = new Event('negotiationneeded');\n        pc._dispatchEvent('negotiationneeded', event);\n      }\n    }, 0);\n  };\n\n  // Update the ice connection state.\n  RTCPeerConnection.prototype._updateIceConnectionState = function() {\n    var newState;\n    var states = {\n      'new': 0,\n      closed: 0,\n      checking: 0,\n      connected: 0,\n      completed: 0,\n      disconnected: 0,\n      failed: 0\n    };\n    this.transceivers.forEach(function(transceiver) {\n      if (transceiver.iceTransport && !transceiver.rejected) {\n        states[transceiver.iceTransport.state]++;\n      }\n    });\n\n    newState = 'new';\n    if (states.failed > 0) {\n      newState = 'failed';\n    } else if (states.checking > 0) {\n      newState = 'checking';\n    } else if (states.disconnected > 0) {\n      newState = 'disconnected';\n    } else if (states.new > 0) {\n      newState = 'new';\n    } else if (states.connected > 0) {\n      newState = 'connected';\n    } else if (states.completed > 0) {\n      newState = 'completed';\n    }\n\n    if (newState !== this.iceConnectionState) {\n      this.iceConnectionState = newState;\n      var event = new Event('iceconnectionstatechange');\n      this._dispatchEvent('iceconnectionstatechange', event);\n    }\n  };\n\n  // Update the connection state.\n  RTCPeerConnection.prototype._updateConnectionState = function() {\n    var newState;\n    var states = {\n      'new': 0,\n      closed: 0,\n      connecting: 0,\n      connected: 0,\n      completed: 0,\n      disconnected: 0,\n      failed: 0\n    };\n    this.transceivers.forEach(function(transceiver) {\n      if (transceiver.iceTransport && transceiver.dtlsTransport &&\n          !transceiver.rejected) {\n        states[transceiver.iceTransport.state]++;\n        states[transceiver.dtlsTransport.state]++;\n      }\n    });\n    // ICETransport.completed and connected are the same for this purpose.\n    states.connected += states.completed;\n\n    newState = 'new';\n    if (states.failed > 0) {\n      newState = 'failed';\n    } else if (states.connecting > 0) {\n      newState = 'connecting';\n    } else if (states.disconnected > 0) {\n      newState = 'disconnected';\n    } else if (states.new > 0) {\n      newState = 'new';\n    } else if (states.connected > 0) {\n      newState = 'connected';\n    }\n\n    if (newState !== this.connectionState) {\n      this.connectionState = newState;\n      var event = new Event('connectionstatechange');\n      this._dispatchEvent('connectionstatechange', event);\n    }\n  };\n\n  RTCPeerConnection.prototype.createOffer = function() {\n    var pc = this;\n\n    if (pc._isClosed) {\n      return Promise.reject(makeError('InvalidStateError',\n          'Can not call createOffer after close'));\n    }\n\n    var numAudioTracks = pc.transceivers.filter(function(t) {\n      return t.kind === 'audio';\n    }).length;\n    var numVideoTracks = pc.transceivers.filter(function(t) {\n      return t.kind === 'video';\n    }).length;\n\n    // Determine number of audio and video tracks we need to send/recv.\n    var offerOptions = arguments[0];\n    if (offerOptions) {\n      // Reject Chrome legacy constraints.\n      if (offerOptions.mandatory || offerOptions.optional) {\n        throw new TypeError(\n            'Legacy mandatory/optional constraints not supported.');\n      }\n      if (offerOptions.offerToReceiveAudio !== undefined) {\n        if (offerOptions.offerToReceiveAudio === true) {\n          numAudioTracks = 1;\n        } else if (offerOptions.offerToReceiveAudio === false) {\n          numAudioTracks = 0;\n        } else {\n          numAudioTracks = offerOptions.offerToReceiveAudio;\n        }\n      }\n      if (offerOptions.offerToReceiveVideo !== undefined) {\n        if (offerOptions.offerToReceiveVideo === true) {\n          numVideoTracks = 1;\n        } else if (offerOptions.offerToReceiveVideo === false) {\n          numVideoTracks = 0;\n        } else {\n          numVideoTracks = offerOptions.offerToReceiveVideo;\n        }\n      }\n    }\n\n    pc.transceivers.forEach(function(transceiver) {\n      if (transceiver.kind === 'audio') {\n        numAudioTracks--;\n        if (numAudioTracks < 0) {\n          transceiver.wantReceive = false;\n        }\n      } else if (transceiver.kind === 'video') {\n        numVideoTracks--;\n        if (numVideoTracks < 0) {\n          transceiver.wantReceive = false;\n        }\n      }\n    });\n\n    // Create M-lines for recvonly streams.\n    while (numAudioTracks > 0 || numVideoTracks > 0) {\n      if (numAudioTracks > 0) {\n        pc._createTransceiver('audio');\n        numAudioTracks--;\n      }\n      if (numVideoTracks > 0) {\n        pc._createTransceiver('video');\n        numVideoTracks--;\n      }\n    }\n\n    var sdp = SDPUtils.writeSessionBoilerplate(pc._sdpSessionId,\n        pc._sdpSessionVersion++);\n    pc.transceivers.forEach(function(transceiver, sdpMLineIndex) {\n      // For each track, create an ice gatherer, ice transport,\n      // dtls transport, potentially rtpsender and rtpreceiver.\n      var track = transceiver.track;\n      var kind = transceiver.kind;\n      var mid = transceiver.mid || SDPUtils.generateIdentifier();\n      transceiver.mid = mid;\n\n      if (!transceiver.iceGatherer) {\n        transceiver.iceGatherer = pc._createIceGatherer(sdpMLineIndex,\n            pc.usingBundle);\n      }\n\n      var localCapabilities = window.RTCRtpSender.getCapabilities(kind);\n      // filter RTX until additional stuff needed for RTX is implemented\n      // in adapter.js\n      if (edgeVersion < 15019) {\n        localCapabilities.codecs = localCapabilities.codecs.filter(\n            function(codec) {\n              return codec.name !== 'rtx';\n            });\n      }\n      localCapabilities.codecs.forEach(function(codec) {\n        // work around https://bugs.chromium.org/p/webrtc/issues/detail?id=6552\n        // by adding level-asymmetry-allowed=1\n        if (codec.name === 'H264' &&\n            codec.parameters['level-asymmetry-allowed'] === undefined) {\n          codec.parameters['level-asymmetry-allowed'] = '1';\n        }\n\n        // for subsequent offers, we might have to re-use the payload\n        // type of the last offer.\n        if (transceiver.remoteCapabilities &&\n            transceiver.remoteCapabilities.codecs) {\n          transceiver.remoteCapabilities.codecs.forEach(function(remoteCodec) {\n            if (codec.name.toLowerCase() === remoteCodec.name.toLowerCase() &&\n                codec.clockRate === remoteCodec.clockRate) {\n              codec.preferredPayloadType = remoteCodec.payloadType;\n            }\n          });\n        }\n      });\n      localCapabilities.headerExtensions.forEach(function(hdrExt) {\n        var remoteExtensions = transceiver.remoteCapabilities &&\n            transceiver.remoteCapabilities.headerExtensions || [];\n        remoteExtensions.forEach(function(rHdrExt) {\n          if (hdrExt.uri === rHdrExt.uri) {\n            hdrExt.id = rHdrExt.id;\n          }\n        });\n      });\n\n      // generate an ssrc now, to be used later in rtpSender.send\n      var sendEncodingParameters = transceiver.sendEncodingParameters || [{\n        ssrc: (2 * sdpMLineIndex + 1) * 1001\n      }];\n      if (track) {\n        // add RTX\n        if (edgeVersion >= 15019 && kind === 'video' &&\n            !sendEncodingParameters[0].rtx) {\n          sendEncodingParameters[0].rtx = {\n            ssrc: sendEncodingParameters[0].ssrc + 1\n          };\n        }\n      }\n\n      if (transceiver.wantReceive) {\n        transceiver.rtpReceiver = new window.RTCRtpReceiver(\n            transceiver.dtlsTransport, kind);\n      }\n\n      transceiver.localCapabilities = localCapabilities;\n      transceiver.sendEncodingParameters = sendEncodingParameters;\n    });\n\n    // always offer BUNDLE and dispose on return if not supported.\n    if (pc._config.bundlePolicy !== 'max-compat') {\n      sdp += 'a=group:BUNDLE ' + pc.transceivers.map(function(t) {\n        return t.mid;\n      }).join(' ') + '\\r\\n';\n    }\n    sdp += 'a=ice-options:trickle\\r\\n';\n\n    pc.transceivers.forEach(function(transceiver, sdpMLineIndex) {\n      sdp += writeMediaSection(transceiver, transceiver.localCapabilities,\n          'offer', transceiver.stream, pc._dtlsRole);\n      sdp += 'a=rtcp-rsize\\r\\n';\n\n      if (transceiver.iceGatherer && pc.iceGatheringState !== 'new' &&\n          (sdpMLineIndex === 0 || !pc.usingBundle)) {\n        transceiver.iceGatherer.getLocalCandidates().forEach(function(cand) {\n          cand.component = 1;\n          sdp += 'a=' + SDPUtils.writeCandidate(cand) + '\\r\\n';\n        });\n\n        if (transceiver.iceGatherer.state === 'completed') {\n          sdp += 'a=end-of-candidates\\r\\n';\n        }\n      }\n    });\n\n    var desc = new window.RTCSessionDescription({\n      type: 'offer',\n      sdp: sdp\n    });\n    return Promise.resolve(desc);\n  };\n\n  RTCPeerConnection.prototype.createAnswer = function() {\n    var pc = this;\n\n    if (pc._isClosed) {\n      return Promise.reject(makeError('InvalidStateError',\n          'Can not call createAnswer after close'));\n    }\n\n    if (!(pc.signalingState === 'have-remote-offer' ||\n        pc.signalingState === 'have-local-pranswer')) {\n      return Promise.reject(makeError('InvalidStateError',\n          'Can not call createAnswer in signalingState ' + pc.signalingState));\n    }\n\n    var sdp = SDPUtils.writeSessionBoilerplate(pc._sdpSessionId,\n        pc._sdpSessionVersion++);\n    if (pc.usingBundle) {\n      sdp += 'a=group:BUNDLE ' + pc.transceivers.map(function(t) {\n        return t.mid;\n      }).join(' ') + '\\r\\n';\n    }\n    sdp += 'a=ice-options:trickle\\r\\n';\n\n    var mediaSectionsInOffer = SDPUtils.getMediaSections(\n        pc._remoteDescription.sdp).length;\n    pc.transceivers.forEach(function(transceiver, sdpMLineIndex) {\n      if (sdpMLineIndex + 1 > mediaSectionsInOffer) {\n        return;\n      }\n      if (transceiver.rejected) {\n        if (transceiver.kind === 'application') {\n          if (transceiver.protocol === 'DTLS/SCTP') { // legacy fmt\n            sdp += 'm=application 0 DTLS/SCTP 5000\\r\\n';\n          } else {\n            sdp += 'm=application 0 ' + transceiver.protocol +\n                ' webrtc-datachannel\\r\\n';\n          }\n        } else if (transceiver.kind === 'audio') {\n          sdp += 'm=audio 0 UDP/TLS/RTP/SAVPF 0\\r\\n' +\n              'a=rtpmap:0 PCMU/8000\\r\\n';\n        } else if (transceiver.kind === 'video') {\n          sdp += 'm=video 0 UDP/TLS/RTP/SAVPF 120\\r\\n' +\n              'a=rtpmap:120 VP8/90000\\r\\n';\n        }\n        sdp += 'c=IN IP4 0.0.0.0\\r\\n' +\n            'a=inactive\\r\\n' +\n            'a=mid:' + transceiver.mid + '\\r\\n';\n        return;\n      }\n\n      // FIXME: look at direction.\n      if (transceiver.stream) {\n        var localTrack;\n        if (transceiver.kind === 'audio') {\n          localTrack = transceiver.stream.getAudioTracks()[0];\n        } else if (transceiver.kind === 'video') {\n          localTrack = transceiver.stream.getVideoTracks()[0];\n        }\n        if (localTrack) {\n          // add RTX\n          if (edgeVersion >= 15019 && transceiver.kind === 'video' &&\n              !transceiver.sendEncodingParameters[0].rtx) {\n            transceiver.sendEncodingParameters[0].rtx = {\n              ssrc: transceiver.sendEncodingParameters[0].ssrc + 1\n            };\n          }\n        }\n      }\n\n      // Calculate intersection of capabilities.\n      var commonCapabilities = getCommonCapabilities(\n          transceiver.localCapabilities,\n          transceiver.remoteCapabilities);\n\n      var hasRtx = commonCapabilities.codecs.filter(function(c) {\n        return c.name.toLowerCase() === 'rtx';\n      }).length;\n      if (!hasRtx && transceiver.sendEncodingParameters[0].rtx) {\n        delete transceiver.sendEncodingParameters[0].rtx;\n      }\n\n      sdp += writeMediaSection(transceiver, commonCapabilities,\n          'answer', transceiver.stream, pc._dtlsRole);\n      if (transceiver.rtcpParameters &&\n          transceiver.rtcpParameters.reducedSize) {\n        sdp += 'a=rtcp-rsize\\r\\n';\n      }\n    });\n\n    var desc = new window.RTCSessionDescription({\n      type: 'answer',\n      sdp: sdp\n    });\n    return Promise.resolve(desc);\n  };\n\n  RTCPeerConnection.prototype.addIceCandidate = function(candidate) {\n    var pc = this;\n    var sections;\n    if (candidate && !(candidate.sdpMLineIndex !== undefined ||\n        candidate.sdpMid)) {\n      return Promise.reject(new TypeError('sdpMLineIndex or sdpMid required'));\n    }\n\n    // TODO: needs to go into ops queue.\n    return new Promise(function(resolve, reject) {\n      if (!pc._remoteDescription) {\n        return reject(makeError('InvalidStateError',\n            'Can not add ICE candidate without a remote description'));\n      } else if (!candidate || candidate.candidate === '') {\n        for (var j = 0; j < pc.transceivers.length; j++) {\n          if (pc.transceivers[j].rejected) {\n            continue;\n          }\n          pc.transceivers[j].iceTransport.addRemoteCandidate({});\n          sections = SDPUtils.getMediaSections(pc._remoteDescription.sdp);\n          sections[j] += 'a=end-of-candidates\\r\\n';\n          pc._remoteDescription.sdp =\n              SDPUtils.getDescription(pc._remoteDescription.sdp) +\n              sections.join('');\n          if (pc.usingBundle) {\n            break;\n          }\n        }\n      } else {\n        var sdpMLineIndex = candidate.sdpMLineIndex;\n        if (candidate.sdpMid) {\n          for (var i = 0; i < pc.transceivers.length; i++) {\n            if (pc.transceivers[i].mid === candidate.sdpMid) {\n              sdpMLineIndex = i;\n              break;\n            }\n          }\n        }\n        var transceiver = pc.transceivers[sdpMLineIndex];\n        if (transceiver) {\n          if (transceiver.rejected) {\n            return resolve();\n          }\n          var cand = Object.keys(candidate.candidate).length > 0 ?\n              SDPUtils.parseCandidate(candidate.candidate) : {};\n          // Ignore Chrome's invalid candidates since Edge does not like them.\n          if (cand.protocol === 'tcp' && (cand.port === 0 || cand.port === 9)) {\n            return resolve();\n          }\n          // Ignore RTCP candidates, we assume RTCP-MUX.\n          if (cand.component && cand.component !== 1) {\n            return resolve();\n          }\n          // when using bundle, avoid adding candidates to the wrong\n          // ice transport. And avoid adding candidates added in the SDP.\n          if (sdpMLineIndex === 0 || (sdpMLineIndex > 0 &&\n              transceiver.iceTransport !== pc.transceivers[0].iceTransport)) {\n            if (!maybeAddCandidate(transceiver.iceTransport, cand)) {\n              return reject(makeError('OperationError',\n                  'Can not add ICE candidate'));\n            }\n          }\n\n          // update the remoteDescription.\n          var candidateString = candidate.candidate.trim();\n          if (candidateString.indexOf('a=') === 0) {\n            candidateString = candidateString.substr(2);\n          }\n          sections = SDPUtils.getMediaSections(pc._remoteDescription.sdp);\n          sections[sdpMLineIndex] += 'a=' +\n              (cand.type ? candidateString : 'end-of-candidates')\n              + '\\r\\n';\n          pc._remoteDescription.sdp =\n              SDPUtils.getDescription(pc._remoteDescription.sdp) +\n              sections.join('');\n        } else {\n          return reject(makeError('OperationError',\n              'Can not add ICE candidate'));\n        }\n      }\n      resolve();\n    });\n  };\n\n  RTCPeerConnection.prototype.getStats = function(selector) {\n    if (selector && selector instanceof window.MediaStreamTrack) {\n      var senderOrReceiver = null;\n      this.transceivers.forEach(function(transceiver) {\n        if (transceiver.rtpSender &&\n            transceiver.rtpSender.track === selector) {\n          senderOrReceiver = transceiver.rtpSender;\n        } else if (transceiver.rtpReceiver &&\n            transceiver.rtpReceiver.track === selector) {\n          senderOrReceiver = transceiver.rtpReceiver;\n        }\n      });\n      if (!senderOrReceiver) {\n        throw makeError('InvalidAccessError', 'Invalid selector.');\n      }\n      return senderOrReceiver.getStats();\n    }\n\n    var promises = [];\n    this.transceivers.forEach(function(transceiver) {\n      ['rtpSender', 'rtpReceiver', 'iceGatherer', 'iceTransport',\n          'dtlsTransport'].forEach(function(method) {\n            if (transceiver[method]) {\n              promises.push(transceiver[method].getStats());\n            }\n          });\n    });\n    return Promise.all(promises).then(function(allStats) {\n      var results = new Map();\n      allStats.forEach(function(stats) {\n        stats.forEach(function(stat) {\n          results.set(stat.id, stat);\n        });\n      });\n      return results;\n    });\n  };\n\n  // fix low-level stat names and return Map instead of object.\n  var ortcObjects = ['RTCRtpSender', 'RTCRtpReceiver', 'RTCIceGatherer',\n    'RTCIceTransport', 'RTCDtlsTransport'];\n  ortcObjects.forEach(function(ortcObjectName) {\n    var obj = window[ortcObjectName];\n    if (obj && obj.prototype && obj.prototype.getStats) {\n      var nativeGetstats = obj.prototype.getStats;\n      obj.prototype.getStats = function() {\n        return nativeGetstats.apply(this)\n        .then(function(nativeStats) {\n          var mapStats = new Map();\n          Object.keys(nativeStats).forEach(function(id) {\n            nativeStats[id].type = fixStatsType(nativeStats[id]);\n            mapStats.set(id, nativeStats[id]);\n          });\n          return mapStats;\n        });\n      };\n    }\n  });\n\n  // legacy callback shims. Should be moved to adapter.js some days.\n  var methods = ['createOffer', 'createAnswer'];\n  methods.forEach(function(method) {\n    var nativeMethod = RTCPeerConnection.prototype[method];\n    RTCPeerConnection.prototype[method] = function() {\n      var args = arguments;\n      if (typeof args[0] === 'function' ||\n          typeof args[1] === 'function') { // legacy\n        return nativeMethod.apply(this, [arguments[2]])\n        .then(function(description) {\n          if (typeof args[0] === 'function') {\n            args[0].apply(null, [description]);\n          }\n        }, function(error) {\n          if (typeof args[1] === 'function') {\n            args[1].apply(null, [error]);\n          }\n        });\n      }\n      return nativeMethod.apply(this, arguments);\n    };\n  });\n\n  methods = ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate'];\n  methods.forEach(function(method) {\n    var nativeMethod = RTCPeerConnection.prototype[method];\n    RTCPeerConnection.prototype[method] = function() {\n      var args = arguments;\n      if (typeof args[1] === 'function' ||\n          typeof args[2] === 'function') { // legacy\n        return nativeMethod.apply(this, arguments)\n        .then(function() {\n          if (typeof args[1] === 'function') {\n            args[1].apply(null);\n          }\n        }, function(error) {\n          if (typeof args[2] === 'function') {\n            args[2].apply(null, [error]);\n          }\n        });\n      }\n      return nativeMethod.apply(this, arguments);\n    };\n  });\n\n  // getStats is special. It doesn't have a spec legacy method yet we support\n  // getStats(something, cb) without error callbacks.\n  ['getStats'].forEach(function(method) {\n    var nativeMethod = RTCPeerConnection.prototype[method];\n    RTCPeerConnection.prototype[method] = function() {\n      var args = arguments;\n      if (typeof args[1] === 'function') {\n        return nativeMethod.apply(this, arguments)\n        .then(function() {\n          if (typeof args[1] === 'function') {\n            args[1].apply(null);\n          }\n        });\n      }\n      return nativeMethod.apply(this, arguments);\n    };\n  });\n\n  return RTCPeerConnection;\n};\n\n},{\"sdp\":17}],17:[function(require,module,exports){\n/* eslint-env node */\n'use strict';\n\n// SDP helpers.\nvar SDPUtils = {};\n\n// Generate an alphanumeric identifier for cname or mids.\n// TODO: use UUIDs instead? https://gist.github.com/jed/982883\nSDPUtils.generateIdentifier = function() {\n  return Math.random().toString(36).substr(2, 10);\n};\n\n// The RTCP CNAME used by all peerconnections from the same JS.\nSDPUtils.localCName = SDPUtils.generateIdentifier();\n\n// Splits SDP into lines, dealing with both CRLF and LF.\nSDPUtils.splitLines = function(blob) {\n  return blob.trim().split('\\n').map(function(line) {\n    return line.trim();\n  });\n};\n// Splits SDP into sessionpart and mediasections. Ensures CRLF.\nSDPUtils.splitSections = function(blob) {\n  var parts = blob.split('\\nm=');\n  return parts.map(function(part, index) {\n    return (index > 0 ? 'm=' + part : part).trim() + '\\r\\n';\n  });\n};\n\n// returns the session description.\nSDPUtils.getDescription = function(blob) {\n  var sections = SDPUtils.splitSections(blob);\n  return sections && sections[0];\n};\n\n// returns the individual media sections.\nSDPUtils.getMediaSections = function(blob) {\n  var sections = SDPUtils.splitSections(blob);\n  sections.shift();\n  return sections;\n};\n\n// Returns lines that start with a certain prefix.\nSDPUtils.matchPrefix = function(blob, prefix) {\n  return SDPUtils.splitLines(blob).filter(function(line) {\n    return line.indexOf(prefix) === 0;\n  });\n};\n\n// Parses an ICE candidate line. Sample input:\n// candidate:702786350 2 udp 41819902 8.8.8.8 60769 typ relay raddr 8.8.8.8\n// rport 55996\"\nSDPUtils.parseCandidate = function(line) {\n  var parts;\n  // Parse both variants.\n  if (line.indexOf('a=candidate:') === 0) {\n    parts = line.substring(12).split(' ');\n  } else {\n    parts = line.substring(10).split(' ');\n  }\n\n  var candidate = {\n    foundation: parts[0],\n    component: parseInt(parts[1], 10),\n    protocol: parts[2].toLowerCase(),\n    priority: parseInt(parts[3], 10),\n    ip: parts[4],\n    address: parts[4], // address is an alias for ip.\n    port: parseInt(parts[5], 10),\n    // skip parts[6] == 'typ'\n    type: parts[7]\n  };\n\n  for (var i = 8; i < parts.length; i += 2) {\n    switch (parts[i]) {\n      case 'raddr':\n        candidate.relatedAddress = parts[i + 1];\n        break;\n      case 'rport':\n        candidate.relatedPort = parseInt(parts[i + 1], 10);\n        break;\n      case 'tcptype':\n        candidate.tcpType = parts[i + 1];\n        break;\n      case 'ufrag':\n        candidate.ufrag = parts[i + 1]; // for backward compability.\n        candidate.usernameFragment = parts[i + 1];\n        break;\n      default: // extension handling, in particular ufrag\n        candidate[parts[i]] = parts[i + 1];\n        break;\n    }\n  }\n  return candidate;\n};\n\n// Translates a candidate object into SDP candidate attribute.\nSDPUtils.writeCandidate = function(candidate) {\n  var sdp = [];\n  sdp.push(candidate.foundation);\n  sdp.push(candidate.component);\n  sdp.push(candidate.protocol.toUpperCase());\n  sdp.push(candidate.priority);\n  sdp.push(candidate.address || candidate.ip);\n  sdp.push(candidate.port);\n\n  var type = candidate.type;\n  sdp.push('typ');\n  sdp.push(type);\n  if (type !== 'host' && candidate.relatedAddress &&\n      candidate.relatedPort) {\n    sdp.push('raddr');\n    sdp.push(candidate.relatedAddress);\n    sdp.push('rport');\n    sdp.push(candidate.relatedPort);\n  }\n  if (candidate.tcpType && candidate.protocol.toLowerCase() === 'tcp') {\n    sdp.push('tcptype');\n    sdp.push(candidate.tcpType);\n  }\n  if (candidate.usernameFragment || candidate.ufrag) {\n    sdp.push('ufrag');\n    sdp.push(candidate.usernameFragment || candidate.ufrag);\n  }\n  return 'candidate:' + sdp.join(' ');\n};\n\n// Parses an ice-options line, returns an array of option tags.\n// a=ice-options:foo bar\nSDPUtils.parseIceOptions = function(line) {\n  return line.substr(14).split(' ');\n};\n\n// Parses an rtpmap line, returns RTCRtpCoddecParameters. Sample input:\n// a=rtpmap:111 opus/48000/2\nSDPUtils.parseRtpMap = function(line) {\n  var parts = line.substr(9).split(' ');\n  var parsed = {\n    payloadType: parseInt(parts.shift(), 10) // was: id\n  };\n\n  parts = parts[0].split('/');\n\n  parsed.name = parts[0];\n  parsed.clockRate = parseInt(parts[1], 10); // was: clockrate\n  parsed.channels = parts.length === 3 ? parseInt(parts[2], 10) : 1;\n  // legacy alias, got renamed back to channels in ORTC.\n  parsed.numChannels = parsed.channels;\n  return parsed;\n};\n\n// Generate an a=rtpmap line from RTCRtpCodecCapability or\n// RTCRtpCodecParameters.\nSDPUtils.writeRtpMap = function(codec) {\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  var channels = codec.channels || codec.numChannels || 1;\n  return 'a=rtpmap:' + pt + ' ' + codec.name + '/' + codec.clockRate +\n      (channels !== 1 ? '/' + channels : '') + '\\r\\n';\n};\n\n// Parses an a=extmap line (headerextension from RFC 5285). Sample input:\n// a=extmap:2 urn:ietf:params:rtp-hdrext:toffset\n// a=extmap:2/sendonly urn:ietf:params:rtp-hdrext:toffset\nSDPUtils.parseExtmap = function(line) {\n  var parts = line.substr(9).split(' ');\n  return {\n    id: parseInt(parts[0], 10),\n    direction: parts[0].indexOf('/') > 0 ? parts[0].split('/')[1] : 'sendrecv',\n    uri: parts[1]\n  };\n};\n\n// Generates a=extmap line from RTCRtpHeaderExtensionParameters or\n// RTCRtpHeaderExtension.\nSDPUtils.writeExtmap = function(headerExtension) {\n  return 'a=extmap:' + (headerExtension.id || headerExtension.preferredId) +\n      (headerExtension.direction && headerExtension.direction !== 'sendrecv'\n        ? '/' + headerExtension.direction\n        : '') +\n      ' ' + headerExtension.uri + '\\r\\n';\n};\n\n// Parses an ftmp line, returns dictionary. Sample input:\n// a=fmtp:96 vbr=on;cng=on\n// Also deals with vbr=on; cng=on\nSDPUtils.parseFmtp = function(line) {\n  var parsed = {};\n  var kv;\n  var parts = line.substr(line.indexOf(' ') + 1).split(';');\n  for (var j = 0; j < parts.length; j++) {\n    kv = parts[j].trim().split('=');\n    parsed[kv[0].trim()] = kv[1];\n  }\n  return parsed;\n};\n\n// Generates an a=ftmp line from RTCRtpCodecCapability or RTCRtpCodecParameters.\nSDPUtils.writeFmtp = function(codec) {\n  var line = '';\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  if (codec.parameters && Object.keys(codec.parameters).length) {\n    var params = [];\n    Object.keys(codec.parameters).forEach(function(param) {\n      if (codec.parameters[param]) {\n        params.push(param + '=' + codec.parameters[param]);\n      } else {\n        params.push(param);\n      }\n    });\n    line += 'a=fmtp:' + pt + ' ' + params.join(';') + '\\r\\n';\n  }\n  return line;\n};\n\n// Parses an rtcp-fb line, returns RTCPRtcpFeedback object. Sample input:\n// a=rtcp-fb:98 nack rpsi\nSDPUtils.parseRtcpFb = function(line) {\n  var parts = line.substr(line.indexOf(' ') + 1).split(' ');\n  return {\n    type: parts.shift(),\n    parameter: parts.join(' ')\n  };\n};\n// Generate a=rtcp-fb lines from RTCRtpCodecCapability or RTCRtpCodecParameters.\nSDPUtils.writeRtcpFb = function(codec) {\n  var lines = '';\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  if (codec.rtcpFeedback && codec.rtcpFeedback.length) {\n    // FIXME: special handling for trr-int?\n    codec.rtcpFeedback.forEach(function(fb) {\n      lines += 'a=rtcp-fb:' + pt + ' ' + fb.type +\n      (fb.parameter && fb.parameter.length ? ' ' + fb.parameter : '') +\n          '\\r\\n';\n    });\n  }\n  return lines;\n};\n\n// Parses an RFC 5576 ssrc media attribute. Sample input:\n// a=ssrc:3735928559 cname:something\nSDPUtils.parseSsrcMedia = function(line) {\n  var sp = line.indexOf(' ');\n  var parts = {\n    ssrc: parseInt(line.substr(7, sp - 7), 10)\n  };\n  var colon = line.indexOf(':', sp);\n  if (colon > -1) {\n    parts.attribute = line.substr(sp + 1, colon - sp - 1);\n    parts.value = line.substr(colon + 1);\n  } else {\n    parts.attribute = line.substr(sp + 1);\n  }\n  return parts;\n};\n\nSDPUtils.parseSsrcGroup = function(line) {\n  var parts = line.substr(13).split(' ');\n  return {\n    semantics: parts.shift(),\n    ssrcs: parts.map(function(ssrc) {\n      return parseInt(ssrc, 10);\n    })\n  };\n};\n\n// Extracts the MID (RFC 5888) from a media section.\n// returns the MID or undefined if no mid line was found.\nSDPUtils.getMid = function(mediaSection) {\n  var mid = SDPUtils.matchPrefix(mediaSection, 'a=mid:')[0];\n  if (mid) {\n    return mid.substr(6);\n  }\n};\n\nSDPUtils.parseFingerprint = function(line) {\n  var parts = line.substr(14).split(' ');\n  return {\n    algorithm: parts[0].toLowerCase(), // algorithm is case-sensitive in Edge.\n    value: parts[1]\n  };\n};\n\n// Extracts DTLS parameters from SDP media section or sessionpart.\n// FIXME: for consistency with other functions this should only\n//   get the fingerprint line as input. See also getIceParameters.\nSDPUtils.getDtlsParameters = function(mediaSection, sessionpart) {\n  var lines = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=fingerprint:');\n  // Note: a=setup line is ignored since we use the 'auto' role.\n  // Note2: 'algorithm' is not case sensitive except in Edge.\n  return {\n    role: 'auto',\n    fingerprints: lines.map(SDPUtils.parseFingerprint)\n  };\n};\n\n// Serializes DTLS parameters to SDP.\nSDPUtils.writeDtlsParameters = function(params, setupType) {\n  var sdp = 'a=setup:' + setupType + '\\r\\n';\n  params.fingerprints.forEach(function(fp) {\n    sdp += 'a=fingerprint:' + fp.algorithm + ' ' + fp.value + '\\r\\n';\n  });\n  return sdp;\n};\n\n// Parses a=crypto lines into\n//   https://rawgit.com/aboba/edgertc/master/msortc-rs4.html#dictionary-rtcsrtpsdesparameters-members\nSDPUtils.parseCryptoLine = function(line) {\n  var parts = line.substr(9).split(' ');\n  return {\n    tag: parseInt(parts[0], 10),\n    cryptoSuite: parts[1],\n    keyParams: parts[2],\n    sessionParams: parts.slice(3),\n  };\n};\n\nSDPUtils.writeCryptoLine = function(parameters) {\n  return 'a=crypto:' + parameters.tag + ' ' +\n    parameters.cryptoSuite + ' ' +\n    (typeof parameters.keyParams === 'object'\n      ? SDPUtils.writeCryptoKeyParams(parameters.keyParams)\n      : parameters.keyParams) +\n    (parameters.sessionParams ? ' ' + parameters.sessionParams.join(' ') : '') +\n    '\\r\\n';\n};\n\n// Parses the crypto key parameters into\n//   https://rawgit.com/aboba/edgertc/master/msortc-rs4.html#rtcsrtpkeyparam*\nSDPUtils.parseCryptoKeyParams = function(keyParams) {\n  if (keyParams.indexOf('inline:') !== 0) {\n    return null;\n  }\n  var parts = keyParams.substr(7).split('|');\n  return {\n    keyMethod: 'inline',\n    keySalt: parts[0],\n    lifeTime: parts[1],\n    mkiValue: parts[2] ? parts[2].split(':')[0] : undefined,\n    mkiLength: parts[2] ? parts[2].split(':')[1] : undefined,\n  };\n};\n\nSDPUtils.writeCryptoKeyParams = function(keyParams) {\n  return keyParams.keyMethod + ':'\n    + keyParams.keySalt +\n    (keyParams.lifeTime ? '|' + keyParams.lifeTime : '') +\n    (keyParams.mkiValue && keyParams.mkiLength\n      ? '|' + keyParams.mkiValue + ':' + keyParams.mkiLength\n      : '');\n};\n\n// Extracts all SDES paramters.\nSDPUtils.getCryptoParameters = function(mediaSection, sessionpart) {\n  var lines = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=crypto:');\n  return lines.map(SDPUtils.parseCryptoLine);\n};\n\n// Parses ICE information from SDP media section or sessionpart.\n// FIXME: for consistency with other functions this should only\n//   get the ice-ufrag and ice-pwd lines as input.\nSDPUtils.getIceParameters = function(mediaSection, sessionpart) {\n  var ufrag = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=ice-ufrag:')[0];\n  var pwd = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=ice-pwd:')[0];\n  if (!(ufrag && pwd)) {\n    return null;\n  }\n  return {\n    usernameFragment: ufrag.substr(12),\n    password: pwd.substr(10),\n  };\n};\n\n// Serializes ICE parameters to SDP.\nSDPUtils.writeIceParameters = function(params) {\n  return 'a=ice-ufrag:' + params.usernameFragment + '\\r\\n' +\n      'a=ice-pwd:' + params.password + '\\r\\n';\n};\n\n// Parses the SDP media section and returns RTCRtpParameters.\nSDPUtils.parseRtpParameters = function(mediaSection) {\n  var description = {\n    codecs: [],\n    headerExtensions: [],\n    fecMechanisms: [],\n    rtcp: []\n  };\n  var lines = SDPUtils.splitLines(mediaSection);\n  var mline = lines[0].split(' ');\n  for (var i = 3; i < mline.length; i++) { // find all codecs from mline[3..]\n    var pt = mline[i];\n    var rtpmapline = SDPUtils.matchPrefix(\n      mediaSection, 'a=rtpmap:' + pt + ' ')[0];\n    if (rtpmapline) {\n      var codec = SDPUtils.parseRtpMap(rtpmapline);\n      var fmtps = SDPUtils.matchPrefix(\n        mediaSection, 'a=fmtp:' + pt + ' ');\n      // Only the first a=fmtp:<pt> is considered.\n      codec.parameters = fmtps.length ? SDPUtils.parseFmtp(fmtps[0]) : {};\n      codec.rtcpFeedback = SDPUtils.matchPrefix(\n        mediaSection, 'a=rtcp-fb:' + pt + ' ')\n        .map(SDPUtils.parseRtcpFb);\n      description.codecs.push(codec);\n      // parse FEC mechanisms from rtpmap lines.\n      switch (codec.name.toUpperCase()) {\n        case 'RED':\n        case 'ULPFEC':\n          description.fecMechanisms.push(codec.name.toUpperCase());\n          break;\n        default: // only RED and ULPFEC are recognized as FEC mechanisms.\n          break;\n      }\n    }\n  }\n  SDPUtils.matchPrefix(mediaSection, 'a=extmap:').forEach(function(line) {\n    description.headerExtensions.push(SDPUtils.parseExtmap(line));\n  });\n  // FIXME: parse rtcp.\n  return description;\n};\n\n// Generates parts of the SDP media section describing the capabilities /\n// parameters.\nSDPUtils.writeRtpDescription = function(kind, caps) {\n  var sdp = '';\n\n  // Build the mline.\n  sdp += 'm=' + kind + ' ';\n  sdp += caps.codecs.length > 0 ? '9' : '0'; // reject if no codecs.\n  sdp += ' UDP/TLS/RTP/SAVPF ';\n  sdp += caps.codecs.map(function(codec) {\n    if (codec.preferredPayloadType !== undefined) {\n      return codec.preferredPayloadType;\n    }\n    return codec.payloadType;\n  }).join(' ') + '\\r\\n';\n\n  sdp += 'c=IN IP4 0.0.0.0\\r\\n';\n  sdp += 'a=rtcp:9 IN IP4 0.0.0.0\\r\\n';\n\n  // Add a=rtpmap lines for each codec. Also fmtp and rtcp-fb.\n  caps.codecs.forEach(function(codec) {\n    sdp += SDPUtils.writeRtpMap(codec);\n    sdp += SDPUtils.writeFmtp(codec);\n    sdp += SDPUtils.writeRtcpFb(codec);\n  });\n  var maxptime = 0;\n  caps.codecs.forEach(function(codec) {\n    if (codec.maxptime > maxptime) {\n      maxptime = codec.maxptime;\n    }\n  });\n  if (maxptime > 0) {\n    sdp += 'a=maxptime:' + maxptime + '\\r\\n';\n  }\n  sdp += 'a=rtcp-mux\\r\\n';\n\n  if (caps.headerExtensions) {\n    caps.headerExtensions.forEach(function(extension) {\n      sdp += SDPUtils.writeExtmap(extension);\n    });\n  }\n  // FIXME: write fecMechanisms.\n  return sdp;\n};\n\n// Parses the SDP media section and returns an array of\n// RTCRtpEncodingParameters.\nSDPUtils.parseRtpEncodingParameters = function(mediaSection) {\n  var encodingParameters = [];\n  var description = SDPUtils.parseRtpParameters(mediaSection);\n  var hasRed = description.fecMechanisms.indexOf('RED') !== -1;\n  var hasUlpfec = description.fecMechanisms.indexOf('ULPFEC') !== -1;\n\n  // filter a=ssrc:... cname:, ignore PlanB-msid\n  var ssrcs = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n    .map(function(line) {\n      return SDPUtils.parseSsrcMedia(line);\n    })\n    .filter(function(parts) {\n      return parts.attribute === 'cname';\n    });\n  var primarySsrc = ssrcs.length > 0 && ssrcs[0].ssrc;\n  var secondarySsrc;\n\n  var flows = SDPUtils.matchPrefix(mediaSection, 'a=ssrc-group:FID')\n    .map(function(line) {\n      var parts = line.substr(17).split(' ');\n      return parts.map(function(part) {\n        return parseInt(part, 10);\n      });\n    });\n  if (flows.length > 0 && flows[0].length > 1 && flows[0][0] === primarySsrc) {\n    secondarySsrc = flows[0][1];\n  }\n\n  description.codecs.forEach(function(codec) {\n    if (codec.name.toUpperCase() === 'RTX' && codec.parameters.apt) {\n      var encParam = {\n        ssrc: primarySsrc,\n        codecPayloadType: parseInt(codec.parameters.apt, 10)\n      };\n      if (primarySsrc && secondarySsrc) {\n        encParam.rtx = {ssrc: secondarySsrc};\n      }\n      encodingParameters.push(encParam);\n      if (hasRed) {\n        encParam = JSON.parse(JSON.stringify(encParam));\n        encParam.fec = {\n          ssrc: primarySsrc,\n          mechanism: hasUlpfec ? 'red+ulpfec' : 'red'\n        };\n        encodingParameters.push(encParam);\n      }\n    }\n  });\n  if (encodingParameters.length === 0 && primarySsrc) {\n    encodingParameters.push({\n      ssrc: primarySsrc\n    });\n  }\n\n  // we support both b=AS and b=TIAS but interpret AS as TIAS.\n  var bandwidth = SDPUtils.matchPrefix(mediaSection, 'b=');\n  if (bandwidth.length) {\n    if (bandwidth[0].indexOf('b=TIAS:') === 0) {\n      bandwidth = parseInt(bandwidth[0].substr(7), 10);\n    } else if (bandwidth[0].indexOf('b=AS:') === 0) {\n      // use formula from JSEP to convert b=AS to TIAS value.\n      bandwidth = parseInt(bandwidth[0].substr(5), 10) * 1000 * 0.95\n          - (50 * 40 * 8);\n    } else {\n      bandwidth = undefined;\n    }\n    encodingParameters.forEach(function(params) {\n      params.maxBitrate = bandwidth;\n    });\n  }\n  return encodingParameters;\n};\n\n// parses http://draft.ortc.org/#rtcrtcpparameters*\nSDPUtils.parseRtcpParameters = function(mediaSection) {\n  var rtcpParameters = {};\n\n  // Gets the first SSRC. Note tha with RTX there might be multiple\n  // SSRCs.\n  var remoteSsrc = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n    .map(function(line) {\n      return SDPUtils.parseSsrcMedia(line);\n    })\n    .filter(function(obj) {\n      return obj.attribute === 'cname';\n    })[0];\n  if (remoteSsrc) {\n    rtcpParameters.cname = remoteSsrc.value;\n    rtcpParameters.ssrc = remoteSsrc.ssrc;\n  }\n\n  // Edge uses the compound attribute instead of reducedSize\n  // compound is !reducedSize\n  var rsize = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-rsize');\n  rtcpParameters.reducedSize = rsize.length > 0;\n  rtcpParameters.compound = rsize.length === 0;\n\n  // parses the rtcp-mux attrіbute.\n  // Note that Edge does not support unmuxed RTCP.\n  var mux = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-mux');\n  rtcpParameters.mux = mux.length > 0;\n\n  return rtcpParameters;\n};\n\n// parses either a=msid: or a=ssrc:... msid lines and returns\n// the id of the MediaStream and MediaStreamTrack.\nSDPUtils.parseMsid = function(mediaSection) {\n  var parts;\n  var spec = SDPUtils.matchPrefix(mediaSection, 'a=msid:');\n  if (spec.length === 1) {\n    parts = spec[0].substr(7).split(' ');\n    return {stream: parts[0], track: parts[1]};\n  }\n  var planB = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n    .map(function(line) {\n      return SDPUtils.parseSsrcMedia(line);\n    })\n    .filter(function(msidParts) {\n      return msidParts.attribute === 'msid';\n    });\n  if (planB.length > 0) {\n    parts = planB[0].value.split(' ');\n    return {stream: parts[0], track: parts[1]};\n  }\n};\n\n// SCTP\n// parses draft-ietf-mmusic-sctp-sdp-26 first and falls back\n// to draft-ietf-mmusic-sctp-sdp-05\nSDPUtils.parseSctpDescription = function(mediaSection) {\n  var mline = SDPUtils.parseMLine(mediaSection);\n  var maxSizeLine = SDPUtils.matchPrefix(mediaSection, 'a=max-message-size:');\n  var maxMessageSize;\n  if (maxSizeLine.length > 0) {\n    maxMessageSize = parseInt(maxSizeLine[0].substr(19), 10);\n  }\n  if (isNaN(maxMessageSize)) {\n    maxMessageSize = 65536;\n  }\n  var sctpPort = SDPUtils.matchPrefix(mediaSection, 'a=sctp-port:');\n  if (sctpPort.length > 0) {\n    return {\n      port: parseInt(sctpPort[0].substr(12), 10),\n      protocol: mline.fmt,\n      maxMessageSize: maxMessageSize\n    };\n  }\n  var sctpMapLines = SDPUtils.matchPrefix(mediaSection, 'a=sctpmap:');\n  if (sctpMapLines.length > 0) {\n    var parts = SDPUtils.matchPrefix(mediaSection, 'a=sctpmap:')[0]\n      .substr(10)\n      .split(' ');\n    return {\n      port: parseInt(parts[0], 10),\n      protocol: parts[1],\n      maxMessageSize: maxMessageSize\n    };\n  }\n};\n\n// SCTP\n// outputs the draft-ietf-mmusic-sctp-sdp-26 version that all browsers\n// support by now receiving in this format, unless we originally parsed\n// as the draft-ietf-mmusic-sctp-sdp-05 format (indicated by the m-line\n// protocol of DTLS/SCTP -- without UDP/ or TCP/)\nSDPUtils.writeSctpDescription = function(media, sctp) {\n  var output = [];\n  if (media.protocol !== 'DTLS/SCTP') {\n    output = [\n      'm=' + media.kind + ' 9 ' + media.protocol + ' ' + sctp.protocol + '\\r\\n',\n      'c=IN IP4 0.0.0.0\\r\\n',\n      'a=sctp-port:' + sctp.port + '\\r\\n'\n    ];\n  } else {\n    output = [\n      'm=' + media.kind + ' 9 ' + media.protocol + ' ' + sctp.port + '\\r\\n',\n      'c=IN IP4 0.0.0.0\\r\\n',\n      'a=sctpmap:' + sctp.port + ' ' + sctp.protocol + ' 65535\\r\\n'\n    ];\n  }\n  if (sctp.maxMessageSize !== undefined) {\n    output.push('a=max-message-size:' + sctp.maxMessageSize + '\\r\\n');\n  }\n  return output.join('');\n};\n\n// Generate a session ID for SDP.\n// https://tools.ietf.org/html/draft-ietf-rtcweb-jsep-20#section-5.2.1\n// recommends using a cryptographically random +ve 64-bit value\n// but right now this should be acceptable and within the right range\nSDPUtils.generateSessionId = function() {\n  return Math.random().toString().substr(2, 21);\n};\n\n// Write boilder plate for start of SDP\n// sessId argument is optional - if not supplied it will\n// be generated randomly\n// sessVersion is optional and defaults to 2\n// sessUser is optional and defaults to 'thisisadapterortc'\nSDPUtils.writeSessionBoilerplate = function(sessId, sessVer, sessUser) {\n  var sessionId;\n  var version = sessVer !== undefined ? sessVer : 2;\n  if (sessId) {\n    sessionId = sessId;\n  } else {\n    sessionId = SDPUtils.generateSessionId();\n  }\n  var user = sessUser || 'thisisadapterortc';\n  // FIXME: sess-id should be an NTP timestamp.\n  return 'v=0\\r\\n' +\n      'o=' + user + ' ' + sessionId + ' ' + version +\n        ' IN IP4 127.0.0.1\\r\\n' +\n      's=-\\r\\n' +\n      't=0 0\\r\\n';\n};\n\nSDPUtils.writeMediaSection = function(transceiver, caps, type, stream) {\n  var sdp = SDPUtils.writeRtpDescription(transceiver.kind, caps);\n\n  // Map ICE parameters (ufrag, pwd) to SDP.\n  sdp += SDPUtils.writeIceParameters(\n    transceiver.iceGatherer.getLocalParameters());\n\n  // Map DTLS parameters to SDP.\n  sdp += SDPUtils.writeDtlsParameters(\n    transceiver.dtlsTransport.getLocalParameters(),\n    type === 'offer' ? 'actpass' : 'active');\n\n  sdp += 'a=mid:' + transceiver.mid + '\\r\\n';\n\n  if (transceiver.direction) {\n    sdp += 'a=' + transceiver.direction + '\\r\\n';\n  } else if (transceiver.rtpSender && transceiver.rtpReceiver) {\n    sdp += 'a=sendrecv\\r\\n';\n  } else if (transceiver.rtpSender) {\n    sdp += 'a=sendonly\\r\\n';\n  } else if (transceiver.rtpReceiver) {\n    sdp += 'a=recvonly\\r\\n';\n  } else {\n    sdp += 'a=inactive\\r\\n';\n  }\n\n  if (transceiver.rtpSender) {\n    // spec.\n    var msid = 'msid:' + stream.id + ' ' +\n        transceiver.rtpSender.track.id + '\\r\\n';\n    sdp += 'a=' + msid;\n\n    // for Chrome.\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n        ' ' + msid;\n    if (transceiver.sendEncodingParameters[0].rtx) {\n      sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n          ' ' + msid;\n      sdp += 'a=ssrc-group:FID ' +\n          transceiver.sendEncodingParameters[0].ssrc + ' ' +\n          transceiver.sendEncodingParameters[0].rtx.ssrc +\n          '\\r\\n';\n    }\n  }\n  // FIXME: this should be written by writeRtpDescription.\n  sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n      ' cname:' + SDPUtils.localCName + '\\r\\n';\n  if (transceiver.rtpSender && transceiver.sendEncodingParameters[0].rtx) {\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n        ' cname:' + SDPUtils.localCName + '\\r\\n';\n  }\n  return sdp;\n};\n\n// Gets the direction from the mediaSection or the sessionpart.\nSDPUtils.getDirection = function(mediaSection, sessionpart) {\n  // Look for sendrecv, sendonly, recvonly, inactive, default to sendrecv.\n  var lines = SDPUtils.splitLines(mediaSection);\n  for (var i = 0; i < lines.length; i++) {\n    switch (lines[i]) {\n      case 'a=sendrecv':\n      case 'a=sendonly':\n      case 'a=recvonly':\n      case 'a=inactive':\n        return lines[i].substr(2);\n      default:\n        // FIXME: What should happen here?\n    }\n  }\n  if (sessionpart) {\n    return SDPUtils.getDirection(sessionpart);\n  }\n  return 'sendrecv';\n};\n\nSDPUtils.getKind = function(mediaSection) {\n  var lines = SDPUtils.splitLines(mediaSection);\n  var mline = lines[0].split(' ');\n  return mline[0].substr(2);\n};\n\nSDPUtils.isRejected = function(mediaSection) {\n  return mediaSection.split(' ', 2)[1] === '0';\n};\n\nSDPUtils.parseMLine = function(mediaSection) {\n  var lines = SDPUtils.splitLines(mediaSection);\n  var parts = lines[0].substr(2).split(' ');\n  return {\n    kind: parts[0],\n    port: parseInt(parts[1], 10),\n    protocol: parts[2],\n    fmt: parts.slice(3).join(' ')\n  };\n};\n\nSDPUtils.parseOLine = function(mediaSection) {\n  var line = SDPUtils.matchPrefix(mediaSection, 'o=')[0];\n  var parts = line.substr(2).split(' ');\n  return {\n    username: parts[0],\n    sessionId: parts[1],\n    sessionVersion: parseInt(parts[2], 10),\n    netType: parts[3],\n    addressType: parts[4],\n    address: parts[5]\n  };\n};\n\n// a very naive interpretation of a valid SDP.\nSDPUtils.isValidSDP = function(blob) {\n  if (typeof blob !== 'string' || blob.length === 0) {\n    return false;\n  }\n  var lines = SDPUtils.splitLines(blob);\n  for (var i = 0; i < lines.length; i++) {\n    if (lines[i].length < 2 || lines[i].charAt(1) !== '=') {\n      return false;\n    }\n    // TODO: check the modifier a bit more.\n  }\n  return true;\n};\n\n// Expose public methods.\nif (typeof module === 'object') {\n  module.exports = SDPUtils;\n}\n\n},{}]},{},[1])(1)\n});\n","//Service 类，会创建session(me), 并且将current属性设置为 me; 以后方法需要此值\n\n\n\nvar _util = require('./Util');\nvar _ = require('underscore');\n\nvar _logger = _util.tagLogger(\"Service\");\n\n\nvar Session = require('./Session');\n\n\nvar Attendee = require('./Attendee');\n\nvar __event = require('./event');\nvar EventHandler = require('./EventHandler');\n\nvar __Desktop = require('./_Desktop');\n\nvar __desktop = new __Desktop({\n    onExtLoaded: function () {\n        _logger.info(\"Share desktop ext. had loaded.\");\n    }\n});\n\nvar __Stream = require('./_Stream');\nvar PCStats = require('./PCStats');\n\nvar DefaultMouseTrack = require('../../../pannel/src/components/DefaultTrack');\n\n/**\n * {\n *  newSession:\n *  onCalling:\n *  onRinging:\n *\n *\n * }\n *\n *\n *\n */\nmodule.exports = _util.prototypeExtend({\n    __init__: function () {\n        var self = this;\n\n        _logger.warn(\"emedia version: \", window._emediaVersion || \"unkown\");\n        _logger.warn(\"UserAgent: \", navigator.userAgent);\n\n        var urlLogLevel = _util.parseURL(\"__log_level___\");\n        if(urlLogLevel){\n            emedia.LOG_LEVEL = parseInt(urlLogLevel);\n        }\n\n        // if(self.ticket && _util.isPlainObject(self.ticket)){\n        //     self.setup(self.ticket);\n        // }\n\n        self.namespace = Math.uuidFast();\n        emedia.useCurrentXService = self;\n\n        if(self.useRTCCfg === undefined){\n            self.useRTCCfg = emedia.config.useRTCCfgIfServerReturn;\n        }\n\n        if(typeof self.useRTCCfg === \"string\"){\n            self.useRTCCfg = JSON.parse(self.useRTCCfg);\n        }\n\n        self.inboundAudio = PCStats.inboundAudio.bind(self);\n        self.inboundVideo = PCStats.inboundVideo.bind(self);\n        self.outboundAudio = PCStats.outboundAudio.bind(self);\n        self.outboundVideo = PCStats.outboundVideo.bind(self);\n\n        // if(self.listeners){\n        //     for(var funcName in self.listeners){\n        //         var name = funcName;\n        //         var func = self.listeners[name];\n        //         if(typeof func === 'undefined'\n        //             || name === 'onRecvRemoteMessage'\n        //             || name === 'onSoundChanage'\n        //             || name === 'onTalking'){\n        //             continue;\n        //         }\n        //\n        //         self.listeners[\"__user_\" + name] = func;\n        //         self.listeners[name] = (function(name, func) {\n        //             return (function () {\n        //                 _logger.info(\"sdk call user impl func. func=\", name, self.current && self.current.getMemberId());\n        //                 func.apply(this, arguments);\n        //             })\n        //         })(name, func);\n        //     }\n        // }\n\n        // 接收到的session\n        self._cache_receive_sessions = [];\n    },\n\n    AVPubstream: __Stream.extend({\n        __init__: function () {\n            var self = this;\n\n            self.type = 0;\n            self._located = true;\n\n            self.mutedMuted = true;\n\n            if(self.constaints){\n                self.constaints.video || (self.voff = 1);\n                self.constaints.audio || (self.aoff = 1);\n            }\n            //self.constaints || (self.constaints = {audio: !self.aoff, video: !self.voff});\n            self.constaints || (self.constaints = {audio: true, video: true});\n\n            emedia.config.maxVideoBitrate && (self.vbitrate = emedia.config.maxVideoBitrate);\n            emedia.config.maxAudioBitrate && (self.abitrate = emedia.config.maxAudioBitrate);\n        }\n    }),\n\n    AudioMixerPubstream: new __Stream.extend({\n        __init__: function () {\n            var self = this;\n\n            self.type = 2;\n            self._located = true;\n\n            self.mutedMuted = true;\n\n            self.constaints || (self.constaints = {audio: true, video: false});\n            if(self.constaints){\n                var audio = !!self.constaints.audio;\n                //self.constaints.audio = true;\n                self.constaints.video || (self.constaints.video = false);\n\n                self.constaints.video || (self.voff = 1);\n                self.constaints.audio || (self.aoff = 1);\n\n                audio === false && (self.aoff = 1);\n            }\n\n            emedia.config.maxVideoBitrate && (self.vbitrate = emedia.config.maxVideoBitrate);\n            emedia.config.maxAudioBitrate && (self.abitrate = emedia.config.maxAudioBitrate);\n        },\n\n        onGotRemoteMediaStream: function(remoteMediaStream){\n            var self = this;\n\n            if(!self.remotePlayAudioObject){\n                var _audioId = \"__o_remote_play_audio_\" + self.id;\n                var audioObject = document.querySelector(\"#\" + _audioId);\n                if(audioObject){\n                    //audioObject.remove();\n                }else{\n                    audioObject = document.createElement(\"audio\");\n\n                    audioObject.style.display = \"none\";\n                    audioObject.id = \"__o_remote_play_audio_\" + self.id;\n                    audioObject.autoplay = true;\n                    audioObject.playsinline = true;\n\n                    document.body.appendChild(audioObject);\n                }\n\n                //monitorEvents && monitorEvents(audioObject);\n\n                self.remotePlayAudioObject = audioObject;\n            }\n\n            // self.remotePlayAudioObject.autoplay = true;\n            // self.remotePlayAudioObject.playsinline = true;\n            self.remotePlayAudioObject.srcObject = remoteMediaStream;\n\n            //window.__$_remoteMediaStream = remoteMediaStream;\n        }\n    }),\n\n    //screenOptions ['screen', 'window', 'tab']\n    ShareDesktopPubstream: __Stream.extend({\n        voff: 0,\n\n        __init__: function () {\n            var self = this;\n\n            self.type = 1;\n            self._located = true;\n\n            self.mutedMuted = true;\n            self.constaints = {audio: !this.aoff, video: true};\n\n            emedia.config.maxVideoBitrate && (self.vbitrate = emedia.config.maxVideoBitrate);\n            emedia.config.maxAudioBitrate && (self.abitrate = emedia.config.maxAudioBitrate);\n        }\n    }),\n\n    __assertCurrent: function () {\n        var self = this;\n        if(!self.current){\n            _logger.error(\"Please call emedia.service.setup(ticket)\");\n            throw \"Please call emedia.service.setup(ticket)\"\n        }\n        if(self.current.closed){\n            _logger.error(\"current closed\");\n            throw \"current closed\"\n        }\n    },\n\n    hasAudioMixers: function () {\n        var self = this;\n\n        self.__assertCurrent();\n\n        for(var sid in self.current.audioMixers) {\n            var stream = self.current.audioMixers[sid];\n            if(stream && stream.located()){\n                return true;\n            }\n        }\n    },\n\n    getMediaDevices: function (kind, devices, errorCallback) {\n        if(typeof kind === 'function'){\n            errorCallback = devices;\n            devices = kind;\n            kind = undefined;\n        }\n\n        function gotDevices(deviceInfos) {\n            var resultDeviceInfos = [];\n\n            for (var i = 0; i !== deviceInfos.length; ++i) {\n                var deviceInfo = deviceInfos[i];\n                //var deviceId = deviceInfo.deviceId;\n\n                if(!kind){\n                    resultDeviceInfos.push(deviceInfo);\n                }else if(kind === deviceInfo.kind){\n                    resultDeviceInfos.push(deviceInfo);\n                }else if (deviceInfo.kind === 'audioinput') {\n                } else if (deviceInfo.kind === 'audiooutput') {\n                } else if (deviceInfo.kind === 'videoinput') {\n                } else {\n                    _logger.info('Some other kind of source/device: ', deviceInfo);\n                }\n            }\n\n            devices && devices(resultDeviceInfos);\n        }\n\n        navigator.mediaDevices.enumerateDevices().then(gotDevices).catch(function handleError(error) {\n            _logger.warn('navigator.getUserMedia error: ', error);\n            errorCallback && errorCallback(error);\n        });\n    },\n\n    //有些机器必须得getUserMedia后才能够产生正常得cands\n    //比如 safair不调用getUserMedia，将不产生cands；window chrome75，则产生得cands中没有ip 而且 uuid.local\n    // requireRights: function(success, errorCallback){\n    //     function gotDevices(deviceInfos) {\n    //         var resultDeviceInfos = [];\n    //\n    //         for (var i = 0; i !== deviceInfos.length; ++i) {\n    //             var deviceInfo = deviceInfos[i];\n    //             _logger.info('Got device: ', deviceInfo);\n    //         }\n    //\n    //         success && success(resultDeviceInfos);\n    //     }\n    //     navigator.mediaDevices.enumerateDevices().then(gotDevices).catch(function handleError(error) {\n    //         _logger.warn('navigator.getUserMedia error: ', error);\n    //         errorCallback && errorCallback(error);\n    //     });\n    // },\n\n    // Attach audio output device to video element using device/sink ID.\n    // sinkId deviceInfo.deviceId;\n    // attachSinkId(videoElement, deviceInfo.deviceId);\n    attachSinkId: function (videoObj, sinkId) {\n        if (typeof videoObj.sinkId !== 'undefined') {\n            videoObj.setSinkId(sinkId)\n                .then(function() {\n                    _logger.info('Success, audio output device attached: ' + sinkId);\n                })\n                .catch(function(error) {\n                    var errorMessage = error;\n                    if (error.name === 'SecurityError') {\n                        errorMessage = 'You need to use HTTPS for selecting audio output ' + 'device: ' + error;\n                    }\n                    _logger.warn(errorMessage);\n                });\n        } else {\n            _logger.warn('Browser does not support output device selection.');\n        }\n    },\n\n    _stopTracks: function (_stream) {\n        emedia.stopTracks(_stream);\n        _stream && _logger.warn(\"Stream tracks stop. it = \", _stream);\n    },\n    _enableVideoTracks: function (_stream, enabled) {\n        emedia.enableVideoTracks(_stream, enabled);\n    },\n    _enableAudioTracks: function (_stream, enabled) {\n        emedia.enableAudioTracks(_stream, enabled);\n    },\n\n    /**\n     * 手机 前置\n     * video:{ 'facingMode': \"user\" }//调用前置摄像头\n     * video: { facingMode: { exact: \"environment\" } }//后置\n     *\n     * @param pubS\n     * @returns {{then: then}}\n     */\n    openUserMedia: function (pubS) {\n        _logger.debug(\"begin open user media\", pubS);\n\n        var self = this;\n\n        //self.__assertCurrent();\n\n        if(!pubS){\n            _logger.error(\"require pubS\");\n            throw \"require pubS\";\n        }\n\n        return {\n            then: function (_success, errCallback) {\n                // stream.oninactive = self._onStreamInactive.bind(self, stream);\n                // stream.onactive = self._onStreamActive.bind(self, stream);\n\n                function success() {\n                    _success.apply(null, arguments);\n\n                    var mediaStream = pubS.localStream;\n                    if(mediaStream){\n                        mediaStream.oninactive = self._onStreamInactive.bind(self, pubS, mediaStream);\n                        mediaStream.onactive = self._onStreamActive.bind(self, pubS, mediaStream);\n                    }\n                }\n\n                if(pubS instanceof self.AVPubstream){\n                    self._openCamera(pubS, success, errCallback);\n                }else if(pubS instanceof self.ShareDesktopPubstream){\n                    self._openSharedDesktop(pubS, success, errCallback)\n                }else if(pubS instanceof self.AudioMixerPubstream){\n                    self._openCamera(pubS, success, errCallback)\n                }else{\n                    _logger.error(\"Unspported pubS\");\n                    throw \"Unspported pubS\"\n                }\n            }\n        }\n    },\n\n    _openSharedDesktop: function (pubS, success, errCallback) {\n        var self = this;\n\n        //self.__assertCurrent();\n\n        function getAudioStream(pubS) {\n            var audioConstaints = {audio: true};\n            if(pubS.constaints){\n                if(typeof pubS.constaints.audio === 'object' && pubS.constaints.audio){\n                }else if(!pubS.constaints.audio){\n                    audioConstaints.audio = false;\n                }\n            }\n            self.__getUserMedia(audioConstaints, function (_user, stream) {\n                var mediaStream = new MediaStream();\n                mediaStream._located = true;\n\n                stream && stream.getAudioTracks().forEach(function(track) {\n                    mediaStream.addTrack(track);\n                });\n\n                pubS.localStream && pubS.localStream.getVideoTracks().forEach(function(track) {\n                    mediaStream.addTrack(track);\n                });\n\n                pubS.localStream = mediaStream;\n\n                success && success(self.current, mediaStream);\n            }, errCallback);\n        }\n\n        var videoTracks;\n        if(pubS._localMediaStream\n            && (videoTracks = pubS._localMediaStream.getVideoTracks())\n            && videoTracks.length > 0){\n            pubS.localStream = pubS._localMediaStream;\n\n            if(pubS.constaints.audio){\n                getAudioStream(pubS);\n            }else{\n                success && success(self.current, stream);\n            }\n\n            return ;\n        }\n\n        //screenOptions ['screen', 'window', 'tab']\n        __desktop.openDesktopMedia(pubS.screenOptions || ['screen', 'window', 'tab'], function (_event) {\n            if(_event instanceof __event.OpenDesktopMedia){\n                var desktopStreamId = _event.desktopStreamId;\n                _logger.warn(\"desktop streamId\", desktopStreamId);\n\n                var constraints = {\n                    audio: false,\n                    video: {\n                        mandatory: _util.extend(pubS.mandatory || {}, {\n                            chromeMediaSource: 'desktop',\n                            chromeMediaSourceId: desktopStreamId,\n                            // maxWidth: window.screen.width > 1920 ? window.screen.width : 1920,\n                            // maxHeight: window.screen.height > 1080 ? window.screen.height : 1080\n                        }),\n                        optional: []\n                    }\n                };\n\n                //delete pubS.mandatory;\n\n                self.__getUserMedia(constraints, function (_me, stream) {\n                    pubS.localStream = stream;\n\n                    if(pubS.constaints.audio){\n                        getAudioStream(pubS);\n                    }else{\n                        success && success(self.current, stream);\n                    }\n                }, errCallback);\n            } else {\n                self.current && self.current.onEvent(new __event.ShareDesktopExtensionNotFound({member: self.current}));\n                errCallback && errCallback(_event);\n            }\n        });\n    },\n\n    _openCamera: function(pubS, success, errCallback){\n        var self = this;\n        //self.__assertCurrent();\n\n        //var constaints = pubS.constaints || {audio: !pubS.aoff, video: !pubS.voff};\n        var constaints = pubS.constaints || {audio: true, video: true};\n\n        function successCallback (_me, stream) {\n            self.__controlStream(pubS, stream);\n\n            pubS.localStream = stream;\n            success && success(self.current, stream);\n        }\n        self.__getUserMedia(constaints, successCallback.bind(constaints), errCallback);\n    },\n\n    __controlStream: function (pubS, stream) {\n        emedia.enableVideoTracks(stream, !pubS.voff);\n        emedia.enableAudioTracks(stream, !pubS.aoff);\n    },\n\n    __getUserMedia: function (constaints, success, errCallback) {\n        _logger.debug('get user media. using constaints', constaints);\n\n        var self = this;\n\n        constaints = _util.extend({}, constaints);\n        // if(typeof constaints.audio === 'object' && constaints.audio){\n        //     constaints.audio = true;\n        // }\n\n        var _openstream;\n\n        function onFail(e) {\n            _logger.debug('[WebRTC-API] getUserMedia() error: ', e);\n\n            emedia.stopTracks(_openstream);\n\n            self.current && self.current.onEvent(new __event.OpenMediaError({member: self.current, event: e}));\n            errCallback && errCallback(new __event.OpenMediaError({member: self.current, event: e}));\n        }\n\n        function onSuccess(stream){\n            if(self.current && !self.current.closed) {\n                //push stream时，由于异步，在未返回成功后，退出会议，摄像头不会被关闭问题\n                //将stream 与 Attendee绑定\n                self.current._openedRtcMediaStreams[stream.id] = stream;\n                stream._bindAttendee = self.current;\n                stream._bindAttendeeId = self.current.getMemberId();\n                _logger.info(\"stream bind attendee.\", stream.id,\n                    (self.current.ticket && self.current.ticket.id), self.current.getMemberId(), self.current.memName);\n            }\n\n            emedia._yetGetUserMedia = true;\n\n            _openstream = stream;\n\n            var videoTracks = stream.getVideoTracks();\n            var audioTracks = stream.getAudioTracks();\n\n            if (videoTracks.length > 0) {\n                var videoTrack = videoTracks[0];\n                _logger.debug(stream.id, 'using video device: ',\n                    videoTrack.id, videoTrack.label, videoTrack.kind, videoTrack.enabled);\n            }\n            if (audioTracks.length > 0) {\n                var audioTrack = audioTracks[0];\n                _logger.debug(stream.id, 'using audio device: ',\n                    audioTrack.id, audioTrack.label, audioTrack.kind, audioTrack.enabled);\n            }\n\n            stream._located = true;\n\n            //window electron 69-73, 当摄像头被占用后，不会抛出任何异常，但是stream active == false\n            if(typeof stream.active === \"boolean\" && !stream.active){\n                _logger.error(\"media stream not active. it is\", stream.id);\n                onFail({constraint: constaints, name: \"NotAllowedStreamNonactive\", message: \"stream non-active\"});\n                return;\n            }\n\n            // stream.oninactive = self._onStreamInactive.bind(self, stream);\n            // stream.onactive = self._onStreamActive.bind(self, stream);\n\n            success && success(self.current, stream);\n        }\n\n        self.__sysGetUserMedia(constaints, onSuccess, onFail);\n    },\n\n    _onStreamInactive: function(pubS, mediaStream, event){\n\n        var self = this;\n        _logger.warn(\"media stream inactive. it =\", mediaStream.id);\n\n        pubS.onMediaInactive && self.current && _util.forEach(self.current._cacheStreams, function (_sid, _stream) {\n            if(_stream.located() && _stream.localStream && _stream.localStream.id === mediaStream.id){\n                if(!_stream._webrtc || !_stream._webrtc.closed){\n                    pubS.onMediaInactive.call(_stream, mediaStream, event, self);\n                }\n            }\n        });\n    },\n    _onStreamActive: function(pubS, mediaStream, event){\n        var self = this;\n        _logger.warn(\"media stream active. it =\", mediaStream.id);\n\n        pubS.onMediaActive && self.current && _util.forEach(self.current._cacheStreams, function (_sid, _stream) {\n            if(_stream.located() && _stream.localStream && _stream.localStream.id === mediaStream.id){\n                pubS.onMediaActive.call(_stream, mediaStream, event, self);\n            }\n        });\n    },\n\n    __sysGetUserMedia: function(constaints, onSuccess, onFail){\n        async function getUserMedia(constaints, onSuccess, onFail) {\n            if(typeof emedia.config.globalConstraints === 'object'){\n                if(typeof emedia.config.globalConstraints.audio === 'object' && constaints.audio){\n                    if(typeof constaints.audio === 'boolean'){\n                        constaints.audio = _util.extend({}, emedia.config.globalConstraints.audio);\n                    }else{\n                        constaints.audio = _util.extend({}, emedia.config.globalConstraints.audio, constaints.audio);\n                    }\n                }\n                if(typeof emedia.config.globalConstraints.video === 'object' && constaints.video){\n                    if(typeof constaints.video === 'boolean'){\n                        constaints.video = _util.extend({}, emedia.config.globalConstraints.video);\n                    }else{\n                        constaints.video = _util.extend({}, emedia.config.globalConstraints.video, constaints.video);\n                    }\n                }\n            }\n\n            _logger.info(\"navigator.mediaDevices.getUserMedia constaints = \", JSON.stringify(constaints));\n\n\n\n            // audio video 分别获取\n            var mediaStream = new MediaStream();\n            let audioStream, videoStream;\n\n            if(constaints.audio) {\n                try {\n                    audioStream = await navigator.mediaDevices.getUserMedia({audio: true})\n                } catch (error) {\n                    console.error('getUserMedia audio error', error);\n                }\n            }\n            if(constaints.video) {\n                try {\n                    videoStream = await navigator.mediaDevices.getUserMedia({video: true})\n                } catch (error) {\n                    console.error('getUserMedia video error', error);\n                }\n            }\n\n            if(audioStream) {\n                audioStream.getAudioTracks().forEach(function(track) {\n                    mediaStream.addTrack(track);\n                });\n            }\n            if(videoStream) {\n                videoStream.getVideoTracks().forEach(function(track) {\n                    mediaStream.addTrack(track);\n                });\n            }\n\n\n            if( !audioStream && !videoStream ){\n                onFail({ message: 'getUserMedia error: not have input device'})\n            } else {\n                onSuccess(mediaStream)\n            }\n        }\n        getUserMedia(constaints, onSuccess, onFail);\n    },\n\n    attachMediaStream: window.attachMediaStream.bind({logger: _logger}),\n\n    setup: function (ticket, ext) {\n        var self = this;\n\n        _logger.count();\n        _logger.debug(\"recv ticket\", ticket, ext);\n        _logger.debug(\"use sdk version\", window._emediaVersion);\n        _logger.debug(navigator.userAgent);\n\n        ext = ext || {};\n\n        var extObj = ext;\n        if(_util.isPlainObject(ext)){ //ext 是对象， extObj 也是对象\n            ext = JSON.stringify(ext);\n        }else{ //ext 是字符串， extObj 尽量转换为 对象\n            try{\n                extObj = JSON.parse(ext);\n            }catch (e){\n            }\n        }\n\n        if(typeof ticket === \"string\"){\n            ticket = JSON.parse(ticket);\n        }\n\n        var sysUserId, memName;\n        sysUserId = memName = ticket.memName;\n        emedia._lastSetupConfr = ticket.confrId;\n        emedia._lastSetupMemName = memName;\n        emedia._lastSetupDate = new Date();\n        emedia._lastSetupTktId = ticket.tktId;\n\n        if(self.current && !self.current.closed){\n            var __eventCalling = new __event.CurrentCalling();\n            self.current.onEvent(__eventCalling);\n\n            _logger.error(\"confr not close. calling...\");\n            throw __eventCalling;\n            //return;\n\n            //self.current.exit(0);\n        }\n\n        var TargetAttendee = self.Attendee || Attendee;\n        var _Attendee = TargetAttendee.extend(EventHandler);\n\n        var attendee = self.current = new _Attendee({\n            _service: self,\n            service: self,\n            autoSub: emedia.config.autoSub,\n            getCopyIntervalMillis: emedia.config.getCopyIntervalMillis,\n            sysUserId: sysUserId,\n            memName: memName,\n            resource: self.resource,\n            nickName: self.nickName,\n            ticket: ticket,\n            ext: ext,\n            extObj: extObj,\n\n            sessionFactory: function(){\n                return self.newSession(this, ticket);\n            }\n        }, self.listeners || {});\n\n        return attendee;\n    },\n\n    getStreamById: function (streamId) {\n        var stream = this.current && this.current._cacheStreams[streamId];\n        return stream && _util.extend(false, {}, stream);\n    },\n\n    getStreamsByRtcId: function (rtcId) {\n        if(!this.current || !this.current._cacheStreams){\n            return;\n        }\n\n        var streams = [];\n        _util.forEach(this.current._cacheStreams, function (sid, _stream) {\n            if (_stream.rtcId === rtcId) {\n                streams.push(_stream);\n            }\n        });\n        return streams;\n    },\n\n    getMemberById: function (memId) {\n        var member = this.current && this.current._cacheMembers[memId];\n        return member && _util.extend(false, {}, member);\n    },\n\n    exit: function (closeMyConfrIfICrtConfr) {\n        _logger.warn(\"User click exit \", closeMyConfrIfICrtConfr);\n        this.current && this.current.exit(closeMyConfrIfICrtConfr);\n    },\n\n    join: function(joined, joinError){\n        _logger.debug(\"begin join ...\");\n\n        var self = this;\n\n        self.__assertCurrent();\n        if(self.current._memberId){ //已经加入会议\n            _logger.warn(\"Had joined. igrone it\");\n            joined && joined(self.memId);\n            return;\n        }else{\n            self.current._session._sessionId = undefined;\n        }\n\n        self.current.join(joined, joinError);\n    },\n\n    withpublish: function (pubS) {\n        var self = this;\n\n        if(!pubS || !pubS.localStream){\n            _logger.error(\"pubS null or stream not open\");\n            throw \"pubS null or stream not open\";\n        }\n\n        self.__assertCurrent();\n        if(self.current._memberId){ //已经加入会议\n            _logger.warn(\"Had joined. igrone it\");\n        }else{\n            self.current._session._sessionId = undefined;\n        }\n\n        return self.current.withpublish(pubS);\n    },\n\n    push: function(pubS, pushed, onPushError){\n        _logger.debug(\"begin push ...\");\n\n        var self = this;\n\n        if(arguments.length === 2){\n            onPushError = pushed;\n            pushed = undefined;\n        }\n\n        if(!pubS || !pubS.localStream){\n            _logger.error(\"pubS or stream open\");\n            throw \"pubS or stream open\";\n        }\n\n        self.__assertCurrent();\n        self.current.push(pubS, pushed, onPushError, false);\n    },\n\n    subscribe: function (streamId, onSub, subfail, subArgs) {\n        var self = this;\n\n        _logger.info(\"begin subscribe \", streamId, subArgs);\n\n        if(onSub && _util.isPlainObject(onSub)){\n            subArgs = onSub;\n            onSub = subfail = undefined;\n        }\n        if(subfail && _util.isPlainObject(subfail)){\n            subArgs = subfail;\n            subfail = onSub;\n            onSub = undefined;\n        }\n\n        if(emedia.isSafari){ // safari 两个流同时订阅可能会出现无声音 等一等\n            var sub = {\n                streamId: streamId,\n                onSub: onSub,\n                subfail: subfail,\n                subArgs: subArgs\n            };\n\n            var subs = (self.__safari_subs || (self.__safari_subs = []));\n            subs.push(sub);\n\n            function _onSub(){\n                try{\n                    var shiftsub = subs.shift();\n                    shiftsub && shiftsub.onSub && shiftsub.onSub.apply(shiftsub, arguments);\n                }finally{\n                    next();\n                }\n            }\n            function _subfail(){\n                try{\n                    var shiftsub = subs.shift();\n                    shiftsub && shiftsub.subfail && shiftsub.subfail.apply(shiftsub, arguments);\n                }finally{\n                    next();\n                }\n            }\n\n            function next(){\n                if(subs.length > 0){\n                    self.__subscribe(subs[0].streamId, _onSub, _subfail, subs[0].subArgs);\n                }\n            }\n\n            if(subs.length === 1){\n                next();\n            }\n        }else{\n            self.__subscribe(streamId, onSub, subfail, subArgs);\n        }\n    },\n    __subscribe: function (streamId, onSub, subfail, subArgs) {\n        var self = this;\n\n        self.__assertCurrent();\n\n        if(arguments.length == 2){\n            subfail = onSub;\n            onSub = undefined;\n        }\n\n        if(onSub && _util.isPlainObject(onSub)){\n            subArgs = onSub;\n            onSub = undefined;\n        }\n        if(subfail && _util.isPlainObject(subfail)){\n            subArgs = subfail;\n            subfail = undefined;\n        }\n\n        subArgs || (subArgs = {subSVideo: true, subSAudio: true});\n\n\n        var subStream = self.current._cacheStreams[streamId];\n        // if(subStream && subStream.type === 2 && subArgs.subSAudio !== undefined && !subArgs.subSAudio){\n        //     subfail && subfail(new __event.AudioMixerStreamNotAllowOnlySubVideo({stream: subStream}));\n        //     self.current.onEvent(new __event.AudioMixerStreamNotAllowOnlySubVideo({stream: subStream}));\n        //     return;\n        // }\n\n        var webrtc = self.current._getWebrtc(streamId);\n\n        var usePreRTCPeer = webrtc && webrtc.isConnected();\n\n        var remoteStream = usePreRTCPeer && webrtc.getRemoteStream();\n        if(remoteStream\n            && (usePreRTCPeer = remoteStream.active)){\n            var hasAudioTracks = remoteStream.getAudioTracks().length;\n            var hasVideoTracks = remoteStream.getVideoTracks().length;\n\n            if(!hasAudioTracks && subArgs.subSAudio === true){\n                usePreRTCPeer = false\n            }else if(!hasVideoTracks && subArgs.subSVideo === true){\n                usePreRTCPeer = false\n            }\n        }\n\n        _logger.info(\"sub stream\", streamId, \", use prertcpeer =\", usePreRTCPeer);\n\n        if(usePreRTCPeer){\n            self.current.subscribeStream(webrtc._rtcId, streamId, subfail, subArgs, onSub);\n            onSub && onSub();\n            return;\n        }\n\n        webrtc && (!webrtc.closed) && self.current.closeWebrtc(webrtc.getRtcId(), true, false);\n\n        self.current.createWebrtcAndSubscribeStream(streamId, {\n            onGotRemote: function(stream) {\n                onSub && onSub(stream)\n            },\n            onEvent: function(_evt){\n                subfail && subfail(_evt)\n            }\n        }, undefined, subArgs);\n    },\n\n    closePubstream: function (stream) {\n        if(stream.located()){\n            emedia.stopTracks(stream._localMediaStream);\n            emedia.stopTracks(stream.localStream);\n        }\n    },\n\n    hungup: function (streamId) {\n        var stream = this.getStreamById(streamId);\n\n        try{\n            this._hungup(streamId);\n        }finally{\n            this.onHungup && stream && this.onHungup(stream);\n        }\n    },\n    _hungup: function (streamId) {\n        var self = this;\n\n        self.__assertCurrent();\n\n        var attendee = self.current;\n\n        var stream = attendee._cacheStreams[streamId];\n        stream && !stream.closeReason && stream.updateAttributes({\n            closeReason: 'UserHangup'\n        });\n\n        var rtcId = stream && stream.rtcId;\n        if(rtcId){\n            attendee.closeWebrtc(rtcId);\n\n            if(stream.located()){\n                stream.type !== 1 && stream._localMediaStream && emedia.stopTracks(stream._localMediaStream);\n\n                if(stream.remotePlayAudioObject){\n                    document.body.removeChild(stream.remotePlayAudioObject);\n                }\n\n                attendee._cacheStreams[streamId] && attendee.onRemoveStream(stream);\n\n                _util.removeAttribute(attendee._cacheStreams, streamId);\n                self._streamAutomators && _util.removeAttribute(self._streamAutomators, streamId);\n            }\n        }\n\n        if(stream && !stream.located()){\n            attendee._linkedStreams[stream.id] && (_util.removeAttribute(attendee._linkedStreams, stream.id));\n            _logger.warn(\"Hangeup remove from _linkedStreams. stream = \", stream.id);\n\n            stream = attendee._cacheStreams[streamId];\n            if(!stream){\n                return;\n            }\n\n            stream.updateAttributes({\n                rtcId: undefined,\n                _webrtc: undefined,\n                mediaStream: undefined\n            });\n\n            var _stream = new __Stream(stream);\n            attendee.onUpdateStream(_stream, new _stream.Update(_stream));\n        }\n    },\n\n    postMessage: function (memberIdOrStreamId, message, fail, onRsp) {\n        var self = this;\n\n        var theMessage = message;\n        if(typeof message !== 'string'){\n            message = JSON.stringify(message);\n        }\n\n        self.__assertCurrent();\n        var attendee = self.current;\n\n        var memberId;\n\n        var linkedStream = attendee._linkedStreams[memberIdOrStreamId];\n        if(linkedStream && linkedStream.owner){\n            memberId = linkedStream.owner.id;\n        }else{\n            memberId = memberIdOrStreamId;\n        }\n\n        var message = attendee.newMessage({\n            op: 1003,\n            memId: memberId,\n            arg: message\n        });\n\n        attendee.postMessage(message, (fail || onRsp) && function (rsp) {\n            onRsp && onRsp(rsp, theMessage);\n\n            if(rsp.result != 0){\n                var _evt = new __event.RemoteControlFail({memId: memberId, failed: rsp.result, cause: rsp.msg, type: \"postMessage\", postMessage: message});\n                attendee.onEvent(_evt);\n\n                fail && fail(_evt, theMessage);\n\n                return;\n            }\n        });\n    },\n\n    torchRemote: function (streamId, torch, success, fail) {\n        var self = this;\n\n        if(typeof torch === 'function'){\n            fail = success;\n            success = torch;\n            torch = undefined;\n        }\n\n        if(torch !== undefined){\n            torch = torch ? 1 : 0;\n        }\n\n        self.__assertCurrent();\n        var attendee = self.current;\n\n        var linkedStream = attendee._linkedStreams[streamId];\n        if(!linkedStream || linkedStream.located()){\n            _logger.error(\"not exsits or locate, not connect\", streamId);\n            throw streamId + \" not exsits or locate, not connect\";\n        }\n\n        var lastTorch = linkedStream.torch;\n        var torch = (torch === undefined) ? (!linkedStream.torch ? 1 : 0) : torch;\n\n        var arg = {\n            op2: 20,\n            streamId: streamId,\n            tor: torch,\n        };\n\n        var message = attendee.newMessage({\n            op: 1002,\n            memId: linkedStream.owner.id,\n            arg: JSON.stringify(arg),\n            _reqOps:[100206]\n        });\n\n        linkedStream.updateAttributes({torch: torch});\n\n        attendee.postMessage(message, function (rsp) {\n            if(rsp.result != 0){\n                var _evt = new __event.RemoteControlFail({stream: linkedStream, failed: rsp.result, cause: rsp.msg, type: \"torch_control\"});\n                attendee.onEvent(_evt);\n\n                linkedStream.updateAttributes({torch: lastTorch});\n\n                fail && fail(_evt, linkedStream.torch);\n\n                return;\n            } else {\n                success && success(linkedStream.torch);\n            }\n        });\n    },\n\n    freezeFrameRemote: function (streamId, success, fail) {\n        var self = this;\n\n        self.__assertCurrent();\n        var attendee = self.current;\n\n        var linkedStream = attendee._linkedStreams[streamId];\n        if(!linkedStream || linkedStream.located()){\n            _logger.error(\"not exsits or locate, not connect\", streamId);\n            throw streamId + \" not exsits or locate, not connect\";\n        }\n\n        var freezeFrame = !linkedStream.freezeFrame;\n\n        var arg = {\n            op2: 20,\n            streamId: streamId,\n            frz: (freezeFrame ? 1 : 0),\n        };\n\n        var message = attendee.newMessage({\n            op: 1002,\n            memId: linkedStream.owner.id,\n            arg: JSON.stringify(arg),\n            _reqOps:[100204]\n        });\n\n        linkedStream.updateAttributes({freezeFrame: freezeFrame});\n\n        attendee.postMessage(message, function (rsp) {\n            if(rsp.result != 0){\n                var _evt = new __event.RemoteControlFail({stream: linkedStream, failed: rsp.result, cause: rsp.msg, type: \"freeze_control\"});\n                attendee.onEvent(_evt);\n\n                linkedStream.updateAttributes({freezeFrame: !linkedStream.freezeFrame});\n\n                fail && fail(_evt, linkedStream.freezeFrame);\n\n                return;\n            } else {\n                success && success(linkedStream.freezeFrame);\n            }\n        });\n    },\n\n    base64Img2Blob: function base64Img2Blob(code) {\n        var parts = code.split(';base64,');\n        var contentType = parts[0].split(':')[1];\n        var raw = window.atob(parts[1]);\n        var rawLength = raw.length;\n\n        var uInt8Array = new Uint8Array(rawLength);\n\n        for (var i = 0; i < rawLength; ++i) {\n            uInt8Array[i] = raw.charCodeAt(i);\n        }\n\n        // if(emedia.isSafari){\n        //     return new Blob([uInt8Array], {type:\"application/octet-stream\"});\n        // }\n\n        return new Blob([uInt8Array], {type: contentType});\n    },\n\n    blob2URL: function (blob) {\n        return URL.createObjectURL(blob);\n    },\n\n    imagesPngContext2URL: function (code) {\n        var self = this;\n        return self.blob2URL(self.blob2URL(code));\n    },\n\n    downloadFile: function downloadFile(fileName, content, blobs) {\n        var self = this;\n\n        var aLink = document.createElement('a');\n        aLink.style.display = 'none';\n        var blob = content ? self.base64Img2Blob(content) : blobs; //new Blob([content]);\n\n        // if(typeof FileReader === 'object'){\n        //     var reader = new FileReader();\n        //\n        //     reader.onloadend = function () {\n        //         var url = reader.result;\n        //         url = url.replace(/^data:[^;]*;/, 'data:attachment/file;');\n        //         window.location.href = url;\n        //     };\n        //\n        //     reader.readAsDataURL(blob);\n        //     return;\n        // }\n\n        var blobUrl;\n        aLink.download = fileName;\n        aLink.href = blobUrl = self.blob2URL(blob);\n        aLink.rel = 'noopener';\n\n        var evt = document.createEvent(\"HTMLEvents\");\n        evt.initEvent(\"click\", false, false); //initEvent 不加后两个参数在FF下会报错\n        aLink.dispatchEvent(evt);\n\n        document.body.appendChild(aLink);\n        aLink.click();\n        aLink.parentNode.removeChild(aLink);\n\n        setTimeout(function () {\n            URL.revokeObjectURL && URL.revokeObjectURL(blobUrl);\n        }, 40000);\n    },\n\n    videoCaptureBase64Context2URL: function (videoObj) {\n        var self = this;\n        return self.imagesPngContext2URL(self.getCaptureBase64Context(videoObj));\n    },\n\n    getCaptureBase64Context: function (videoObj) {\n        var canvas = document.createElement(\"canvas\");\n        var id = canvas.id = \"__capture_video_\" + new Date().getTime();\n\n        canvas.width = videoObj.videoWidth;\n        canvas.height = videoObj.videoHeight;\n\n        var canvas2dContext = canvas.getContext('2d');\n        canvas2dContext.drawImage(videoObj, 0, 0, canvas.width, canvas.height);\n\n        var base64 = canvas.toDataURL('images/png');\n        //console.log(base64);\n\n        return base64;\n    },\n\n    captureVideo: function captureVideo(videoObj, storeLocal, filename) {\n        var self = this;\n\n        var base64 = self.getCaptureBase64Context(videoObj);\n\n        if (storeLocal) {\n            filename = filename || (\"capture_\" + (new Date()).getTime());\n            self.downloadFile(filename, base64);\n            //window.location.href = base64;\n\n            // var iframe = document.createElement(\"iframe\");\n            // iframe.id = \"__capture_video_pic_dl_iframe_\" + (new Date().getTime());\n            // iframe.style.display = \"none\";\n            //\n            // //document.body.appendChild(iframe);\n            //\n            // iframe.src = base64;\n            // //iframe.contentWindow.location.href = URL.createObjectURL(base64);\n            //\n            // setTimeout(function () {\n            //     //document.body.removeChild(iframe);\n            // }, 50);\n        }\n\n        return base64;\n    },\n\n    capturePictureRemote: function (streamId, rspBase64Pic, success, fail) {\n        var self = this;\n\n        self.__assertCurrent();\n        var attendee = self.current;\n\n        var linkedStream = attendee._linkedStreams[streamId];\n        if(!linkedStream || linkedStream.located()){\n            _logger.error(\"not exsits or locate, not connect\", streamId);\n            throw streamId + \" not exsits or locate, not connect\";\n        }\n\n        var arg = {\n            op2: 20,\n            streamId: streamId,\n            pic: 1,\n            rspBase64Pic: (rspBase64Pic === true)\n        };\n\n        var message = attendee.newMessage({\n            op: 1002,\n            memId: linkedStream.owner.id,\n            arg: JSON.stringify(arg),\n            _reqOps:[100205]\n        });\n\n        attendee.postMessage(message, function (rsp) {\n            if(rsp.result != 0){\n                var _evt = new __event.RemoteControlFail({stream: linkedStream, failed: rsp.result, cause: rsp.msg, type: \"capture_control\"});\n                attendee.onEvent(_evt);\n                fail && fail(_evt);\n\n                return;\n            } else {\n                if(!rspBase64Pic){\n                    success && success();\n                    return;\n                }\n\n                if(!rsp.arg) {\n                    fail && fail(new __event.RemoteControlFail({stream: linkedStream, failed: rsp.result, cause: \"Not found base64 pic\"}));\n                    return;\n                }\n\n                var arg = JSON.parse(rsp.arg);\n                success && success(arg.pic);\n            }\n        });\n    },\n\n    zoomRemote: function (streamId, multiples, fail, success) {\n        var self = this;\n\n        self.__assertCurrent();\n        var attendee = self.current;\n\n        var linkedStream = attendee._linkedStreams[streamId];\n        if(!linkedStream || linkedStream.located()){\n            _logger.error(\"not exsits or locate, not connect\", streamId);\n            throw streamId + \" not exsits or locate, not connect\";\n        }\n\n        linkedStream._zoom || (linkedStream.updateAttributes({_zoom: 1}));\n\n        var _zoom = linkedStream._zoom * multiples;\n        if(_zoom < 1){\n            return;\n        }\n\n        linkedStream.updateAttributes({_zoom: _zoom});\n\n        var arg = {\n            op2: 20,\n            streamId: streamId,\n            zoom: Math.round(_zoom * 10000)\n        }\n\n        var message = attendee.newMessage({\n            op: 1002,\n            memId: linkedStream.owner.id,\n            arg: JSON.stringify(arg),\n            _reqOps:[100201]\n        });\n\n        attendee.postMessage(message, function (rsp) {\n            if(rsp.result != 0){\n                var _evt = new __event.RemoteControlFail({stream: linkedStream, failed: rsp.result, cause: rsp.msg, type: \"zoom_control\"});\n                attendee.onEvent(_evt);\n                fail && fail(_evt);\n\n                return;\n            }\n\n            success && success();\n        });\n    },\n\n    _getPosition: function getPosition(obj){\n        var topValue= 0,leftValue= 0;\n        while(obj){\n            leftValue+= obj.offsetLeft;\n            topValue+= obj.offsetTop;\n            obj= obj.offsetParent;\n        }\n\n        return {clientX: leftValue, clientY: topValue};\n    },\n\n    eventXYAtMedia: function (eventXY, videoTag) {\n        var videoXY = _util.getDomPageRect(videoTag);\n\n        var videoWidth = videoXY.width, videoHeight = videoXY.height;\n        var mediaWidth = videoTag.videoWidth, mediaHeight = videoTag.videoHeight;\n\n        if(mediaHeight/mediaWidth > videoHeight/videoWidth){\n            var t = mediaWidth / mediaHeight;\n            mediaHeight = videoHeight;\n            mediaWidth = mediaHeight * t;\n        } else {\n            var t = mediaHeight / mediaWidth;\n            mediaWidth = videoWidth;\n            mediaHeight = mediaWidth * t;\n        }\n\n        var clickXY = eventXY;\n\n        var isRadioX, isRadioY;\n        if(isRadioX = _util.isFloat(clickXY.x)){ //比率\n            clickXY.x = clickXY.x * videoWidth;\n        }\n        if(isRadioY = _util.isFloat(clickXY.y)){ //比率\n            clickXY.y = clickXY.y * videoHeight;\n        }\n\n        if(Math.abs(clickXY.x) < (videoWidth - mediaWidth) / 2\n            || (videoWidth - Math.abs(clickXY.x)  < (videoWidth - mediaWidth) / 2)){\n            return;\n        }\n        if(Math.abs(clickXY.y) < (videoHeight - mediaHeight) / 2\n            || (videoHeight - Math.abs(clickXY.y)  < (videoHeight - mediaHeight) / 2)){\n            return;\n        }\n\n        clickXY.x = clickXY.x < 0 ? Math.floor(clickXY.x + (videoWidth - mediaWidth) / 2)\n            : Math.floor(clickXY.x - (videoWidth - mediaWidth) / 2);\n        clickXY.y = clickXY.y < 0 ? Math.floor(clickXY.y + (videoHeight - mediaHeight) / 2)\n            : Math.floor(clickXY.y - (videoHeight - mediaHeight) / 2);\n\n\n        if(isRadioX){\n            clickXY.x = clickXY.x / mediaWidth;\n        }\n        if(isRadioY){\n            clickXY.y = clickXY.y / mediaHeight;\n        }\n\n        return {x: clickXY.x, y: clickXY.y, width: mediaWidth, height: mediaHeight};\n    },\n\n    eventXYAtVideo: function (mediaXY, videoTag) {\n        var videoXY = _util.getDomPageRect(videoTag);\n\n        var videoWidth = videoXY.width, videoHeight = videoXY.height;\n        var mediaWidth = videoTag.videoWidth, mediaHeight = videoTag.videoHeight;\n\n        if(mediaHeight/mediaWidth > videoHeight/videoWidth){\n            var t = mediaWidth / mediaHeight;\n            mediaHeight = videoHeight;\n            mediaWidth = mediaHeight * t;\n        } else {\n            var t = mediaHeight / mediaWidth;\n            mediaWidth = videoWidth;\n            mediaHeight = mediaWidth * t;\n        }\n\n        var isRadioX, isRadioY;\n        if(isRadioX = _util.isFloat(mediaXY.x)){ //比率\n            mediaXY.x = mediaXY.x * mediaWidth;\n        }\n        if(isRadioY = _util.isFloat(mediaXY.y)){ //比率\n            mediaXY.y = mediaXY.y * mediaHeight;\n        }\n\n        mediaXY.x = mediaXY.x < 0 ? Math.floor(mediaXY.x - (videoWidth - mediaWidth) / 2)\n            : Math.floor(mediaXY.x + (videoWidth - mediaWidth) / 2);\n        mediaXY.y = mediaXY.y < 0 ? Math.floor(mediaXY.y - (videoHeight - mediaHeight) / 2)\n            : Math.floor(mediaXY.y + (videoHeight - mediaHeight) / 2);\n\n        if(isRadioX){\n            mediaXY.x = mediaXY.x / videoWidth;\n        }\n        if(isRadioY){\n            mediaXY.y = mediaXY.y / videoHeight;\n        }\n\n        return mediaXY;\n    },\n\n    getClickXY: function (videoTag, clickEvent) {\n        var self = this;\n\n        var e = clickEvent || window.event;\n        var scrollX = document.documentElement.scrollLeft || document.body.scrollLeft;\n        var scrollY = document.documentElement.scrollTop || document.body.scrollTop;\n        var x = e.pageX || e.clientX + scrollX;\n        var y = e.pageY || e.clientY + scrollY;\n\n        var xy = self._getPosition(videoTag);\n\n        _logger.info(\"Video tag position \", xy.clientX, \":\", xy.clientY);\n\n\n        var mediaWidth = videoTag.videoWidth;\n        var mediaHeight = videoTag.videoHeight;\n\n        if(mediaHeight/mediaWidth > videoTag.offsetHeight/videoTag.offsetWidth){\n            var t = mediaWidth / mediaHeight;\n            mediaHeight = videoTag.offsetHeight;\n            mediaWidth = mediaHeight * t;\n\n            xy.clientX += (videoTag.offsetWidth - mediaWidth) / 2;\n        } else {\n            var t = mediaHeight / mediaWidth;\n            mediaWidth = videoTag.offsetWidth;\n            mediaHeight = mediaWidth * t;\n\n            xy.clientY += (videoTag.offsetHeight - mediaHeight) / 2;\n        }\n        _logger.info(\"Media position \", xy.clientX, \":\", xy.clientY);\n        _logger.info(\"Media xy \", mediaWidth, \":\", mediaHeight);\n        _logger.info(\"Click position \", x, \":\", y);\n\n        return {\n            mediaWidth: mediaWidth,\n            mediaHeight: mediaHeight,\n            x: (x - xy.clientX),\n            y: (y - xy.clientY)\n        };\n    },\n\n    focusExpoRemote: function (streamId, videoTag, clickEvent, fail, success) {\n        var self = this;\n\n        var e = clickEvent || window.event;\n        var scrollX = document.documentElement.scrollLeft || document.body.scrollLeft;\n        var scrollY = document.documentElement.scrollTop || document.body.scrollTop;\n        var x = e.pageX || e.clientX + scrollX;\n        var y = e.pageY || e.clientY + scrollY;\n\n        var xy = self._getPosition(videoTag);\n\n        _logger.info(\"Video tag position \", xy.clientX, \":\", xy.clientY);\n\n\n        var mediaWidth = videoTag.videoWidth;\n        var mediaHeight = videoTag.videoHeight;\n\n        if(mediaHeight/mediaWidth > videoTag.offsetHeight/videoTag.offsetWidth){\n            var t = mediaWidth / mediaHeight;\n            mediaHeight = videoTag.offsetHeight;\n            mediaWidth = mediaHeight * t;\n\n            xy.clientX += (videoTag.offsetWidth - mediaWidth) / 2;\n        } else {\n            var t = mediaHeight / mediaWidth;\n            mediaWidth = videoTag.offsetWidth;\n            mediaHeight = mediaWidth * t;\n\n            xy.clientY += (videoTag.offsetHeight - mediaHeight) / 2;\n        }\n        _logger.info(\"Media position \", xy.clientX, \":\", xy.clientY);\n        _logger.info(\"Media xy \", mediaWidth, \":\", mediaHeight);\n        _logger.info(\"Click position \", x, \":\", y);\n\n        self._focusExpo(streamId, mediaWidth, mediaHeight, (x - xy.clientX), (y - xy.clientY), fail, success);\n    },\n\n    _focusExpo: function (streamId, width, height, x, y, fail, success) {\n        var self = this;\n\n        if(x <= 0 || x > width){\n            return;\n        }\n        if(y <= 0 || y > height){\n            return;\n        }\n\n        self.__assertCurrent();\n        var attendee = self.current;\n\n        var linkedStream = attendee._linkedStreams[streamId];\n        if(!linkedStream || linkedStream.located()){\n            _logger.error(\"not exsits or locate, not connect\", streamId);\n            throw streamId + \" not exsits or locate, not connect\";\n        }\n\n        var arg = {\n            op2: 20,\n            streamId: streamId,\n            focus: 1,\n            expo: 1,\n            x: width === 0 ? 0 : Math.round(x * 10000 / width),\n            y: height === 0 ? 0 : Math.round(y * 10000 / height)\n        }\n\n        var message = attendee.newMessage({\n            op: 1002,\n            memId: linkedStream.owner.id,\n            arg: JSON.stringify(arg),\n            _reqOps:[100202, 100203]\n        });\n\n        attendee.postMessage(message, function (rsp) {\n            if(rsp.result != 0){\n                var _evt = new __event.RemoteControlFail({stream: linkedStream, failed: rsp.result, cause: rsp.msg, type: \"focus_expo_control\"});\n                attendee.onEvent(_evt);\n                fail && fail(_evt);\n\n                return;\n            }else{\n                success && success();\n            }\n        });\n    },\n\n    _republish: function (pubS, success, error) {\n        _logger.info(\"Republish stream. it = \", pubS.id);\n\n        var self = this;\n\n        var webrtc;\n        if(pubS.id){\n            var rtcId = self.current.__getWebrtcFor(pubS.id);\n            rtcId && self.current.closeWebrtc(rtcId, true);\n\n            webrtc = self.current._getWebrtc(pubS.id);\n        }\n\n        var _pubS;\n\n        // if(emedia.isSafari){\n        //     emedia.enableAudioTracks(false);\n        //     emedia.enableVideoTracks(false);\n        // }\n\n        switch(pubS.type) {\n            case 0:\n                //emedia.isSafari || emedia.stopTracks(pubS._localMediaStream);\n                emedia.stopTracks(pubS._localMediaStream);\n                _pubS = new self.AVPubstream(pubS);\n\n                break;\n            case 1:\n                //emedia.isSafari || emedia.stopAndRemoveAudioTracks(pubS._localMediaStream);\n                emedia.stopAndRemoveAudioTracks(pubS._localMediaStream);\n                _pubS = new self.ShareDesktopPubstream(pubS);\n\n                break;\n            case 2:\n                //emedia.isSafari || emedia.stopTracks(pubS._localMediaStream);\n                emedia.stopTracks(pubS._localMediaStream);\n                _pubS = new self.AudioMixerPubstream(pubS);\n\n                break;\n        }\n\n        setTimeout(function () {\n            self.openUserMedia(_pubS).then(function () {\n                pubS.localStream = _pubS.localStream;\n\n                pubS.isRepublished = true;\n\n                pubS.optimalVideoCodecs = pubS.optimalVideoCodecs || ( webrtc && webrtc.optimalVideoCodecs);\n                self.push(pubS, success, error);\n            }, error);\n        }, 100);\n\n        // if(emedia.isSafari){\n        //     setTimeout(function () {\n        //         switch(pubS.type) {\n        //             case 0:\n        //                 emedia.stopTracks(pubS._localMediaStream);\n        //                 break;\n        //             case 1:\n        //                 emedia.stopAndRemoveAudioTracks(pubS._localMediaStream);\n        //                 break;\n        //             case 2:\n        //                 emedia.stopTracks(pubS._localMediaStream);\n        //                 break;\n        //         }\n        //     }, 1400);\n        // }\n    },\n\n    switchMobileCamera: function(pubS, error, success){\n        var self = this;\n\n        if(typeof pubS === 'string'){ //id\n            pubS = self.current._cacheStreams[pubS];\n        } else if(pubS.id){\n            pubS = self.current._cacheStreams[pubS.id];\n        }\n\n        if(pubS.voff){\n            _logger.warn(\"Stream id = \", pubS.id, \" voff, do not chanage camera.\");\n            return;\n        }\n\n        pubS.constaints || (pubS.constaints = {});\n        var preConstaints = _util.extend({}, pubS.constaints);\n        pubS._lastConstaints = preConstaints;\n\n        //video: {'facingMode': \"user\"}, // 前置\n        //video: { facingMode: { exact: \"environment\" } } //后置\n        pubS.constaints.video = (typeof pubS.constaints.video === \"object\") ? pubS.constaints.video : {};\n        if(pubS.constaints.video.facingMode === \"user\" || !pubS.constaints.video.facingMode){ //facingMode不存在或指定了user当前置\n            pubS.constaints.video.facingMode = {exact: \"environment\"};\n        }else{ //pubS.constaints.video.facingMode\n            pubS.constaints.video.facingMode = \"user\";\n        }\n\n        self._republish(pubS, function(mediaStream){\n            success && success(mediaStream);\n        },function (_evt) {\n            if(_evt instanceof emedia.event.OpenMediaError){ //设备可能不支持，比如 没有摄像头，或 被禁止访问摄像头\n                pubS.constaints = preConstaints;\n            }\n\n            error && error(_evt);\n        });\n    },\n\n    chanageCamera: function(pubS, error, success){\n        var self = this;\n\n        if(typeof pubS === 'string'){ //id\n            pubS = self.current._cacheStreams[pubS];\n        } else if(pubS.id){\n            pubS = self.current._cacheStreams[pubS.id];\n        }\n\n        if(pubS.voff){\n            _logger.warn(\"Stream id = \", pubS.id, \" voff, do not chanage camera.\");\n            return;\n        }\n\n        self.getMediaDevices(\"videoinput\", function (devices) {\n            if(devices.length <= 1){\n                _logger.warn(\"Only video input. not chanage\");\n                return;\n            }\n\n            var cameraIndex = pubS._cameraIndex;\n\n            if(pubS._cameraIndex === null || pubS._cameraIndex === undefined){\n                var localStream = pubS.getLocalMediaStream();\n                var videoTracks = localStream && localStream.getVideoTracks();\n                var track = videoTracks && videoTracks.length && videoTracks[0];\n\n                if(track && track.getCapabilities && typeof track.getCapabilities === 'function'){\n                    var videoCapabilities = track.getCapabilities();\n                    var deviceId = videoCapabilities && videoCapabilities.deviceId;\n\n                    for(var index in devices){\n                        var device = devices[index];\n                        if(device.deviceId === deviceId\n                            || device.label == track.label){\n                            cameraIndex = parseInt(index);\n                            break;\n                        }\n                    }\n                }else{\n                    for(var index in devices){\n                        var device = devices[index];\n                        if(device.label == track.label){\n                            cameraIndex = parseInt(index);\n                            break;\n                        }\n                    }\n                }\n            }\n\n            while(cameraIndex < devices.length){\n                var lastDevice = devices[cameraIndex];\n                cameraIndex = (cameraIndex + 1) % devices.length;\n\n                var device = devices[cameraIndex];\n\n                var videoTracks = pubS.getLocalMediaStream().getVideoTracks();\n                if(!videoTracks || videoTracks.length === 0 || device.label != videoTracks[0].label){\n                    break;\n                }\n            }\n\n            var device = devices[cameraIndex];\n            var deviceInfoLabel = device.label;\n\n            _logger.warn(\"Stream \", pubS.id, lastDevice.label, \">>\", deviceInfoLabel);\n\n            pubS._cameraIndex = cameraIndex;\n\n            pubS.constaints || (pubS.constaints = {});\n            var preConstaints = _util.extend({}, pubS.constaints);\n            pubS._lastConstaints = preConstaints;\n\n            pubS.constaints.video = (typeof pubS.constaints.video === \"object\") ? pubS.constaints.video : {};\n            pubS.constaints.video.deviceId = {exact: device.deviceId};\n\n            self._republish(pubS, function(mediaStream){\n                success && success(mediaStream);\n            },function (_evt) {\n                if(_evt instanceof emedia.event.OpenMediaError){ //设备可能不支持，比如 没有摄像头，或 被禁止访问摄像头\n                    pubS.constaints = preConstaints;\n                }\n\n                error && error(_evt);\n            });\n        }, error);\n    },\n\n    chanageConstraints: function(pubS, constraints, error, success){\n        var self = this;\n\n        if(typeof pubS === 'string'){ //id\n            pubS = self.current._cacheStreams[pubS];\n        } else if(pubS.id){\n            pubS = self.current._cacheStreams[pubS.id];\n        }\n\n        if(!pubS){\n            _logger.warn(\"Not found pubS\");\n            return;\n        }\n        _logger.info(\"chanage pubstream constraints. it\", pubS.id, constraints);\n\n        function updateAndDisabled() {\n            var mediaStream = pubS.getMediaStream();\n            emedia.enableVideoTracks(mediaStream, !pubS.voff);\n            emedia.enableAudioTracks(mediaStream, !pubS.aoff);\n        }\n\n        if(_.isObject(constraints) && !_.isEqual(pubS.constaints, constraints)){\n            var preConstraints = pubS.constaints || {};\n            var preVoff = pubS.voff;\n            var preAoff = pubS.aoff;\n\n            pubS._lastConstaints = preConstraints;\n            pubS.constaints = _util.extend(true, {}, preConstraints, constraints);\n\n            pubS.aoff = pubS.constaints.audio ? 0 : 1;\n            pubS.voff = pubS.constaints.video ? 0 : 1;\n\n            self._republish(pubS, function(mediaStream){\n                updateAndDisabled();\n                success && success(mediaStream);\n            },function (_evt) {\n                if(_evt instanceof emedia.event.OpenMediaError){ //设备可能不支持，比如 没有摄像头，或 被禁止访问摄像头\n                    pubS.constaints = preConstraints;\n                    pubS.aoff = preAoff;\n                    pubS.voff = preVoff;\n                }\n\n                error && error(_evt);\n            });\n\n            return;\n        }\n\n        updateAndDisabled();\n        success && success(pubS.getMediaStream());\n    },\n\n    voff: function(pubS, _voff, error, success){\n        var self = this;\n\n        if(typeof pubS === 'string'){ //id\n            pubS = self.current._cacheStreams[pubS];\n        }\n\n        var oldVoff = pubS.voff;\n        _voff = _voff ? 1 : 0;\n        pubS.voff = _voff;\n\n        function updateAndDisabled() {\n            if(_voff == oldVoff){\n                _logger.info(\"pubstream voff not chanage.\");\n                return;\n            }\n            emedia.enableVideoTracks(pubS.getMediaStream(), !_voff);\n            self.current && self.current.voff(pubS, _voff);\n        }\n\n        if(!_voff && pubS.constaints && !pubS.constaints.video){\n            //error && error(\"When pub. only audio, voff invalidate\");\n            //throw \"When pub. only audio, voff invalidate\";\n\n            var preVideo = pubS.constaints.video;\n\n            pubS.constaints.video = true;\n            self._republish(pubS, function(mediaStream){\n                updateAndDisabled();\n                success && success(mediaStream);\n            },function (_evt) {\n                if(_evt instanceof emedia.event.OpenMediaError){ //设备可能不支持，比如 没有摄像头，或 被禁止访问摄像头\n                    pubS.constaints.video = preVideo;\n                    pubS.voff = oldVoff;\n                }\n\n                error && error(_evt);\n            });\n\n            return;\n        }\n\n        updateAndDisabled();\n        success && success(pubS.getMediaStream());\n    },\n\n    aoff: function(pubS, _aoff, error, success){\n        var self = this;\n\n        if(typeof pubS === 'string'){ //id\n            pubS = self.current._cacheStreams[pubS];\n        }\n\n        var oldAoff = pubS.aoff;\n        _aoff = _aoff ? 1 : 0;\n        pubS.aoff = _aoff;\n\n        function updateAndDisabled() {\n            if(_aoff == oldAoff){\n                _logger.info(\"pubstream aoff not chanage.\");\n                return;\n            }\n\n            emedia.enableAudioTracks(pubS.getMediaStream(), !_aoff);\n            self.current && self.current.aoff(pubS, _aoff);\n        }\n\n        if(!_aoff && pubS.constaints && !pubS.constaints.audio){\n            // error && error(\"When pub. only video, aoff invalidate\");\n            // throw \"When pub. only video, aoff invalidate\";\n\n            var preAudio = pubS.constaints.audio;\n\n            pubS.constaints.audio = true;\n            self._republish(pubS, function(mediaStream){\n                updateAndDisabled();\n                success && success(mediaStream);\n            },function (_evt) {\n                if(_evt instanceof emedia.event.OpenMediaError){ //设备可能不支持，比如 没有摄像头，或 被禁止访问摄像头\n                    pubS.constaints.audio = preAudio;\n                    pubS.aoff = oldAoff;\n                }\n\n                error && error(_evt);\n            });\n\n            return;\n        }\n\n        updateAndDisabled();\n        success && success(pubS.getMediaStream());\n    },\n\n    iceing: function (streamId) {\n        var self = this;\n\n        return _util.isPlainObject(self.current._linkedStreams[streamId]);\n    },\n\n    recording: function (streamId) {\n        var self = this;\n\n        return _util.isPlainObject(self.current._records[streamId]);\n    },\n\n    startRecord: function (streamId, callback) {\n        var self = this;\n\n        var _stream = self.current._linkedStreams[streamId];\n        if(!_stream){\n            _logger.error(\"not at linked streams\", streamId);\n            throw streamId + \" not at linked streams\";\n        }\n        if(!_stream._webrtc){\n            callback && callback(false);\n        }\n\n        self.current.startRecord(_stream, callback);\n    },\n\n    stopRecord: function (streamId, callback) {\n        var self = this;\n\n        var _stream = self.current._records[streamId];\n        if(!_stream){\n            _logger.error(\"not at recording streams\", streamId);\n            throw streamId + \" not at recording streams\";\n        }\n\n        self.current.stopRecord(_stream, callback);\n    },\n\n    getCurrentMembers: function () {\n        var self = this;\n        return self.current.getCurrentMembers();\n    },\n\n    _onCapturePicture: function (evt) {\n        var self = this;\n\n        var rspBase64Pic = evt.arg.rspBase64Pic;\n        var streamId = evt.arg.streamId;\n        var stream = self.current._cacheStreams[streamId];\n\n        var base64;\n        if(rspBase64Pic){\n            var htmlVideo;\n            if(typeof self.getHTMLVideo !== \"function\" || !(htmlVideo = self.getHTMLVideo(streamId))){\n                _logger.warn(\"Not support capture picture. caused by htmlVideo not found\");\n                return;\n            }\n\n            base64 = self.getCaptureBase64Context(htmlVideo);\n        }else{\n            if(typeof self.onCapturePicture !== \"function\"){\n                _logger.warn(\"Not support capture picture. caused by onCapturePicture not found\");\n                return;\n            }\n            self.onCapturePicture(stream);\n        }\n\n        var message = self.current.newMessage({\n            op: 1001,\n            tsxId: evt.tsxId,\n            memId: evt.memId,\n            arg: JSON.stringify(base64 ? {pic: base64} : {}),\n            result: 0\n        });\n\n        self.current.postMessage(message, function (rsp) {\n            _logger.warn(\"Send remote control onCapturePicture response. the result = \", rsp.result, rsp.msg || \"\");\n        });\n\n        return true;\n    },\n\n    // _onRemotePannelControl: function (evt) {\n    //\n    // },\n\n    newSession: function (attendee, ticket) {\n        var self = this;\n\n        var ExtendSession = self.Session || Session;\n        var session = new ExtendSession({\n            ticket: ticket,\n            owner: attendee,\n\n            onTcklC: function(evt){\n                attendee.onTcklC(evt.rtcId, evt.cands);\n            },\n            onAcptC: function(evt){\n                attendee.onAcptC(evt.rtcId, evt.sdp, evt.cands);\n            },\n            onAnsC: function(evt){\n                attendee.onAnsC(evt.rtcId, evt.sdp, evt.cands);\n            },\n            onTermC: function(evt){\n                //self.onTermC(me, evt);\n                _logger.info(\"Server termc rtc: \", evt.rtcId, evt.message || evt.msg);\n\n                let { endReason } = evt;\n                if(endReason === 21 || endReason === 22){ \n                    _util.forEach(attendee._cacheStreams, function (sid, _stream) {\n                        if(_stream.rtcId === evt.rtcId){\n                            var _event;\n                            if(endReason === 21){ // 建议更换编码方式\n                                _event = new emedia.event.SwitchVCodes({stream: _stream, useVCodes: evt.useVCodes});\n                            }else{\n                                _event = new emedia.event.SubFailNotSupportVCodes({stream: _stream});\n                            }\n\n                            attendee.onEvent(_event);\n                        }\n                    });\n                }else if(endReason == 23) { //达到最大视频数\n                    let onCallBack = self.listeners.mgr.onPubVideoTooMuch;\n                    if(\n                        !onCallBack || \n                        typeof onCallBack != 'function'\n                    ) {\n                        return\n                    }\n    \n                    onCallBack();\n                } else if(endReason == 24) { //达到最大共享桌面数\n                    let onCallBack = self.listeners.mgr.onPubDesktopTooMuch;\n                    if(\n                        !onCallBack || \n                        typeof onCallBack != 'function'\n                    ) {\n                        return\n                    }\n    \n                    onCallBack()\n                } else{\n                    attendee.closeWebrtc(evt.rtcId, false, true);\n                }\n            },\n            onEnter: function(evt){\n                attendee.onEnter(evt.cver, evt.mem);\n            },\n            onExit: function(evt){\n                attendee.onExit(evt.cver, evt.memId, evt.reason || 0);\n            },\n            onPub: function(evt){\n                attendee.onPub(evt.cver, evt.memId, evt.pubS);\n            },\n            onUnpub: function(evt){\n                attendee.onUnpub(evt.cver, evt.memId, evt.pubSId);\n            },\n            onMems: function(evt){\n            },\n            onClose: function(evt){\n                attendee.onClose(evt.cver, evt.confrId);\n            },\n            onEvent: function(evt){\n                attendee.onEvent(evt);\n            },\n            onStreamControl: function (evt) {\n                attendee.onStreamControl(evt.cver, evt.streamId, evt.voff, evt.aoff, evt.sver);\n            },\n            onRoleUpdate: function(evt){\n                attendee._onRoleUpdate(evt.role, evt.roleToken);\n            },\n            onRemoteControl: function (evt) {\n                if(typeof evt.arg === 'string'){\n                    evt.arg = JSON.parse(evt.arg);\n                }\n                if(evt.arg.op2 === 20 && evt.arg.pic && self._onCapturePicture.call(self, evt)){\n                    return;\n                }\n                if(evt.arg.op2 === 30 && self._onRemotePannelControl){\n                    try{\n                        self._onRemotePannelControl.call(self, evt);\n                        return;\n                    }catch (e){\n                        _logger.warn(e);\n                    }\n                }\n\n                // 上麦申请\n                if(evt.arg.op2 === 21){\n\n                    let { memId:applicat_memId, nickName } = evt.arg;\n\n                    if(!applicat_memId) { //申请者 memId\n                        console.warn('onRequestToTalker not have memberId');\n                        return\n                    }\n\n                    self._cache_receive_sessions.push(evt);//将接收到的session 存储\n\n                    let { onRequestToTalker } = self.listeners.mgr;\n\n                    let applicat = {memberId:applicat_memId, nickName}\n                    if(\n                        onRequestToTalker &&\n                        typeof onRequestToTalker == 'function'\n                    ) {\n                        onRequestToTalker(\n                            applicat, \n                            (memberId, talker_is_full_callback) => self.agreeRequestToTalker(memberId,talker_is_full_callback), \n                            memberId => self.refuseRequestToTalker(memberId), \n                        )\n                    }\n                    return;\n                }\n\n                // 主持人申请回调给管理员\n                if(evt.arg.op2 === 22){\n\n                    let { memId:applicat_memId, nickName } = evt.arg;\n\n                    if(!applicat_memId) { //申请者 memId\n                        console.warn('onRequestToAdmin not have memberId');\n                        return\n                    }\n\n                    self._cache_receive_sessions.push(evt);//将接收到的session 存储\n\n                    let { onRequestToAdmin } = self.listeners.mgr;\n                    let applicat = {memberId:applicat_memId, nickName}\n                    if(\n                        onRequestToAdmin &&\n                        typeof onRequestToAdmin == 'function'\n                    ) {\n                        onRequestToAdmin(\n                            applicat, \n                            memberId => self.agreeRequestToAdmin(memberId), \n                            memberId => self.refuseRequestToAdmin(memberId), \n                        )\n                    }\n                    return;\n                }\n\n                // 静音或取消静音 接收消息\n                if(evt.arg.op2 === 23) {\n                    let callBack = self.listeners.mgr.onMuted;\n                    if(\n                        callBack &&\n                        typeof callBack == 'function'\n                    ) {\n                        callBack()\n                        return\n                    }\n                }\n                if(evt.arg.op2 === 24) {\n                    let callBack = self.listeners.mgr.onUnmuted;\n                    if(\n                        callBack &&\n                        typeof callBack == 'function'\n                    ) {\n                        callBack()\n                        return\n                    }\n                }\n\n\n                _logger.warn(\"Not support remote control\");\n\n                var message = attendee.newMessage({\n                    op: 1001,\n                    tsxId: evt.tsxId,\n                    memId: evt.memId,\n                    arg: JSON.stringify(evt.arg),\n                    result: evt && evt.arg && evt.arg.op2 === 30 ? -405 : -507,\n                    msg: \"Not support the remote control.\"\n                });\n\n                attendee.postMessage(message, function (rsp) {\n                    _logger.warn(\"Send remote control response. the result = \", rsp.result, rsp.msg || \"\");\n                });\n            },\n            onRecvRemoteMessage: function (evt) {\n                attendee._onRecvRemoteMessage && attendee._onRecvRemoteMessage(evt.memId, evt.arg, evt);\n            },\n\n            // 402 session的回调 会议属性 和会议状态\n            onConfrAttrsUpdated: session => {\n                // 会议属性 cattrs 处理函数\n                const cattrs_updated = evt => {\n                    \n                    if(!self.listeners.mgr){\n                        return\n                    }\n                    let cattrs = self.listeners.mgr.catrrs || []; //内存中的 会议属性\n\n                    function object_to_array(obj) {\n                        let array = [];\n    \n                        for (let key in obj) {\n                            let _item = {};\n                            _item.key = key;\n                            _item.val = obj[key];\n                            _item.op = '';\n                            array.push(_item);\n                        }\n    \n                        return array;\n                    };\n    \n                    function set_attrs(target_array, array) {\n                        if(array.length == 0){\n                            return target_array;\n                        }\n                    \n                        array.forEach(item => { //有相同key的对象替换，没有则添加\n                            let is_have = false;\n                            target_array.forEach((target_item, index) => {\n                                if(target_item.key == item.key) {\n                                    target_array.splice(index, 1, item) //替换item\n                                    is_have = true;\n                                    return;\n                                }\n                    \n                            })\n                    \n                            if(!is_have) {\n                                target_array.push(item)\n                            }\n                        });\n                        \n                        return target_array;\n                    }\n\n                    // 返回的结构不同，处理\n                    // 示例\n                    /**\n                     * 1. cattrs = {type:\"MIXER\"};\n                     * 2. cattrs = [{key:'type',val:'MIXER',op:'UPDATE}]\n                     * 3. 统一成 array 回调给前面\n                     * */ \n    \n                    if((evt.cattrs instanceof Array) == true){ \n                        cattrs = set_attrs(cattrs, evt.cattrs)\n                    } else {\n                        cattrs = object_to_array(evt.cattrs);\n                    }\n    \n                    self.listeners.mgr.catrrs = cattrs; //将处理后的会议属性保存到内存\n    \n                    // 以下为回调\n                    let onCallBack = self.listeners.mgr.onConfrAttrsUpdated;\n\n                    if(\n                        onCallBack && \n                        typeof onCallBack == 'function'\n                    ) {\n                        onCallBack = onCallBack.bind(self.listeners.mgr);\n                        onCallBack(cattrs)\n                    }\n\n                }\n\n                // 会议属性 cstate 处理函数\n                const cstate_updated = evt => {\n                    if(//会议状态为空 或者空对象\n                        !evt.cstate || \n                        Object.keys(evt.cstate).length == 0\n                    ){\n                        return\n                    }\n\n                    let onCallBack = self.listeners.mgr.onConfrStateUpdated;\n                    if(onCallBack && typeof onCallBack == 'function'){\n                        onCallBack = onCallBack.bind(self.listeners.mgr);\n                        onCallBack(evt.cstate)\n                    }\n                }\n                \n\n                // 收到回调判断是否有 某一个 cattrs 或者 cstate\n                // 会议属性有两种结构\n                // 对象或数组 不是空对象 或 空数组 才可以\n                if(\n                    (session.cattrs instanceof Array) == true && \n                    session.cattrs.length > 0\n                ) { // 非空数组\n                    cattrs_updated(session)\n                }\n                if(\n                    session.cattrs.constructor == Object  && \n                    Object.keys(session.cattrs).length > 0\n                ){ // 非空对象\n                    cattrs_updated(session)\n                }\n\n                if(session.cstate){\n                    cstate_updated(session)\n                }\n\n\n            },\n\n            onAdminChanged: evt => {\n\n                let onCallBack = self.listeners.mgr.onAdminChanged;\n                if(\n                    !onCallBack || \n                    typeof onCallBack != 'function'\n                ) {\n                    return\n                }\n\n                onCallBack(evt)\n            },\n           \n            // 上麦申请的回复\n            onRequestToTalkerReply: result => {\n                let callback = self.listeners.mgr.onRequestToTalkerReply;\n\n                if(\n                    callback &&\n                    typeof callback == 'function'\n                ) {\n                    callback(result)\n                }\n\n            },\n\n            // 主持人申请的回复\n            onRequestToAdminReply: result => {\n                let callback = self.listeners.mgr.onRequestToAdminReply;\n\n                if(\n                    callback &&\n                    typeof callback == 'function'\n                ) {\n                    callback(result)\n                }\n\n            },\n\n            // 存储 liveCfgs\n            onLivecfgsChanged: evt => {\n                if(evt.liveCfgs) {\n                    emedia.config({\n                        liveCfgs: evt.liveCfgs\n                    })\n                }\n            }\n\n        });\n\n        return session;\n    },\n\n    _judgeTalking: function (meter) {\n        if(!meter){\n            return false;\n        }\n\n        return meter.instant >= emedia.config.judgeTalkingByInstantGE;\n    },\n\n    graffitiVideo: function (streamId, videoTag, canvasTag) {\n        var self = this;\n\n        var hxStream = self.getStreamById(streamId);\n\n        var mediaStream = new MediaStream();\n        mediaStream._located = true;\n\n        hxStream._localMediaStream.getAudioTracks().forEach(function(track) {\n            mediaStream.addTrack(track);\n        });\n\n        var drawStream = canvasTag.captureStream(25);\n        drawStream.getVideoTracks().forEach(function(track) {\n            mediaStream.addTrack(track);\n        });\n\n        videoTag.srcObject = mediaStream;\n\n        hxStream.updateAttributes({\n            localStream: mediaStream,\n            isRepublished: true,\n            optimalVideoCodecs: hxStream.optimalVideoCodecs\n        });\n        self.push(hxStream);\n    },\n\n    resetCanvas: function (canvasTag) {\n        var set;\n        if(arguments.length > 1){\n            for(var i = 0; i < arguments.length; i++){\n                set = arguments[i];\n\n                typeof set === \"function\" && set(canvasTag);\n                typeof set !== \"function\" && _util.isPlainObject(set) && _util.forEach(set, function (key, value) {\n                    _logger.debug(\"Canvas set \", key, \" = \", value);\n                    canvasTag.setAttribute(key, value);\n                });\n            }\n        }\n    },\n\n    _random: function (c) {\n        return Math.floor(Math.random() * c)\n    },\n    requestFrame: function (stream, millis) {\n        var self = this;\n\n        var _cacheStream;\n        if(typeof stream === \"string\"){\n            _cacheStream = this.current._cacheStreams[stream];\n        }else if(stream.id){\n            _cacheStream = this.current._cacheStreams[stream.id];\n        }else{\n            return;\n        }\n\n        if(!_cacheStream){\n            return;\n        }\n\n        function _requestFrame() {\n            _cacheStream.requestFrame();\n\n            if(_cacheStream.canvas){\n                var redraw = DefaultMouseTrack.prototype.redraw.bind({_canvasContext: _cacheStream.canvas.getContext(\"2d\")});\n                //_logger.debug(self._random(255));\n                redraw(3, 3);\n            }\n        }\n\n        if(!millis){\n            _requestFrame();\n            return;\n        }\n\n        setTimeout(function () {\n            _requestFrame();\n            self.requestFrame(_cacheStream, millis);\n        }, millis)\n    },\n\n    graffitiCanvas: function (withVoice, canvasTag) {\n        if(_util.targetDOM(withVoice)){\n            canvasTag = withVoice;\n            withVoice = false;\n        }\n\n        var self = this;\n\n        var pubS = new self.ShareDesktopPubstream({\n            voff: 0,\n            aoff: withVoice ? 0 : 1\n        });\n\n        canvasTag || (canvasTag = document.createElement(\"canvas\"));\n\n        //canvasTag.getContext(\"2d\", {willReadFrequently: true}); //Fixed: Firefox captureStream  NS_ERROR_NOT_INITIALIZED\n        canvasTag.getContext(\"2d\");\n        pubS.canvas = canvasTag;\n\n        var diy = function () {};\n        diy.prototype.setCanvas = function(set){\n            this.canvasTag = canvasTag;\n            self.resetCanvas(canvasTag, set);\n\n            return this;\n        };\n\n        diy.prototype.push = function (frameRate, _onpushed) {\n            var diy = this;\n            diy._push(frameRate, _onpushed);\n        };\n        diy.prototype._push = function (frameRate, _onpushed) {\n            if(typeof frameRate === \"function\"){\n                _onpushed = frameRate;\n                frameRate = undefined;\n            }\n\n            canvasTag.captureStream && (canvasTag.captureStream.enabled = true);\n            var drawStream = canvasTag.captureStream(frameRate || 25);\n\n            function pushed(stream) {\n                stream.canvas = canvasTag;\n                _onpushed && _onpushed(stream, canvasTag, drawStream);\n\n                if(withVoice){ //发送一帧视频\n                    stream.requestFrame();\n                }\n            }\n\n            function pub(pubS, pushed) {\n                var mediaStream = new MediaStream();\n                mediaStream._located = true;\n\n                pubS._localMediaStream && pubS._localMediaStream.getAudioTracks().forEach(function(track) {\n                    mediaStream.addTrack(track);\n                });\n\n                drawStream.getVideoTracks().forEach(function(track) {\n                    mediaStream.addTrack(track);\n                });\n\n                pubS._localMediaStream = mediaStream;\n                pubS.localStream = mediaStream;\n                self.push(pubS, pushed);\n            }\n\n            if(withVoice){\n                self.__getUserMedia({audio: true}, function success(_user, stream) {\n                    pubS._localMediaStream = stream;\n                    pub(pubS, pushed);\n                });\n            }else{\n                pub(pubS, pushed);\n            }\n\n            return this;\n        };\n\n        return new diy();\n    },\n\n    blobRecorder: function (mediaStream, options, handleDataAvailable, handleStop) {\n        var self = this;\n\n        if(_util.targetDOM(mediaStream)){\n            mediaStream = mediaStream.srcObject;\n        }\n\n        options || (options = {mimeType: 'video/webm;codecs=vp9'});\n        if (!MediaRecorder.isTypeSupported(options.mimeType)) {\n            _logger.info(options.mimeType, ' is not Supported');\n            options = {mimeType: 'video/webm;codecs=vp8'};\n            if (!MediaRecorder.isTypeSupported(options.mimeType)) {\n                _logger.info(options.mimeType, ' is not Supported');\n                options = {mimeType: 'video/webm'};\n                if (!MediaRecorder.isTypeSupported(options.mimeType)) {\n                    _logger.info(options.mimeType, ' is not Supported');\n                    options = {mimeType: ''};\n                }\n            }\n        }\n\n        try {\n            var mediaRecorder = new MediaRecorder(mediaStream, options);\n        } catch (e) {\n            _logger.error('Exception while creating MediaRecorder: ', e);\n            //alert('Exception while creating MediaRecorder: ' + e + '. mimeType: ' + options.mimeType);\n            return;\n        }\n        var recordedBlobs = [];\n        mediaRecorder.onstop = handleStop || function handleStop(event) {\n            _logger.info('Recorder stopped: ', event);\n        };\n        mediaRecorder.ondataavailable = handleDataAvailable || function(event) {\n            if (event.data && event.data.size > 0) {\n                recordedBlobs.push(event.data);\n            }\n        };\n        // mediaRecorder.start(10); // collect 10ms of data\n        // _logger.error('MediaRecorder started', mediaRecorder);\n\n        function BlobRecorder() {\n            this.blobs = recordedBlobs;\n        }\n        BlobRecorder.prototype.start = function (secornds) {\n            mediaRecorder.start(secornds);\n        };\n        BlobRecorder.prototype.stop = function () {\n            mediaRecorder.stop();\n        };\n        BlobRecorder.prototype.playurl = function (options) {\n            var superBuffer = new Blob(this.blobs, options || {type: 'video/webm'});\n            return window.URL.createObjectURL(superBuffer);\n        };\n        BlobRecorder.prototype.download = function (filename, options) {\n            var blobs = new Blob(this.blobs, options || {type: 'video/webm'});\n            self.downloadFile(filename, undefined, blobs);\n        };\n\n\n        return new BlobRecorder();\n    },\n\n    // 申请上麦\n    requestToTalker:function() {\n        this.current.requestToTalker()\n    },\n    // 读取 _cache_session\n    _get_session_by_memberId_and_op_type: function(memberId, op_type) {\n        if(!memberId || !op_type){\n            return undefined\n        }\n\n        let session = undefined;\n        this._cache_receive_sessions.map(item => {\n            let arg = item.arg;\n\n            if(\n                arg &&\n                arg instanceof Object &&\n                Object.keys(arg).length > 0\n            ) {\n                let { memId: applicant_memberId, op2:op } = arg;\n\n                if( // 比较 memberId 和 op 都相等返回 session\n                    applicant_memberId == memberId &&\n                    op == op_type\n                ) {\n                    session = item\n                }\n            }\n            \n        });\n\n        return session\n    },\n    // 删除 _cache_session\n    _delete_session_by_memberId_and_op_type: function(memberId, op_type) {\n        if(!memberId || !op_type){\n            return\n        }\n\n        let _this = this;\n        this._cache_receive_sessions.map((item, index) => {\n            let arg = item.arg;\n\n            if(\n                arg &&\n                arg instanceof Object &&\n                Object.keys(arg).length > 0\n            ) {\n                let { memId: applicant_memberId, op2:op } = arg;\n\n                if( // 比较 memberId 和 op 都相等 删除这一项\n                    applicant_memberId == memberId &&\n                    op == op_type\n                ) {\n                    _this._cache_receive_sessions.splice(index, 1)\n                }\n            }\n            \n        });\n\n    },\n    // 同意上麦\n    agreeRequestToTalker: async function(memberId, talker_is_full_callback) {\n        let session = this._get_session_by_memberId_and_op_type(memberId, 21);\n        \n        if(!session) {\n            return\n        }\n\n        let { memName } = session.arg;\n        let { confrId } = this.listeners;\n\n        try {\n            await this.listeners.mgr.chanageRoles(3, [memName], confrId);\n        } catch (error) {\n            if(error.error == -523){ //主播已满\n                if(\n                    talker_is_full_callback &&\n                    typeof talker_is_full_callback == 'function'\n                ) { //回调给使用者\n                    talker_is_full_callback();\n                    return  //主播满了不能删除 session\n                }\n            }\n        }\n\n\n        this._delete_session_by_memberId_and_op_type(memberId, 21)\n    },\n    // 拒绝上麦\n    refuseRequestToTalker: function(memberId) {\n        if(!memberId){\n            console.warn('refuseRequestToTalker memberId is required');\n            return\n        }\n        \n        let session = this._get_session_by_memberId_and_op_type(memberId, 21);\n        \n        if(!session) {\n            return\n        }\n        \n        \n        this.current.refuseRequestToTalker(session);\n\n        this._delete_session_by_memberId_and_op_type(memberId, 21)\n    },\n    // 申请主持人\n    requestToAdmin:function() {\n        this.current.requestToAdmin()\n    },\n    // 同意成为主持人\n    agreeRequestToAdmin: function(memberId) {\n        let session = this._get_session_by_memberId_and_op_type(memberId, 22);\n        \n        if(!session) {\n            return\n        }\n\n        let { memName } = session.arg;\n        let { confrId } = this.listeners;\n        this.listeners.mgr.chanageRoles(7, [memName], confrId);\n\n\n        this._delete_session_by_memberId_and_op_type(memberId, 22)\n    },\n    // 拒绝成为主持人\n    refuseRequestToAdmin: function(memberId) {\n        if(!memberId){\n            console.warn('refuseRequestToAdmin memberId is required');\n            return\n        }\n        \n        let session = this._get_session_by_memberId_and_op_type(memberId, 22);\n        \n        if(!session) {\n            return\n        }\n        \n        \n        this.current.refuseRequestToAdmin(session);\n\n        this._delete_session_by_memberId_and_op_type(memberId, 22)\n    },\n    // 指定静音\n    muteBymemberId:function(memberId) {\n\n        if(!this.current) {\n            return\n        }\n\n        if(this.current.role != 7){\n            return\n        }\n        \n        this.current.muteBymemberId(memberId);\n    },\n\n    // 指定取消静音\n    unmuteBymemberId:function(memberId) {\n        if(!this.current) {\n            return\n        }\n\n        if(this.current.role != 7) {\n            return\n        }\n        \n        this.current.unmuteBymemberId(memberId);\n    }\n\n    \n});","\nvar _util = require('./Util');\nvar _logger = _util.tagLogger(\"Member\");\n\nvar __event = require('./event');\n\nvar WebRTC = require('./_Webrtc');\n\n/**\n * 未体现 Member 使用了 session。\n * 请 这样创建\n * Member({_session: sess, _memberId: memberId})\n * this._session\n *\n * {\n *  _memberId:\n *  _ices[Map]:\n * }\n *\n *\n *\n */\nmodule.exports = _util.prototypeExtend({\n    __init__: function(){\n        var self = this;\n\n        if(!self._session) {\n            _logger.error(\"Require session\");\n            throw \"Require session\";\n        }\n\n        self.closed = false;\n        self._ices = {};\n\n        self.supportVCodes = {};\n\n        self.audioMixers = {};\n    },\n\n    reflushSupportVCodes: function (vcodes) {\n        var self = this;\n\n        self.supportVCodes = {};\n\n        self._orderVCodes = vcodes;\n\n        if(!vcodes || vcodes.length == 0){\n            _logger.warn(\"Not config support vcodes\");\n            return;\n        }\n\n        _util.forEach(vcodes, function (index, vcode) {\n            self.supportVCodes[vcode] = 1;\n        });\n    },\n\n    getOptimalVideoCodecs: function () {\n        var self = this;\n\n        if(!self._orderVCodes || self._orderVCodes.length == 0){\n            if(/Chrome/.test(navigator.userAgent)){\n                return 'VP8';\n            }else if (/Safari/.test(navigator.userAgent)){\n                if(/Version\\/11/.test(navigator.userAgent)){\n                    return \"H264\";\n                }\n                return 'VP8';\n            }\n\n            return 'VP8';\n        }\n\n        var memberCount = 0;\n        _util.forEach(self._cacheMembers, function () {\n            memberCount ++;\n        });\n\n\n        var maxSupportCount = 0;\n        var optimalVCode;\n\n        for(var i = 0; i < self._orderVCodes.length; i++){\n            var vcode = self._orderVCodes[i];\n\n            if(maxSupportCount == 0){\n                maxSupportCount = self.supportVCodes[vcode];\n            }\n\n            if(self.supportVCodes[vcode] > memberCount){\n                return vcode;\n            }\n\n            if(self.supportVCodes[vcode] > maxSupportCount){\n                maxSupportCount = self.supportVCodes[vcode];\n                optimalVCode = vcode;\n            }\n        }\n\n        return optimalVCode || (self._orderVCodes && self._orderVCodes.length > 0 && self._orderVCodes[0]);\n    },\n\n    setMemberId: function (memberId) {\n        this._memberId = memberId;\n    },\n\n    getMemberId: function () {\n        return this._memberId || this.id;\n    },\n\n    /**\n     * createWebrtc({\n     *  _rtcId:\n     *  iceServerConfig:\n     *  onGotMediaStream:\n      * onEvent:\n     * })\n     *\n     * @param iceServerConfig\n     */\n    createWebrtc: function(webrtcCfg, rebuildCount){\n        var self = this;\n\n        webrtcCfg || (webrtcCfg = {});\n\n        _util.extend(webrtcCfg, {_rebuildCount: (rebuildCount || 0)});\n\n        if(self._service.useRTCCfg === true && self.__rtc_cfg){ //优先使用 __rtc_cfg\n            webrtcCfg.iceServerConfig = _util.extend(true, {}, self.__rtc_cfg);\n        }else if(_util.isPlainObject(self._service.useRTCCfg)){\n            webrtcCfg.iceServerConfig = _util.extend(true, {}, self._service.useRTCCfg);\n        }\n\n        var webrtc = new WebRTC({\n            //iceServerConfig: iceServerConfig,\n            confrAttendee: self,\n            useIp: self.ip,\n            onIceStateChange: function(iceState){\n                var state = iceState;\n\n                _logger.debug(\"evt.target ice state\", state);\n                try{\n                    if(state == 'failed'){\n                        self.onEvent(new __event.ICEConnectFail({webrtc: webrtc}));\n                        webrtc.onEvent && webrtc.onEvent(new __event.ICEConnectFail({webrtc: webrtc}));\n\n                        return;\n                    }\n                    if(state == 'connected'){\n                        self.onEvent(new __event.ICEConnected({webrtc: webrtc}));\n                        webrtc.onEvent = null;\n\n                        return;\n                    }\n                    if(state == 'closed'){\n                        self.onEvent(new __event.ICEClosed({webrtc: webrtc}));\n                        webrtc.onEvent && webrtc.onEvent(new __event.ICEClosed({webrtc: webrtc}));\n\n                        return;\n                    }\n                    if(state == 'disconnected'){\n                        self.onEvent(new __event.ICEDisconnected({webrtc: webrtc}));\n                        webrtc.onEvent && webrtc.onEvent(new __event.ICEDisconnected({webrtc: webrtc}));\n\n                        return;\n                    }\n                }finally {\n                    self._onIceStateChange && self._onIceStateChange(webrtc, iceState);\n                }\n            },\n\n            onIceCandidate: function (candidate) { //event.candidate\n                self._onIceCandidate && candidate && self._onIceCandidate(webrtc, candidate);\n            },\n\n            onGotRemoteStream: function (remoteStream) {\n                _logger.info(\"got stream.\", webrtc._rtcId, webrtc.__id, remoteStream);\n\n                webrtc.onGotMediaStream && webrtc.onGotMediaStream(remoteStream);\n\n                self.onEvent(new __event.ICERemoteMediaStream({webrtc: webrtc}));\n            },\n            onAddIceCandidateError: function (err) {\n                self.onEvent(new __event.AddIceCandError({webrtc: webrtc, event: err}))\n            },\n            onSetSessionDescriptionError: function (error) {\n                _logger.warn('onSetSessionDescriptionError : Failed to set session description: ' + error.toString());\n                self.onEvent && self.onEvent(new __event.ICEConnectFail({webrtc: webrtc, event: error}));\n            },\n            onCreateSessionDescriptionError: function (error) {\n                _logger.warn('Failed to create session description: ' + error.toString());\n                self.onEvent && self.onEvent(new __event.ICEConnectFail({webrtc: webrtc, event: error}));\n            },\n            // onSetLocalSessionDescriptionSuccess: function (error) {\n            //     _logger.debug('onSetLocalSessionDescriptionSuccess : setLocalDescription complete: ' + error.toString());\n            //     self.onEvent && self.onEvent(new __event.ICEConnectFail({webrtc: webrtc, event: error}));\n            // },\n        }, webrtcCfg);\n\n        (self._ices || (self._ices = {}));\n        if(self._ices[webrtc.getRtcId()]){\n            self._howDoWebrtcWhenCrtExsitsWebrtc(webrtc);\n        }\n        self._ices[webrtc.getRtcId()] = webrtc;\n        self._ices[webrtc.__id] = webrtc;\n\n        self._iceCreateRtcPeerConnection(webrtc.getRtcId());\n        _logger.debug(\"create rtc \", webrtc);\n\n        return webrtc;\n    },\n\n    _howDoWebrtcWhenCrtExsitsWebrtc: function (webrtc) {\n        var self = this;\n\n        //throw \"Webrtc id exsits at ices. it is \" + webrtc.getRtcId();\n        self.closeWebrtc(webrtc.getRtcId(), true, false);\n    },\n\n    connect: function (suceess, fail) {\n        var self = this;\n\n        self._session.connect(suceess, fail);\n    },\n\n    connected: function () {\n        var self = this;\n\n        return self._session.connected();\n    },\n\n    newMessage: function message (cfg) {\n        var self = this;\n\n        var message = self._session.newMessage(cfg);\n        message.post = function (callback, timeoutMillis) {\n            self.postMessage(this, callback, timeoutMillis)\n        };\n\n        return message;\n    },\n\n    message: function (cfg) {\n        var self = this;\n\n        var message = self._session.newMessage(cfg);\n        message.post = function (callback, timeoutMillis) {\n            self.postMessage(this, callback, timeoutMillis)\n        };\n\n        return message;\n    },\n\n    postMessage: function(message, callback, timeoutMillis){\n        var self = this;\n\n        try {\n            message.sessId || (message.sessId = self._session._sessionId);\n            self._session.postMessage(message, callback, timeoutMillis);\n        } catch (e){\n            callback && callback({op: 1001, tsxId: message.tsxId, result: -9527, msg: \"post message. exception\"});\n            _logger.warn(e);\n        }\n    },\n\n    onEvent: function (error) {\n\n    },\n\n    _onIceStateChange: function(webrtc, rtcState){\n        var self = this;\n\n        _logger.info(webrtc.getRtcId(), rtcState);\n        self.onEvent(new __event.ICEChanage({webrtc: webrtc, state: rtcState}));\n    },\n\n    _onIceCandidate: function (webrtc, cand) { //event.candidate\n        var self = this;\n\n        var cands;\n        if(_util.isArray(cand)){\n            cands = cand;\n        }else{\n            cands = [];\n            cands.push(cand);\n        }\n\n        var tcklC = self.newMessage()\n            .setOp(105)\n            .setRtcId(webrtc.getRtcId())\n            .setCands(cands);\n\n        self.postMessage(tcklC, function (rsp) {\n            if(rsp.result != 0){\n                self.onEvent(new __event.RspFail({request: tcklC, response: rsp}));\n\n                return;\n            }\n        });\n    },\n\n    _initC: function (webrtc, stream, sdp, subSId, rspFail, rspSuccess) {\n        var self = this;\n\n        if(stream && stream.rtcId !== webrtc.getRtcId()){\n            _logger.error(\"stream and webrtc rtcId not equal.\");\n            throw \"stream and webrtc rtcId not equal.\";\n        }\n\n        var initC = self.newMessage()\n            .setOp(102)\n            .setRtcId(webrtc.getRtcId())\n            .setSdp(sdp)\n            .setSubSId(subSId);\n\n        webrtc.subArgs && _util.extend(initC, webrtc.subArgs);\n\n        if(stream && stream.located()){\n            initC.setPubS(stream);\n        }\n\n        self.postMessage(initC, function (rsp) {\n            if(rsp.result != 0){\n                self.onEvent(new __event.RspFail({request: initC, response: rsp}));\n                rspFail && rspFail(new __event.RspFail({request: initC, response: rsp, hidden: rsp.retrying === true}));\n\n                return;\n            }\n\n            if(stream && !stream.id && rsp.streamId){\n                stream.updateAttributes({id: rsp.streamId});\n            }\n\n            try{\n                rspSuccess && rspSuccess();\n            }catch(e){\n                _logger.warn(e);\n            }\n\n            rsp.sdp && self.ansC(webrtc.getRtcId(), rsp.sdp, rsp.cands)\n\n            rsp.mems && self.onMembers && self.onMembers(rsp.cver, rsp.mems);\n            rsp.streams && self.onStreams && self.onStreams(rsp.cver, rsp.streams);\n        });\n    },\n\n    _acptC: function (webrtc, sdp, rspFail) {\n        var self = this;\n\n        var acptC = self.newMessage()\n            .setOp(104)\n            .setRtcId(webrtc.getRtcId())\n            .setSdp(sdp);\n\n        self.postMessage(acptC, function (rsp) {\n            if(rsp.result != 0){\n                self.onEvent(new __event.RspFail({request: acptC, response: rsp}));\n                rspFail && rspFail(new __event.RspFail({request: acptC, response: rsp}));\n\n                return;\n            }\n        });\n    },\n\n    _ansCAndPubstream: function(webrtc, stream, sdp, rspFail, rspSuccess){\n        var self = this;\n\n        var ansC = self.newMessage()\n            .setOp(106)\n            .setRtcId(webrtc.getRtcId())\n            .setSdp(sdp);\n\n        webrtc.subArgs && _util.extend(ansC, webrtc.subArgs);\n\n        if(stream && stream.located()){\n            stream = _util.extend({}, stream);\n            _util.removeAttribute(stream, \"mutedMuted\");\n            _util.removeAttribute(stream, \"_located\");\n\n            ansC.setPubS(stream);\n        }\n\n        self.postMessage(ansC, function (rsp) {\n            if(rsp.result != 0){\n                self.onEvent(new __event.RspFail({request: ansC, response: rsp}));\n                rspFail && rspFail(new __event.RspFail({request: ansC, response: rsp, hidden: rsp.retrying === true}));\n\n                return;\n            }\n\n            if(stream && !stream.id && rsp.streamId){\n                stream.updateAttributes({id: rsp.streamId});\n            }\n\n            try{\n                rspSuccess && rspSuccess();\n            }catch(e){\n                _logger.warn(e);\n            }\n        });\n    },\n\n    _ansC: function (webrtc, sdp, rspFail) {\n        var self = this;\n\n        var ansC = self.newMessage()\n            .setOp(106)\n            .setRtcId(webrtc.getRtcId())\n            .setSdp(sdp);\n\n        self.postMessage(ansC, function (rsp) {\n            if(rsp.result != 0){\n                self.onEvent(new __event.RspFail({request: ansC, response: rsp}));\n                rspFail && rspFail(new __event.RspFail({request: ansC, response: rsp}));\n\n                return;\n            }\n        });\n    },\n\n    _termC: function (webrtc, endReason, rspFail) {\n        var self = this;\n\n        var rtcId = (typeof webrtc === \"string\") ? webrtc : webrtc.getRtcId();\n        var termC = self.newMessage()\n            .setOp(107)\n            .setRtcId(rtcId)\n            .setEndReason(endReason);\n\n        self.postMessage(termC, function (rsp) {\n            if(rsp.result != 0){\n                self.onEvent(new __event.RspFail({request: termC, response: rsp}));\n                rspFail && rspFail(new __event.RspFail({request: termC, response: rsp}));\n\n                return;\n            }\n        });\n    },\n\n    _iceCreateRtcPeerConnection: function(rtcId){\n        var self = this;\n\n        self._ices[rtcId].createRtcPeerConnection();\n\n        _logger.debug(\"create rtc peer connection\", rtcId);\n    },\n\n    doOffer: function(rtcId, onGotOffer, onCreateOfferError){\n        var self = this;\n\n        var webrtc = self._ices[rtcId];\n\n        webrtc.createOffer(function(sdp){\n            onGotOffer(sdp);\n        });\n    },\n\n    offerCall: function(rtcId, stream, subSId, rspFail, rspSuccess){\n        var self = this;\n\n        var webrtc = self._ices[rtcId];\n\n        webrtc.createOffer(function(sdp){\n            self._initC && self._initC(webrtc, stream, sdp, subSId, rspFail, rspSuccess);\n        });\n    },\n\n    accept: function(rtcId, rspFail){\n        var self = this;\n\n        var webrtc = self._ices[rtcId];\n        webrtc.createPRAnswer(function(sdp){\n            self._acptC && self._acptC(webrtc, sdp, rspFail);\n        });\n    },\n\n    answerCall: function(rtcId, stream, rspFail, rspSuccess){\n        var self = this;\n\n        var webrtc = self._ices[rtcId];\n\n        webrtc.createAnswer(function(sdp){\n            self._ansCAndPubstream && self._ansCAndPubstream(webrtc, stream, sdp, rspFail, rspSuccess);\n        });\n    },\n\n    answer: function(rtcId, rspFail){\n        var self = this;\n\n        var webrtc = self._ices[rtcId];\n        webrtc.createAnswer(function(sdp){\n            self._ansC && self._ansC(webrtc, sdp, rspFail);\n        });\n    },\n\n    onTcklC: function(rtcId, cands){\n        var self = this;\n        self._addIceCandidate(cands, rtcId);\n    },\n\n    onAcptC: function(rtcId, sdp, cands){\n        var self = this;\n        self._iceSetRemoteSDP(sdp, rtcId);\n        cands && self._addIceCandidate(cands, rtcId);\n    },\n\n    onAnsC: function(rtcId, sdp, cands){\n        var self = this;\n        // setTimeout(function () {\n        //     self._iceSetRemoteSDP(sdp, rtcId);\n        //     cands && self._addIceCandidate(cands, rtcId);\n        // }, 2000);\n\n        self._iceSetRemoteSDP(sdp, rtcId);\n        cands && self._addIceCandidate(cands, rtcId);\n    },\n\n    _addIceCandidate: function(cands, rtcId){\n        var self = this;\n\n        if(!cands || cands.length == 0){\n            _logger.warn(\"drop cands\", cands);\n            return;\n        }\n\n        var webrtc = self._ices[rtcId];\n        webrtc && webrtc.addIceCandidate(cands);\n    },\n\n    closeWebrtc: function(rtcId, remainLocalStream, serverClosed){\n        var self = this;\n        var webrtc = self._ices[rtcId];\n\n        _util.forEach(self._cacheStreams, function (sid, _stream) {\n            if(_stream.rtcId === rtcId && !_stream.located()){\n                try{\n                    var soundMeter = _util.removeAttribute(self._mediaMeters, sid);\n                    soundMeter && soundMeter._finally();\n                }catch(e){\n                    _logger.warn(e);\n                }\n            }\n\n            if(_stream.rtcId === rtcId && _stream.type === 2){\n                _util.removeAttribute(self.audioMixers, _stream.id);\n            }\n        });\n\n        if(!webrtc || webrtc.closed){\n            _logger.warn(\"Webrtc not exsits or closed\", webrtc && webrtc.closed);\n\n            if(serverClosed){\n                webrtc && _util.forEach(self._cacheStreams, function (sid, _stream) {\n                    if(_stream.rtcId === rtcId){\n                        //delete self._linkedStreams[sid];\n                        _util.removeAttribute(self._linkedStreams, sid);\n                        _logger.warn(\"Webrtc close, remvoe from _linkedStreams\", sid);\n                    }\n                });\n            }\n\n            serverClosed || (self._termC(rtcId, 0));\n\n            return;\n        }\n\n        if(self._records){\n            function _stopRecord(_stream) {\n                try{\n                    self.stopRecord(_stream);\n                } catch (e){\n                    _logger.warn(e);\n                } finally {\n                    _util.removeAttribute(self._records, _stream.id);\n                }\n            }\n\n            _util.forEach(self._records, function (sid, _stream) {\n                _stream.rtcId === rtcId && _stopRecord(_stream);\n            });\n        }\n\n        try{\n            serverClosed || (webrtc && self._termC(webrtc, remainLocalStream && webrtc._localStream ? -10 : 0));\n        } finally {\n            //webrtc && _util.removeAttribute(self._ices, rtcId);\n\n            webrtc && webrtc.close(remainLocalStream); //\n            webrtc && self.onWebrtcTermC && self.onWebrtcTermC(webrtc);\n\n            if(remainLocalStream){\n            }else{\n                webrtc && _util.forEach(self._cacheStreams, function (sid, _stream) {\n                    if(_stream.rtcId === rtcId){\n                        if(_stream.located()){\n                            emedia.stopTracks(_stream._localMediaStream);\n\n                            _stream && !_stream.closeReason && _stream.updateAttributes({\n                                closeReason: \"WebrtcClose\"\n                            });\n\n                            self._cacheStreams[sid] && self._linkedStreams[sid] && self.onRemoveStream(_stream);\n\n                            _util.removeAttribute(self._cacheStreams, sid);\n                            self._streamAutomators && _util.removeAttribute(self._streamAutomators, sid);\n                            self._monitSoundChanagedStreams && _util.removeAttribute(self._monitSoundChanagedStreams, sid);\n                            _logger.info(\"Webrtc close. Remove stream\", sid, \". from cache\");\n                        }\n\n                        if(serverClosed){\n                            //delete self._linkedStreams[sid];\n                            _util.removeAttribute(self._linkedStreams, sid);\n                            _logger.info(\"Webrtc close. Remove stream\", sid, \". from _linkedStreams\");\n                        }\n                    }\n                });\n            }\n        }\n\n        return webrtc;\n    },\n\n    __close: function (reason) {\n        _logger.warn(\"closing, reason = \", reason);\n\n        var self = this;\n        if(self.closed){\n            return;\n        }\n\n        self.closed = true;\n\n        if(self.__getCopyInterval){\n            clearInterval(self.__getCopyInterval);\n            _logger.warn(\"Stop interval get copy\");\n        }\n\n\n        if(self._ices) {\n            for(var _rtcId in self._ices){\n                self.closeWebrtc(_rtcId, false);\n            }\n        }\n\n        var exit = self.newMessage()\n            .setOp(201)\n            .setReason(reason || 0);\n        self.postMessage(exit);\n    },\n\n\n    exit: function (closeMyConfrIfICrtConfr) {\n        var self = this;\n\n        if(!closeMyConfrIfICrtConfr){\n            self.close(0); // 正常挂断\n            return;\n        }\n\n        if(closeMyConfrIfICrtConfr){\n            self._closeMyConfr(11);\n            //return;\n        }\n        setTimeout(function () {\n            self.close(0); // 正常挂断\n        }, 100);\n    },\n\n    _closeMyConfr: function (reason) {\n        var self = this;\n\n        var closeConfr = self.newMessage()\n            .setOp(204)\n            .setReason(reason || 0);\n        self.postMessage(closeConfr,  function (rsp) {\n            _logger.warn(\"Close confr \", rsp.result, rsp.msg);\n        });\n    },\n\n    /**\n     * 1.服务端 踢掉\n     * 2.手动点击 挂断\n     * 3.enter失败！\n     *\n     * @param reason\n     */\n    close: function (reason, failed) {\n        var self = this;\n        if(self.closed){\n            return;\n        }\n\n        try{\n            _util.forEach(self._cacheStreams || {}, function (sid, _stream) {\n                if(_stream.located() && _stream._localMediaStream){\n                    emedia.stopTracks(_stream._localMediaStream);\n                }\n            });\n\n            self.__close(reason);\n\n            _util.forEach(self._cacheStreams, function (sid, _stream) {\n                self.onRemoveStream(_stream);\n            });\n            _util.forEach(self._cacheMembers, function (_id, _member) {\n                self.onRemoveMember(_member);\n            });\n        } finally {\n            try{\n                setTimeout(function () {\n                    self._session && self._session.close(reason);\n                }, 500);\n\n                self.onEvent(new __event.Hangup({reason: reason, failed: failed, self: {id: self._memberId}}));\n                self.onMeExit && self.onMeExit(reason, failed);\n            } catch (e) {\n                _logger.error(e);\n            } finally {\n                self._onFinally && self._onFinally();\n            }\n        }\n    },\n\n    webrtcState: function(rtcId){\n        var self = this;\n\n        var webrtc = self._ices[rtcId];\n        return webrtc.iceConnectionState();\n    },\n\n    _iceSetRemoteSDP: function (sdp, rtcId) {\n        var self = this;\n\n        var webrtc = self._ices[rtcId];\n        webrtc && webrtc.setRemoteDescription(sdp);\n    },\n\n    setLocalStream: function(stream, rtcId){\n        var self = this;\n\n        var webrtc = self._ices[rtcId];\n        webrtc.setLocalStream(stream);\n    },\n\n    onWebrtcTermC: function (_webrtc) {\n\n    }\n});","/*\n *  Copyright (c) 2015 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n\n'use strict';\n\n// Meter class that generates a number correlated to audio volume.\n// The meter class itself displays nothing, but it makes the\n// instantaneous and time-decaying volumes available for inspection.\n// It also reports on the fraction of samples that were at or near\n// the top of the measurement range.\nfunction SoundMeter(context) {\n  this.context = context;\n  this.instant = 0.0;\n  this.slow = 0.0;\n  this.clip = 0.0;\n  this.script = context.createScriptProcessor(2048, 1, 1);\n  var that = this;\n  this.script.onaudioprocess = function(event) {\n    var input = event.inputBuffer.getChannelData(0);\n    var i;\n    var sum = 0.0;\n    var clipcount = 0;\n    for (i = 0; i < input.length; ++i) {\n      sum += input[i] * input[i];\n      if (Math.abs(input[i]) > 0.99) {\n        clipcount += 1;\n      }\n    }\n    that.instant = Math.sqrt(sum / input.length);\n    that.slow = 0.95 * that.slow + 0.05 * that.instant;\n    that.clip = clipcount / input.length;\n  };\n}\n\nSoundMeter.prototype.connectToSource = function(stream, callback) {\n  console.log('SoundMeter connecting');\n  try {\n    this.mic = this.context.createMediaStreamSource(stream);\n    this.mic.connect(this.script);\n    // necessary to make sample run, but should not be.\n    this.script.connect(this.context.destination);\n    if (typeof callback !== 'undefined') {\n      callback(null);\n    }\n  } catch (e) {\n    console.error(e);\n    if (typeof callback !== 'undefined') {\n      callback(e);\n    }\n  }\n};\nSoundMeter.prototype.stop = function() {\n  this.mic.disconnect();\n  this.script.disconnect();\n};\n\n\nmodule.exports = SoundMeter;","\nvar _util = require('./Util');\nvar _logger = _util.tagLogger(\"Handler\");\n\nvar __event = require('./event');\n\n\n/**\n * Error({\n *   code:\n *   targetObj:\n *   evtObj:\n * })\n *\n *\n *\n *\n */\nvar Handler = _util.prototypeExtend({\n    onEvent: function(evt){\n        if(this.mgr.upload_stats) {// upload qoe\n            this.mgr.upload_stats.upload_event(evt)\n        }\n        var self = this;\n\n        evt && _logger.info(\"[EVT]\", evt.message(), evt.hidden || \"\");\n\n        if(evt instanceof __event.ServerRefuseEnter){\n            evt.failed && evt.failed === -95270 && (evt.failed = -9527);\n        }\n\n        function afterNotify() {\n            try{\n                self.handleEvent(evt);\n            }catch(e){\n                _logger.warn(e);\n            }\n        }\n\n        if(evt instanceof emedia.event.StreamState && evt.stream && evt.stream.located()){\n            afterNotify();\n            return;\n        }\n\n        try{\n            evt.hidden || (self.onNotifyEvent && self.onNotifyEvent(evt));\n        } finally {\n            afterNotify();\n        }\n    },\n\n    handleEvent: function (evt) {\n        var self = this;\n\n        if(evt instanceof __event.RecvResponse){\n            self._onRecvResponse(evt);\n        } else if(evt instanceof __event.ServerRefuseEnter){\n            _logger.warn(\"Server refuse, \", evt.failed, evt.msg);\n            self.onServerRefuseEnter(evt);\n        } else if(evt instanceof __event.NetworkChanaged){\n            _logger.warn(\"Network chanaged, \", evt.preIp, evt.nowIp);\n            self.onNetworkChanaged(evt);\n        } else if(evt instanceof __event.EnterFail){\n            _logger.warn(\"Enter fail, result = \", evt.failed);\n            self.onEnterFail();\n        } else if(evt instanceof __event.WSClose){\n            //_logger.warn(\"Websocket closed\");\n            self.onWSClose();\n        } else if(evt instanceof __event.WSConnected){\n            _logger.warn(\"Websocket connected\");\n        } else if(evt instanceof __event.ICEConnected){\n            var webrtc = evt.webrtc;\n            self.onICEConnected(webrtc);\n        } else if(evt instanceof __event.ICEConnectFail){\n            var webrtc = evt.webrtc;\n            self.onICEConnectFail(webrtc);\n        } else if(evt instanceof __event.ICEDisconnected){ //只要ICE断开\n            var webrtc = evt.webrtc;\n            self.onICEDisconnected(webrtc);\n        }  else if(evt instanceof __event.ICEClosed){ //只要ICE断开\n            var webrtc = evt.webrtc;\n            self.onICEClosed(webrtc);\n        } else if(evt instanceof __event.ICERemoteMediaStream) {\n            self.onICERemoteMediaStream(evt.webrtc);\n        } else if(evt instanceof __event.PushSuccess){\n            self._cacheStreams[evt.stream.id] = self._linkedStreams[evt.stream.id] = evt.stream;\n\n            var _stream = self.newStream(evt.stream);\n\n            if(evt.hidden && !self._maybeNotExistStreams[evt.stream.id] && !_stream.isRepublished){\n                self._onAddStream(_stream);\n                return;\n            }\n\n            emedia._yetGetUserMedia = true;\n\n            try{\n                //_stream && (_stream.mediaStream = _stream.getMediaStream());\n                (evt.hidden !== true) && _stream && self.onUpdateStream(_stream,\n                    new _stream.Update({voff: _stream.voff, aoff: _stream.aoff, mediaStream: _stream.getMediaStream()}));\n\n                // _util.forEach(self._cacheStreams, function (_pubSId, _stream) {\n                //     if(_stream.type === 2){\n                //         self.onStreamControl(undefined, _pubSId, _stream.voff, _stream._1_aoff);\n                //     }\n                // });\n            } finally {\n                if(emedia.isSafari){\n                    _util.forEach(self._cacheStreams, function (_sid, _stream) {\n                        if(_stream._autoSubWhenPushStream === true){\n                            _util.removeAttribute(_stream, \"_autoSubWhenPushStream\");\n                            self.createWebrtcAndSubscribeStream(_stream.id);\n                        }\n                    });\n                }\n            }\n        } else if(evt instanceof __event.SubSuccess){\n            console.log('__event.SubSuccess', evt);\n            self._linkedStreams[evt.stream.id] = evt.stream;\n            evt.stream.updateAttributes({_zoom: 1});\n        } else if(evt instanceof __event.PushFail){\n            if(evt.hidden !== true){\n                var _removeStream = _util.removeAttribute(self._linkedStreams, evt.stream.id);\n                _logger.warn(\"PushFail remove from _linkedStreams\", evt.stream.id, _removeStream);\n\n                if(_removeStream){\n                    var _stream = self.newStream(evt.stream);\n                    self.onRemoveStream(_stream);\n                }\n            }\n        } else if(evt instanceof __event.SubFail){\n            if(evt.hidden !== true){\n                //delete self._linkedStreams[evt.stream.id];\n                _util.removeAttribute(self._linkedStreams, evt.stream.id);\n                _logger.warn(\"SubFail remove from _linkedStreams\", evt.stream.id);\n\n                var _stream = self.newStream(evt.stream);\n                _stream.updateAttributes({\n                    rtcId: undefined,\n                    _webrtc: undefined,\n                    mediaStream: undefined\n                });\n\n                self.onUpdateStream(_stream, new _stream.Update(_stream));\n            }\n        } else if(evt instanceof __event.SubFailNotSupportVCodes){\n            // Server发现 此订阅时 不支持视频视频编码。或者 推送流 打开视频时，并不是所有的订阅端 都支持此视频编码\n            // Server保持这个channel，客户端自行处理\n\n            var stream = evt.stream;\n\n            _logger.warn(\"Rtc donot support pub VCodes. close. sub fail.\", stream.rtcId, \" -> \", stream.id);\n            try{\n                self.onNotSupportPublishVideoCodecs && self.onNotSupportPublishVideoCodecs(stream);\n            }catch (e){\n                _logger.warn(e);\n            }\n\n            // var streamId = stream.id;\n            //\n            // var webrtc = self._getWebrtc(streamId);\n            // if(webrtc && webrtc.isConnected()){\n            //     self.subscribeStream(webrtc._rtcId, streamId, undefined, {subSVideo: false, subSAudio: true});\n            //     return;\n            // }\n        } else if(evt instanceof __event.EnterSuccess){\n            console.log('__event.EnterSuccess', evt);\n            self.onEnterSuccess();\n        } else if(evt instanceof  __event.SwitchVCodes) {\n            var stream = evt.stream;\n            var useVCodes = evt.useVCodes;\n\n            var webrtc = stream._webrtc;\n            _logger.warn(\"Rtc switch VCodes. \", stream.id, useVCodes);\n\n            if (!useVCodes || useVCodes.length == 0) {\n                _logger.warn(\"Rtc switch VCodes. error! useVCodes is empty \", stream.id, useVCodes);\n            }\n\n            var forceUseVideoCodecs;\n            if(emedia.config && emedia.config.forceUseVideoCodecs && emedia.config.forceUseVideoCodecs.length > 0){\n                forceUseVideoCodecs = emedia.config.forceUseVideoCodecs;\n                if(!_util.isArray(forceUseVideoCodecs)){\n                    forceUseVideoCodecs = [];\n                    forceUseVideoCodecs.push(emedia.config.forceUseVideoCodecs)\n                }\n            }\n            // if(forceUseVideoCodecs){\n            //     //与 useVCodes 取 交集\n            //     var newVCodes = [];\n            //     for(var index in useVCodes){\n            //         var vcode = useVCodes[index];\n            //\n            //         for(var ii in forceUseVideoCodecs){\n            //             if(forceUseVideoCodecs[ii] === vcode){\n            //                 newVCodes.push(vcode);\n            //             }\n            //         }\n            //     }\n            //     useVCodes = evt.useVCodes = newVCodes;\n            //     _logger.warn(\"Rtc switch VCodes. subset! config forceUseVideoCodecs. new useVCodes\", stream.id, useVCodes);\n            // }\n            // if (!useVCodes || useVCodes.length == 0) {\n            //     _logger.warn(\"Rtc switch VCodes. error! useVCodes is empty \", stream.id, useVCodes);\n            // }\n            if(forceUseVideoCodecs){\n                if(typeof forceUseVideoCodecs === 'string'\n                    && forceUseVideoCodecs !== useVCodes[0]){\n                    _logger.warn(\"Rtc switch VCodes. igrone . useVCodes !== forceUseVideoCodecs \",\n                        stream.id, webrtc._rtcId, useVCodes, forceUseVideoCodecs);\n                    return;\n                }\n                if(_util.isArray(forceUseVideoCodecs)\n                    && forceUseVideoCodecs[0] !== useVCodes[0]){\n                    _logger.warn(\"Rtc switch VCodes. igrone ddd . useVCodes == forceUseVideoCodecs \",\n                        stream.id, webrtc._rtcId, useVCodes, forceUseVideoCodecs);\n                    return;\n                }\n            }\n\n            if(webrtc && webrtc.optimalVideoCodecs){\n                if(typeof webrtc.optimalVideoCodecs === 'string'\n                    && webrtc.optimalVideoCodecs == useVCodes[0]){\n                    _logger.warn(\"Rtc switch VCodes. igrone . useVCodes == optimalVideoCodecs \", stream.id, webrtc._rtcId, useVCodes);\n                    return;\n                }\n                if(_util.isArray(webrtc.optimalVideoCodecs)\n                    && webrtc.optimalVideoCodecs.length > 0\n                    && webrtc.optimalVideoCodecs[0] == useVCodes[0]){\n                    _logger.warn(\"Rtc switch VCodes. igrone ddd . useVCodes == optimalVideoCodecs \", stream.id, webrtc._rtcId, useVCodes);\n                    return;\n                }\n            }\n\n            stream.updateAttributes({optimalVideoCodecs: useVCodes});\n\n            webrtc && self.closeWebrtc(webrtc.getRtcId(), true);\n            setTimeout(function () {\n                stream.updateAttributes({iceRebuildCount: 1});\n                self.iceRebuild(stream);\n                _logger.warn(\"Rtc switch VCodes. iceRebuild end.\", stream.id, useVCodes);\n            }, 300);\n        }\n    },\n\n    _onRecvResponse: function (evt) {\n        var self = this;\n\n        var request = evt.request;\n        var response = evt.response;\n\n        if(request && response\n            && request.op !== 200\n            && request.op !== 1002\n            && response.result !== 0){\n\n            _logger.warn(\"Server refuse. when request = \", request);\n\n            var failed = evt.failed;\n            switch (failed){\n                case -9527:\n                case -95270:\n                    //self.close(4, -9527);\n                    break;\n                case -500:\n                case -502:\n                case -504:\n                case -508:\n                case -510:\n                    self.close(4, failed);\n                    break;\n                case -506:\n                    self.close(11, failed);\n                    break;\n\n                case -501:\n                    self.close(11, failed);\n                default: // -501 异常引起 忽略\n            }\n        }\n    },\n\n    onServerRefuseEnter: function (evt) {\n        var self = this;\n\n        var failed = evt.failed;\n        switch (failed){\n            case -9527:\n            case -95270:\n                self.close(4, -9527);\n                break;\n            case -500:\n            case -502:\n            case -504:\n            case -508:\n            case -510:\n                self.close(4, failed);\n                break;\n            case -506:\n                self.close(11, failed);\n                break;\n            default:\n                self.close(2);\n        }\n    },\n\n    onEnterFail: function () {\n        var self = this;\n\n        if(self.__getCopyInterval){\n            clearInterval(self.__getCopyInterval);\n        }\n    },\n\n    //会在enter success后回调\n    onNetworkChanaged: function (evt) {\n        var self = this;\n\n        //var preIp = evt.preIp;\n        var nowIp = evt.nowIp;\n\n        if(emedia.config.rebuildPeerConnectionWhenNetworkChanaged){\n            setTimeout(function () {\n                //ip地址改变，需要将 useIp == preIp 和 useIp == undefined webrtc，rebuild\n                var tmp = {};\n                _util.forEach(self._cacheStreams, function (_sid, stream) {\n                    if(!self._maybeNotExistStreams[_sid]){\n                        //_maybeNotExistStreams 中的stream 将在 Enter success后，重建，所以在_maybeNotExistStreams中，不需要rebuild\n                        if(stream._webrtc) {\n                            var _webrtc = stream._webrtc;\n                            if (tmp[stream.rtcId]) {\n\n                            } else {\n                                if (!_webrtc.closed && (typeof _webrtc.useIp === \"string\") && _webrtc.useIp !== nowIp) {\n                                    _logger.warn(\"network chanage. webrtc will rebuild.\", _webrtc._rtcId, _webrtc.__id);\n                                    self.onICEClosed(_webrtc);\n                                }\n                                tmp[stream.rtcId] = true;\n                            }\n                        }\n                    }\n                });\n\n                // _util.forEach(self._ices, function (_id, _webrtc){\n                //     if(_id === _webrtc._rtcId && !_webrtc.closed && (typeof _webrtc.useIp === \"string\") && _webrtc.useIp !== nowIp){\n                //         _logger.warn(\"network chanage. webrtc will rebuild.\", _webrtc._rtcId, _webrtc.__id);\n                //         self.onICEClosed(_webrtc);\n                //     }\n                // });\n            }, 100);\n        }\n    },\n\n    onEnterSuccess: function () {\n        var self = this;\n\n        setTimeout(function () {\n            self._failIcesRebuild();\n        }, 50);\n\n        if(self.getCopyIntervalMillis && self.getCopyIntervalMillis > 0){\n            _logger.warn(\"Run interval get copy. interval = \", self.getCopyIntervalMillis);\n\n            if(self.__getCopyInterval){\n                clearInterval(self.__getCopyInterval);\n            }\n\n            self.__getCopyInterval = setInterval(function () {\n                if(self._session.connected()){\n                    self._sysCopy.apply(self);\n                }else{\n                    _logger.warn(\"Warn! cannot get copy. cause offline.\");\n\n                    self.__getCopyInterval && clearInterval(self.__getCopyInterval);\n                }\n            }, self.getCopyIntervalMillis);\n        }\n\n        if(self.getMediaMeterIntervalMillis && self.getMediaMeterIntervalMillis > 0){\n            self._intervalGetMediaMeters();\n        }\n    },\n\n    _intervalGetMediaMeters: function () {\n        var self = this;\n\n        function _start() {\n            self.__getMediaMetersIntervalFlag && emedia.cancelAnimationFrame(self.__getMediaMetersIntervalFlag);\n\n            if(!self.getMediaMeterIntervalMillis){\n                _logger.warn(\"Ontalking closed. please use getMediaMeterIntervalMillis\");\n                return;\n            }\n            self.__getMediaMetersIntervalFlag = emedia.requestAnimationFrame(function (time) {\n                if(typeof emedia.AudioContext === 'function'){\n                    self._flushMediaMetersByAudioContext.apply(self);\n                }\n\n                !(self.closed !== false) && _start();\n            }, self.getMediaMeterIntervalMillis);\n        }\n        _start();\n    },\n\n    _flushMediaMetersByAudioContext: function () {\n        var self = this;\n\n        _util.forEach(self._cacheStreams, function (_sid, _stream){\n            if(!self._monitSoundChanagedStreams || self._monitSoundChanagedStreams[_sid]){\n                _stream.id != \"0\" && self._updateMetersOrNewOne.call(self, _sid, _stream);\n            }\n        });\n\n        var delStreamSoundMeters = [];\n        _util.forEach(self._mediaMeters, function (_sid, streamSoundMeter){\n            var _stream = self._cacheStreams[_sid];\n            _stream && self._updateMetersOrNewOne.call(self, _sid, _stream);\n            _stream || delStreamSoundMeters.push(_sid);\n        });\n\n        _util.forEach(delStreamSoundMeters, function (index, _sid) {\n            _util.removeAttribute(self._mediaMeters, _sid);\n        })\n    },\n\n    _updateMetersOrNewOne: function (_sid, _stream) {\n        var self = this;\n\n        var metersData;\n\n        var streamSoundMeter = self._mediaMeters[_sid];\n\n        if(_stream.type === 2 && !_stream.located() && (!_stream.subArgs || !_stream.subArgs.subSAudio)) {\n            var pubAudioMixersStream = self._oneAudioMixers();\n            if (!pubAudioMixersStream\n                || (streamSoundMeter && streamSoundMeter._webrtc && pubAudioMixersStream._webrtc.__id != streamSoundMeter._webrtc.__id) ) {\n                streamSoundMeter && streamSoundMeter._finally();\n                _util.removeAttribute(self._mediaMeters, _sid);\n                self._onSoundChanage.call(self, _stream.owner, _stream);\n\n                return;\n            }\n        }\n\n        if(streamSoundMeter\n            && streamSoundMeter._streamCreateId === _stream.__create_id\n            && streamSoundMeter.__mediaSoundMeter.__worked){\n\n            streamSoundMeter.onSoundMeters(function (metersData) {\n                self._onSoundChanage.call(self, _stream.owner, _stream, metersData);\n            });\n\n            return streamSoundMeter;\n        }\n\n        if((streamSoundMeter && (streamSoundMeter._streamCreateId !== _stream.__create_id || streamSoundMeter.__mediaSoundMeter.__worked))){\n            streamSoundMeter && streamSoundMeter._finally();\n            _util.removeAttribute(self._mediaMeters, _sid);\n            self._onSoundChanage.call(self, _stream.owner, _stream);\n        }\n\n        if(_stream.aoff){\n            return;\n        }\n\n        streamSoundMeter = self._newMediaMeters(_stream);\n        if(streamSoundMeter){\n            self._mediaMeters[_sid] && (self._mediaMeters[_sid]._finally());\n            self._mediaMeters[_sid] = streamSoundMeter;\n        }\n\n        return streamSoundMeter;\n    },\n\n    _newAudioContext: function () {\n        var self = this;\n\n        if(!emedia.__usingWebAudio){\n            return;\n        }\n\n        return emedia.__audioContext;\n    },\n\n    _newMediaMeters: function (_stream) {\n        var self = this;\n\n        var mediaStream;\n        if(_stream.type === 2\n            && _stream.subArgs\n            && _stream.subArgs.subSAudio\n            && _stream._webrtc\n            && _stream._webrtc.getRemoteStream()){\n            var soundMeter = new _stream.StreamSoundMeter({\n                _stream: _stream,\n                _mediaStream: _stream._webrtc.getRemoteStream(),\n                _webrtc: _stream._webrtc,\n                __audioContext: self._newAudioContext()\n            });\n\n            return soundMeter;\n        }\n\n        if(_stream.type === 2 && _stream.located()){\n            var soundMeter = new _stream.StreamSoundMeter({\n                _stream: _stream,\n                _mediaStream: _stream._localMediaStream,\n                __audioContext: self._newAudioContext()\n            });\n\n            return soundMeter;\n        }\n\n        if(_stream.type === 2 && !_stream.located()){\n            var pubAudioMixersStream = self._oneAudioMixers();\n            if(!pubAudioMixersStream || !pubAudioMixersStream._webrtc || pubAudioMixersStream._webrtc.closed){\n                return;\n            }\n\n            if(pubAudioMixersStream\n                && (pubAudioMixersStream._remoteMediaSoundMeters === undefined || !pubAudioMixersStream._remoteMediaSoundMeters.__worked)\n                && pubAudioMixersStream._webrtc\n                && pubAudioMixersStream._webrtc.getRemoteStream()){\n                pubAudioMixersStream._remoteMediaSoundMeters = new pubAudioMixersStream.MediaSoundMeter({\n                    _mediaStream: pubAudioMixersStream._webrtc.getRemoteStream(),\n                    __audioContext: self._newAudioContext()\n                });\n            }\n\n            if(!pubAudioMixersStream._remoteMediaSoundMeters){\n                return;\n            }\n\n            var soundMeter = new _stream.StreamSoundMeter({\n                _stream: _stream,\n                _webrtc: pubAudioMixersStream._webrtc,\n                __mediaSoundMeter: pubAudioMixersStream._remoteMediaSoundMeters\n            });\n\n            return soundMeter;\n        }\n\n        if(!_stream.aoff && (mediaStream = _stream.getMediaStream())){\n            var soundMeter = new _stream.StreamSoundMeter({\n                _stream: _stream,\n                _mediaStream: mediaStream,\n                __audioContext: self._newAudioContext()\n            });\n\n            return soundMeter;\n        }\n    },\n\n    _oneAudioMixers: function () {\n        var self = this;\n\n        var zeroStream = self._cacheStreams[\"0\"];\n        if(zeroStream && zeroStream._webrtc && !zeroStream._webrtc.closed){\n            return zeroStream;\n        }\n\n        for(var sid in self.audioMixers) {\n            var stream = self.audioMixers[sid];\n            if(stream.located()){\n                return stream;\n            }\n        }\n    },\n\n    onWSClose: function () {\n        var self = this;\n        if(self.__getCopyInterval){\n            clearInterval(self.__getCopyInterval);\n        }\n\n        _logger.info(\"Websocket closed.\");\n    },\n\n    onICEDisconnected: function (webrtc) {\n        var self = this;\n\n        self.__networkWeakInterval && clearTimeout(self.__networkWeakInterval);\n        self.__networkWeakInterval = setTimeout(function () {\n            self.onNetworkWeak && self.onNetworkWeak();\n        }, 1000);\n\n        _util.forEach(self._linkedStreams, function (sid, stream) {\n            if(stream.rtcId == webrtc.getRtcId()){\n                var problemStream;\n                if(!(problemStream = self._maybeNotExistStreams[sid])){\n                    problemStream = self._maybeNotExistStreams[sid] = _util.extend({}, stream);\n                    problemStream.updateAttributes({iceRebuildCount: 1});\n                }\n\n                _logger.info(\"Stream maybe not exist. caused by disconnected\", stream.id);\n            }\n        });\n    },\n\n    onICEConnectFail: function (webrtc) {\n        var self = this;\n\n        for(var sid in self._linkedStreams){\n            var stream = self._linkedStreams[sid];\n            if(stream.rtcId == webrtc.getRtcId()){\n                if(stream._webrtc && stream._webrtc.__id !== webrtc.__id){\n                    _logger.warn(\"Stream use other webrtc rtcId = \", stream.rtcId, \", id: \", stream._webrtc.__id, webrtc.__id);\n                    continue;\n                }\n\n                var problemStream;\n                if(!(problemStream = self._maybeNotExistStreams[sid])){\n                    problemStream = self._maybeNotExistStreams[sid] = _util.extend({}, stream);\n                    problemStream.updateAttributes({iceRebuildCount: 1});\n                }\n\n                if(problemStream){\n                    var _evt = new __event.StreamState({stream: problemStream});\n                    _evt.iceFail();\n\n                    self.onEvent(_evt);\n                }\n\n                _logger.info(\"ice fail. webrtc = \", webrtc.getRtcId(), \" problem stream is \", problemStream.iceRebuildCount, problemStream.id);\n\n                if(problemStream.iceRebuildCount > emedia.config.iceRebuildCount){\n                    _logger.info(\"ice fail. webrtc = \", webrtc.getRtcId(), \" rebuild fail. problem stream is \", problemStream.id);\n\n                    if(problemStream.located()){\n                        self.onEvent(new __event.PushFail({\n                            stream: stream,\n                            cause: \"pub ice rebuild failed.\"\n                        }));\n                    }else{\n                        self.onEvent(new __event.SubFail({\n                            stream: stream,\n                            cause: \"sub ice rebuild failed.\"\n                        }));\n                    }\n                    self.closeWebrtc(webrtc.getRtcId(), false);\n                }else{\n                    var recording = self._records[problemStream.id];\n\n                    if(problemStream._localMediaStream){\n                        _logger.info(\"ice fail. webrtc = \", webrtc.getRtcId(), \" will rebuild. remain local stream. \", problemStream.id);\n                    }else{\n                        _logger.info(\"ice fail. webrtc = \", webrtc.getRtcId(), \" will rebuild.\", problemStream.id);\n                    }\n\n                    self.closeWebrtc(webrtc.getRtcId(), true);\n\n                    if(recording){\n                        self._records[problemStream.id] = recording;\n                    }\n\n                    (function (problemStream) {\n                        setTimeout(function () {\n                            self.iceRebuild(problemStream);\n                        }, emedia.config.iceRebuildIntervalMillis);\n                    })(problemStream);\n\n                    _logger.info(\"ice fail. webrtc = \", webrtc.getRtcId(), \" will rebuilding. problem stream is \", problemStream.id);\n                }\n\n                if(stream.type === 2){\n                    _util.removeAttribute(self.audioMixers, stream.id);\n                }\n            }\n        }\n    },\n\n    onICEClosed: function (webrtc) {\n        var self = this;\n\n        if(webrtc.closed){\n            _logger.warn(\"Webrtc will be removed. by __id = \", webrtc.__id, \", rtcId = \", webrtc.getRtcId());\n            var removedWebrtc = _util.removeAttribute(self._ices, webrtc.__id);\n            if(removedWebrtc){\n                _logger.warn(\"Webrtc removed. by id = \", removedWebrtc.__id, \", rtcId = \", removedWebrtc.getRtcId());\n            }else{\n                _logger.warn(\"Webrtc removed. by id = \", webrtc.__id, \", rtcId = \", webrtc.getRtcId());\n            }\n\n            var webrtc22 = self._ices[webrtc.getRtcId()];\n            if(webrtc22 && webrtc22.__id === removedWebrtc.__id){\n                removedWebrtc = _util.removeAttribute(self._ices, webrtc.getRtcId());\n                _logger.warn(\"Webrtc removed. by rtcId = \", removedWebrtc.getRtcId(), \", __id = \", removedWebrtc.__id);\n            }\n        }else{\n            _logger.info(\"ICE self closed. not allow. will rebuild\", webrtc.getRtcId());\n            self.onICEConnectFail(webrtc);\n        }\n    },\n\n    onICEConnected: function (webrtc) {\n        var self = this;\n\n        _util.forEach(self._cacheStreams, function (sid, stream) {\n            if(stream.rtcId == webrtc.getRtcId()){\n                stream.updateAttributes({finalVCodeChoices: webrtc.finalVCodeChoices});\n\n                if(self._maybeNotExistStreams[sid]){\n                    _util.removeAttribute(self._maybeNotExistStreams, stream.id);\n                    self._linkedStreams[sid] = stream;\n\n                    _logger.info(\"ice reconnected. webrtc = \", webrtc.getRtcId(), \"will update stream = \", stream.id);\n                    //stream.located() && self.onUpdateStream(self._linkedStreams[stream.id]);\n                    //self.onUpdateStream(self._linkedStreams[stream.id]);\n\n                    var _recordStream = self._records[stream.id];\n                    if(_recordStream && _recordStream.rtcId !== stream.rtcId){ //在重连后，恢复录制\n                        //self.stopRecord(_recordStream);\n                        self.startRecord(stream);\n                        _logger.warn(\"Re record. for \", stream.id, \", after rebuild ice.\", _recordStream.rtcId, \"->\", stream.rtcId);\n                    }\n                } else {\n                    _logger.info(\"ice connected. webrtc = \", webrtc.getRtcId(), stream.id);\n\n                    stream.located() && self.onEvent(new __event.PushSuccess({stream: stream}));\n                    stream.located() || self.onEvent(new __event.SubSuccess({stream: stream}));\n                }\n\n                if(stream.type === 2){\n                    self.audioMixers[stream.id] = stream;\n                }\n            }\n        });\n    },\n\n    onICERemoteMediaStream: function (webrtc) {\n        var self = this;\n\n        var streams = [];\n        _util.forEach(self._cacheStreams, function (sid, _stream) {\n            if (_stream.rtcId == webrtc.getRtcId() && (!_stream.located() || _stream.type === 2)) {\n                var mediaStream = webrtc.getRemoteStream();\n                self._updateRemoteStream(_stream, mediaStream);\n\n                if(_stream.onGotRemoteMediaStream){\n                    _stream.onGotRemoteMediaStream.call(_stream, mediaStream);\n                }else{\n                    var _stream = self.newStream(_stream);\n                    _stream.updateAttributes({mediaStream: webrtc.getRemoteStream()});\n                    self.onUpdateStream(_stream, new _stream.Update({mediaStream: _stream.mediaStream}));\n                }\n            }\n        });\n    },\n\n    _failIcesRebuild: function () {\n        var self = this;\n\n        var count = 1;\n        _util.forEach(self._maybeNotExistStreams, function (streamId, stream) {\n            setTimeout(function () {\n                self.iceRebuild(stream);\n            }, count * 100);\n        });\n    },\n\n    iceRebuild: function (stream) {\n        var self = this;\n\n        if(!self.connected()){\n            stream.updateAttributes({iceRebuildCount: 1});\n            _logger.warn(\"Websocket disconnect. waiting. rebuild count reset\", stream.iceRebuildCount, stream.id);\n            return;\n        }\n        if(!self._linkedStreams[stream.id] || !self._cacheStreams[stream.id]){\n            _logger.info(\"ice rebuild fail. it yet closed. stream is \", stream.id, stream.rtcId);\n            _util.removeAttribute(self._maybeNotExistStreams, stream.id);\n            _util.removeAttribute(self._linkedStreams, stream.id);\n            _logger.warn(\"iceRebuild, remvoe from _linkedStreams\", stream.id);\n\n            return;\n        }\n\n        if(stream.iceRebuildCount > emedia.config.iceRebuildCount){\n            _logger.info(\"ice rebuild fail. count too many. stream is \", stream.id);\n\n            if(stream.located()){\n                self.onEvent(new __event.PushFail({\n                    stream: stream,\n                    cause: \"pub ice rebuild failed.\"\n                }));\n            }else{\n                self.onEvent(new __event.SubFail({\n                    stream: stream,\n                    cause: \"sub ice rebuild failed.\"\n                }));\n            }\n        } else if(self.connected()){\n            _logger.info(\"ice try rebuild. count\", stream.iceRebuildCount, \". stream is \", stream.id);\n            self.rebuildIce(stream);\n\n            stream.iceRebuildCount ++;\n        } else {\n            _logger.warn(\"ice rebuild. stop. cause by not websocket disconnect\", stream.id);\n        }\n    },\n\n    rebuildIce: function (stream) {\n        var self = this;\n\n        if(!(self._cacheStreams[stream.id])){\n            _logger.warn(\"Begin rebuild ice. not found stream at local\", stream.iceRebuildCount, stream.id);\n            return;\n        }\n        _logger.warn(\"Begin rebuild ice \", stream.iceRebuildCount, stream.id);\n\n        if(stream.located()){\n            stream.updateAttributes({isRepublished: true});\n            self.push(stream, undefined, undefined, true);\n        }else{\n            self.createWebrtcAndSubscribeStream(stream.id);\n        }\n        _logger.warn(\"Finish rebuild ice \", stream.iceRebuildCount, stream.id, self._cacheStreams[stream.id].rtcId);\n    },\n\n    _sysCopy: function () {\n        var self = this;\n\n        var copyMessage = self.newMessage()\n            .setOp(1000)\n            .setCver(self._cver || 0);\n\n        self.postMessage(copyMessage, function (rsp) {\n            if(rsp.result != 0){\n                _logger.warn(\"Get copy fail. result = \", rsp.result);\n\n                return;\n            }\n\n            if((self._cver || 0) < rsp.cver){\n                self._cver = rsp.cver;\n\n                self.onMembers(rsp.cver, rsp.mems || {});\n                self.onStreams(rsp.cver, rsp.streams || {})\n\n                _logger.info(\"Got copy success.\");\n            }\n        });\n    },\n});\n\nmodule.exports = Handler;\n","\nvar _util = require('./Util');\nvar _logger = _util.tagLogger(\"Desktop\");\n\nvar __event = require('./event');\n\n\nwindow.__shareDesktopMessageCount__ = 0;\n\nmodule.exports = _util.prototypeExtend({\n\n    __RTC_PAGE_MSG_TYPE__: 'RTC-SD-PAGE',\n    __RTC_EXT_MSG_TYPE__: 'RTC-SD-EXT',\n\n\n\n    __init__: function () {\n        var self = this;\n\n        self.__extLoaded = self.rsdExtLoaded();\n        if(self.__extLoaded){\n            self.__onRsdExtLoad();\n        }\n\n        window.addEventListener(\"load\", function(event) {\n            if(self.__extLoaded){\n                return;\n            }\n\n            var exist = self.rsdExtLoaded();\n            // console.log('exist=', exist, ', ev4detect=', ev4detect);\n\n            self.__extLoaded = exist;\n        });\n\n        window.addEventListener('message', function (event) {\n            if(!event.data) {\n                return;\n            }\n\n            var msg = event.data;\n            if(!msg.type || msg.type !== self.__RTC_EXT_MSG_TYPE__ || !msg.evname) {\n                return;\n            }\n            _logger.info('got ext-msg: ', msg);\n\n\n            if(msg.evname === 'extLoaded'){\n                if(!self.__extLoaded){\n                    self.__extLoaded = true;\n\n                    setTimeout(self.__onRsdExtLoad(), 50);\n                }\n\n                return;\n            }\n\n            self.__onMessage(msg);\n        });\n    },\n\n    rsdExtLoaded: function(){\n        var existele = document.getElementById('RTC-Share-Deskto-installed-ele-rat1abrr');\n        return emedia.isElectron || existele ? true : false;\n    },\n\n    __sendMessage: function(msg, callback){\n        var self = this;\n\n        var tsxId = 'tsx_' + (__shareDesktopMessageCount__++) + '_' +  Math.random().toString(36).substr(2,4);\n\n        if(!self.__extLoaded){\n            _logger.error(\"Rtc share desktop not loaded\");\n            throw \"Rtc share desktop not loaded\";\n        }\n\n        msg.tsxId = tsxId;\n\n        self[\"on_\" + tsxId] = function () {\n            callback && callback.apply(self, arguments);\n\n            //delete self[\"on_\" + tsxId];\n            _util.removeAttribute(self, (\"on_\" + tsxId));\n        }\n\n        window.postMessage && window.postMessage(msg, '*');\n    },\n\n    __onMessage: function (msg) {\n        var self = this;\n\n        var tsxId = msg.tsxId;\n\n        self[\"on_\" + tsxId] && self[\"on_\" + tsxId](msg);\n        //self[\"on_\" + tsxId] || _logger.info(msg);\n    },\n\n    __onRsdExtLoad: function () {\n        var self = this;\n\n        self.onExtLoaded && self.onExtLoaded();\n    },\n\n    openDesktopMedia: function (screenOptions, callback){\n        var self = this;\n\n        if(emedia.isElectron){\n            self.openDesktopMediaInElectron(screenOptions, callback);\n            return;\n        }\n\n        if(!self.__extLoaded || !self.rsdExtLoaded()){\n            callback(new __event.ShareDesktopExtensionNotFound());\n            return;\n        }\n\n        var msg = {type:self.__RTC_PAGE_MSG_TYPE__, evname: 'chooseDesktopMedia', screenOptions: screenOptions};\n        self.__sendMessage(msg, function(m){\n            if(m.evname === 'onAccessApproved' && m.streamId){\n                callback(new __event.OpenDesktopMedia({desktopStreamId: m.streamId}));\n            }else{\n                callback(new __event.OpenDesktopMediaAccessDenied());\n            }\n        });\n    },\n\n    openDesktopMediaInElectron: function (screenOptions, callback) {\n        var self = this;\n\n        if(!screenOptions){\n            screenOptions = ['screen', 'window'];\n        }\n\n        let getSourcesOptions = {\n            types: screenOptions, \n            thumbnailSize:{ width: 230, height: 230}\n        }\n        emedia.electron.desktopCapturer.getSources(getSourcesOptions).then(\n            sources => {\n\n\n                if(typeof emedia.chooseElectronDesktopMedia !== 'function'){\n                    callback(new __event.OpenDesktopMedia({desktopStreamId: sources[0].id}));\n                    return\n                }\n    \n                for (var i = 0; i < sources.length; i++) {\n                    // _logger.debug(\"desktop capturer. \", sources[i]);\n                    var source = sources[i];\n                    source.hxThumbDataURL = source.thumbnail.toDataURL();\n                }\n    \n                emedia.chooseElectronDesktopMedia(sources, function accessApproved(desktopCapturerSource) {\n                    var sourceId;\n                    if(desktopCapturerSource && desktopCapturerSource.id){\n                        sourceId = desktopCapturerSource.id;\n                    }else{\n                        sourceId = desktopCapturerSource;\n                    }\n    \n                    callback(new __event.OpenDesktopMedia({desktopStreamId: sourceId}));\n                }, function accessDenied() {\n                    callback(new __event.OpenDesktopMediaAccessDenied({message: () => \"User denied access\"}));\n                });\n\n\n            }\n        ).catch(\n            error => callback(new __event.OpenDesktopMediaAccessDenied({error:error}))\n        );\n\n    }\n});","var _util = require('./Util');\nvar _logger = _util.tagLogger(\"AddonsP2P\");\n\nvar __event = require('./event');\n\n/**\n *\n * 对于视频流，往往 会出现 多个流 共用一个webrtc情况\n *\n *\n * @type {{}}\n * @private\n */\n\n\nvar addonsSession = function (Session) {\n    var NewSession = Session.extend({\n\n        postMessage: function(message, callback) {\n            var self = this;\n\n            var tsxId = message.tsxId;\n            if (!message.tsxId) {\n                tsxId = message.tsxId = (\"MSG\" + Date.now() + \"-\" + (emedia.__session_globalCount++));\n            }\n\n            Session.prototype.postMessage.call(self, message, callback);\n\n            (function (tsxId) {\n                var attendee = self.owner;\n                if(attendee.isP2P() && self._callbacks[tsxId]){\n                    setTimeout(function () {\n                        var _sentMessage = self._callbacks[tsxId];\n                        if(_sentMessage && _sentMessage.op === 1004){\n                            var rsp = self.newMessage({\n                                op: 1001,\n                                tsxId: _sentMessage.tsxId,\n                                memId: _sentMessage.memId,\n                                result: 0,\n                                msg: (\"3000ms not recv response. will success callback. \" + _sentMessage.tsxId)\n                            });\n                            self.onMessage(rsp);\n                        }\n                    }, 3000);\n                }\n            })(tsxId);\n        },\n\n        __modifyMessageForPost: function (message) {\n            var self = this;\n\n            message = Session.prototype.__modifyMessageForPost.call(self, message);\n\n            var attendee = self.owner;\n            if(attendee.isP2P()){\n                if(message.op === 102 || message.op === 105){ //缓存  回调推流成功\n                    var rsp = self.newMessage({\n                        op: 1001,\n                        tsxId: message.tsxId,\n                        memId: message.memId,\n                        result: 0,\n                        streamId: (message.rtcId + (attendee.isCaller() ? \"__Caller\" : \"__Callee\")),\n                        sver: 1\n                    });\n\n                    setTimeout(function () {\n                        self.onMessage(rsp);\n                    }, 100);\n\n                    if(!message._cached_){\n                        var cacheMessage = _util.extend({_cached_: true}, message);\n                        _util.removeAttribute(cacheMessage, \"tsxId\");\n                        (message.op === 102) && (attendee.__cache_[message.rtcId] = []).push(cacheMessage);\n                        (message.op === 105) && attendee.__cache_[message.rtcId] && attendee.__cache_[message.rtcId].push(cacheMessage);\n                        attendee.__cache_[message.rtcId] && (attendee.__cache_[message.rtcId].selfId = attendee.getMemberId());\n                    }\n                }\n\n                _util.removeAttribute(message, \"_cached_\");\n\n                if(message.memId){\n                    var p2pMessage = self.newMessage({\n                        op: 1004,\n                        sessId: _util.removeAttribute(message, \"sessId\"),\n                        memId: _util.removeAttribute(message, \"memId\"),\n                        tsxId: _util.removeAttribute(message, \"tsxId\"),\n                        arg: JSON.stringify(message)\n                    });\n\n                    message = p2pMessage;\n                }\n\n                switch(message.op){\n                    case 205:\n                        var rsp = self.newMessage({\n                            op: 1001,\n                            tsxId: message.tsxId,\n                            result: 0\n                        });\n\n                        setTimeout(function () {\n                            self.onMessage(rsp);\n                        }, 50);\n\n                        return;\n                    case 102:\n                    case 104:\n                    case 105:\n                    case 106:\n                    case 107:\n                        if(message.endReason === -10){\n                            return;\n                        }\n                    case 1001:\n                    case 400:\n                        var p2pMessage = self.newMessage({\n                            op: 1004,\n                            sessId: _util.removeAttribute(message, \"sessId\"),\n                            tsxId: _util.removeAttribute(message, \"tsxId\"),\n                            arg: JSON.stringify(message)\n                        });\n\n                        message = p2pMessage;\n\n                        break;\n\n                    case 303:\n                    case 206:\n                        return;\n\n                    default:\n                }\n            }\n\n            return message;\n        },\n\n        onP2PMessage: function (evt) {\n            var self = this;\n            var attendee = self.owner;\n\n            if(self.owner.isConfr()){\n                _logger.warn(\"Recv p2p ctrl message. when CONFR. ignore\");\n                return;\n            }\n\n            var message = JSON.parse(evt.arg);\n            message.memId = evt.memId;\n            message.tsxId = evt.tsxId;\n            message.sessId = evt.sessId;\n\n            if(message.op === 400){\n                message.streamId = message.rtcId + (self.owner.isCaller() ? \"__Callee\" : \"__Caller\");\n            }\n\n            if(message.op !== 1001){\n                var rsp = self.newMessage({\n                    op: 1001,\n                    tsxId: evt.tsxId,\n                    memId: evt.memId,\n                    sessId: evt.sessId,\n                    result: 0,\n                    msg: \"Web sdk success recv\"\n                });\n\n                if(message.op === 102 || message.op === 105){\n                    _util.extend(rsp, {\n                        streamId: (message.rtcId + (attendee.isCaller() ? \"__Callee\" : \"__Caller\")),\n                        sver: 1\n                    });\n                }\n\n                self.postMessage(rsp);\n            }\n\n            (function (message) {\n                setTimeout(function () {\n                    self.onMessage(message);\n                }, 10);\n            })(message);\n        }\n    });\n\n    _util.extend(NewSession.prototype._events, {\n        '1004': 'onP2PMessage'\n    });\n\n    return NewSession;\n}\n\nvar addonsAttendee = function (Attendee) {\n    var NewAttendee = Attendee.extend({\n        __init__ : function () {\n            var self = this;\n            Attendee.prototype.__init__.call(self);\n\n            self.__cache_ = {};\n\n            var extIceRebuild = self.iceRebuild;\n            self.iceRebuild = function (stream) {\n                var self = this;\n\n                if(!self.isP2P() || !stream.rtcId){\n                    extIceRebuild.call(self, stream);\n                    return;\n                }\n\n                if(stream._webrtc && (stream._webrtc.answerWebrtc === true)){\n                    _logger.warn(\"Stream not auto iceRebuild. caused by answer webrtc. it = \", stream.id, stream);\n                    return;\n                }\n\n                if(!stream.located()){ //被叫 rtcId 不自动重建；所有的订阅流不自动重建；\n                    _logger.warn(\"Stream not auto iceRebuild. caused by not located. it = \", stream.id, stream);\n                    return;\n                }\n\n                // stream.isRepublished = true;\n                // self.push(stream, undefined, undefined, true);\n                extIceRebuild.call(self, stream);\n            };\n        },\n\n        onEnter: function(cver, mem){\n            var self = this;\n            try {\n                Attendee.prototype.onEnter.call(self, cver, mem);\n            } finally {\n                if(!self.isP2P() || !(mem = self._cacheMembers[mem.id])){ //不是p2p 或者 没有 member\n                    return;\n                }\n                _util.forEach(self.__cache_, function (rtcId, cacheMessages) {\n                    if(cacheMessages.answered !== true){\n                        _util.forEach(cacheMessages, function (index, cacheMessage) {\n                            (function (cacheMessage) {\n                                cacheMessage.memId = mem.id;\n                                self.postMessage(cacheMessage);\n                            })(cacheMessage);\n                        });\n                    }\n                });\n            }\n        },\n\n        rejectAnswer: function (memId, rtcId, endReason, rspFail) {\n            var self = this;\n\n            var termC = self.newMessage()\n                .setOp(107)\n                .setRtcId(rtcId)\n                .setMemId(memId)\n                .setEndReason(endReason);\n\n            self.postMessage(termC, function (rsp) {\n                if(rsp.result != 0){\n                    self.onEvent(new __event.RspFail({request: termC, response: rsp}));\n                    rspFail && rspFail(new __event.RspFail({request: termC, response: rsp}));\n\n                    return;\n                }\n            });\n        },\n\n        closeWebrtc: function(rtcId, remainLocalStream, serverClosed){\n            var self = this;\n\n            var failed = false;\n\n            if(self.isP2P()){\n                var _webrtc = self._ices[rtcId];\n                if(_webrtc){\n                    var state = _webrtc.iceConnectionState();\n                    failed = (state === 'failed');\n                    failed = failed && (_webrtc._rebuildCount < emedia.config.iceRebuildCount);\n\n                    _logger.warn(\"Webrtc state failed. it is \", rtcId, _webrtc._rebuildCount, emedia.config.iceRebuildCount, _webrtc.__id);\n                }\n            }\n\n            //p2p failed认为服务端关闭，不发送 107.\n            Attendee.prototype.closeWebrtc.call(self, rtcId, remainLocalStream, serverClosed || failed);\n\n            if(self.isP2P())\n            if(!serverClosed && failed){ //p2p failed 需要重连 所以需要将 steam重新添加到_linkedStreams中\n                //换句话说 需要重建RTC必须 _linkedStreams中有值\n                _util.forEach(self._cacheStreams, function (sid, _stream) {\n                    if(_stream.rtcId === rtcId){\n                        self._linkedStreams[sid] = _stream;\n                        _logger.warn(\"Reput stream to _linkedStreams\", sid);\n                    }\n                });\n            }\n\n            // p2p时 ice close 可以认为 流 已经关闭，移除流\n            if(self.isP2P() && (!remainLocalStream)){\n                _util.removeAttribute(self.__cache_, rtcId);\n\n                var _tmp = _util.extend({}, self._cacheStreams);\n\n                _util.forEach(_tmp, function (streamId, stream) {\n                    if(rtcId === stream.rtcId){\n                        _util.removeAttribute(self._linkedStreams, stream.id);\n                        var rmStream = _util.removeAttribute(self._cacheStreams, stream.id);\n                        self._streamAutomators && _util.removeAttribute(self._streamAutomators, stream.id);\n                        _logger.warn(\"P2P close webrtc. remove stream from _cacheStreams. it = \", stream.id, stream);\n\n                        if(rmStream._localMediaStream){\n                            self._service._stopTracks(rmStream._localMediaStream);\n                        }\n\n                        if(self.onRemoveStream){\n                            var stream = self.newStream(stream);\n\n                            self.onRemoveStream(stream);\n                        }\n                    }\n                });\n            }\n        },\n\n        subscribeStream: function (rtcId, streamId, rspFail, subArgs){\n            var self = this;\n\n            if(!self.isP2P()){\n                Attendee.prototype.subscribeStream.call(self, rtcId, streamId, rspFail, subArgs);\n                return;\n            }\n\n            // throw \"P2P not allow call subscribeStream\";\n            var webrtc = self._ices[rtcId];\n\n            var subStream = self._cacheStreams[streamId];\n\n            //var stream = self.newStream(subStream);\n            var stream = subStream;\n            stream.updateAttributes({\n                _webrtc: webrtc,\n                rtcId: rtcId\n            });\n\n            subArgs = subArgs || {subSVideo: true, subSAudio: true};\n            stream.updateAttributes({\n                subArgs: stream.subArgs || {subSVideo: true, subSAudio: true}\n            });\n            stream._webrtc && (stream._webrtc.setSubArgs(stream._webrtc.subArgs || {subSVideo: true, subSAudio: true}));\n\n            if(!stream.subArgs.subSVideo && subArgs.subSVideo && stream.voff){\n                _logger.error(\"Sub not allow. stream voff\");\n                throw \"Sub not allow. stream voff\"\n            }\n\n            if(!stream.subArgs.subSAudio && subArgs.subSAudio && stream.aoff){\n                _logger.error(\"Sub not allow. stream aoff\");\n                throw \"Sub not allow. stream aoff\"\n            }\n\n            if(stream.subArgs.subSVideo && !subArgs.subSVideo && !stream.voff && emedia.isSafari){\n                _logger.error(\"Sub not allow. safari close sub video. will error\");\n                throw \"Sub not allow. safari close sub video. will error\"\n            }\n\n            subArgs && stream._webrtc && stream._webrtc.setSubArgs(subArgs);\n            subArgs && (stream.updateAttributes({subArgs: subArgs}));\n\n            var evt = new __event.SubSuccess({\n                stream: stream,\n                hidden: true\n            });\n            self._updateRemoteStream(stream, stream._webrtc.getRemoteStream());\n            self.onEvent(evt);\n        },\n\n        unsubscribeStream: function(streamId){\n            var self = this;\n\n            if(!self.isP2P()){\n                Attendee.prototype.unsubscribeStream.call(self, streamId);\n                return;\n            }\n        },\n\n        onPub: function(cver, memId, pubS){\n            var self = this;\n\n            if(!self.isP2P()){\n                Attendee.prototype.onPub.call(self, cver, memId, pubS);\n                return;\n            }\n\n            var stream = Attendee.prototype.onPub.call(self, cver, memId, pubS);\n\n            return stream;\n        },\n\n        onStreams: function(cver, streams) {\n            var self = this;\n\n            if(!self.isP2P()){\n                Attendee.prototype.onStreams.call(self, cver, streams);\n                return;\n            }\n\n            _logger.warn(\"P2P ingrone the onStreams\");\n        },\n\n        _howDoWebrtcWhenCrtExsitsWebrtc: function (webrtc) {\n            var self = this;\n\n            if(!self.isP2P()){\n                Attendee.prototype._howDoWebrtcWhenCrtExsitsWebrtc.call(self, webrtc);\n                return;\n            }\n\n            self.closeWebrtc(webrtc.getRtcId(), true, true);\n        },\n\n        createWebrtcAndSubscribeStream: function (streamId, callbacks, iceServerConfig, subArgs) {\n            var self = this;\n\n            if(!self.isP2P()){\n                Attendee.prototype.createWebrtcAndSubscribeStream.call(self, streamId, callbacks, iceServerConfig, subArgs);\n                return;\n            }\n\n\n            var self = this;\n\n            callbacks || (callbacks = {});\n\n            var subStream = self._cacheStreams[streamId];\n            var subMember = self._cacheMembers[subStream.owner.id];\n\n            //var stream = self.newStream(subStream);\n            var stream = subStream;\n            subArgs = subArgs || stream.subArgs || {subSVideo: true, subSAudio: true};\n\n            function _onSubFail(evt) {\n                _logger.warn(\"sub stream error\", streamId, evt);\n\n                preSubArgs && stream._webrtc && stream._webrtc.setSubArgs(preSubArgs);\n                preSubArgs && stream.updateAttributes({subArgs: preSubArgs});\n\n                evt = new __event.SubFail({\n                    stream: stream,\n                    hidden: evt.hidden === true,\n                    cause: evt\n                });\n\n                callbacks && callbacks.onEvent && callbacks.onEvent(evt);\n                self.onEvent && self.onEvent(evt);\n            }\n\n            var pubStreamVCodes = subStream.vcodes;\n            var pubMemberSupportVCodes = subMember.vcodes;\n            var selfSupportVCodes = self.supportVCodes;\n\n            var optimalVideoCodecs = self._getOptimalVideoCodecsSubset(pubStreamVCodes, pubMemberSupportVCodes, selfSupportVCodes);\n\n            subArgs = subArgs || stream.subArgs;\n\n            var preSubArgs = stream.subArgs;\n\n            var withoutVideo = !(stream.vcodes && stream.vcodes.length > 0);\n            var offerOptions = {\n                offerToReceiveAudio: true,\n                offerToReceiveVideo: (subArgs.subSVideo && withoutVideo)\n            };\n\n            if(!offerOptions.offerToReceiveAudio && !offerOptions.offerToReceiveVideo){\n                _logger.warn(\"offerToReceiveAudio == false and offerToReceiveVideo == false\");\n            }\n\n            var webrtc = self.createWebrtc({\n                _rtcId: stream.rtcId,\n\n                iceServerConfig: iceServerConfig,\n                optimalVideoCodecs: optimalVideoCodecs,\n                offerOptions: offerOptions,\n\n                onGotMediaStream: function (remoteMediaStream) {\n                    var evt = new __event.SubSuccess({\n                        stream: stream,\n                        hidden: true\n                    });\n\n                    callbacks.onGotRemote && callbacks.onGotRemote(stream);\n                    self.onEvent && self.onEvent(evt);\n                }\n            }, stream.iceRebuildCount);\n            var rtcId = webrtc.getRtcId();\n\n            _logger.warn(rtcId, \" sub stream \", streamId, optimalVideoCodecs);\n\n            var preWebrtc = stream._webrtc;\n\n            stream.updateAttributes({\n                _webrtc: webrtc,\n                rtcId: rtcId,\n                owner: _util.extend({}, subMember)\n            });\n\n            self._ices[rtcId] = webrtc;\n\n            webrtc.answerWebrtc = true;\n\n\n            subArgs && stream._webrtc && stream._webrtc.setSubArgs(subArgs);\n            subArgs && stream.updateAttributes({subArgs: subArgs});\n\n            function channelSet(localStream) {\n                localStream && webrtc.setLocalStream(localStream);\n                webrtc.setRemoteDescription(stream.sdp);\n                stream.cands && (stream.cands.length > 0) && webrtc.addIceCandidate(stream.cands);\n            }\n\n            if(rtcId === (\"rtc-\" + self.ticket.confrId)){\n                var lastCalleePub = self.__lastCalleePub;\n\n                var calleePub = self._cacheStreams[rtcId + (self.isCaller() ? \"__Caller\" : \"__Callee\")];\n                var calleePub = new self._service.AVPubstream(calleePub || {\n                    constaints: {\n                        audio: (!stream.aoff),\n                        video: (!stream.voff)\n                    }\n                });\n\n                preWebrtc && preWebrtc.getLocalStream() && self._service._stopTracks(preWebrtc.getLocalStream());\n\n                self._service.openUserMedia(calleePub).then(function () {\n                    var stream = self.newStream(calleePub);\n\n                    stream.updateAttributes({\n                        _localMediaStream: calleePub.localStream,\n                        _webrtc: webrtc,\n                        rtcId: webrtc.getRtcId(),\n                        id: rtcId + (self.isCaller() ? \"__Caller\" : \"__Callee\"),\n                        owner: {id: self.getMemberId(), nickName: self.nickName, name: self.sysUserId, ext: self.extObj}\n                    });\n\n                    self.onEvent(new __event.PushSuccess({stream: stream, hidden: true}));\n\n                    channelSet(calleePub.localStream);\n                    self.answerCall(rtcId, calleePub, _onSubFail);\n                }, _onSubFail);\n\n            }else{\n                channelSet();\n                self.answer(rtcId, _onSubFail);\n            }\n        }\n    });\n\n    return NewAttendee;\n}\n\n\nvar addonsService = function (Service, Session, Attendee) {\n    var NewService = Service.extend({\n        Session: Session,\n        Attendee: Attendee,\n\n        __init__: function () {\n            var self = this;\n            Service.prototype.__init__.call(self);\n\n            if(self.useRTCCfg === undefined || self.useRTCCfg === false || self.useRTCCfg === null){\n                self.useRTCCfg = emedia.config.forceUseRTCCfgIfServerReturnWhenP2P;\n            }\n        },\n\n        push: function(pubS, pushed, onPushError){\n            var self = this;\n\n            if(self.current && self.current.isP2P()){\n                if(pubS.type === 2){\n                    _logger.error(\"P2P do not allow audio_mixer\");\n                    throw \"P2P do not allow audio_mixer\";\n                }\n\n                if((pubS instanceof self.AVPubstream) && !pubS.rtcId){ // 主叫 如果没有主RTC, 将创建\n                    var p2pAV = self.current._cacheStreams[\"rtc-\" + self.current.ticket.confrId + \"__Caller\"]\n                        || self.current._cacheStreams[\"rtc-\" + self.current.ticket.confrId + \"__Callee\"];\n\n                    if(!p2pAV){\n                        pubS.rtcId = \"rtc-\" + self.current.ticket.confrId;\n                    }\n                }\n            }\n\n            Service.prototype.push.call(self, pubS, pushed, onPushError);\n        },\n\n        newSession: function (attendee, ticket){\n            var self = this;\n\n            var session = Service.prototype.newSession.call(self, attendee, ticket);\n            var preOnTermC = session.onTermC;\n            var preOnAnsC = session.onAnsC;\n\n            return _util.extend(session, {\n                onInitC: function (message) {\n                    if(!attendee.isP2P()){\n                        return;\n                    }\n\n                    if(message.rtcId === (\"rtc-\" + attendee.ticket.confrId)){ //收到主呼叫\n                        var streamId = message.rtcId + (attendee.isCaller() ? \"__Callee\" : \"__Caller\");\n                        var _stream = attendee._cacheStreams[streamId];\n                        if(_stream && _stream.owner && (_stream.owner.id !== message.memId)){\n                            attendee.rejectAnswer(message.memId, message.rtcId, 10);\n                            attendee.postMessage(attendee.newMessage({\n                                op: 1001,\n                                memId: message.memId,\n                                tsxId: message.tsxId,\n                                result: -554,\n                                msg: \"Other device call it. you no.\"\n                            }));\n\n                            return;\n                        }\n                    }\n\n                    //认为 只有一个音视频流，多个桌面共享的流  音视频流双向的。\n                    message.pubS.sdp = message.sdp;\n                    message.pubS.cands = message.cands;\n                    message.pubS.id = message.rtcId + (attendee.isCaller() ? \"__Callee\" : \"__Caller\");\n                    message.pubS._located = false;\n                    message.pubS.memId = message.memId;\n                    message.pubS.rtcId = message.rtcId;\n                    message.pubS.sver = 0;\n\n                    var _stream = attendee._cacheStreams[message.pubS.id];\n                    if(_stream){\n                        message.pubS.sver = _stream.sver + 1;\n                        _util.removeAttribute(attendee._maybeNotExistStreams, message.pubS.id);\n                    }\n                    attendee.onPub.call(attendee, ++attendee._cver, message.memId, message.pubS);\n                },\n\n                onTermC: function(evt){\n                    if(!attendee.isP2P()){\n                        preOnTermC.call(attendee, evt);\n                        return;\n                    }\n\n                    if(evt.endReason === -20){\n                        var callerPub = attendee._cacheStreams[(evt.rtcId+ \"__Caller\")];\n\n                        _logger.warn(\"Begin re-publish. 20\", callerPub);\n                        callerPub && self._republish(callerPub);\n\n                        return;\n                    }\n\n                    // memId 不相等说明 来自 p2p的对方\n                    // 意思是 evt.memId 关闭了一个 rtcId\n                    if(evt.memId && evt.memId !== attendee.getMemberId()){\n                        // 由于流集合中，所有的发布流均有个特点，caller __Caller结尾，callee __Callee结尾\n                        // 关闭流时，先关闭订阅流，在关闭发布流\n                        // 所以做了下排序\n                        var sortedStreams = [];\n                        _util.forEach(attendee._cacheStreams, function (streamId, stream) {\n                            sortedStreams.push(stream);\n                        });\n                        sortedStreams = sortedStreams.sort(function(a, b){\n                            var result = -1;\n                            if(a.id > b.id){\n                                result = 1;\n                            }\n\n                            return attendee.isCallee() ? (0 - result) : result;\n                        });\n\n                        _util.forEach(sortedStreams, function (_index, stream) {\n                            // evt.memId 关闭的 evt.rtcId 所关联的流 要关闭\n                            if(stream && stream.owner && stream.owner.id === evt.memId && evt.rtcId === stream.rtcId){\n                                (evt.endReason !== -10) && preOnTermC.call(attendee, evt);\n\n                                if(evt.rtcId === (\"rtc-\" + attendee.ticket.confrId)){\n                                    attendee.onUnpub(++attendee._cver, evt.memId, stream.id);\n                                }\n\n                                if(evt.endReason === 10){\n                                    attendee.onEvent(new __event.OtherDeviceAnswer({rtcId: evt.rtcId, stream: stream}));\n                                }\n                            }\n\n                            if(stream && stream.owner && stream.owner.id === attendee.getMemberId() && evt.rtcId === stream.rtcId){\n                                attendee.closeWebrtc(evt.rtcId);\n                                attendee.onUnpub(++attendee._cver, stream.owner.id, stream.id);\n                            }\n                        });\n                        return;\n                    }\n\n                    (evt.endReason !== -10) && preOnTermC.call(attendee, evt);\n\n                    if(evt.endReason === 10){\n                        attendee.onEvent(new __event.OtherDeviceAnswer({rtcId: evt.rtcId}));\n                    }\n                },\n\n                onAnsC: function(evt){\n                    if(!attendee.isP2P()){\n                        preOnAnsC.call(attendee, evt);\n                        return;\n                    }\n\n                    if(!attendee.__cache_[evt.rtcId]){\n                        _logger.warn(\"Webrtc \", evt.rtcId, \"not created. drop the answer\");\n\n                        return;\n                    }\n\n                    if(attendee.__cache_[evt.rtcId].answered === true){\n                        _logger.warn(\"Webrtc \", evt.rtcId, \"had been ansC\");\n\n                        attendee.rejectAnswer(evt.memId, evt.rtcId, 10);\n                        attendee.postMessage(attendee.newMessage({\n                            op: 1001,\n                            memId: evt.memId,\n                            tsxId: evt.tsxId,\n                            result: -554,\n                            msg: \"Other device sub it. you no.\"\n                        }));\n\n                        return;\n                    }\n\n                    try{\n                        if(evt.pubS){\n                            var stream = attendee.newStream(evt.pubS);\n\n                            stream.updateAttributes({\n                                _webrtc: attendee._ices[evt.rtcId],\n                                rtcId: evt.rtcId,\n                                id: evt.rtcId + (attendee.isCaller() ? \"__Callee\" : \"__Caller\"),\n                                owner: attendee._cacheMembers[evt.memId]\n                            });\n\n                            if(!attendee._cacheStreams[stream.id]){\n                                attendee.onPub.call(attendee, ++attendee._cver, evt.memId, stream);\n                            }else{\n                                attendee._cacheStreams[stream.id] = stream;\n                            }\n\n                            attendee.onEvent(new __event.SubSuccess({stream: stream, hidden: true}));\n                        }\n\n                        var ansCMember = attendee._cacheMembers[evt.memId];\n\n                        preOnAnsC.call(attendee, evt);\n\n                        _util.forEach(attendee._cacheMembers, function (_memberId, _member) {\n                            if(_memberId !== evt.memId && ansCMember.memName === _member.memName){\n                                attendee.rejectAnswer(_memberId, evt.rtcId, 10);\n                            }\n                        });\n                    } finally {\n                        attendee.__cache_[evt.rtcId].answered = true;\n                    }\n                }\n            });\n        }\n    });\n\n    return NewService;\n}\n\n\nmodule.exports = function (Service) {\n    var _Session = Service.prototype.Session || require('./Session');\n    var Session = addonsSession(_Session.extend({}));\n\n    var _Attendee = Service.prototype.Attendee || require('./Attendee');\n    var Attendee = addonsAttendee(_Attendee.extend({}));\n\n    return addonsService(Service, Session, Attendee);\n};","import _util from '../Util';\n\nimport { Subject } from 'rxjs';\nimport zepto from \"zepto-webpack\";\n\nfunction EventsObservable(mgr, confrId, onRemoteStream){\n    this.mgr = mgr;\n    this.confrId = confrId;\n    init.apply(this);\n    this.subject = new Subject();\n    this.onRemoteStream = onRemoteStream;\n}\n\nfunction init(){\n    _util.extend(this, {\n        subscribe: function(observerOrNext, error, complete){\n            return this.subject.subscribe(observerOrNext, error, complete);\n        }\n    },{ //以下监听，this object == me == service.current\n        onMeExit: function (reason, failed) {\n            this.mgr._onExit(this.confrId, reason, failed);\n\n\n            if(this.mgr.upload_stats){ // upload call analysis\n                \n                this.mgr.upload_stats.upload_event({\n                    event: 1,\n                    reason,\n                    sessionId: this._session._sessionId\n                });\n            }\n        },\n\n        onAddMember: function (member) {\n            this.mgr.onMemberJoin(member, this.confrId);\n\n            if(this.mgr.upload_stats){ // upload call analysis\n                let {\n                    role,\n                    memName: addMemName,\n                    id: addMemId\n                } = member;\n\n                this.mgr.upload_stats.upload_event({\n                    event: 10,\n                    role,\n                    addMemName,\n                    addMemId\n                });\n            }\n        },\n        onRemoveMember: function (member, reason) {\n            this.mgr.onMemberLeave(member, reason, this.confrId);\n\n            if(this.mgr.upload_stats){ // upload call analysis\n                let {\n                    role,\n                    memName: removeMemName,\n                    id: removeMemId\n                } = member;\n                \n                this.mgr.upload_stats.upload_event({\n                    event: 11,\n                    role,\n                    removeMemName,\n                    removeMemId\n                });\n            }\n        },\n\n        onAddStream: function (stream) {\n\n            if(stream.id == 0){\n                return;\n            }\n            if(!stream.located()){\n                this.onRemoteStream && this.onRemoteStream(stream);\n            }\n\n            this.mgr.streamBindVideo(stream, undefined, this.confrId);\n            this.mgr._onAddMemberStream(stream, this.confrId);\n\n            if(!stream.located()) { // only sub stream\n\n                if(this.mgr.upload_stats){ // upload call analysis\n                    let {\n                        id: sId,\n                        voff,\n                        aoff,\n                        type: streamType,\n                        memId: addMemId,\n                        memName: addMemName\n                    } = stream;\n                    \n                    this.mgr.upload_stats.upload_event({\n                        event: 12,\n                        sId,\n                        voff,\n                        aoff,\n                        streamType,\n                        addMemId,\n                        addMemName\n                    });\n                }\n\n            }\n        },\n        onRemoveStream: function (stream) {\n            if(stream.id == 0){\n                return;\n            }\n\n            var confr = this.mgr._confr(this.confrId);\n            if(confr && stream && stream.located()){\n                confr.av && confr.av.id === stream.id && (confr.av = undefined);\n                confr.desktop && confr.desktop.id === stream.id && (confr.desktop = undefined);\n            }\n\n            var video = _util.removeAttribute(this.mgr._videos, stream.id);\n            this.mgr._onRemoveMemberStream(stream, this.confrId);\n            video && this.mgr.unloadVideo(stream.owner, stream, video);\n\n\n\n            if(!stream.located()) { // only sub stream\n\n                if(this.mgr.upload_stats){ // upload call analysis\n                    let {\n                        id: sId,\n                        type: streamType,\n                        memId: removeMemId,\n                        memName: removeMemName\n                    } = stream;\n                    \n                    this.mgr.upload_stats.upload_event({\n                        event: 13,\n                        sId,\n                        streamType,\n                        removeMemId,\n                        removeMemName\n                    });\n                }\n\n            }\n        },\n        onUpdateStream: function (stream, update) {\n            if(stream.id == 0){\n                return;\n            }\n\n            var self = this;\n\n            var videoTag = this.mgr._videos[stream.id];\n            if(videoTag){\n                update && update.ifMediaStream(function (mediaStream) {\n                    videoTag && attachMediaStream(videoTag, mediaStream);\n\n                    if(videoTag && videoTag.hasAttribute(\"flow\")){\n                        self.mgr.onMediaTransmission(videoTag, function cb(trackId, type, subtype, data) {\n                            zepto(videoTag).trigger(\"onMediaTransmission\", [trackId, type, subtype, data]);\n                        });\n                    }\n                });\n\n                stream.aoff ? videoTag.setAttribute(\"aoff\", \"aoff\") : videoTag.removeAttribute(\"aoff\");\n                stream.voff ? videoTag.setAttribute(\"voff\", \"voff\") : videoTag.removeAttribute(\"voff\");\n            }\n\n            var constaints = {video: !stream.voff, audio: !stream.aoff};\n            update && update.ifVoff(function (voff) {\n                constaints || (constaints = {});\n                constaints.video = !voff;\n                if(!stream.located()){\n                    //constaints.video = constaints.video && (!stream.subArgs ||(stream.subArgs && stream.subArgs.subSVideo));\n                    constaints.video = stream.subArgs ? stream.subArgs.subSVideo : !stream.voff;\n                }\n            });\n            update && update.ifAoff(function (aoff) {\n                constaints || (constaints = {});\n                constaints.audio = !aoff;\n                if(!stream.located()){\n                    //constaints.audio = constaints.audio && (!stream.subArgs ||(stream.subArgs && stream.subArgs.subSAudio));\n                    constaints.audio = stream.subArgs ? stream.subArgs.subSAudio : !stream.aoff;\n\n                    if(stream.type === 2){\n                        constaints.audio = true;\n                    }\n                }\n            });\n\n            constaints && this.mgr._onMemberMediaChanaged(stream.owner, stream, constaints, this.confrId);\n            constaints && this.mgr._onUpdateMemberStream(stream, constaints, this.confrId);\n        },\n        onNetworkWeak: function () {\n        },\n        onNotSupportPublishVideoCodecs: function (stream) {\n            this.mgr._onNotSupportMemberPublishVideoCodecs(stream, this.confrId);\n        },\n        onRecvRemoteMessage: function (fromMember, argsObject) {\n            this.mgr._onRecvRemoteMessage(fromMember, argsObject, this.confrId);\n        },\n\n        onSoundChanage: function (member, stream, meterData) {\n            this.mgr._onMemberSoundChanaged(member, stream, meterData, this.confrId);\n        },\n        onTalking: function (member, stream, meterData) {\n            this.mgr._onTalking(member, stream, meterData, this.confrId);\n        },\n\n        onRoleUpdate: function(role, roleToken){\n            \n            var confr = this.mgr._confrs[this.confrId];\n            roleToken && (confr.roleToken = roleToken);\n            confr.role = role;\n\n            if(role == this.mgr.Role.AUDIENCE){\n                confr.av && this.mgr.hungup(confr.av);\n                confr.desktop && this.mgr.hungup(confr.desktop);\n            }\n\n            this.mgr._onRoleUpdated(role, this.confrId);\n\n            if(this.mgr.upload_stats){ // upload call analysis\n                \n                this.mgr.upload_stats.upload_event({\n                    event: 21,\n                    role,\n                    sessionId: this._session._sessionId\n                });\n            }\n        },\n\n        onNotifyEvent: function (evt) {\n            var self = this;\n\n            try{\n                if(evt instanceof emedia.event.ICEChanage){\n                    var webrtc = evt.webrtc;\n                    var state = evt.state;\n                    _util.forEach(self._cacheStreams, function (sid, stream) {\n                        if(stream.rtcId == webrtc.getRtcId()){\n\n                            var _stream = _util.extend({}, stream);\n                            var _member = _util.extend({}, stream.owner);\n\n                            self.mgr._onStreamIceStateChanged(_member, _stream, state, self.confrId);\n                        }\n                    });\n                }\n            }finally {\n                self.subject.next(evt);\n            }\n        }\n    });\n}\n\n\nexport default EventsObservable;","var _util = require('./Util');\nvar _logger = _util.tagLogger(\"PannelVideo\");\n\nvar Mouse = require('../../../pannel/src/components/Mouse');\nvar Keyboard = require('../../../pannel/src/components/Keyboard');\nvar MouseTrack = require('../../../pannel/src/components/MouseTrack');\nvar MouseTrigger = require('../../../pannel/src/components/MouseTrigger');\nvar TotalBuffer = require('../../../pannel/src/components/TotalBuffer');\n\n\nfunction overrideOnRemoveMember(service){\n    overrideOnRemoveMember._overrideCount++;\n    if(overrideOnRemoveMember.overrideObj === service){\n        return;\n    }\n\n    overrideOnRemoveMember.overrideObj = service;\n    onRemoveMember.override = service.listeners.onRemoveMember;\n    onRemoveMember.overrideService = service;\n    service.listeners.onRemoveMember = onRemoveMember;\n}\noverrideOnRemoveMember._overrideCount = 0;\n\nfunction onRemoveMember(member, reason) {\n    try{\n        var remoteControls = member && member.id && selectRemoteControlByMemId(onRemoveMember.overrideService, member.id);\n\n        if(remoteControls && remoteControls.length){\n            _util.forEach(remoteControls, function (_index, ctrl) {\n                _logger.warn(\"Remove member. free remote controller. it is \", ctrl.id, ctrl._ctrlStream.id, ctrl._controller.memName, member.id);\n\n                ctrl._free(); //超时清空\n\n                ctrl._callbacks && ctrl._callbacks.onRemoteFreeControl\n                    && ctrl._callbacks.onRemoteFreeControl(ctrl._ctrlStream, ctrl._controller,  ctrl._cId);\n            });\n        }\n    }finally{\n        onRemoveMember.override && onRemoveMember.override.apply(this, arguments);\n    }\n}\n\n\nfunction overrideOnRemoveStream(service) {\n    overrideOnRemoveStream._overrideCount++;\n    if(overrideOnRemoveStream.overrideObj === service){\n        return;\n    }\n\n    overrideOnRemoveStream.overrideObj = service;\n    onRemoveStream.override = service.listeners.onRemoveStream;\n    onRemoveStream.overrideService = service;\n    service.listeners.onRemoveStream = onRemoveStream;\n}\noverrideOnRemoveStream._overrideCount = 0;\n\nfunction resetOnRemoveStream(service) {\n    // overrideOnRemoveStream._overrideCount--;\n    //\n    // if(overrideOnRemoveStream._overrideCount === 0){\n    //     service.current.onRemoveStream = onRemoveStream.override;\n    //     overrideOnRemoveStream.overrideObj = undefined;\n    // }\n}\n\nfunction onRemoveStream(stream) {\n    doCleanAfterStreamClose(onRemoveStream.overrideService, stream);\n\n    onRemoveStream.override && onRemoveStream.override.apply(this, arguments);\n}\n\nfunction doCleanAfterStreamClose(service, stream) {\n    disControlled(service, stream.id);\n\n    var controls = getRemoteControl(service, stream);\n    controls && _util.forEach(controls, function (_i, control) {\n        control._free && control._free();\n    })\n\n    _util.removeAttribute(service.current.__remoteControls, stream.id);\n}\n\nfunction overrideOnHungup(service) {\n    overrideOnHungup._overrideCount++;\n    if(overrideOnHungup.overrideObj === service){\n        return;\n    }\n\n    overrideOnHungup.overrideObj = service;\n    var override = service.onHungup;\n\n    service.onHungup = (function onHungup(stream) {\n        doCleanAfterStreamClose(service, stream);\n        override && override.apply(this, arguments);\n    }).bind(service);\n}\noverrideOnHungup._overrideCount = 0;\n\nfunction overrideOnRemotePannelControl(service, callbacks) {\n    overrideOnRemotePannelControl._overrideCount++;\n    if(overrideOnRemotePannelControl.overrideObj === service){\n        return;\n    }\n\n    overrideOnRemotePannelControl.overrideObj = service;\n    var override = service._onRemotePannelControl;\n\n    service._onRemotePannelControl = (function _onRemotePannelControl(evt) {\n        handlePannelRemoteMessage(this, evt, false, callbacks);\n        override && override.apply(this, arguments);\n    }).bind(service);\n}\noverrideOnRemotePannelControl._overrideCount = 0;\n\nfunction resetOnRemotePannelControl(service) {\n    // overrideOnRemotePannelControl._overrideCount--;\n    //\n    // if(overrideOnRemotePannelControl._overrideCount === 0){\n    //     service._onRemotePannelControl = _onRemotePannelControl.override;\n    //     overrideOnRemotePannelControl.overrideObj = undefined;\n    // }\n}\n\nfunction codeCtrlMessage(service, stream, ctrl) {\n    var actions = [];\n\n    ctrl && _util.forEach(ctrl.actions, function (i, m) {\n        m.xy && actions.push({\n            x: Math.round(m.xy.x * 10000),\n            y: Math.round(m.xy.y * 10000),\n            oper: m.oper,\n            btn: m.btn,\n            sn: m.sn,\n            _time: m._time\n        });\n\n        m.xy || actions.push({\n            oper: m.oper,\n            btn: m.btn,\n            sn: m.sn,\n            _time: m._time\n        });\n    });\n\n    var arg = {\n        op2: 30,\n        evt: 0,\n        streamId: stream.id,\n        actions: actions,\n        cId: ctrl.cId\n    };\n\n    return service.current.newMessage({\n        op: 1002,\n        memId: stream.owner.id,\n        arg: JSON.stringify(arg),\n        _reqOps:[100230]\n    });\n}\n\nfunction decodeCtrlMessage(evt) {\n    if(typeof evt.arg === 'string'){\n        evt.arg = JSON.parse(evt.arg);\n    }\n\n    var arg = evt.arg;\n\n    var mouse = [], keyboard = [];\n    arg && arg.actions && _util.forEach(arg.actions, function (i, m) {\n        (m.x !== undefined && m.y !== undefined) && mouse.push({\n            xy: {x: m.x / 10000, y: m.y / 10000},\n            oper: m.oper,\n            btn: m.btn,\n            sn: m.sn,\n            _time: m._time\n        });\n\n        (m.x === undefined || m.y === undefined) && keyboard.push({\n            oper: m.oper,\n            btn: m.btn,\n            sn: m.sn,\n            _time: m._time\n        });\n    });\n\n    arg.mouse = mouse;\n    arg.keyboard = keyboard;\n}\n\nvar remoteControlSeqno = 0;\nvar RemoteControl = _util.prototypeExtend({\n    //id:\n    //_service:\n    //controller:\n    //_ctrlStream:\n    //_cId:\n    //_reqevt:\n    __init__: function () {\n        this.id = remoteControlSeqno++;\n    },\n    accept: function (mouseTrack, keyboard) {\n        var self = this;\n\n        if(self.hasOtherControl()){\n            self.busy();\n\n            _logger.error(\"Other has been controled.\");\n            throw \"Other has been controled.\";\n        }\n\n        var preAcpt = false;\n\n        var preRemoteControls = getRemoteControl(this._service, this._ctrlStream, this._controller); // 获取此前的remotecontrol\n        preRemoteControls && _util.forEach(preRemoteControls, function (_index, preRC) {\n            if(preRC.id < self.id) {\n                preRC._free();\n            }else{\n                preAcpt = true;\n            }\n        });\n\n        if(preAcpt){ //已经同意最新的控制。忽略这个\n            self._free();\n            return;\n        }\n\n        var remoteControls = this._service.current.__remoteControls || (this._service.current.__remoteControls = {});\n        remoteControls[self.id] = self;\n\n        controlling(this, mouseTrack, keyboard);\n\n        rspRemoteControl(this._service, this._reqevt, 0);\n    },\n\n    controlling: function () {\n        var self = this;\n\n        //存在启动人控制\n        var controls = [];\n        var remoteControls =  getRemoteControl(this._service, this._ctrlStream);\n        remoteControls && _util.forEach(remoteControls, function (_index, other) {\n            if(other._controller.memName === self._controller.memName){\n                controls.push(other);\n            }\n        });\n\n        return controls && controls.length ? controls : undefined;\n    },\n\n    hasOtherControl: function () {\n        var self = this;\n\n        //存在启动人控制\n        var hasOtherControl = false;\n        var controls =  getRemoteControl(this._service, this._ctrlStream);\n        controls && _util.forEach(controls, function (_index, other) {\n            if(other._controller.memName != self._controller.memName){\n                hasOtherControl = true;\n            }\n        });\n\n        return hasOtherControl;\n    },\n\n    busy: function () {\n        rspRemoteControl(this._service, this._reqevt, -403);\n    },\n\n    reject: function () {\n        rspRemoteControl(this._service, this._reqevt, -402);\n    },\n\n    _free: function () {\n        _util.removeAttribute(this._service.current.__remoteControls, this.id);\n    },\n\n    forceDisconnect: function () {\n        var remoteControls = getRemoteControl(this._service, this._ctrlStream);\n        if(remoteControls){\n            _util.forEach(remoteControls, function (_index, remoteControl) {\n                remoteControl._free && remoteControl._free();\n            })\n        }\n        _logger.info(\"remote control force disconnect\")\n    }\n});\n\nfunction rspRemoteControl(service, evt, result) {\n    service.current.message({\n        op: 1001,\n        tsxId: evt.tsxId,\n        memId: evt.memId,\n        arg: JSON.stringify({cId: evt.arg.cId}),\n        result: result\n    }).post();\n}\n\nfunction notAllowControl(service, evt) {\n    rspRemoteControl(service, evt, -405);\n}\n\nfunction selectRemoteControlByMemId(service, controllerMemId, stream) {\n    var remoteControls = [];\n    service.current.__remoteControls && _util.forEach(service.current.__remoteControls, function (_remoteControlId, _remoteControl) {\n        if((!stream || _remoteControl._ctrlStream.id === stream.id)\n            && (!controllerMemId || ((_remoteControl._controller.id === controllerMemId) )\n            )){\n            remoteControls.push(_remoteControl);\n        }\n    });\n\n    return remoteControls;\n}\n\nfunction getRemoteControl(service, stream, controller, cId) {\n    var remoteControls = [];\n    service.current.__remoteControls && _util.forEach(service.current.__remoteControls, function (_remoteControlId, _remoteControl) {\n        if((!stream || _remoteControl._ctrlStream.id === stream.id)\n            && (!controller || _remoteControl._controller.memName === controller.memName)\n            && (!cId || _remoteControl._cId === cId)){\n            remoteControls.push(_remoteControl);\n        }\n    });\n\n    return remoteControls;\n}\n\nfunction handlePannelRemoteMessage(service, evt, located, callbacks) {\n    decodeCtrlMessage(evt);\n\n    var arg = evt.arg;\n    var cId = arg.cId;\n\n    var streamId = arg.streamId;\n\n    var member = service.getMemberById(evt.memId);\n    var stream = service.getStreamById(streamId);\n\n    function recvRemoteControl() {\n        if(!member || !stream){\n            notAllowControl(service, evt);\n            return true;\n        }\n\n        if(arg.evt === 1){ // 控制申请\n            var remoteControl = new RemoteControl({\n                _service: service,\n                _controller: member,\n                _ctrlStream: stream,\n                _cId: cId,\n                _reqevt: evt,\n                _callbacks: callbacks\n            });\n\n            if(remoteControl.hasOtherControl()){\n                remoteControl.busy();\n                return true;\n            }\n\n            var ctrls;\n            if((ctrls =remoteControl.controlling())){\n                _util.forEach(ctrls, function (_index, ctrl) {\n                    ctrl._cId = cId;\n                });\n\n                rspRemoteControl(service, evt, 0);\n                return true;\n            }\n\n            callbacks && callbacks.onHasRemoteControl && callbacks.onHasRemoteControl(stream, member, remoteControl);\n\n            return true;\n        }\n\n        if(arg.evt === 2){ // 控制释放\n            var remoteControls = getRemoteControl(service, stream, member, cId);\n            if(remoteControls){\n                _util.forEach(remoteControls, function (_index, remoteControl) {\n                    remoteControl._free && remoteControl._free();\n                    rspRemoteControl(service, evt, 0)\n                })\n            }\n\n            callbacks && callbacks.onRemoteFreeControl && callbacks.onRemoteFreeControl(stream, member, cId);\n\n            return true;\n        }\n    }\n\n    if(!located && recvRemoteControl()){\n        return;\n    }\n\n    var remoteControls = getRemoteControl(service, stream, member, cId);\n    if(!located && (!remoteControls || remoteControls.length === 0)){\n         notAllowControl(service, evt);\n    }\n\n    remoteControls && _util.forEach(remoteControls, function (_index, __ctrl) {\n        __ctrl._lastRecvTimestamp = (new Date()).getTime();\n    });\n\n    if(located){\n        var remoteControl = service.current.__remoteControls[stream.id];\n        remoteControls = (remoteControls || []);\n\n        remoteControl && remoteControls.push(remoteControl);\n    }\n\n    _util.forEach(remoteControls, function (_i, ctrl) {\n        var maxSN = 0;\n\n        var triggers = arg.mouse;\n        if(triggers && triggers.length > 0){\n            try {\n                _util.forEach(triggers, function (index, elem) {\n                    if(elem.sn > maxSN){\n                        maxSN = elem.sn;\n                    }\n\n                    if(elem.oper === MouseTrigger.BTN.MOVE){\n                        ctrl.mouseTrack && ctrl.mouseTrack.track(elem.xy);\n                    }else{\n                        ctrl.mouseTrack && ctrl.mouseTrack.trigger(new MouseTrigger(elem));\n                    }\n                });\n            } catch (e){\n                _logger.warn(e);\n            }\n        }\n\n        var triggers = arg.keyboard;\n        if(triggers && triggers.length > 0){\n            try {\n                _util.forEach(triggers, function (index, elem) {\n                    if(elem.sn > maxSN){\n                        maxSN = elem.sn;\n                    }\n\n                    if(ctrl.keyboard) if(elem.oper === MouseTrigger.BTN.KEYBOARD_DOWN){\n                        ctrl.keyboard.onKeyDown(elem.btn);\n                    }else if(elem.oper === MouseTrigger.BTN.KEYBOARD_UP){\n                        ctrl.keyboard.onKeyUp(elem.btn);\n                    }\n                });\n            } catch (e){\n                _logger.warn(e);\n            }\n        }\n\n        if(located === true){ //自个儿 没通过 session发送\n            return;\n        }\n\n        function rsp() {\n            service.current.message({\n                op: 1001,\n                tsxId: evt.tsxId,\n                memId: evt.memId,\n                arg: JSON.stringify({sn: maxSN}),\n                result: 0\n            }).post(function (rsp) {\n                _logger.debug(\"Send remote control response. the result = \", rsp.result, rsp.msg || \"\");\n            });\n        }\n\n        try {\n            rsp();\n        }catch (e){\n            _logger.warn(e);\n        }\n    })\n}\n\nfunction onMouseEnter(service, streamId, videoTarget, _onMouseEnter, onCallbacks) {\n    _onMouseEnter && _onMouseEnter();\n}\n\nfunction onMouseExit(service, streamId, videoTarget, _onMouseExit, onCallbacks) {\n    _onMouseExit && _onMouseExit();\n}\n\nfunction onMouseMove(service, streamId, videoTarget, eventXY, lastTrigger, _onMouseMove, onCallbacks) {\n    var pos = service.eventXYAtMedia(eventXY, videoTarget);\n    if(!pos){\n        return;\n    }\n\n    pos = {\n        x: (pos.x / pos.width),\n        y: (pos.y / pos.height)\n    };\n\n    //_logger.info(pos.x, pos.y);\n\n    sendPannelMessage(service, {xy: pos, oper: MouseTrigger.BTN.MOVE, sid: streamId}, onCallbacks);\n    _onMouseMove && _onMouseMove(pos, lastTrigger);\n}\n\nfunction onMouseButton(service, streamId, videoTarget, trigger, lastTrigger, _onMouseButton, onCallbacks) {\n    trigger.xy = service.eventXYAtMedia(trigger.xy, videoTarget);\n    if(!trigger.xy){\n        return;\n    }\n\n    trigger.xy = {\n        x: (trigger.xy.x / trigger.xy.width),\n        y: (trigger.xy.y / trigger.xy.height)\n    };\n\n    _util.extend(trigger, {sid: streamId});\n\n    sendPannelMessage(service, trigger, onCallbacks);\n    _onMouseButton && _onMouseButton(trigger, lastTrigger);\n}\n\nfunction onKeyboard(service, streamId, oper, btn, _onKeyboard, onCallbacks) {\n    sendPannelMessage(service, {oper: oper, btn: btn, sid: streamId}, onCallbacks);\n    _onKeyboard && _onKeyboard(oper, btn);\n}\n\nfunction maskVideo(videoTarget) {\n    var maskDiv = document.createElement(\"div\");\n    maskDiv.style = videoTarget.style;\n    maskDiv.style.background = \"transparent\";\n\n    videoTarget.parentNode.appendChild(maskDiv);\n}\n\nfunction sendPannelMessage(service, trigger, onCallbacks) {\n    var streamId = trigger.sid;\n\n    var stream = service.getStreamById(streamId);\n\n    var ctrl;\n    if(service.current.__remoteControls && (ctrl = service.current.__remoteControls[streamId])){\n        handlePannelRemoteMessage(service, codeCtrlMessage(service, stream, {actions: [trigger]}), true);\n    }\n\n    var _buffer = service.current.__pannelBuffers[streamId];\n\n    var preUnclearSize = _buffer.getUnclearSize();\n    _buffer.put(trigger);\n\n    if(preUnclearSize < emedia.config.allowSendWhenLessThan){\n        function _getAndSend() {\n            var evts = _buffer.getUnread();\n\n            var _maxSN = 0;\n            for(var i = 0; evts && i < evts.length; i++){\n                var evt = evts[i];\n                _util.removeAttribute(evt, \"sid\");\n\n                (_maxSN < evt.sn) && (_maxSN = evt.sn);\n            }\n\n            if(!evts || evts.length === 0){\n                return;\n            }\n\n            _logger.debug(streamId, \"buffer remain:\", _buffer.getUnclearSize(), \", send evt:\", evts.length);\n\n            service.current.postMessage(codeCtrlMessage(service, stream, {actions: evts, cId: _buffer._cId}), function (rsp) {\n                if(rsp.result === -402){ //对方 拒绝控制\n                    onCallbacks && onCallbacks.onReject && onCallbacks.onReject(stream);\n                    return;\n                }\n                if(rsp.result === -403){ //对方 正被控制，忙\n                    onCallbacks && onCallbacks.onBusy && onCallbacks.onBusy(stream);\n                    return;\n                }\n                if(rsp.result === -408){ //超时\n                    onCallbacks && onCallbacks.onRemoteControlTimeout && onCallbacks.onRemoteControlTimeout(stream);\n                    return;\n                }\n                if(rsp.result === -507 || rsp.result === -405){ //不被支持\n                    _buffer.clearRead(_maxSN);\n                    onCallbacks && onCallbacks.onNotAllowRemoteControl && onCallbacks.onNotAllowRemoteControl(stream);\n                    return;\n                }\n\n                if(rsp.result === 0){\n                    _buffer._lastRspTimestamp = (new Date()).getTime();\n                }\n\n                var arg = rsp.arg;\n                if(arg && (arg = JSON.parse(arg)) && !_util.isInt(arg.sn)){\n                    _logger.warn(\"rsp.sn not a Number.\", arg.sn, \"for streamId\", streamId);\n                }else{\n                    arg && (arg.sn !== undefined) && _buffer.clearRead(arg.sn);\n                }\n\n                _getAndSend();\n            });\n\n        }\n\n        _getAndSend();\n    }\n}\n\nfunction disControlled(service, streamId) {\n    var buffer;\n\n    var mouse = service.current.__pannelMouses && _util.removeAttribute(service.current.__pannelMouses, streamId);\n    var keyboard = service.current.__pannelKeyboards && _util.removeAttribute(service.current.__pannelKeyboards, streamId);\n    service.current.__pannelBuffers && (buffer = _util.removeAttribute(service.current.__pannelBuffers, streamId));\n\n    mouse && mouse.ungrab();\n    keyboard && keyboard.ungrab();\n\n    resetOnRemoveStream(service);\n\n    if(!buffer){\n        return;\n    }\n\n    var stream = service.getStreamById(streamId);\n    if(buffer._callbacks && buffer._callbacks.onDisControlled){\n        buffer._callbacks.onDisControlled(stream);\n    }\n\n\n    if(!stream){\n        return;\n    }\n\n    var messge = service.current.newMessage({\n        op: 1002,\n        memId: stream.owner.id,\n        arg: JSON.stringify({\n            op2: 30,\n            streamId: stream.id,\n            evt: 2,\n            cId: buffer._cId\n        }),\n        _reqOps:[100230]\n    });\n\n    service.current.postMessage(messge, function (rsp) {\n        if(rsp.result === 0){\n            return;\n        }\n\n        _logger.warn(\"Unkown result：\", rsp.result);\n        return;\n    });\n}\n\n\nfunction mirrorControlled(service, streamId, videoTarget, maskTarget) {\n    var onCallbacks = {};\n    _util.forEach(arguments, function (_index, _func) {\n        if(typeof _func === \"function\"){\n            onCallbacks[_func.name] = _func;\n        }\n    });\n\n    reqControlled(service, streamId, videoTarget, true, maskTarget, onCallbacks);\n}\n\nfunction controlled(service, streamId, videoTarget, maskTarget) {\n    var onCallbacks = {};\n    _util.forEach(arguments, function (_index, _func) {\n        if(typeof _func === \"function\"){\n            onCallbacks[_func.name] = _func;\n        }\n    });\n\n    reqControlled(service, streamId, videoTarget, false, maskTarget, onCallbacks);\n}\n\nfunction reqControlled(service, streamId, videoTarget, mirror, maskTarget, onCallbacks) {\n    var cId = Math.uuidFast();\n    cId = cId.substr(cId.length - 6, 6);\n\n    var stream = service.getStreamById(streamId);\n\n    if(!stream._webrtc){\n        //throw \"Not allow control. cause by the stream not sub\";\n        onCallbacks && onCallbacks.onNotAllowRemoteControl && onCallbacks.onNotAllowRemoteControl(stream);\n\n        _logger.error(\"Not allow control. cause by the stream not sub\");\n        throw \"Not allow control. cause by the stream not sub\";\n    }\n\n    var arg = {\n        op2: 30,\n        streamId: stream.id,\n        evt: 1,\n        cId: cId\n    };\n\n    var messge = service.current.newMessage({\n        op: 1002,\n        memId: stream.owner.id,\n        arg: JSON.stringify(arg),\n        _reqOps:[100230]\n    });\n\n    service.current.postMessage(messge, function (rsp) {\n        if(rsp.result === -402){ //对方 拒绝控制\n            onCallbacks && onCallbacks.onReject && onCallbacks.onReject(stream);\n            return;\n        }\n        if(rsp.result === -403){ //对方 正被控制，忙\n            onCallbacks && onCallbacks.onBusy && onCallbacks.onBusy(stream);\n            return;\n        }\n        if(rsp.result === -408){ //超时\n            onCallbacks && onCallbacks.onRemoteControlTimeout && onCallbacks.onRemoteControlTimeout(stream);\n            return;\n        }\n        if(rsp.result === -507 || rsp.result === -405){ //不被支持\n            onCallbacks && onCallbacks.onNotAllowRemoteControl && onCallbacks.onNotAllowRemoteControl(stream);\n            return;\n        }\n\n        if(rsp.result === 0){\n            _controlled(service, streamId, videoTarget, mirror, maskTarget, onCallbacks, cId, true);\n            onCallbacks && onCallbacks.onAccept && onCallbacks.onAccept(stream);\n            return;\n        }\n\n        _logger.warn(\"Unkown result：\", rsp.result);\n\n        onCallbacks && onCallbacks.onNotAllowRemoteControl && onCallbacks.onNotAllowRemoteControl(stream);\n        return;\n    });\n}\n\nfunction _controlled(service, streamId, videoTarget, mirror, maskTarget, onCallbacks, cId, openKeyboard) {\n    if(maskTarget === undefined){\n        maskTarget = videoTarget;\n    }\n\n    var stream = service.getStreamById(streamId);\n\n    var mouse = (service.current.__pannelMouses || (service.current.__pannelMouses = {}))[streamId];\n    if(mouse){\n        disControlled(service, streamId);\n    }\n\n    if(!stream.located() && !stream.owner.acptOps[1003]){\n        _logger.error(\"which do not recv remote message, it is \", stream.owner.memName);\n        throw stream.owner.memName + \" do not recv remote message\";\n    }\n\n    mouse = new Mouse({\n        _target: maskTarget,\n        _focused: true,\n\n        onMouseEnter: function () {\n            onMouseEnter.call(mouse, service, streamId, videoTarget, onCallbacks && onCallbacks.onMouseEnter, onCallbacks);\n\n            keyboard && keyboard.grab();\n        },\n\n        onMouseExit: function () {\n            onMouseExit.call(mouse, service, streamId, videoTarget, onCallbacks && onCallbacks.onMouseExit, onCallbacks);\n\n            keyboard && keyboard.ungrab();\n        },\n\n        onMouseButton: function(trigger, lastTrigger) {\n            mirror === true && (trigger.xy.x = - trigger.xy.x);\n            onMouseButton.call(mouse, service, streamId, videoTarget, trigger, lastTrigger, onCallbacks && onCallbacks.onMouseButton, onCallbacks);\n        },\n\n        onMouseMove: function(pos, lastTrigger) {\n            //_logger.info(pos.x, pos.y);\n\n            if(!emedia.config.disableTrack){\n                mirror === true && (pos.x = - pos.x);\n                onMouseMove.call(mouse, service, streamId, videoTarget, pos, lastTrigger, onCallbacks && onCallbacks.onMouseMove, onCallbacks);\n            }\n        }\n    });\n\n    var pannelBuffers = (service.current.__pannelBuffers || (service.current.__pannelBuffers = {}));\n    var _buffer = pannelBuffers[streamId] = new TotalBuffer({\n        _cId: cId,\n        _callbacks: onCallbacks,\n        trackBufferSize: emedia.config.trackBufferSize || 1000\n    });\n\n    (service.current.__pannelMouses || (service.current.__pannelMouses = {}))[streamId] = mouse;\n    mouse.grab();\n\n    var keyboard;\n    if(openKeyboard){\n        keyboard = new Keyboard({\n            _target: document,\n            _focused: true,\n            onKeyPress: function(keyValue, isPressed) {\n                var oper = isPressed ? MouseTrigger.BTN.KEYBOARD_DOWN : MouseTrigger.BTN.KEYBOARD_UP;\n                var btn = keyValue;\n\n                onKeyboard.call(keyboard, service, streamId, oper, btn, onCallbacks && onCallbacks.onKeyboard, onCallbacks);\n            }\n        });\n\n        (service.current.__pannelKeyboards || (service.current.__pannelKeyboards = {}))[streamId] = keyboard;\n        //keyboard.grab();\n    }\n\n    // overrideOnHungup(service);\n    // overrideOnRemoveStream(service);\n    // overrideOnRemoveMember(service);\n}\n\nfunction graffiti(maskTag, mouseTrack, referenceVideo, mirror){\n    var mouse = new Mouse({\n        _target: maskTag,\n        _focused: true,\n\n        onMouseEnter: function () {\n            //mouse.grab();\n        },\n\n        onMouseExit: function () {\n            mouseTrack.releaseTrigger();\n        },\n\n        onMouseButton: function(trigger, lastTrigger) {\n            trigger.xy = {\n                x: (trigger.xy.x / trigger.xy.width),\n                y: (trigger.xy.y / trigger.xy.height)\n            };\n\n            mirror === true && (trigger.xy.x = - trigger.xy.x);\n            referenceVideo && (trigger.xy = emedia.Service.prototype.eventXYAtMedia.call(null, trigger.xy, referenceVideo));\n            trigger.xy && mouseTrack.trigger(trigger);\n        },\n\n        onMouseMove: function(pos, lastTrigger) {\n            pos = {\n                x: (pos.x / pos.width),\n                y: (pos.y / pos.height)\n            };\n\n            mirror === true && (pos.x = - pos.x);\n            referenceVideo && (pos = emedia.Service.prototype.eventXYAtMedia.call(null, pos, referenceVideo));\n            pos && mouseTrack.track(pos);\n        }\n    });\n\n    mouse.grab();\n\n    return mouse;\n}\n\nfunction controlling(ctrl, mouseTrack, keyboard) {\n    var __mouseTrack = mouseTrack;\n\n    // mouseTrack && (__mouseTrack = new MouseTrack({\n    //     _focused: true,\n    //\n    //     onMouseTrack: function (position, lastPosition, lastTrigger) {\n    //         mouseTrack.track(position);\n    //     },\n    //     onMouseTrigger: function (trigger, _lastTrigger) {\n    //         mouseTrack.trigger(trigger);\n    //     },\n    //     onReleaseTrigger: function (_lastTrigger) {\n    //         mouseTrack.releaseTrigger();\n    //     }\n    // }));\n\n    __mouseTrack && (ctrl.mouseTrack = __mouseTrack);\n    ctrl.keyboard = keyboard;\n}\n\nfunction support(service) {\n    var onCallbacks = {};\n    _util.forEach(arguments, function (_index, _func) {\n        if(_index != 0 && typeof _func === \"function\"){\n            onCallbacks[_func.name] = _func;\n        }\n    });\n\n    overrideOnHungup(service);\n\n    overrideOnRemoveStream(service);\n    overrideOnRemoveMember(service);\n    overrideOnRemotePannelControl(service, onCallbacks);\n\n    checkTimeout(service);\n}\n\nfunction getController(service, streamId) {\n    var stream = service.getStreamById(streamId);\n\n    var controls = getRemoteControl(service, stream);\n\n    if(!controls || controls.length === 0){\n        return;\n    }\n\n    return controls[0]._controller.memName;\n}\n\nfunction echoControl(service, streamId, mouseTrack, keyboard) {\n    var stream = service.getStreamById(streamId);\n\n    var echoControl = {_ctrlStream: stream, _controller: stream.owner, _service: service};\n    controlling(echoControl, mouseTrack, keyboard);\n\n    (service.current.__remoteControls || (service.current.__remoteControls = {}))[streamId] = echoControl;\n}\n\nfunction disEchoControl(service, streamId) {\n    _util.removeAttribute(service.current.__remoteControls, streamId);\n}\n\nvar checkTimeout = function(service) {\n    if(checkTimeout.timeoutId){\n        clearTimeout(checkTimeout.timeoutId);\n    }\n\n    checkTimeout.timeoutId = setTimeout(function () {\n        checkTimeout(service)\n    }, emedia.config.ctrlCheckIntervalMillis);\n\n    if(!service.current){\n        return;\n    }\n\n    var controls;\n    if((controls = service.current.__remoteControls)){ //受控制端，查看 _lastRecvTimestamp\n        //_logger.debug(\"Will check timeout for remote controller.\");\n\n        _util.forEach(controls, function (ctrlId, ctrl) {\n            if(ctrl.id !== undefined && ctrlId == ctrl.id){\n                var now = (new Date()).getTime();\n                if(ctrl._lastRecvTimestamp && (now - ctrl._lastRecvTimestamp) > emedia.config.ctrlTimeoutMillis){\n                    _logger.warn(\"Timeout for remote controller. it is \", ctrl.id, ctrl._ctrlStream.id, ctrl._controller.memName);\n\n                    ctrl._free(); //超时清空\n\n                    ctrl._callbacks && ctrl._callbacks.onRemoteFreeControl\n                        && ctrl._callbacks.onRemoteFreeControl(ctrl._ctrlStream, ctrl._controller,  ctrl._cId);\n                }\n            }\n        });\n    }\n\n    var buffers;\n    if((buffers = service.current.__pannelBuffers)){ //控制端 根据是否还存在 这个发布流判断，如果 这个pub流被移除，控制 停止。查看 _lastRspTimestamp\n        _util.forEach(buffers, function (_streamId, buffer) { //控制端发送ping\n            var stream = service.getStreamById(_streamId);\n            if(stream && !stream.located()){\n                service.current.message({ // 发送ping\n                    op: 1002,\n                    memId: stream.owner.id,\n                    arg: JSON.stringify({\n                        op2: 30,\n                        streamId: stream.id,\n                        evt: 3,\n                        cId: buffer._cId\n                    }),\n                    _reqOps:[100230]\n                }).post(function (rsp) {\n\n                });\n            }\n        });\n    }\n}\n\nmodule.exports = {\n    mirrorControlled: mirrorControlled,\n    controlled: controlled,\n    disControlled: disControlled,\n\n    controlling: controlling,\n\n    graffiti: graffiti,\n\n    echoControl: echoControl,\n    disEchoControl: disEchoControl,\n\n    support: support,\n\n    getController: getController\n};\n","var _util = require('../../../webrtc/src/components/Util');\nvar _logger = _util.tagLogger(\"Mouse\");\n\n\nvar MouseTrigger = require(\"./MouseTrigger\");\n\n/**\n * { target:\n *   onMouseButton:\n *   onMouseMove:\n * }\n *\n */\n\nmodule.exports = _util.prototypeExtend({\n    __init__: function () {\n        var self = this;\n\n        this._handlers = _util.extend({\n            mousedown: this._handleMouseDown.bind(this),\n            mouseup: this._handleMouseUp.bind(this),\n            mousemove: this._handleMouseMove.bind(this),\n            mousewheel: this._handleMouseWheel.bind(this),\n            mousedisable: this._handleMouseDisable.bind(this),\n            mouseover: this._handleMouseOver.bind(this),\n            mouseout: this._handleMouseOut.bind(this)\n        }, this._handlers || {});\n    },\n\n    //target: n,\n\n    /**\n     *\n     * @param posX\n     * @param posY\n     * @param oper 1按下 0up\n     * @param button 1左键单击 2滚轮按下 4右键 8滚轮向底端滑 16滚轮向顶端滑\n     */\n    onMouseButton: function(trigger, lastTrigger) {\n\n    },\n\n    onMouseMove: function(eventXY, lastTrigger) {\n\n    },\n\n    onMouseEnter: function () {\n\n    },\n\n    onMouseExit: function () {\n\n    },\n\n    _onMouseButton: function (eventXY, oper, button) {\n        var _time = (new Date().getTime());\n\n        var trigger = new MouseTrigger({\n            xy: eventXY,\n            oper: oper,\n            btn: button,\n            _time: _time\n        });\n\n        this.onMouseButton && this.onMouseButton(trigger, this._lastTrigger);\n\n        this._lastTrigger = trigger;\n    },\n\n    _onMouseMove: function (eventXY) {\n        this.onMouseMove && this.onMouseMove(eventXY, this._lastTrigger);\n    },\n\n    _captureMouse: function() {\n        this._target.setCapture && this._target.setCapture();\n        this._mouseCaptured = true;\n    },\n    _releaseMouse: function() {\n        this._target.releaseCapture && this._target.releaseCapture();\n        this._mouseCaptured = false;\n    },\n    _resetDoubleClickTimer: function() {\n        this._doubleClickTimer = null;\n    },\n\n    _handleMouseOver:function (event) {\n        if(this._mouseExit !== false){\n            this._mouseExit = false;\n            this.onMouseEnter && this.onMouseEnter();\n        }\n    },\n    _handleMouseOut:function (event) {\n        if(this._mouseExit !== true){\n            this._mouseExit = true;\n            this.onMouseExit && this.onMouseExit();\n        }\n\n        this._lastTrigger = undefined;\n    },\n    _handleMouseDown: function(event) {\n        this._captureMouse();\n        this._handleMouseButton(event, MouseTrigger.BTN.KEY_DOWN);\n    },\n    _handleMouseUp: function(event) {\n        this._mouseCaptured && (this._handleMouseButton(event, MouseTrigger.BTN.KEY_UP), this._releaseMouse());\n    },\n\n    _handleMouseWheel: function(event) {\n        if (!this._focused){\n            return;\n        }\n\n        var event = event || window.event, eventXY = _util.getEventElementXY(event, this._target, this._scale);\n\n        // 8up 16down\n        var wheel = (event.detail ? -1 * event.detail : event.wheelDelta / 40) > 0 ? MouseTrigger.BTN.WHEEL_ROLL_UP : MouseTrigger.BTN.WHEEL_ROLL_DOWN;\n        this._onMouseButton(eventXY, MouseTrigger.BTN.KEY_DOWN, wheel);\n        _util.stopEvent(event);\n    },\n\n    _handleMouseMove: function(event) {\n        if (!this._focused){\n            return;\n        }\n\n        var event = event || window.event, eventXY = _util.getEventElementXY(event, this._target, this._scale);\n        this._onMouseMove(eventXY);\n        _util.stopEvent(event);\n    },\n\n    _handleMouseDisable: function(event) {\n        if (!this._focused){\n            return;\n        }\n\n        var event = event || window.event, eventXY = _util.getEventElementXY(event, this._target, this._scale);\n\n        try{\n            return !(eventXY.realX >= 0 && eventXY.realY >= 0 && eventXY.realX < this._target.offsetWidth && eventXY.realY < this._target.offsetHeight);\n        } finally{\n            _util.stopEvent(event);\n        }\n    },\n\n    /**\n     *\n     * @param event\n     * @param oper 1鼠标按下\n     * @private\n     */\n    _handleMouseButton: function(event, oper) {\n        if (!this._focused){\n            return;\n        }\n\n        var button, event = event || window.event, eventXY = _util.getEventElementXY(event, this._target, this._scale);\n        if (event.touches || event.changedTouches) {\n            if (oper == MouseTrigger.BTN.KEY_DOWN) {\n                if (this._doubleClickTimer === null)\n                    this._lastTouchPos = eventXY;\n                else {\n                    clearTimeout(this._doubleClickTimer);\n                    var distanceX = this._lastTouchPos.x - eventXY.x, distanceY = this._lastTouchPos.y - eventXY.y;\n                    (Math.sqrt(distanceX * distanceX + distanceY * distanceY) < 20 * window.devicePixelRatio) && (eventXY = this._lastTouchPos)\n                }\n                this._doubleClickTimer = setTimeout(this._resetDoubleClickTimer.bind(this), 500);\n            }\n            button = MouseTrigger.BTN.LEFT;\n        } else\n            button = event.which ? 1 << event.button : (1 & event.button) + 2 * (2 & event.button) + (4 & event.button) / 2;\n\n        this._onMouseButton(eventXY, oper, button);\n        _util.stopEvent(event);\n    },\n\n    grab: function() {\n        var element = this._target;\n\n        _util.addEvent(element, \"mouseover\", this._handlers.mouseover);\n        _util.addEvent(element, \"mouseout\", this._handlers.mouseout);\n\n        _util.addEvent(element, \"touchstart\", this._handlers.mousedown);\n        //_util.addEvent(window, \"touchend\", this._handlers.mouseup);\n        _util.addEvent(element, \"touchend\", this._handlers.mouseup);\n        _util.addEvent(element, \"touchmove\", this._handlers.mousemove);\n        _util.addEvent(element, \"mousedown\", this._handlers.mousedown);\n        //_util.addEvent(window, \"mouseup\", this._handlers.mouseup);\n        _util.addEvent(element, \"mouseup\", this._handlers.mouseup);\n        _util.addEvent(element, \"mousemove\", this._handlers.mousemove);\n        _util.addEvent(element, _util.layoutEngine.gecko ? \"DOMMouseScroll\" : \"mousewheel\", this._handlers.mousewheel);\n        _util.addEvent(element, \"contextmenu\", this._handlers.mousedisable);\n        //_util.addEvent(document, \"click\", this._handlers.mousedisable);\n        //_util.addEvent(document.body, \"contextmenu\", this._handlers.mousedisable);\n    },\n    ungrab: function() {\n        var element = this._target;\n\n        _util.removeEvent(element, \"mouseover\", this._handlers.mouseover);\n        _util.removeEvent(element, \"mouseout\", this._handlers.mouseout);\n\n        _util.removeEvent(element, \"touchstart\", this._handlers.mousedown);\n        //_util.removeEvent(window, \"touchend\", this._handlers.mouseup);\n        _util.removeEvent(element, \"touchend\", this._handlers.mouseup);\n        _util.removeEvent(element, \"touchmove\", this._handlers.mousemove);\n        _util.removeEvent(element, \"mousedown\", this._handlers.mousedown);\n        //_util.removeEvent(window, \"mouseup\", this._handlers.mouseup);\n        _util.removeEvent(element, \"mouseup\", this._handlers.mouseup);\n        _util.removeEvent(element, \"mousemove\", this._handlers.mousemove);\n        _util.removeEvent(element, _util.layoutEngine.gecko ? \"DOMMouseScroll\" : \"mousewheel\", this._handlers.mousewheel);\n        _util.removeEvent(element, \"contextmenu\", this._handlers.mousedisable);\n        //_util.removeEvent(document, \"click\", this._handlers.mousedisable);\n        //_util.removeEvent(document.body, \"contextmenu\", this._handlers.mousedisable);\n    }\n});","var _util = require('../../../webrtc/src/components/Util');\nvar _logger = _util.tagLogger(\"Keyboard\");\n\nmodule.exports = _util.prototypeExtend({\n\n    __init__: function () {\n        var self = this;\n\n        this._eventHandlers = {\n            keyup: this._handleKeyUp.bind(this),\n            keydown: this._handleKeyDown.bind(this),\n            keypress: this._handleKeyPress.bind(this),\n            blur: this._allKeysUp.bind(this)\n        }\n    },\n\n    getKey: function(event) {\n        return \"keyCode\"in event && \"key\"in event ?\n            (event.key + \":\" + event.keyCode) : (\"keyCode\" in event ? event.keyCode : event.key)\n    },\n\n    onKeyPress: function(keyValue, isPressed) {\n    },\n\n    _onKeyPress: function(keyValue, isPressed) {\n        this.onKeyPress && this.onKeyPress(keyValue, isPressed);\n    },\n\n    _handleRfbEvent: function(event, type) {\n        var shift = event.shiftKey,\n            ctrl = event.ctrlKey,\n            alt = event.altKey,\n            ascii = event.keyCode || event.which;\n\n        this._onKeyPress(ascii, \"keydown\" == type);\n    },\n\n    _handleKeyDown: function(event) {\n        return !this._focused || !this._handleRfbEvent(event, \"keydown\") || (_util.stopEvent(event), false);\n    },\n    _handleKeyPress: function(event) {\n        return !this._focused || (_util.stopEvent(event), false)\n        //return !this._focused || !this._handleRfbEvent.keypress(event) || (_util.stopEvent(event), false);\n    },\n    _handleKeyUp: function(event) {\n        return !this._focused || !this._handleRfbEvent(event, \"keyup\") || (_util.stopEvent(event), false);\n    },\n\n    _allKeysUp: function() {\n    },\n    sync: function(e) {\n    },\n\n    grab: function() {\n        var element = this._target;\n\n        _util.addEvent(element, \"keydown\", this._eventHandlers.keydown);\n        _util.addEvent(element, \"keyup\", this._eventHandlers.keyup);\n        _util.addEvent(element, \"keypress\", this._eventHandlers.keypress);\n        _util.addEvent(element, \"blur\", this._eventHandlers.blur);\n        //_util.addEvent(window, \"blur\", this._eventHandlers.blur);\n\n        _logger.info(\"keyboard grab at element\");\n    },\n    ungrab: function() {\n        var element = this._target;\n\n        _util.removeEvent(element, \"keydown\", this._eventHandlers.keydown);\n        _util.removeEvent(element, \"keyup\", this._eventHandlers.keyup);\n        _util.removeEvent(element, \"keypress\", this._eventHandlers.keypress);\n        _util.removeEvent(element, \"blur\", this._eventHandlers.blur);\n        //_util.removeEvent(window, \"blur\", this._eventHandlers.blur);\n\n        this._allKeysUp();\n\n        _logger.info(\"keyboard upgrab at element\");\n    }\n});\n\n\n","var _util = require('../../../webrtc/src/components/Util');\nvar _logger = _util.tagLogger(\"TotalBuffer\");\n\nvar EventBuffer = require(\"./EventBuffer\");\nvar TrackBuffer = require(\"./TrackBuffer\");\n\nvar MouseTrigger = require(\"./MouseTrigger\");\n\nmodule.exports = _util.prototypeExtend({\n    trackBufferSize: 100,\n    _trackBufferCompRadio: 0.25,\n\n    _sn: 1,\n\n    __init__: function () {\n        this._eventBuffer = new EventBuffer({\n            _nextsn: this._nextsn.bind(this)\n        });\n        this._trackBuffer = new TrackBuffer({\n            _nextsn: this._nextsn.bind(this),\n            _compRadio: this._trackBufferCompRadio,\n            mouseTrackBufferSize: this.trackBufferSize\n        });\n    },\n\n    _nextsn: function () {\n        return this._sn ++;\n    },\n\n    put: function (event) {\n        if(!event || event.oper === undefined){\n            return;\n        }\n\n        event.oper === MouseTrigger.BTN.MOVE ?\n            this._trackBuffer.put(event) : this._eventBuffer.put(event);\n    },\n\n\n    getUnread1: function (length) {\n        function sortby(a, b) {\n            return a._time - b.time;\n        }\n\n        var result;\n        if(!length){\n            var events = this._eventBuffer.getUnread();\n            var tracks = this._trackBuffer.getUnread();\n\n            Array.prototype.push.apply(events, tracks);\n            result = events;\n\n            result.sort(sortby);\n            return result;\n        }\n\n        result = [];\n\n        var events = this._eventBuffer._getUnread(length);\n        var tracks = this._trackBuffer._getUnread(length);\n\n        Array.prototype.push.apply(result, events);\n        Array.prototype.push.apply(result, tracks);\n\n        result.sort(sortby);\n\n        result = result.slice(0, length > result.length ? result.length : length);\n        for(var i = 0; i < result.length; i++){\n            if(result[i].oper === MouseTrigger.BTN.MOVE){\n                this._trackBuffer.getUnread(1);\n            }else{\n                this._eventBuffer.getUnread(1);\n            }\n        }\n\n        return result;\n    },\n\n    getUnread: function (length) {\n        function sortby(a, b) {\n            return a.sn - b.sn;\n        }\n\n        if(!length){\n            length = this._eventBuffer.getUnreadSize() + this._trackBuffer.getUnreadSize();\n        }\n\n        var result = [];\n        while(result.length !== length){\n            var event = this._eventBuffer._getUnread(1);\n            var track = this._trackBuffer._getUnread(1);\n\n            if(event === undefined && track){\n                result.push(this._trackBuffer.getUnread(1));\n            } else if(track === undefined && event){\n                result.push(this._eventBuffer.getUnread(1));\n            } else if(track === undefined && event === undefined){\n                return result;\n            } else {\n                if(event.sn < track.sn){\n                    result.push(this._eventBuffer.getUnread(1));\n                }else{\n                    result.push(this._trackBuffer.getUnread(1));\n                }\n            }\n        }\n\n        return result;\n    },\n\n    getUnreadSize: function () {\n        return this._trackBuffer.getUnreadSize() + this._eventBuffer.getUnreadSize();\n    },\n\n    getUnclearSize: function () {\n        return this._trackBuffer.getUnclearSize() + this._eventBuffer.getUnclearSize();\n    },\n\n    clearRead: function (limitSN) { // <=\n        return this._eventBuffer.clearRead(limitSN) + this._trackBuffer.clearRead(limitSN);\n    }\n});\n","var _util = require('../../../webrtc/src/components/Util');\nvar _logger = _util.tagLogger(\"EventBuffer\");\n\n\nmodule.exports = _util.prototypeExtend({\n    _buffer: [],\n\n    _sn: 1,\n\n    _beginIndex: 0,\n    _readIndex: 0,\n    _endIndex: 0,\n\n    _nextsn: function () {\n        return this._sn ++;\n    },\n\n    put: function (event) {\n        if(!event){\n            return;\n        }\n\n        event.sn = this._nextsn();\n\n        this._buffer.push(event);\n        this._endIndex++;\n    },\n\n    _getUnread: function (length) {\n        if(this._readIndex === this._endIndex){\n            return length === 1 ? undefined : [];\n        }\n\n        return this._buffer[this._readIndex];\n\n        var end = this._readIndex + (length || this._endIndex),\n            end = (end > this._endIndex ? this._endIndex : end);\n\n        return this._buffer.slice(this._readIndex, end);\n    },\n\n    getUnread: function (length) {\n        var result;\n        try{\n            result = this._getUnread(length);\n            return result;\n        } finally {\n            result && (this._readIndex += (length === 1 ? 1 : result.length));\n        }\n    },\n\n    getUnreadSize: function () {\n        return this._endIndex - this._readIndex;\n    },\n\n    getUnclearSize: function () {\n        return this._readIndex - this._beginIndex;\n    },\n\n    clearRead: function (limitSN) { // <=\n        if(this._readIndex === this._beginIndex){\n            return;\n        }\n\n        var count = 0;\n        for(var i = this._beginIndex; i < this._readIndex; i++){\n            if(this._buffer[i].sn <= limitSN){\n                count++;\n            }else{\n                break;\n            }\n        }\n\n        if(count === 0){\n            return 0;\n        }\n\n        for(var i = 0; i < count; i++){\n            this._buffer.shift();\n        }\n\n        this._beginIndex = 0;\n        this._readIndex -= count;\n        this._endIndex -= count;\n\n        return count;\n    }\n});","var _util = require('../../../webrtc/src/components/Util');\nvar _logger = _util.tagLogger(\"TrackBuffer\");\n\n\nmodule.exports = _util.prototypeExtend({\n    mouseTrackBufferSize: 1000,\n\n    _sn: 1,\n    _compRadio: 0.25,\n\n    _beginIndex: 0,\n    _readIndex: 0,\n    _endIndex: 0, //不包含end\n\n    __init__: function () {\n        this._mouseTrackBuffer = new Array(this.mouseTrackBufferSize);\n    },\n\n    _nextsn: function () {\n        return this._sn ++;\n    },\n\n    _index: function (_index) {\n        return _index % this.mouseTrackBufferSize;\n    },\n\n    comp1: function(compRadio){ //compRadio 压缩原来的compRadio，如0.25，就是删除其中0.25个元素\n        if(compRadio >= 1){\n            return;\n        }\n\n        var span = Math.floor(1 / compRadio);\n\n        var _nextIndex = this._beginIndex;\n        var _currentIndex = _nextIndex + 1;\n\n        while (_nextIndex < this._endIndex){\n            for(var i = 2; i < span && (_nextIndex + i) < this._endIndex; i++){\n                this._mouseTrackBuffer[this._index(_currentIndex++)] = this._mouseTrackBuffer[this._index(_nextIndex + i)];\n            }\n\n            _nextIndex += span;\n        }\n\n        this._endIndex = _currentIndex;\n    },\n\n    put1: function (track) {\n        if(!track){\n            return;\n        }\n\n        track.sn = this._nextsn();\n\n\n        if(this._endIndex - this._readIndex === this.mouseTrackBufferSize){\n            //此时 begin = read, buffer）将原有数组(未发送队列)压缩为原先的0.75\n            this.comp1(this._compRadio);\n            this._readIndex = this._beginIndex;\n        }\n\n        var begin = this._index(this._beginIndex),\n            read = this._index(this._readIndex),\n            end = this._index(this._endIndex);\n\n        var next = end;\n        if(next <= begin && next >= 0 && this._endIndex > this._beginIndex){ // buffer不足后，首先覆盖已经发送的\n            this._beginIndex++;\n        }\n\n        this._mouseTrackBuffer[next] = track;\n        this._endIndex++;\n    },\n\n    compHalfOfUnread: function(){ //compRadio 压缩原来的compRadio，如0.25，就是删除其中0.25个元素\n        var _nextIndex = this._readIndex + 2;\n        var _currentIndex = this._readIndex + 1;\n\n        while (_nextIndex < this._endIndex){\n            this._mouseTrackBuffer[this._index(_currentIndex++)] = this._mouseTrackBuffer[this._index(_nextIndex)];\n\n            _nextIndex += 2;\n        }\n\n        this._endIndex = _currentIndex;\n    },\n\n    put: function (track) {\n        if(!track){\n            return;\n        }\n\n        track.sn = this._nextsn();\n\n\n        if(this._endIndex - this._beginIndex === this.mouseTrackBufferSize){\n            // begin->read 待清除区，read->end 待发送，如果待清除区+待发送区满，压缩待发送区\n            this.compHalfOfUnread();\n        }\n\n        var end = this._index(this._endIndex);\n\n        this._mouseTrackBuffer[end] = track;\n        this._endIndex++;\n    },\n\n    _interval: function (startIndex, endIndex) {\n        var read = this._index(startIndex), end = this._index(endIndex);\n\n        if(read < end){\n            return this._mouseTrackBuffer.slice(read, end);\n        }\n\n        var result = this._mouseTrackBuffer.slice(read);\n        Array.prototype.push.apply(result, this._mouseTrackBuffer.slice(0, end));\n\n        return result;\n    },\n\n    _getUnread: function (length) {\n        if(this._readIndex === this._endIndex){\n            return length === 1 ? undefined : [];\n        }\n\n        return this._mouseTrackBuffer[this._index(this._readIndex)];\n\n        var end = this._readIndex + (length || this._endIndex),\n            end = (end > this._endIndex ? this._endIndex : end);\n\n        return this._interval(this._readIndex, end);\n    },\n\n    getUnread: function (length) {\n        var result;\n        try{\n            result = this._getUnread(length);\n            return result;\n        } finally {\n            result && (this._readIndex += (length === 1 ? 1 : result.length));\n        }\n    },\n\n    getUnreadSize: function () {\n        return this._endIndex - this._readIndex;\n    },\n\n    getUnclearSize: function () {\n        return this._readIndex - this._beginIndex;\n    },\n\n    clearRead: function (limitSN) { // <=\n        if(this._readIndex === this._beginIndex){\n            return;\n        }\n\n        var count = 0;\n\n        for(var i = this._beginIndex; i < this._readIndex; i++){\n            var index = this._index(i);\n\n            if(this._mouseTrackBuffer[index].sn <= limitSN){\n                this._beginIndex++;\n                count++;\n            }else{\n                break;\n            }\n        }\n\n        return count;\n    }\n});","var _util = require('./Util');\nvar _logger = _util.tagLogger(\"CompositeCanvas\");\n\nfunction SimpleCanvasRenderingContext2D() {\n\n};\n\nfor(var key in CanvasRenderingContext2D.prototype){\n    (function (attr) {\n        SimpleCanvasRenderingContext2D.prototype[attr] = function(){\n            if(typeof this._canvasContext[attr] === \"function\"){\n                this._canvasContext[attr].apply(this._canvasContext, arguments);\n            }else{\n                var arg = arguments.length >=1 ? arguments[0] : undefined;\n                if(arg){\n                    this._canvasContext[attr] = arg;\n                }else{\n                    return this._canvasContext[attr];\n                }\n            }\n        }\n    })(key);\n}\n\n//https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D\n\nvar CompositeCanvas = _util.prototypeExtend(SimpleCanvasRenderingContext2D, {\n    //compositeCanvasTag:\n    //_compositeOperation:\n    //_globalAlpha:\n    __init__: function () {\n        var self = this;\n\n        if(!self.compositeCanvasTag){\n            self.compositeCanvasTag = document.createElement(\"canvas\");\n        }\n\n        self._canvasContext = self.compositeCanvasTag.getContext(\"2d\");\n\n        self._canvasContext.globalAlpha = this._globalAlpha !== undefined ? this._globalAlpha : 1;\n\n        self._compositeOperation = self._compositeOperation || operation.source_over;\n        self.globalCompositeOperation(self._compositeOperation);\n    },\n\n    setCanvas: function () {\n        var self = this;\n        var set;\n        for(var i = 0; i < arguments.length; i++){\n            set = arguments[i];\n\n            typeof set === \"function\" && set(this.compositeCanvasTag, this._canvasContext);\n            typeof set !== \"function\" && _util.isPlainObject(set) && _util.forEach(set, function (key, value) {\n                _logger.debug(\"Canvas set \", key, \" = \", value);\n                self.compositeCanvasTag.setAttribute(key, value);\n            });\n        }\n\n        return self;\n    },\n\n    getCanvasImageData: function(canvas, alpha){\n        var args = [];\n        for(var i = 1; i < arguments.length; i++){\n            args.push(arguments[i]);\n        }\n\n        var canvasContext = canvas.getContext(\"2d\");\n        canvasContext.globalAlpha = alpha || 0;\n        return canvasContext.getImageData.apply(canvasContext, args);\n    },\n\n    _composite: function (compositeOperation) {\n        var self = this;\n\n        return new CompositeCanvas(self, {_compositeOperation: compositeOperation});\n    },\n\n    composite: function (compositeOperation) {\n        var self = this;\n        self.globalCompositeOperation(compositeOperation);\n\n        return self;\n    },\n\n    requestAnimationFrame: function (time) {\n        var self = this;\n\n        self.requestFrame();\n        self._requestAnimationFrameStart = window.requestAnimationFrame(function (time) {\n            self.requestAnimationFrame(time);\n        });\n\n        return self;\n    },\n\n    cancelAnimationFrame: function () {\n        var self = this;\n        self._requestAnimationFrameStart && window.cancelAnimationFrame(self._requestAnimationFrameStart);\n\n        return self;\n    },\n\n    requestFrame: function (_frameRate){\n        var self = this;\n        if(typeof this.requestOneFrame !== \"function\"){\n            _logger.error(\"Pleas implement requestOneFrame()\");\n            throw \"Pleas implement requestOneFrame()\";\n        }\n\n        try{\n            this.requestOneFrame();\n        }catch (e){\n            _logger.error(e);\n        }\n\n        var timeoutMillis;\n        if(_frameRate){\n            timeoutMillis = Math.floor(1000 / _frameRate);\n        }\n\n        if(!timeoutMillis){\n            return self;\n        }\n\n        var requestFrame = this.requestFrame.bind(this);\n        this.intervalId = setInterval(function () {\n            requestFrame(_frameRate);\n        }, timeoutMillis);\n\n        return self;\n    },\n    stopRequestFrame: function () {\n        this.intervalId && clearInterval(this.intervalId);\n        return this;\n    },\n\n    // getImageData: function(x, y, width, height){\n    //     x = x || 0,\n    //         y = y || 0,\n    //         width = width || this.compositeCanvasTag.width,\n    //         height = height || this.compositeCanvasTag.height;\n    //\n    //     var imageData = this._canvasContext.getImageData(x, y, width, height);\n    //     return imageData;\n    // },\n\n    /**\n     * https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/putImageData\n     *\n     * @param imageData ImageData ，包含像素值的数组对象。\n     * @param dx 源图像数据在目标画布中的位置偏移量（x 轴方向的偏移量）。\n     * @param dy 源图像数据在目标画布中的位置偏移量（y 轴方向的偏移量）。\n     * @param dirtyX 在源图像数据中，矩形区域左上角的位置。默认是整个图像数据的左上角（x 坐标）。\n     * @param dirtyY 在源图像数据中，矩形区域左上角的位置。默认是整个图像数据的左上角（y 坐标）。\n     * @param dirtyWidth 在源图像数据中，矩形区域的宽度。默认是图像数据的宽度。\n     * @param dirtyHeight 在源图像数据中，矩形区域的高度。默认是图像数据的高度。\n     * @returns {CompositeCanvas}\n     */\n    // putImageData: function(imageData, dx, dy, dirtyX, dirtyY, dirtyWidth, dirtyHeight){\n    //     dx = dx || 0,\n    //         dy = dy || 0;\n    //\n    //     if(arguments.length >= 7){\n    //         this._canvasContext.putImageData(imageData, dx, dy, dirtyX, dirtyY, dirtyWidth, dirtyHeight);\n    //     }else{\n    //         this._canvasContext.putImageData(imageData, dx, dy);\n    //     }\n    //\n    //     return this;\n    // },\n\n    /**\n     * https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/drawImage\n     *\n     * @param image 绘制到上下文的元素。允许任何的 canvas 图像源(CanvasImageSource)，例如：HTMLImageElement，HTMLVideoElement，或者 HTMLCanvasElement。\n     * @param dx 目标画布的左上角在目标canvas上 X 轴的位置。\n     * @param dy 目标画布的左上角在目标canvas上 Y 轴的位置。\n     * @param dWidth 在目标画布上绘制图像的宽度。 允许对绘制的图像进行缩放。 如果不说明， 在绘制时图片宽度不会缩放。\n     * @param dHeight 在目标画布上绘制图像的高度。 允许对绘制的图像进行缩放。 如果不说明， 在绘制时图片高度不会缩放。\n     * @param sx 需要绘制到目标上下文中的，源图像的矩形选择框的左上角 X 坐标。\n     * @param sy 需要绘制到目标上下文中的，源图像的矩形选择框的左上角 Y 坐标。\n     * @param sWidth 需要绘制到目标上下文中的，源图像的矩形选择框的宽度。如果不说明，整个矩形从坐标的sx和sy开始，到图像的右下角结束。\n     * @param sHeight 需要绘制到目标上下文中的，源图像的矩形选择框的高度。\n     * @returns {CompositeCanvas}\n     */\n    // drawImage: function(image, dx, dy, dWidth, dHeight, sx, sy, sWidth, sHeight){\n    //     if(arguments.length >= 9){\n    //         this._canvasContext.drawImage(image, sx, sy, sWidth, sHeight, dx, dy, dWidth, dHeight);\n    //     }else if(arguments.length >= 5){\n    //         this._canvasContext.drawImage(image, dx, dy, dWidth, dHeight);\n    //     }else{\n    //         dx = dx || 0, dy = dy || 0;\n    //         this._canvasContext.drawImage(image, dx, dy);\n    //     }\n    //\n    //     return this;\n    // }\n});\n\nCompositeCanvas.CompositeOperation = [\n    'source-atop',\n    'source-in',\n    'source-out',\n    'source-over',\n    'destination-atop',\n    'destination-in',\n    'destination-out',\n    'destination-over',\n    'lighter',\n    'darker',\n    'xor',\n    'copy'\n];\n\nvar operation = CompositeCanvas.operation = {\n    source_atop: 'source-atop',\n    source_in: 'source-in',\n    source_out: 'source-out',\n    source_over: 'source-over',\n    destination_atop: 'destination-atop',\n    destination_in: 'destination-in',\n    destination_out: 'destination-out',\n    destination_over: 'destination-over',\n    lighter: 'lighter',\n    darker: 'darker',\n    xor: 'xor',\n    copy: 'copy'\n};\n\nCompositeCanvas.compositeVideoOverCanvas = function(compositeCanvasTag, video, canvas){\n    var compositeCanvas;\n    if(!(compositeCanvas = compositeCanvasTag.compositeCanvas)){\n        compositeCanvas = new CompositeCanvas({\n            compositeCanvasTag: compositeCanvasTag,\n\n            requestOneFrame: function () {\n                video && compositeCanvas.drawImage(video, 0, 0, compositeCanvasTag.width, compositeCanvasTag.height);\n                canvas && compositeCanvas.drawImage(canvas, 0, 0, compositeCanvasTag.width, compositeCanvasTag.height);\n            }\n        });\n\n        compositeCanvasTag.compositeCanvas = compositeCanvas;\n    }\n\n    return compositeCanvas;\n}\n\nmodule.exports = CompositeCanvas;","var _util = require('../../../webrtc/src/components/Util');\nvar _logger = _util.tagLogger(\"Keyboard\");\n\n\nmodule.exports = _util.prototypeExtend({\n    onKeyDown: function (btn) {\n        \n    },\n    \n    onKeyUp: function (btn) {\n        \n    }\n});","window.emedia = window.emedia || {};\n\nvar _util = require('./Util');\nvar _logger = _util.tagLogger(\"electron\");\n\nemedia.electron = window.require('electron');\n\nemedia.chooseElectronDesktopMedia = function (sources, accessApproved, accessDenied) {\n    _logger.info(\"Choose desktop. \", sources[0]);\n    accessApproved(sources[0]);\n}","var map = {\n\t\"./admin-icon.png\": 338,\n\t\"./admin-small-icon.png\": 339,\n\t\"./apply-icon.png\": 340,\n\t\"./apply-to-audience-icon.png\": 341,\n\t\"./apply-to-talker-icon.png\": 342,\n\t\"./audio-is-close-icon.png\": 343,\n\t\"./close-handle-icon.png\": 344,\n\t\"./destory-white-board-icon.png\": 345,\n\t\"./expand-icon.png\": 346,\n\t\"./invite-icon.png\": 347,\n\t\"./is-speak-icon.png\": 348,\n\t\"./join-white-board-icon.png\": 349,\n\t\"./leave-icon.png\": 350,\n\t\"./login-bg.png\": 351,\n\t\"./logo-text-login.png\": 352,\n\t\"./logo-text-room.png\": 353,\n\t\"./logo.png\": 354,\n\t\"./micro-is-close-icon.png\": 355,\n\t\"./micro-is-open-icon.png\": 356,\n\t\"./mute-all-icon.png\": 357,\n\t\"./no-speak-icon.png\": 358,\n\t\"./room-setting-close-icon.png\": 359,\n\t\"./room-setting-open-icon.png\": 360,\n\t\"./setting-icon.png\": 361,\n\t\"./share-desktop-icon.png\": 362,\n\t\"./stop-share-desktop-icon.png\": 363,\n\t\"./unmute-all-icon.png\": 364,\n\t\"./video-icon.png\": 365,\n\t\"./video-is-close-icon.png\": 366,\n\t\"./video-is-open-icon.png\": 367,\n\t\"./volume-0.png\": 368,\n\t\"./volume-1.png\": 369,\n\t\"./volume-10.png\": 370,\n\t\"./volume-11.png\": 371,\n\t\"./volume-12.png\": 372,\n\t\"./volume-13.png\": 373,\n\t\"./volume-14.png\": 374,\n\t\"./volume-2.png\": 375,\n\t\"./volume-3.png\": 376,\n\t\"./volume-4.png\": 377,\n\t\"./volume-5.png\": 378,\n\t\"./volume-6.png\": 379,\n\t\"./volume-7.png\": 380,\n\t\"./volume-8.png\": 381,\n\t\"./volume-9.png\": 382,\n\t\"./warning-icon.png\": 383\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 337;","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAilBMVEUAAAD/////////////////////////////////jQD/jQH/jgP/kQr/kgr/lBD/mRn/mRr/mRz/mh3/mx7/myD/nST/oi//ozH/ozL/pDP/umX/u2b/v3D/wHH/wHL/wXT/xn7/yYb/yof/zI3/69P/7NT/7tj/9Of/9ej/9en/+fH/+fL/+/b////Z11xoAAAACXRSTlMABiuPk7zU8vxOVFVLAAAAmUlEQVQY023PXUrDQBhA0fPNDEG0EAW3UND9b6aQFSgWawItgfnxQXwR7wruCUiRw2ijI4hcjmCpbQhRXoz1Yp7DqY6svPJ57v3q3vO5p1ToF/hqlJTiSO/QG8dIGeUR5gk5BRwK+QCRYF/r3UNbd0iD+rF6mm3vlZEa1xvTxL7R0lhs2G/YLaP0quENutp/1n871fEP7g//G1C/SpfK2LZEAAAAAElFTkSuQmCC\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAhFBMVEUAAAAAAAAAAAAKBQAKBgAQCQARCgAaDQAaDwAbDwAbEAAcEAAuGQAzHQA0HQB/RwCGSgCHSwCPTwCYVACbVgCbVgCcVwCmXACoXQDUdQDWdgDWdwDYeADhfQDkfgDmgADngADogADpgQDrggDyhgD3iQD3iAD8jAD9jAD+jQD/jQD/jQAYi+cHAAAAK3RSTlM7tczNzc7O0NDQ0NDT1NTi4+Tl5+fo6Orq9PT19ff4+Pn5+fn7/P3+/v7+oZWGVwAAAHVJREFUGBkFwQVCAwEQALG9YAWKuxeX+f//SGYWAFhmFgBgGbB1+fFxtQ0G3FTdgoGd76qfXRhYVdUhDLirugcDjj7r6xgMrB96fe5xDYPVpk5P6m0Pg4vqYL+6xmBTnZ1XTxi8V79/1QsGAGAWAGCZWQBgmX918QyBT14d/wAAAABJRU5ErkJggg==\"","\nvar _util = require('./Util');\nvar _logger = _util.logger;\n\n\n/**\n * Error({\n *   hidden:\n * })\n *\n *\n *\n *\n */\nvar Error = _util.prototypeExtend({\n    msg: \"\",\n    __init__: function () {\n        this.day = new Date();\n    },\n\n    execTime: function () {\n        var hour = this.day.getHours();\n        if(hour < 10){\n            hour = \"0\" + hour;\n        }\n        var minute = this.day.getMinutes();\n        if(minute < 10){\n            minute = \"0\" + minute;\n        }\n        var second = this.day.getSeconds();\n        if(second < 10){\n            second = \"0\" + second;\n        }\n\n        return hour + \":\" + minute + \":\" + second;\n    }\n});\n\nvar __ICEEvent = Error.extend({\n    _webrtcDesc: function () {\n        var webrtc = this.webrtc;\n\n        var message = this.webrtc.getRtcId();\n\n        return message;\n    }\n});\n\n\nmodule.exports = {\n    Exception: Error.extend(),\n\n    NetworkChanaged: Error.extend({message: function () {\n            var message = this.execTime() + \" : Network chanage (\" + this.preIp + \" -> \" + this.nowIp + \").\";\n\n            return message;\n    }}),\n\n    /**\n     * {retry: retry, online: self.online, event: evt, cause: e, session: self}\n     */\n    WSClose: Error.extend({message: function () {\n        var message = this.execTime() + \" WSClose: Websocket close (\" + (this.retry || 0) + \").\";\n\n        this.online || (message += \" offline.\");\n        this.event && (message += \" wscode: \" + this.event.code);\n        this.cause && (message += \" cause: \" + this.cause.message);\n\n        this.url && (message += \" url: \" + this.url);\n\n        message += \" retry: \" + (this.retry || 0);\n\n        this.session && this.session.getSessionId() && (message = message + \", sess = \" + this.session.getSessionId());\n\n        return message;\n    }}),\n\n    /**\n     * {event: evt, online: self.online, session: self}\n     */\n    WSError: Error.extend({message: function () {\n        var message = this.execTime() + \" WSError: Websocket error. ready state:\"\n            + (this.event.srcElement && this.event.srcElement.readyState || this.event.currentTarget.readyState)\n            + \". online = \" + this.online;\n        this.session && this.session.getSessionId() && (message = message + \", sess = \" + this.session.getSessionId());\n\n        this.url && (message += \" url: \" + this.url);\n\n        return message;\n    }}),\n\n    /**\n     * {event: evt, session: self}\n     */\n    WSConnected: Error.extend({message: function () {\n        var message = this.execTime() + \" WSConnected: Websocket success. ready state:\"\n            + (this.event.srcElement && this.event.srcElement.readyState || this.event.currentTarget.readyState);\n        this.session && this.session.getSessionId() && (message = message + \", sess = \" + this.session.getSessionId());\n\n        return message;\n    }}),\n\n    /**\n     * {webrtc: webrtc, event: webrtcEvent, state: webrtcEvent.target.iceConnectionState}\n     */\n    ICEChanage: __ICEEvent.extend({message: function () {\n        return this.execTime() + \" ICEChanage: \" + this._webrtcDesc() + \" state: \" + this.state;\n    }}),\n\n    /**\n     * {webrtc: webrtc, event: err}\n     */\n    AddIceCandError: __ICEEvent.extend({message: function () {\n        return this.execTime() + \" AddIceCandError: \" + this._webrtcDesc() + \", add cand error\";\n    }}),\n\n    /**\n     * {webrtc: webrtc, event: event}\n     */\n    ICEConnectFail: __ICEEvent.extend({message: function () {\n        return this.execTime() + \" ICEConnectFail: \" + this._webrtcDesc() + \" failed\";\n    }}),\n\n    /**\n     * {webrtc: webrtc, event: event}\n     */\n    ICEConnected: __ICEEvent.extend({message: function () {\n        return this.execTime() + \" ICEConnected: \" + this._webrtcDesc() + \" connected\";\n    }}),\n\n    /**\n     * {webrtc: webrtc, event: event}\n     */\n    ICEDisconnected: __ICEEvent.extend({message: function () {\n        return this.execTime() + \" ICEDisconnected: \" + this._webrtcDesc() + \" disconnected\";\n    }}),\n\n    /**\n     * {webrtc: webrtc}\n     */\n    ICEClosed: __ICEEvent.extend({message: function () {\n        return this.execTime() + \" ICEClosed: \" + this._webrtcDesc() + \" closed\";\n    }}),\n\n    /**\n     * {webrtc: webrtc}\n     */\n    ICERemoteMediaStream: __ICEEvent.extend({message: function () {\n        return this.execTime() + \" ICERemoteMediaStream: \" + this._webrtcDesc() + \" got remote stream\";\n    }}),\n\n    /**\n     * {stream: stream, state:, msg: }\n     */\n    StreamState: Error.extend({message: function () {\n            return this.execTime() + \" StreamState: \" + \" stream \"\n                + this.stream.id + \" state: \" + this.state + \" \" + this.msg;\n        },\n        iceFail: function () {\n            this.state = 1;\n            this.msg = \"network anomaly. media lost\";\n        }\n    }),\n\n    /**\n     * {member: self.current, event: e}\n     */\n    OpenMediaError: Error.extend({message: function () {\n        return this.execTime() + \" OpenMediaError: \" + \" open media error. caused by \"\n            + (this.event.name ? this.event.name : (this.event.message ? this.event.message : this.event.toString()));\n    }}),\n\n    /**\n     * {reason: reason, parnter: {id: self._memberId}}\n     */\n    Hangup: Error.extend({message: function () {\n        if(this.self){\n            return \"hangup id = \" + (this.self.id || \"--\") + \" reason：\" + (this.reason || 0)\n        }else{\n            return this.execTime() + \" Hangup: \"\n                + ((this.parnter && (this.parnter.name || this.parnter.id || \" \")) || \"\")\n                + \" hangup, reason：\" + (this.reason || 0);\n        }\n    }}),\n\n    /**\n     * {failed: rsp.result, msg: rsp.msg}\n     */\n    ServerRefuseEnter: Error.extend({message: function () {\n        return this.execTime() + \" ServerRefuseEnter: \"\n            + \"server refuse, cause：\" + this.failed + \", msg:\" + (this.msg || \"\");\n    }}),\n\n    /**\n     * {request: req, response: rsp}\n     */\n    RspFail: Error.extend({\n        __init__: function () {\n            this.day = new Date();\n            this.failed = this.response.result;\n            this.msg = this.response.msg || this.response.message || \"--\";\n        },\n        message: function () {\n            return this.execTime() + \" RspFail: \" + this.request.tsxId + \", \"\n                + (this.response.sessId || \"--\") + \" op: \" + this.request.op\n                + \", cause: \" + this.failed + \" \" + this.msg ;\n        }\n    }),\n\n    RecvResponse: Error.extend({\n        __init__: function () {\n            this.day = new Date();\n            this.failed = this.response.result;\n            this.msg = this.response.msg;\n            //this.request = this.response.result;\n            //this.response = this.response.msg;\n        },\n        message: function () {\n            if(this.request){\n                return this.execTime() + \" RecvResponse: \" + (this.request && this.request.tsxId) + \", \"\n                    + (this.response.sessId || \"--\") + \" op: \" + (this.request && this.request.op)\n                    + \", cause: \" + this.failed + \" \" + this.msg ;\n            }else{\n                return this.execTime() + \" RecvMessage: \" + (this.response && this.response.tsxId) + \", \"\n                    + (this.response.sessId || \"--\") + \" op: \" + (this.response && this.response.op) + \" \" + this.msg ;\n            }\n        }\n    }),\n\n    /**\n     * {me: me, cause: _event_}\n     */\n    EnterFail: Error.extend({message: function () {\n        return this.execTime() + \" EnterFail: \" + \"enter fail：\" + (this.cause ? this.cause.message() : \"unkown\");\n    }}),\n\n    EnterSuccess: Error.extend({message: function () {\n        return this.execTime() + \" EnterSuccess: \" + \"enter success \"\n            + (this.ip ? \", ip = \" + this.ip : \"\");\n            // + (\", wifi: \" + emedia.isWifi());\n    }}),\n\n    /**\n     * {streamId: rsp.streamId}\n     */\n    PushSuccess: Error.extend({message: function () {\n        return this.execTime() + \" PushSuccess: \" + \"push success, streamId = \" + this.stream.id + \", \"\n            + this.stream.optimalVideoCodecs + \", webrtc = \" + this.stream.rtcId;\n    }}),\n\n    /**\n     * {webrtc: webrtc, pubS: pubS, me: me, cause: _event_}\n     */\n    PushFail: Error.extend({message: function () {\n        return this.execTime() + \" PushFail: \" + \"push fail, streamId = \" + this.stream.id + \", \"\n            + this.stream.optimalVideoCodecs + \", webrtc = \" + this.stream.rtcId\n            + \" cause：\" + (this.cause ? (this.cause.message ? this.cause.message() : this.cause) : \"unkown\");\n    }}),\n\n    /**\n     * {stream: stream, failed: failed, me: me, cause: cause}\n     */\n    RemoteControlFail: Error.extend({message: function () {\n        return this.execTime() + \" RemoteControlFail: \" + (this.type || \"remote control\") + \" fail, \"\n            + (this.stream ? this.stream.id : \"\")\n            + \" failed = \" + this.failed\n            + \" cause：\" + (this.cause ? (this.cause.message ? this.cause.message() : this.cause) : \"unkown\");\n    }}),\n\n    /**\n     * {stream: stream, cause: }\n     */\n    SubSuccess: Error.extend({message: function () {\n        return this.execTime() + \" SubSuccess: \" + \"sub success, streamId = \" + this.stream.id + \", \"\n            + this.stream.vcodes + \", webrtc = \" + this.stream.rtcId;\n    }}),\n\n    /**\n     * {stream: stream, cause: }\n     */\n    SubFail: Error.extend({message: function () {\n        return this.execTime() + \" SubFail: \" + \"sub fail, streamId = \" + this.stream.id + \", \"\n            + this.stream.vcodes + \", webrtc = \" + this.stream.rtcId\n            + \" cause：\" + (this.cause ? (this.cause.message ? this.cause.message() : this.cause) : \"unkown\");\n    }}),\n\n    /**\n     * {stream: stream, cause: }\n     */\n    SubFailNotSupportVCodes: Error.extend({message: function () {\n        return this.execTime() + \" SubFailNotSupportVCodes: \" + \"sub fail, streamId = \" + this.stream.id\n            + \" cause：\" + (this.cause ? (this.cause.message ? this.cause.message() : this.cause) : \"unkown\");\n    }}),\n\n    /**\n     * {stream: stream, cause: }\n     */\n    SubFailSafariNotAllowSubBeforePub: Error.extend({message: function () {\n        return this.execTime() + \" SubFailSafariNotAllowSubBeforePub: \" + \"sub fail, streamId = \" + this.stream.id\n            + \" cause：Safari without access to capture devices, \" +\n            \"WebKit only exposes Server Reflexive and TURN ICE candidates, \" +\n            \"which expose IPs that could already be gathered by websites.\";\n    }}),\n\n    /**\n     * {stream: stream, useVCodes: []}\n     */\n    SwitchVCodes: Error.extend({message: function () {\n        return this.execTime() + \" SwitchVCodes: \" + \"pub streamId = \" + this.stream.id;\n    }}),\n\n\n    CurrentCalling: Error.extend({message: function () {\n        return this.execTime() + \" CurrentCalling: \" + \"warn! current calling...\";\n    }}),\n\n    /**\n     * {desktopStreamId: m.streamId}\n     */\n    OpenDesktopMedia: Error.extend({message: function () {\n        return this.execTime() + \" OpenDesktopMedia: \" + \"shared desktop, desktopStreamId = \" + desktopStreamId;\n    }}),\n\n    OpenDesktopMediaAccessDenied: Error.extend({message: function () {\n        return this.execTime() + \" OpenDesktopMediaAccessDenied: \" + \"shared desktop not allow\";\n    }}),\n\n    ShareDesktopExtensionNotFound: Error.extend({message: function () {\n        return this.execTime() + \" ShareDesktopExtensionNotFound: \" + \"shared desktop plugin required\";\n    }}),\n\n    OtherDeviceAnswer: Error.extend({message: function () {\n        return this.execTime() + \" other device answer, webrtc = \" + this.rtcId;\n    }}),\n\n    AudioMixerStreamNotAllowSub: Error.extend({message: function () {\n        return this.execTime() + \" audio mixer stream not allow sub, webrtc = \" + this.rtcId + \", streamId = \" + this.stream.id;\n    }}),\n    AudioMixerStreamNotAllowOnlySubVideo: Error.extend({message: function () {\n            return this.execTime() + \" audio mixer stream not allow only sub video, webrtc = \" + this.rtcId + \", streamId = \" + this.stream.id;\n    }}),\n    AudioMixerStreamRepeatPublish: Error.extend({message: function () {\n        return this.execTime() + \" audio mixer stream repeat publish\";\n    }})\n};","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAMAAAANIilAAAAB3VBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAQECAgIFBQUHBwcJCQkMDAwPDw8QEBARERESEhIWFhYXFxcZGRkaGhocHBwkJCQoKCgpKSkqKioqKiosLCwtLS0uLi4xMTE0NDQ2NjY3Nzc8PDw9PT0+Pj5ERERGRkZHR0dHR0dRUVFTU1NXV1dfX19gYGBhYWFubm5vb29wcHBxcXFzc3N0dHR1dXV4eHh3d3d9fX1+fn5/f3+BgYGCgoKDg4OFhYWHh4eHh4eIiIiLi4uMjIyNjY2QkJCRkZGSkpKWlpaVlZWWlpaYmJiZmZmampqdnZ2fn5+fn5+goKCjo6OkpKSnp6eoqKirq6uurq6urq6vr6+xsbG0tLS2tra3t7e2tra5ubm8vLy7u7u8vLy+vr7AwMDAwMDCwsLFxcXFxcXGxsbIyMjJycnKysrMzMzV1dXW1tba2tre3t7g4ODn5+fo6Ojr6+vr6+vs7Ozt7e3v7+/x8fHy8vL09PTz8/P09PT19fX29vb39/f5+fn6+vr7+/v7+/v8/Pz+/v7///////9fcc+yAAAAnnRSTlMABQgLERIUMjM4RFlhd4CFj5ebnJ+lsrzAx8nMzMzMzc3Ozs7Oz8/P0NDQ0tLS0tPT09PU1NXV1dbW19fX2Nna2tzc3N/f39/g4ODg4eHi4uLi4+Pj5OTk5OXl5ubm5+fn5+jo6Onp6enq6uvr7Ozs7e3t7u7u7+/v7/Dw8PHx8fHy8vX19vf3+fn5+vr6+vv7+/z8/Pz9/f39/v7+/ihEPVQAAALySURBVEjHpVf3QxMxFL6yS/egg7S0qCCIRVRUqggoiIIoiiwFFEEFFbC4UMEJWESmA7Cl39/q9a6Ou6TQku+XvLx7X5PmjbwIAhMZWr3R7nC63U6H3ajXZggpI1tndRMF3FZddkrUXHMhYaDQnLsrNc9GksKWtyM1x0R2hCknOTffRXaBKz8JVWMgKcCgYXEzLSQlWDJpblYBSREFWdS6KXNFtmptjYWkAYvyfxtIWjAofETSxH8ey3GlS3b9ixYTSRumv/FM9oA/cW7bC9mWyEHWt5Lu8LQvLvimw10lLAs5Q830B0/bGoD31YRUfxCFtTYPbWOW6gad+yVvgHDLR8SWloBPlz4Drw/Q1SFeW3T0jz7A5nUv8XcvAF96/MTbvon7tJVOJFtpdTNuykJZuTz24gJtZRXrpJtWn8RTpSKEE7SVO0PQMg7yLF4qFc9xhmGmFfQM7TD6lIpbGGaY6QUjrayLRKtkj1VUyD4KRCN1tJ1RsKs0xfUjEXRK4kXxtBeaJbEDkZH6YpWpXXAQ9dlg7XLiiLG1BfRIk1YxakIqU4fgVGnCuLpfEiqj6PL5uhAJSNN9VxBWmToFtad+4qgsXMNMfJhBuzyvxA+1ryhyFIdk4Q6G4sMQbicCBlGKrN72Oo7LQitmvYR4Z9Eiz49hndq2+sDm8ahGXuk7JmtqJvHtoDQ99RDz1IGpXTUIxMb8cel8RMxG/DonZfXjGGKDlKuoICltWsYTSQpOray8CEriOJabSukgYYRnYFUdyqexGmCFJysxOnFPHeydzMRgpWQQr5SKKQSZKckqBkFMKBVjLLKVXYY6cFcajzQ2ViVccINdhhgFsB+YKCeH38ZEt70LkLJxoJ9dABml1zuwjY3RRSyGQov4OrqB7QEvu/Qyi37tnBgffUWEFIm7wFxt0qLPvG48Dc8SFbR3ssGT/Lrhu+i4rli+y52rreBraPhaKa4mjq995Gtc+Vpmvmad85nA90DhfBpxPsrSeA7+Bu9qmCYUWR3vAAAAAElFTkSuQmCC\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAADJUlEQVRIS82VS2gTURSG/3MzmcxkMm2Spg9sV8WFm+7qxo26LMVtsQ8pRUSkoAsXFgSNFkVUtFIQRFxZEVuQttDuuuxCrO4UEdSNStqaxOY1kyZzr9xMBvHRZhQEB4bZnDsf//+fcy7hHz/k5//i4kVmd3cPoVjspkTshTYwuOTnnKxpCBBv3pj282d3sV0ZgaqCGBNQFFuU7Rwx5Yo2MjK9G2xXgP3g/m0hcJpMk5FhAGoIYAyoViAsCygWhYiYI1pX1zz19pZ+B9oRUHr48ACs0ipraQFFoyAjAtI8QBWiVILI5cAzGaBQSFE0fFA7Ovr2Z8iOAHtmpg9qcJlaEmCxKCgSqSmgQACiIhWUILZyEJk0+OYmULIu6OPjk/4Bi4t9pKrLLJEANTeDIq5FxBhE1VOwBZFOg6+vQ3zNJvWTpy75BlRXVvq4pi1TPA4mAeEwoAZBrK7As6gGSEklSX3s+O6A9MxMU7hYeELx+GFKJD6w5ug+CSDTBGkaKBh0Q5YW2Ra4Z1EqBZ7OJPVjx3YHlKZunUVAucna2yHf7/6boFAIUBSACJAWWVY9ZNcifEknQ8PDDQDTd86ABaZYRwdYWxtc/92Aa4BA4EdAPg9etwiZdDI02ACQmZ1t1rLZVywW62Ttba4C2aIe4CcFPJerh5wClxkMN7BIdkBl7vEhZ9tZoUQrqymQLVqbAQ0IKu7wexblc9J78I11N+TRMX9dZM09uUYB5RxLtIJiMTdkXa+HTBCVKiBDzuXdOdjYgMhkk/qJE/4Aa2trwZ7371ZhGPspFnfnIBwGqarbRY4M2YaQCjJSwQZQ2T6vj45d9T0H9sLCXtjWS2pqMt2gDVBIcwHc+Q7IZmUOnBmRntDAwGvfAFloz88fQWX7ERmGWVsVchbkqnAcwC5DFPIQ+bwDh49rQ0P3/mjZecWFpaUOBRgkoInJoGUncQ5u2/JbFsBTrb//lyXnnW94H/i9WHaqawgoTk5+BKNOGGE3AzlsQtTXhQ1RLIAc/sm4PNn1dxZNTHwSgu8hXQPJC8cDyFkol2trm1jgc+T6jc6/Avxzi/57wDdbZ4AoY1vMvAAAAABJRU5ErkJggg==\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAABLElEQVRIS83VvytFYRzH8fdHEeMtGztF7mL3IxObf+EOJhldiyilZDIZlEUmk1UZFCsDq5RsVkXKR6fOLenc8zzPrSfO/DnfV8/n9HyPyPwodr7tJWAKuJJ0HfteELA9AOwDq+VQAy/AG7Aj6aQOqwVsbwIbwGCXIV/AInAp6bMq0xWw3QTuIqt4BGYlPf/O1wELwEUkUMTWJe3lBLYkbf8tYLv4mMfAHFD0OZ1QUfgEtleAw4ShP6NRQAs4ygkMAbfAWA9I+ATFUNtF7zdAfyISB5RIG9jNCfSVl2w+AVmTdJByD0bKVTEcgXwA45KeooGyqhngDKhD3oGWpNOkZdcJ224Ay8BoxYBX4LxqyXWywf9BRD21kSBg+x6YCEAPkiZ7rSgvkL2ifw98A1t0aRn5ZuG2AAAAAElFTkSuQmCC\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAARCAYAAAA7bUf6AAABm0lEQVQ4T2NkYGAQZmBgUGNgYGBnIB38ZGBguMXIwMBgSaYBMCt/ggxxIN0BqDpwGsLPwsK829gw889/hp9Wp07PhmmboaVhOfHBo4vXv337BhPDaoiHsLDQNC31BkEWVt27375vNDl5agJIAwcDA9MTB7sNr3//vqR59HgNhiGT1NVNNbk5VRgZGZl0eHgD2ZkYQQHOADOkWklBY/bTJ3f71dTtvEREapa9eFGeff3mKZAauEveOdrtZGRgZEMPH5AhNidPTXziaLflwbcfu0xOnpr42NZ6zue//55qHTtej2LIe0f7/dgCGOaSw2YmSdpcXBGWp8/6zdXSiFHl5vYQP3AohCRDQN6NlZLoKrt1J85fTMTMWkAgXXD/QTeSDDlkapKsw80VjtclxITJ/W8/dpniC5OJGqommlw8Kszg2OEOZGNiEkGOnRoFBfVZT57cm6ChYe8pKlyNNXaQAxWUTqZradQLsLDooaeTxw52G9/+/nNB4+ixWryJDSSJK8VO19CwmPzo0cVr3759J2gIKfmJarmY4vIEAAXJz+qOcbcSAAAAAElFTkSuQmCC\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAACk0lEQVRYR+2XzU4TURTHz7lDWzoLO60kSos2wZXCQpeVIjtjjDFuiG/AE1DCQtM2uiCUJ+ANTDfGGGPcIcUucYG6kqSWFk2gHy6mzJS5x1zMJLV26Ew/zMT0bu+95/zmfz7uGQSXL3Q5H4wA+43QSMGRgv0q0O/9/zsHk8mkV1WNKwA4hcgCjDG/UIxz3iDidQA6kGWpmE6n9V6V7EnBxcVFKRqduS5JdAMAvF2c64aBnwuFT1+y2azhFNQx4NJSSg4GcQGAX3TmjB1Xq7S1uZlSndxzBCjgFIXuIYLsxIl5lgjUWg3fOoG0DSjCOj09e9e5cu2fwo739/fe2Q23bcDl5dSsJNHNXpRrv2MY+HFjI7Vnx5YtQFGtJyfwqL0gdB3eeDx0CxEnOzkjopKu467PBw/a9vXxcXhpp7ptASYST64xJsXaITjnBVlmeU3DO0QUbt0XcH4/bquqNMeYaEV/Ls6NfCbz/Gs3FW0CPl1gjP3l5Ldx/FatlvOhUHjehDThNA3iRDDVCYJzXsxknm0NBHBlJfkQES5YGRPO6vUfHyYmIvHTU4BarZQLhSbnrOCEHSL4ub6efjUQwNXV9GMi7jnPGCIcVCqHO+KMolyOI2Lk/POsubaWfPHPAEVYa7XvOeGwm3pniYEDBOwWYlM9RYnEx8YAjo5KuUDg0m3rvB1wiBMJ6yIRcD4f5BoNmjfDiojlSqW8HQyGYwB0dehFYt1mpKIsGzutcCaMgPT56L2q8hhjLDrUNmPVqDUNXnu9Z426Y0EQ0WGzibteL9wfaqMWxl391AlA1w8LAtLV45aZQ64eWE1IV4/8rdXo2p+mbu/nIPdtjVuDdOjU1gjQqWLt50cKjhTsV4F+77s+B38BCfFUOGOOt8cAAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAABcVBMVEUAAAD/s7Pznp71ra36oqL2oaH4vb31k5P8t7f1kZH5lJH5r6/5qKj2oaH3i4j3qan6rqz4oZ74o6H4nZr4nZ34mZf1lZX1j431j4/4oqL2g4H2kpD4oZ/2mJf1hYX4kY/1kI/0fXv4o6L3l5b4oqH0eXf2hYT2kpH2hYT2hYT0c3H0dHP1gH74r670eXf0eXj0fXz0fn31h4X1h4b1iIf1iYj2jo32kI/2kZD2kpH2k5L2l5b2mJf3mZj3m5r3nJv3nZz3np33n573oJ/3oqH3o6L4p6b4qaj4q6r4raz4rq34r674sbD5srH5s7L5tLP5tbT5t7b5vLv5vbz6wL/6wcH6xMP6xcT6xsX6xsb6x8b6yMj6ycn7ysr7y8v7zMv7zMz7zcz7z8770tH71NT81dT81dX819b82dn82tn82tr829r83d383t7939/94eD94uH95OP95ub95+b96ej+6un+6ur+6+r+6+v+7Oz+7e1makWPAAAALnRSTlMAChUZNzxNTk5PT1BSVGVlZWdnaGhpamtra4qMmLPNz9TY4eTk8vL6+/z9/f7+akfdCQAAAO5JREFUGBm1wTlOA0EQQNFf1TU92BaYJUIEEBJxAu6fEyEiMiBAAlvCnqW6Gg+LyBG8x/84v+CH8W0pSQ/rii8G2KzWEtdJifs7TSLdCAJcHs3zXmqSEmUs3bB5vQUDlot5O2+yCjUGt14CMCDnvN+2SZSoudfqGTDAzFKjpkKN2riZAQaIqEBUJSqIigAGRHgpUplEKR4BGDCOTYcJk+qdjyNggPsgnpOw44MP7vyGAFfW5izCpNZx6P0GDHAdqydlElE8HBBgdlBLHNu6h8XpQydpvQEDtltoz14egdVMn/mgfDp5e2CnPLXKX3sHT95qO9c6uBUAAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAXCAMAAAA4Nk+sAAAAQlBMVEUAAAD///////////////////////////////////////////////////////////////////////////////////8IX9KGAAAAFnRSTlMAAQYQFRwiN0BKZXuUlqWptbq/w8rMKd3iyQAAAEpJREFUKM9jYKAL4OCHYFTAKsQLxqiAiU+QBYTRhLlF2MEYFXCKcoExKmAT5mEEYTRhPgFmMCZOGIchOKzE5UBc3sHheVxBRTcAACI/A9XZetZDAAAAAElFTkSuQmCC\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAABn0lEQVRIS9WUvUtWYRiHr59DNCgIQVDoINZU6drg5Bw4iIom4ZA0RNDiohgl5hCBi6iDgoIvKIIoQn9BDg1hgWDQEgRt4iDUpD954Lxwej+ec/Tg4LOe+7mu++Pcj7jioyvmkymw3QC8Al4A94DfwDwwK+ksK8E8gsUEXslalvS8kMB2B/AN6lb6WNKXmCRage0pYDICmJE0UURQAoYigHVJg0UEq8CzCKAkabiIIJQ/HQG8lfSuiKAT2I8MuUvS3qUF4aLtbaCnBuQQeCDJRQW3ga9ASwoUoE8kfSq0B+XLtueAlynYlqTeLHj4nmeTm4DvQFsKuCRpNGlhH/AGuA/8BKYkbZZj6wpsB3A/8Bp4WJFtaFHYj1NgI0n0D3A3jA0YKEuqBLbvAGNAyLAx0oZQ0W5KPgKsJPEHkh5Vtch2eDE/ZoDLzhvACXAEjAOfgS5gBrgl6eZ/Atsh6H2ewSUx7cBO7gpsHwPNFxCEwf7IPQPbodxYzyvd/4BuoDXXX2T7KbCQkkQ3NLH9BT4Aa8CvWluduQcXaFnN0OsvOAdWSYAZi7kFOQAAAABJRU5ErkJggg==\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAARCAYAAAA7bUf6AAABmklEQVQ4T2NkYGAQZmBgUGNgYGBnIB38ZGBguMXIwMBgSaYBMCt/ggxxIN0BqDpwGsLCz8FsuNsvk+HP35+nrdbOhmnTmOFo+WjihYvfrr//BhPDaoiwh7yQ+jSHBlZBdt3vdz9uPGWycgJYAwcLk92ThA2/X3+/dFxzaQ2GIeqTbE05NYVVGBkZmXh1hAIZ2ZlBAc4AM0Sh2ljjyewbd9X7re1EvBRqXiy7WX4z++ApkBq4S+zepe5kZGRkQw8fsCE2ayfaPUnc8uPBx12nTFZNtH6cMOff599Pj2strUcxxP592n5sAQxzicnh4CQubaGIs5Zr/TTmOsVwq/J7HBKfG0KSIeqT7E0lYtW77pQdixPxVzATsJZKPyg4y40kQ0wOBSdz6QiF43UJUWFy/+OuU6Z4wkR1op0Jj6agCiMzAxO3jmggExuTCErs1JioP5l1+Z7GBHt7YU+FaqyxgxyooHSiMd2hnkWAXQ8jnTxO2Pjn7Y8LxzSW1OJNbCBJnCl2uoPFo8kXL3679v47QUNIyU9Uy8UUlycAM6HP6oG5UX0AAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAV1BMVEUAAAD///////////////////////////////////////////////////////////////////////////////////////////////////////////////+ORg7oAAAAHHRSTlMABg0RJyo7QFVXWF14eoCnu7/H1NXY4un2+fr+mIQ8vAAAAFtJREFUKM9jYKAJEBDEKszJJSLKxYkixMIOAjIgIA1mskIlJGTQgCRUQgYDDGoJ0gFOo6RwBQkbFxAIS3ADSX4ZPiDJhmQcuzQviGIWR48THiFGMM0hxkT1BAAAd+0WgxuE4yAAAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAYAAAAfSC3RAAAB80lEQVQ4T0WSP28UQQzFf56Zu80BCrQEiZIAOkT+EEIuQAg1LR8AhBAdBYICGiioUiChdBR8AGryBWiQ6GioI2iQIkBJDnS7Ozby7Al2tZqVx36233syf/6iiQAiSPkBM/+sOzHEXxFUteSZKnJ2uGieFGLwLEeYFnmBTkPdnfqdKm3OyPxwwTw5hkBWJYZYuhRU6bpLCGhWTAJ1XRdgOXdhyVSNGENBOpUSNXCzn0rhxyaXgt1JjUiXo95xuLBiPnuIkZOqvDlxhFe/a07HUJD3zHgw6HPnx5ivbUanu8vCpTXLORdSXgwSvwy2xg13B4kgwttJ5tEgMQs8+TkuYCFEZGllZI7i++3MVjzcn/ClVW7PJEIIvPvTcCYIr49X3Ph+UGIpBWRxZVRYdUJ3jvV4fNjwORd6CzNOzDDA1tEem3tjQhBijMjy6rqZdjo+r4SDrLwct0Ue188hns4EKoxnh03BS353ee16GdWfOWB7RvhQK+8b1xFuVZFRhHv7NbtNS0yRXkrI6mjDfD+dumVO4H4/sBy7aT81xvbhhG9Tc7hsvRSR1fUNa9uplcxom1z28r0zRnbhO++RYiREIbo9r1zdLB3dPa6nJ3a2g0ZzibnwnZ3dYUK/l5C1a5vWjck/dHeSd2nV/hcW+1khpqr6/AXKThbItLMXFgAAAABJRU5ErkJggg==\"","module.exports = __webpack_public_path__ + \"static/media/login-bg.35ac64e9.png\";","module.exports = \"data:image/png;base64,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\"","module.exports = \"data:image/png;base64,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\"","module.exports = \"data:image/png;base64,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\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAABPlBMVEUAAAD////////////////////fQED////////wPDzxOTnkQzbpQzf0QzfqQED0QED////rPT3////////5pKT////////6tbX////8ysrwQD3wPz/////wQT7wQD7yQD7////////vQj/vQT7////yQD7wPz/////yYGD0amr0bWryamfwQT/yaWb0ZmbyZWP93d373d3939/94uL////////////////////////////////////////////////////////////wQT7////////////////wQD/////vQT/vQT7////vQT7wQT7vQD/wQD/vQT/////vQT/////vQT7wQT7////vQD7uQD////////////////////////////////////////////////////////////////9+GtcDAAAAaXRSTlMAAQIDBAYIDhAREhMXFxgYGBkgIioqLDRFUlRVVVZXX19gYWJiY2VwcnNzdHV1dXd3eHh6ent8gIGRkpOVoq6vs7S1ubm6v8DKysvMzM3Nzs7Pz9DQ0dHR0tPV1tfY2eHp7/Dy8/T4/f622Q8FAAABAUlEQVQYGYXBh1LCQBQF0AtJzGLFhg17x45iQcGOIlhZLAkG0STr+/8fMGSYyWac0XPwv3iu0cjF8YtukcfS4WmDJEO+DIDRc0gK5CsAY2+9kHDycYy/9kDGyXc18dyNEE5NVqrahTBOnvdUtRMyJQJORLXlyggiCgL8Ak9EtZXKZhmXLwjYXzgjc+1xS5zCcREwqG/aWH9IC5rqJwOBQ9qLLt2nBeWj+5RFICGKk3cD+eM5JeGIQUgWN26H4Bn+oAPIZkrbopg9Kn/TiQbJbKlj1ybP544CyfxNO6AnXTepQ7ZwHUOTbSNsNQaojDHHYYypCNHq1FLXIFNNajFV/O0HqttAllsTUR0AAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAjVBMVEUAAAD///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8DizOFAAAALnRSTlMAAQIDBAYOEBgiKyxFVV9ienuBkZKVoq6vs7S5ur/MztDR1dbZ4env8PP0+P3+wpkPNAAAALRJREFUGBmFwYcOgjAUBdCrBeree/EUXEXv/3+e5MWkUI2eg/9ai+t10cKHJGcpTxAaU40R2lPtERIqQUioBCGhEoSESlBjGhAqQcPAO26RUqXYHeEVDhuqDVwB78T2gGrQ5gnejJPmkqVlc8IZvM7Ddc1wtRqarnt0UDHlpYdS78IpquI1n4f5/PDkOkaNGd1Yuo0MQkm/KPoJvrnf8Smy1jpnrY1QE5/5do5RFWV8yyL89gJXDRtk/Nu5+QAAAABJRU5ErkJggg==\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAAoCAYAAABjPNNTAAACp0lEQVRYR+2Xz2sTURDHv7NbjIgk3ZCqx4qYgz8uglakZDdNEW/iQYpelCp4VBpB/wQFG72KP/CklB7Em0LT3Q0iEsGLxIM96NVYExIUrHTfyCppk3YT3sZNTXHf9c3OfN53ZufNI2yCRZuAESFkUFkKlQyVDEqBoPyENdk3Sn7JjCYHhDoB4ASAYQAJAIsAPgF4vqw4M0P5lx/+BrjrdNcNIyEINxh8HoDaAcIh0COFcT1qWS6879UVZGU8dVBx6BkDu2UjEvBRqHwyPld4J/tNw843ZNUwhgEugjDkPxiXmZURzbLcUpBeviD5NNTaol5k4FBLBMZTIhxjYGfT6T8z4xUIp5ptCXgbS9hHaBaOLKUvyGo6NQnQgzVBRcy0B+pjqZxgurKyR3xncL4wVUvrywworUB8QTMLD3sCWUnrJQL2rXEuNNNWa2l9WgBTjT0FyMVMO1tN665iLZAMvI+b9v7AIWup1F6hklcr8Q3pwikOJ2OFwoIMqHS6K2P6GWI89nDaFSQTzsbn7SeBQlaNVBZEt7ycEvgSM10E4fDKPuMNEd9n0F1PEOarmlWYDhYyrbv1JuVUJjCArGbaORnbINItE2edTU/S3eHHAcA/AeUegScYSNCfu3uWgUkAEa9T9OTHcQO1aUHuVnmQac9XZSmm8tZrDv24KUSktoV4gYFd6yGppJnWAdkUSKfbdejVzFf7IpWWGEd3WNa3smFsjxBeC3CbXtjDZt7uWmTguwolEzXNYi2jj8fy9lzdMEYEiTxA2zb0WvytpseA4dagAJ8D6DIBxwn0gkC3BYTbV+Or9/kGDBiNYH0/qjVA+37oba6xemY06XR4PqiKMxP9V88H2fYRhJ2vFhREwG58hJDdqOY9ZQXlqYd+wnQHJW6o5H+l5C8dLhs4tJGDbgAAAABJRU5ErkJggg==\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAABgElEQVQoU5VSPU8CQRCdOT6MGg0XIyAWYGLFLzAQYO8iNbHCxN5YaGFCq4W2JBYWJvYmUBlq4rFAgH9AZ8BCRCw4NGo8uBuzcBRXWLjNTmZ23nvzZhHsQ9Go9z3oPySiAwIIijQC9BHxbrU/uMV227BzAF+qummQVSIEDmBcy1rzSRSHaiwM4D0BAraAUmZJ055RII8C/iYBXsqVSumbscgi513RMI+HipIBoDPf6yCGI5UdWwARWeO5t0Riw+2SijKvJqcMLFWbmFZ2vV5/GaosLwF0UVdSLcLxvpDxmU6HjIlRlCvVxLRBSdW9bm92uVzuCXlIngIOlVRHrlS3xAOKx1d0j+tC5rXTGUPyyjc2z7HR+LABOo6GuWN/3QLcIWmGypjLNemJ2DTdIZlzPnNMDSOZBcfQojDaZTtk0j0BoCXB3tpDtSXyusryKIYWtuoBfxNsW3WV5QAgbstq+DSed9gqCmJxP2SVAIEjSDc+TXucsjG2bUlw5Fjcf7/GL/rAyYe/tTdUAAAAAElFTkSuQmCC\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAC1ElEQVRoQ+2Zu69NURDGf58WlcbrCrUeISGICo1LXIX3o/IqPK6/wLPwqrwfBYLboBKEhKDXi+ctqFytkUnWSU72PfvutfY+556zk7PKvWfPzDez1sw3a4uaL9Xcf/oAup3Bfgb6GagYgf4W8gCa2TRgA7AJGJO0ZaLAmtl9YCrwEBiRNFY2EZUyEBzfDxwBZjQ5sVPSrVZOmdkO4GbTu9/AOeByGSBVAWwGPJrZZcBF4IykHyFLs4FjwEFo2X+GJD1IzURVAHOBrwVGR8P7mQVy8yQV6RqnYjIAxAa1KwD84D6O9bBAbqOkZF2lM2BmU4CXwIo2AXgDrJT0L0VfKQDB+VPA0RRjEbJejY6ngCgEEErlWuBdcGARcKCNkc/ieh0q2MfwYhnwLK/ExgAYBk5GRK+TIickecbTqlCI/udMk+qko3m6vdnNb5WFCTNgZtuA293wuIXN7ZLuZJ8XAXgCrCsBwDvxNeA68Cl8vxDYDezJ6cRFZp5KWp8KwGmC04WU9RPYKulFq4/MbDVwF5iVotQpSyuSGHOInXzdiIyaR35NnvMNhwOI5wk6d+WRw0IAbtTMzgOHIiJ2VdK+CDnXeQXYGyF7QdLhPLlYAM4kv0cYWyLpQ4ScA1gMvI+QndNgtMlltPkDM/O9XcQop8dy+lCi/xQAGJU04VmJykDYRvUFYGb13kK1PsRhhq1nGTWze8BQRKVoFumdRmZmtacStSdzfmHVC3T6F7AgmU6H+t8LA82wpNOlOnHTSPk2KPCR0i+n2jXMZ/3ykfIS0Bgpl1YaKXMosd9IeET8SrGd6yzg0Y6+mYimElkvw83EK2B5mxB45FelOO92SwMI52MQeNQmAIOSRlJ1VQUwAHxJNZojPyDpW6quyQAQe7nbFQBOM5xujDsidble90ZX3x8cjbBnfjH9lTQhAeyZX0ypB64T8pUOcSccStXZB5AasXbL/wektixAh5acaQAAAABJRU5ErkJggg==\"","module.exports = \"data:image/png;base64,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\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAACHklEQVRYR+1XXUvbUBg+H0lL7YZflTknm/PCDfRiFPpX+i/qTWnXQEoMDcRFvJn/on9FKLtwsHmhTly1TN2Ga0ubvMk4nTBpAjlpRA5bzl04z/u+z3nOOc95g5HgAwvODyUE4+5QomCiYFwF4sb/02cQK4qSo3RqbjBwfu7s6Bd31apUtMV0WpoG6F2bpnmJEPImUXNiBVW18dJxvDlWlBDqOc7wot+fv2LfmczVvCSlFl0XbvPD9+1t/ehBCVar2jIh9AlPUddNdyzr7RkPdhwzsYKKoq15Hn3MUxRjuDFN/ZAHey8Ey+WtnCyTF1EK2rb7ZXd3i53FSINXQayqjZXh0LEpRVO8yvnUwHADgHqplCQbRv2E5+JwEVQUZcHzMs8jLT0EjHH/1DTNb2E5uQiqauOV43iPwpJFmZck/Msw6p/DYrgIMk+T5dTSX9vwpXUB4LxQWB8psr//cYFS+pQ5UBABZku2PWyPe2cQlosgC6xWtSVCRkV9AwC+Bhk1pfRZEN514dyy9HaYemyem2Cp9D6dzf7YCEqaz7/+UCwW4e5cs9mkrdanN0H4bnfmYG9vc/B/ERR6i4W/JMLbjPBGzW670E/duB2I2Cz4LEvoduvPy/JumZABZ8MKHcvSH7ZhrdW0VYToLCMb1vJLEr42jPoxz8vha9EmCbqNEfunKcbCIoVyNwuRst4jOCEYV8xEwUTBuArEjRf+DP4G1ewiOH+zPakAAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAABGElEQVRIS+3VLUuEQRTF8d8FLWaDRTBYDH4GUVCTiiAGo8kPYzUJgs1kECwKviSzTTCJFoNNLC5ceWRd8OF5QZcNyk6dmfOfOXPPnTDgEQPW988AmTmJA8xh9If2veMa2xHx+LX3m0WZeYH5HwqXl19GxEIdoDjFSJ+ATkT0bl++QfYp/rk9Inq6Q0Clo0OLWgvttxbdYAdv2MVaHakJUBe0K6xExGshmplFGA+xVQFpDFpVqzjDOsZwUuQIq3jBftF7SpDGVlFudqfYwDgK0ExX7A5LeMJe17pOa7Or8jQzp3GOqdL8AxYj4r7p1Rs/nMyc7Z58okbkGcsRcVv74E30zDzCZktdHkdEYWN1qluLus8Ff/9P/gDzWmUZAY/RtgAAAABJRU5ErkJggg==\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAABs1BMVEUAAAD/f3//qqr/////xsboubnr2MT/xcX0vLz3tbX3t7f3lpb42Nj5pqb5qKj61dX6lJT1k474rq76wcH80ND1f3/82Nj0f334r677xML70dD2kI/2kZD3kI/2j4/819f7wsL7wsH6uLf6t7f4qaj4qaf3k5P2kpH3lpX3mJf2lJP2lZT1goD1goH1iYj2iYj2j432j472kZD3oqH2mJf2mZj3nZz3np33oJ/3oqH3paT3pqX3p6b4qKf4qaj4qqn4q6r4rKv4rKz4raz4srH4s7L4s7P5tLT5tbT5t7b5t7f5uLf5urn5u7r5u7v5vbz5vb36wcD6wsH6w8L6w8P6xMT6xcT6xcX6xsX6xsb6yMf6ycn6ysr7zMz7zc37zs37z8/70ND70dH71NP71NT719b719f81tX819f82Nf82Nj82dn82tn82tr829v83dz83d383t7839/84OD84eH84uH94eH94uL94+P95ub95+f96Oj96ej96en96ur96+v97Ov+6+v+7Oz+7u7+7+/+8PD+8fD+8fH+8vL+8/P+9fX/9/b/9/f/+Pf/+Pj/+fn/+vlssJuBAAAANHRSTlMAAgMECQsNFhcfICInKCkxMjSboaevsrO5vcLDw8PGyMnK2Nni4+rr/Pz9/f7+/v7+/v7+gk4JywAAARZJREFUKM+1kVFOwzAMQJ3EadNt3YoADSHgn/NwVrgAZ+CXL/gAprFurKSJnZC24QZgybJeXiInDsD/h0g5b+qV0jgyeW4PuyPAgKfrqjKIQkCMRLasVRZ1tVwaLIfDsSe7hxomsZgt56sCR0GuBeqzQGNWCyPHHsECG/wVCosSEWK6C5UuYRYKtRQihAgiVaGVyiLGyCQgBBAKfEiYRfCO+sA8COV8TyELT94KH9NeqQXZhFmw7aTHcL/j2Z3g/vjNQ+OUDaoQ/MN75+zzTVrv2o9JVIYDP27k9Un39XJ+7PrPdhJELJ82+vL2zNvDxuy3Wz9Nd4x6faWAX9/2mVWuzUXD3ruySDMZA7PQpZPDG3Xx93/+A3wsi2ldjJzCAAAAAElFTkSuQmCC\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAACMElEQVRYR+2XPWgVURCFvyPYqlhKbGKjFlYWkQghndioiGJhISRWKRKCv4UYSaFGCTZWRrCwEEU0TbATQTFFKgu10ULE1p9WcMI85oV185DdvdnnFnu7t+ww354zM3eeaPhRw/loAVMdahVsFUxVIDW+rcH/qqCZbQaOAkeA/cCOAPoGrACLwHNJv6uCVrbYzI4Bt4BdwGfgJfA1QAaAUWAQ+AScl/SsCmRpQDPbBNwAzgGvgcuS3vRKbmbDwHXgIHAbuCTpTxnQKoBzATcLzEiyfyU0M88xA1xxSEkXagMMW58Cs5KueiIzczv3SVrKJjazw8A7SR3bzexaQB4vY3dhBaMhPgDeACNd5czMQSclbc8BfgfuSHIwB/Rcr6KR9hRtnDKAJ4DHXk/ZmgtlpiRtzQH+DMCO0gHpNel1e1LSkyJWlwF8CByQ5F27dsoABqR39VtJpzca8KN/vaTxRMCFcGH3RgP+AuYleUdmFRzxQS1pOvd83ge1JK+77PsePy1pS18AiyTpF2BPiysA1mZxzyaJwh8Ctkl6Eb8PAT8kLec/wMxqa5KeYyaAbgJ+Q7g6fryR5iRdzNlb65jxzWXdoA5AH1f3gLEAug+czV6DtQ/qAPEN5q+rLp6fAh4AX6DzV3YncEbSo66CtV91mUTrlgUzmwD2Al1L3fL3ku72dVkItZq9bmWUbObCmuvK5q78ZQd01fcLbzNVE6TGtYCtgqkKpMa3NdgqmKpAavwqlBQbOKzvDTIAAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAARCAYAAAA7bUf6AAAAv0lEQVQ4T2NkYGAQZmBgUGNgYGBnIB38ZGBguMXIwMBgSaYBMCt/ggxxIN0BqDqoa8iHDx+m8/Pza+Bz1aNHj3bLy8u3gdTw8/Mzf/z48S+IDXfJ////9xPy1rdv3x5zc3PHLV++3DYoKCifnZ09hGRDfvz48erFixcXFBQU3MCaGRkdSTYE3aVD3BBomJxXUFBwJztMYLGzdOlSm5CQkAKM2CE1nfDw8DB9+fLlH0rsEEoj+OSpluypkospLk8Atbxd6uCfBjkAAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAABblBMVEUAAAD////////////////////////////////////////////yPDz////rOzv////tQTvuQEDzQEDuPj7////////////////vPj7wQTz////xQTztQDvxQDvxbW3yPz/////yQj7////////zPj7zQT3vQDz////////////////////////////////2pKT////2mJj////3kpD////1kZH4kJD4lZP4n5/4oaH4qKj4q6j4q6v1kZH4tbP6tbX6uLj////////////////////wQT/////////////////////////////uQT7////////////////////////////////////////////////////////////////////wQD/vQD/vQT/wQT/////vQT/////////////////////////////////////////////////////////////////////////////////2+7lQAAAAeXRSTlMAAQMEBQcMEhMbHyUmJicpKywsLS0uLzAxMzQ3ODg4OTk6Ozw+P0BAQkVHSElLTlRWWV1eZWhqampqampqa2tra3J9fpWZmpqcnaGjpKeprbG0uby9vsHDyMzNz9HV19ja29vb29zd3+jq6+3u7/Hy9PX2+Pn6/P3+Y7IaUQAAARRJREFUGBmFwWVbwmAABdA7MVCxxcBOVGxRsbu7G3ETlOGAyYz77x28exh+0XPwH2loP5JKPe/247faG1quSpHDpzNL62w8hMWt06bNhBsgSLfMUGMktUB4DJZhpp25gbrzt4AyG/dCOKDpwgFT/oQyF+c2hBeaPEhrUuYT5CMEg6SOtGal5pWkDuGd5EcegBalOs8gaUAI0uQD2pQqDNAUgbBFU9DZIVeiKEjTHoQumtRJubV4PMK0QVhOyej002KSwrUES4kaXZCXdAqJCmR5puRlnULcC1t3aESncFkGW0+oHO3rd2rsfsOLHL0hF+oLkFE46kDWpgsrX9rRqt+/dpzkiQM2yaCtDzl2Pmn5fnDiTz8ldm+ACCmVNgAAAABJRU5ErkJggg==\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAACHElEQVRIS7WVS29OURSGnzfEfSQm0gjRARMiVKSo0EY1lWBIRCSkf6C/wFziBzQpE0lHbWLQtIhrtCUMxKRJRQ0YGCAuUdWQJSvZnxz723ufz8Canb0u77q8ax3xn0Wl+Gbm+n7gDNAJtAX7N8A0cF3S7VKMLICZ7QCuAXtqinwEXJD0MmWXBDCzPmAUWNNiBz8DxyVNxfZNAGa2E5j5h+CNmJ+ADkmvqiB/AYSePwN2ZzJ/H943ZPQPJB0uAZwAbiSc7wCDkl64LlR5BehJ2HZLutd4jysYAU5HTm7cK+ln9d3MlgO3gCOR/VVJF3MAr4EtkcNeSd62JjGzDuBppJiTtC0H8ANYUXFYkLS2Zle+RYRYlLQ6B/AdWFUJuOTOkn5lKlgGLERJLUlamQOYBbZHwfok3cwAHAMmI928pPYcwBAwEDk46EFJH6Mhrwd8seKE/HycywF0AQ8T2c4Dl4C7QdcdvrcmbPslTSQBAsedekdLgy3onvhRlGQlgM2A0zK3rbn4X4F9krylfyR37JzfXmarIF+Ak5Lux+ilc+2V+NB7a9rlMxuQNJeyK/5wwkwOAGeB/cCmEOQt8BgYSWVd26KGgZntAmYl+YY3iZmtC3+8sfhWZYdcCT4IXAa8v07P58C7oN8Y/nR+Tf2UjAOnUiC5Ifv7YnQC6pjbI6mxJ2UWhd4PA+cBvzclcc47NQ9J+tAyi+rSbVX/G4RZsBnkowTSAAAAAElFTkSuQmCC\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAjVBMVEUAAAD///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8DizOFAAAALnRSTlMAAQIDBAYOEBgiKyxFVV9ienuBkZKVoq6vs7S5ur/MztDR1dbZ4env8PP0+P3+wpkPNAAAALRJREFUGBmFwYcOgjAUBdCrBeree/EUXEXv/3+e5MWkUI2eg/9ai+t10cKHJGcpTxAaU40R2lPtERIqQUioBCGhEoSESlBjGhAqQcPAO26RUqXYHeEVDhuqDVwB78T2gGrQ5gnejJPmkqVlc8IZvM7Ddc1wtRqarnt0UDHlpYdS78IpquI1n4f5/PDkOkaNGd1Yuo0MQkm/KPoJvrnf8Smy1jpnrY1QE5/5do5RFWV8yyL89gJXDRtk/Nu5+QAAAABJRU5ErkJggg==\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAkFBMVEUAAAD///////////////+Z/5n///////////////////////////////////////9R8XT///////////////////////////////////////9I8G3////////////////////////////////////////////////////////////////////////////////9remcAAAAL3RSTlMAAQIDBAUGDhAYIissRVVfbnp7gZGSlaKus7S5ubq/zM7Q0dXW2eHp7/Dz9Pj9/g05MZYAAAC1SURBVBgZhcEHDoJAFATQURDW3rGXr4Jlkbn/7SQ/Jgur0ffwX3txuy3a+BCnLKUxfBOqCXx7qj18QiXwCZXAJ1QCn1AJaoIGhErQCOCctjhSHbE7wckt1lRr2BzOmZ0h1bDDM5w5p80lS8vmlHM43afttUabzajVs88uKma89lHqXzlDVbRicUiSQ8FVhJpgfGfpPg7giwd5PojxzeOBT6ExxlpjTIiaKONbFqEqvPDtEuK3Fz2tHC6gD78OAAAAAElFTkSuQmCC\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAnFBMVEUAAAD///+q/6r///////+Z/5n///////////////////////////////////9S8XZR8XVQ8XX///////////////////////////////9J8G7///9L8XD///9I8G3///////////////////////9J8G5J8G5K8G5K8G////////////////////////////////////8/72b////JX9JrAAAAMnRSTlMAAQMDBAUGDhAYIissRVVqa216e4GRkpWis7m5urq8v8zR1dbZ2tzc3eHp7/Dz9Pj9/gz0LfIAAAC6SURBVBgZhcEHEoIwEAXQryDEXrEX7FEg6O797yaz40wgOvoe/mvOk2TexIfwxIVTCNeYxRiuHYsdXFcSF7g0CQ2XJqHh0iQ0KrwaNAmNmgdrv8KZxBmbPazcYEtiC5PDOnCrT2LQ4gOsKU/qayqs6xOewmo/TKcxXC6HjY55tFES8b2LQvfOEcqCBT/j2Sx+8iJAhTdKuZCOPLjCXp73QnyTZfjkK6WMUUr5qAhu/HYLUOYf+e3o47cXpVkeKeaqKxgAAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAmVBMVEUAAAD///+q/6r///////+Z/5n///////////////////////////////////9S8XZR8XVQ8XX///////////////////////////////9J8G7///9L8XD///9I8G1F8Gr///////////////////9J8G5J8G5K8G////////////////////////////////////8/72b////MZmusAAAAMXRSTlMAAQMDBAUGDhAYIissRVVqa216e4GRkpWis7m5urq8x8zR1dbZ2tzd4env8PP0+P3+wQRYnAAAALpJREFUGBmFwQcSgjAQBdCPIMSu2HtBCJagu/c/nMyOM4Ho6Hv4r7W4XhctfIjOXDpHcI1ZjOHak9jDlZHI4NIkNFyahIZLk9Co8T1oEhqeD+u4RkoixfYIqzDYkdjBFLBO3B6QGLb5BGvGk8aGSpvGhGewOg/TbY5Wq1Gzax4dVEz50kOpd+EpqsIlPw/z+eHJyxA1fnzj0i324Yr6RdGP8M39jk+BUsoYpVSAmjDntzxEVZDwWxLgtxf/sx2iIkNIcAAAAABJRU5ErkJggg==\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAmVBMVEUAAAD///+q/6r///////+Z/5n///////////////////////////////////9S8XZR8XVQ8XX///////9P8nL///////////////////9J8G7///9L8XD///9I8G1F8Gr///////////////////9J8G5J8G5K8G////////////////////////////////////8/72b///+DMAvqAAAAMXRSTlMAAQMDBAUGDhAYIissRVVqa216gYiRkpWis7m5urq8x8zR1dbZ2tzd4env8PP0+P3+9B7C1gAAALpJREFUGBmFwQcSgjAQBdCPIMSu2HtBCJagu/c/nMyOM4Ho6Hv4r7W4XhctfIjOXDpHcE1ITODak9jDlZHI4NIkNFyahIZLk9Co8T1oEhqeD+u4RkoixfYIqzDYkdjBFLBO3B6QGLb5BGvG48aGSpvGmGewOg/TbY5Wq1Gzax4dVEz50kOpd+EpqsIlPw/z+eHJyxA1fnzj0i324Yr6RdGP8M39jk+BUsoYpVSAmjDntzxEVZDwWxLgtxf1pB2csnl/+QAAAABJRU5ErkJggg==\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAn1BMVEUAAAD///+q/6r///////+Z/5n///////////9r8ob///////////////////////9S8XZR8XVQ8XX///////9Q8nT///////////////////9J8G7///9L8XD///9I8G1F72tG72v///////////////9J8G5J8G5K8G9G8Gz///////////////////////////////////8/72b///8BEpvzAAAAM3RSTlMAAQMDBAUGDhATGCIrLEVVamtteoGGkZKVorO5ubq6vMXFzNHV1trc3eHh6e/w8/T4/f51citoAAAAu0lEQVQYGYXBBxKCMBAF0K8gxoqCvVeINeju/c8ms+NMIDr6Hv5rTq/XaRMfGifKnRpwDUkM4dqS2MCVkkjh0iQ0XJqEhkuT0CjxKtAkNCoerP0CCYkEqz2szGBNYg2TwTpwq0ei3+IDrDEPqkvKLasDHsNqP0ynFs3nUa1jHm0UjPjSRa574RGKghk/d5PJ7smzACVefOPcLfbgqodZFtbxzf2OT75SyhillI+S4Mxv5wBF/pHfjj5+ewF0ux7dSdOXwQAAAABJRU5ErkJggg==\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAnFBMVEUAAAD///+q/6r///////+Z/5n///////////9r8oZm7oj///////////////////9S8XZR8XVQ8XX///////9P8HP///////////9K8G////9J8G7///9L8XD///9I8G1G8Gv///////////////9J8G5J8G5K8G9F8Gz///////////////////////9H8Gz///////8/72b////gzZ6EAAAAMnRSTlMAAQMDBAUGDhATHiIrLEVVamtteoGHkZKVrbO5ubq6vMbM0dXW2tzd4eHp8PP0+Pn9/gzRgLkAAAC7SURBVBgZhcEHEoIwEAXQryDE3rtYAI0tqLv3v5vMjjOB4Oh7+K+1fDyWLVQ0z5Q7N+GakpjCtSexh+tE4gSXJqHh0iQ0XJqERolXgyahUfNgxRscSRyxjWFlBjsSO5gMVsLtAYlhmxNYc57UI8pF9QnPYXWeptsYrdejRtc8OyiY8bWHXO/KMxQFK34dFovDi1cBSrzxjXO3sQdX2M+yfohv7ndU+UopY5RSPkqCC39cAhT5KX+kPn57A9BBHkgIY7KNAAAAAElFTkSuQmCC\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAk1BMVEUAAAD///////9/v3+//7////////////////////////////////////////////9S8XX///////////////////////////////////////9H8GxN8HD///////////////////////////////////////////////////////////////////////8/72b///+yOX0uAAAAL3RSTlMAAQMEBAQGDhAYIissRVVfbXp7gZGSlaKztLm6urq/zM7Q0dXW2eHp7/Dz9Pj9/pF1+DQAAAC2SURBVBgZhcEHDoJAFATQEQXW3nvBL1gXde5/OsmPycJq9D3815xfLvMmPsRHFo4xfCOqEXw7qh18QiXwCZXAJ1QCn1AJKoIahEpQC+AcVthT7bE9wMktllRL2BxOylafqt9iCmfKcX3zLGzqY07htO+20xis14NGx97bKJnw3EWhe+YEZdGCj2Q2Sx5cRKgIhlcWrsMAvriX570Y39xu+BQaY6w1xoSoiE58O0UoCzO+ZSF+ewGvmRyM7IpwUQAAAABJRU5ErkJggg==\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAk1BMVEUAAAD///////9//3////+Z/5n///////////////////////////////////9T8XVR8XT///////////////////////////////////9I8G3///////9K8G7///////////////////////////////////////////////////////////////////8/72b///92MoCSAAAAL3RSTlMAAQMEBAUGDhAYIissRVVrbnp7gZGSlaKztLm5uru/zM7Q0dXW2eHp7/Dz9Pj9/jX+F5MAAAC2SURBVBgZhcEHDoJAFATQERHW3nvBL1gXde5/OsmPycJq9D3815xfLvMmPsRHFo4xfCOqEXw7qh18QiXwCZXAJ1QCn1AJKoIahEpQC+Ac1thT7bE5wMktllRL2BxOylb/qfotpnCmHNe3z8K2PuYUTvtuO43BajVodOy9jZIJz10UumdOUBYt+Ehms+TBRYSKYHhl4ToM4It7ed6L8c3thk+hMcZaY0yIiujEt1OEsjDjWxbitxep+hyEGOh1fQAAAABJRU5ErkJggg==\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAllBMVEUAAAD///////9//3////+Z/5n///////////////////////////////////9S83ZU83ZQ8XX///////////////////////////////9J8G7///////9L8HBI8Gz///////////////////////////////////////////////////////////////////8/72b///+bZcbkAAAAMHRSTlMAAQMEBAUGDhAYIissRVVqam16e4GRkpWis7m5uru9v8zO0NHV1tnh6e/w8/T4/f5AQbNuAAAAt0lEQVQYGYXBBw6CQBQE0BER1t57Qb9dF2XufznJj8nCavQ9/FefXa+zOj7EJ+ZOMXxDqiF8CVUCn1AJfEIl8AmVwCdUgpKgAqESVAI4+yV2VDus9nBSi02mNrApnAMb3Uz1GjzAmXBUXWe5dXXECZzmw7Zq/cWiX2vZRxMFY17ayLUvHKMomvO5nU63T84jlASDG3O3QQBf3EnTToxv7nd8Co0x1hpjQpREZ76dIxSFR74dQ/z2AnF8HSubvLfMAAAAAElFTkSuQmCC\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAllBMVEUAAAD///+q/6r///////+Z/5n///////////////////////////////////9S8XZR8XVQ8XX///////////////////////////////9J8G7///9L8XD///9I8G3///////////////////////////9J8G7///////////////////////////////////8/72b///+h1cuQAAAAMHRSTlMAAQMDBAUGDhAYIissRVVqa216e4GRkpWis7m5urq8v8zQ0dXW2drh6e/w8/T4/f6u3cT0AAAAt0lEQVQYGYXBBw6CQBQE0FEQ1t57wW8vizL3v5zkx2RhNfoe/qvPrtdZHR/iI3PHGL4h1RC+hCqBT6gEPqES+IRK4BMqQUlQgVAJKgGc3RKnTJ2w3sFJLTaZ2sCmcPZsdDPVa3APZ8JRdZXlVtURJ3CaD9uq9ReLfq1lH00UjHlpI9e+cIyiaM7ndjrdPjmPUBIMbszdBgF8cSdNOzG+ud/xKTTGWGuMCVESnfl2jlAUHvh2CPHbC16RHR5S91G1AAAAAElFTkSuQmCC\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAmVBMVEUAAAD///+q/6r///////+Z/5n///////////////////////////////////9S8XZR8XVQ8XX///////////////////////////////9J8G7///9L8XD///9I8G3///////////////////////////9J8G5K8G////////////////////////////////////8/72b////7EXAcAAAAMXRSTlMAAQMDBAUGDhAYIissRVVqa216e4GRkpWis7m5urq8v8zQ0dXW2drd4env8PP0+P3+/xN+dwAAALhJREFUGBmFwYcOgjAUBdCrIBT33qtuxaK9//9xkheTQjV6Dv5LprfbNMGH+MjcMYZvQDGAb0OxgU9TaPg0hYZPU2j4NIVGSVDB2YozKgGc3QInK05Y7eBkBmsr1jAZnD3rHSu6de7hjDmsLm1uWR1yDKfxMM1abz7v1Zrm0UDBiNcWcq0rRyiKZnxuJ5Ptk7MIJUE/ZS7tB/DF7Sxrx/jmfsenUClljFIqREl04dslQlF44NshxG8v8ugdnOPneLsAAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAmVBMVEUAAAD///+q/6r///////+Z/5n///////////////////////////////////9S8XZR8XVQ8XX///////////////////////////////9J8G7///9L8XD///9I8G3///////////////////////////9J8G5K8G////////////////////////////////////8/72b////7EXAcAAAAMXRSTlMAAQMDBAUGDhAYIissRVVqa216e4GRkpWis7m5urq8v8zQ0dXW2drd4env8PP0+P3+/xN+dwAAALlJREFUGBmFwYcOgjAUBdCrINS998C6cBXt/f+Pk7yYFKrRc/BffXa9zur4EB+ZO8bwDSmG8CUUCXyaQsOnKTR8mkLDl1qRoiSoILUiRSWAs1viZMUJ6x2czGBjxQYmg7Nno2tFr8E9nAlH1ZXNraojTuA0H6ZV6y8W/VrLPJooGPPSRq594RhF0ZzP7XS6fXIeoSQY3Ji7DQL44k6WdWJ8c7/jU6iUMkYpFaIkOvPtHKEoPPDtEOK3F/v9HaLAHfklAAAAAElFTkSuQmCC\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAmVBMVEUAAAD///+q/6r///////+Z/5n///////////////////////////////////9S8XZR8XVQ8XX///////////////////////////////9J8G7///9L8XD///9I8G3///////////////////////////9J8G5K8G////////////////////////////////////8/72b////7EXAcAAAAMXRSTlMAAQMDBAUGDhAYIissRVVqa216e4GRkpWis7m5urq8v8zQ0dXW2drd4env8PP0+P3+/xN+dwAAALtJREFUGBmFwYcOgjAUBdCrrLoHuHAgrgpaoO//P07yYlKoRs/Bf711nq97+BBcqXYNYAuJhbAlxBLYUmIpbCmxFDapmYRNaibR4nQgNZPoODBOW9w0u2F/glEoHDQ7QBUwztSfaDbt0xnGkqLuTtd23YiWMAalGnqzOJ55Q1UO0LCgbITaKKMFmvwNVcfV6ljRxkeLM39Q7TF3YAvGRTEO8M3ziU+uEEIpIYSLFv9Ob3cfTe6F3i4ufnsBBbcdqHLgiBwAAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAmVBMVEUAAAD///+q/6r///////+Z/5n///////////////////////////////////9S8XZR8XVQ8XX///////////////////////////////9J8G7///9L8XD///9I8G3///////////////////////////9J8G5K8G////////////////////////////////////8/72b////7EXAcAAAAMXRSTlMAAQMDBAUGDhAYIissRVVqa216e4GRkpWis7m5urq8v8zQ0dXW2drd4env8PP0+P3+/xN+dwAAALxJREFUGBmFwQsTgUAUBtAvpZaIEPLIo1iPNvb+/x+nuWNmaxnOwX+95e227OFDcKLaKYBtSmwK247YDrYDsQNsUjMJm9RMwiY1k2hxHUjNJBwXxnGNs2ZnbI8wKoVMswyqgpFTf6TZuE85jDnNOhtd23RmNIcRPtSgG69WcXegHiEaEroOURteKUGTn9Jzv1jsn5T6aHEnd6rdJy5sQVRVUYBvyhKfPCGEUkIIDy3+hd4uPpq8gt4KD7+9AA/4Ha7O8FpQAAAAAElFTkSuQmCC\"","module.exports = \"data:image/png;base64,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\"","//console.  emedia.useCurrentXService.current\n\n\nvar emedia = window.emedia = window.emedia || {};\n\nvar util = emedia.util = require('./components/Util');\n\n/**\n * webpack.config.js\n *     module: {\n        noParse: [/adapter.js$/],\n        rules: [\n            {\n                test: require.resolve('zepto'),\n                loader: 'exports-loader?window.Zepto!script-loader'\n            }\n        ]\n    },\n *\n * var zepto = require(\"zepto\");\n * // var zepto = require('exports-loader?window.Zepto!script-loader!zepto');\n *\n * 或者\n * npm install zepto-webpack\n *\n *\n */\nvar zepto = require(\"zepto-webpack\");\n\n\nemedia.config = function (cfg) {\n    cfg = util.extend({}, cfg);\n\n    for(var key in cfg){\n        emedia.config[key] = cfg[key];\n        if(key === \"logLevel\"){\n            emedia.LOG_LEVEL = cfg[key];\n        }\n    }\n\n    if(emedia.config.loglastConfrCount && !emedia._logContext){\n        emedia._logContext = new Array(emedia.config.loglastConfrCount);\n        emedia._logContextIndex = -1; //代表没有日志\n    }\n};\nemedia.config({\n    autoSub: true,\n\n    onlyEnter: false,\n\n    reconnect: 13, //重连次数\n    reconnectDelay: 3000, //重连间隔 毫秒\n\n    getCopyIntervalMillis: 30000,\n    checkConnectIntervalMillis: 1000,\n\n    iceRebuildCount: 3,\n    iceRebuildIntervalMillis: 500,\n    //iceWaitBuildMillis: 30000,\n\n    enterTimeout: 20000,\n\n    useRTCCfgIfServerReturn: false,\n    forceUseRTCCfgIfServerReturnWhenP2P: true,\n\n    allowRepeatAudioMixerPublish: false,\n\n    logVolumeWhenInstantGE: 0.5,\n    getMediaMeterIntervalMillis: 400,\n    _useRequestAnimationFrame: false,\n\n    meterWithTrackAudioLevel: false,\n    judgeTalkingByInstantGE: 0.05,\n\n    _printSoundData: false,\n\n    trackBufferSize: 20,\n    allowSendWhenLessThan: 4,\n    disableTrack: false,\n\n    ctrlCheckIntervalMillis: 10 * 1000,\n    ctrlTimeoutMillis: 30 * 1000,\n\n    _printDebugStats: false,\n    statsSeconds: 10,\n    remainLastStatsCount: 120,\n    //wsorigin\n\n    loglastConfrCount: 2,\n    loglastStoreArray: true,\n    consoleLogger: true,\n\n    printStatsWhenPCClose: true,\n\n    rebuildPeerConnectionWhenNetworkChanaged: true,\n    useDeployMore:false,\n    useDTX:true, // 开启 DTX\n    uploadStats:true, // 开启 数据上报\n    liveCfgs:[], // 多路推流数组\n    rtcStatsTypeMath: function (_stat, name) {\n        switch(_stat.type){\n            case \"remote-candidate\":\n            case \"local-candidate\":\n            case \"track\":\n            case \"stream\":\n            case \"inbound-rtp\":\n            case \"outbound-rtp\":\n            case \"transport\":\n                return true;\n        }\n        return false;\n    }\n\n    // forceUseVideoCodecs: [],\n    // forceUseAudioCodecs: [],\n    // forceVideoBitrate: ,\n    // forceAudioBitrate: ,\n});\n\nutil.logger.count();\n//util.logger.info(navigator.userAgent);\n\n(function requireWebrtcAdapter() {\n    var adapter = require('./_adapter/_Adapter.import').default;\n    emedia.browser = adapter.__browser; // firefox chrome safari IE\n    emedia.browserVersion = adapter.__browserVersion;\n\n    if(emedia.browser === undefined){\n        throw \"Not discern browser. may require adapter error. eg. it.default\"\n    }\n})();\nutil.logger.info(\"Current browser\", emedia.browser, emedia.browserVersion);\n\n\nemedia.AudioContext = window.AudioContext || window.webkitAudioContext;\n\nif(emedia.config.getMediaMeterIntervalMillis){\n    // https://stackoverflow.com/questions/46363048/onaudioprocess-not-called-on-ios11/46534088#46534088\n    // There are two problems.\n    // The main one is that Safari on iOS 11 seems to automatically suspend new AudioContext's that aren't created in response to a tap.\n    // You can resume() them, but only in response to a tap.\n    //\n    // So, you have to either create it before you get the MediaStream, or else get the user to tap again later.\n    try {\n        if (typeof emedia.AudioContext === 'function') {\n            emedia.__audioContext = new emedia.AudioContext();\n            emedia.__usingWebAudio = true;\n        }else{\n            emedia.__usingWebAudio = false;\n        }\n    } catch(e) {\n        emedia.__usingWebAudio = false;\n    }\n\n    // context state at this time is `undefined` in iOS8 Safari\n    if (emedia.__usingWebAudio && emedia.__audioContext.state === 'suspended') {\n        zepto(function(){\n            var resume = function () {\n                (emedia.__audioContext.state === 'suspended') && emedia.__audioContext.resume();\n                util.logger.warn(\"AudioContext state suspended ->\", emedia.__audioContext.state);\n\n                setTimeout(function () {\n                    if (emedia.__audioContext.state === 'running') {\n                        document.body.removeEventListener('touchend', resume, false);\n                        document.body.removeEventListener('click', resume, false);\n                    }\n                }, 0);\n            };\n\n            document.body.addEventListener('touchend', resume, false);\n            //document.body.addEventListener('load', resume, false);\n            document.body.addEventListener('click', resume, false);\n        });\n    }\n\n    if(!emedia.__usingWebAudio){\n        console.warn(\"'new AudioContext()' failed. can not know who talking.\");\n    }\n    if(emedia.__audioContext && emedia.__audioContext.state === 'suspended'){\n        console.warn(\"audioContext.state is suspended. can not know who talking. You can resume() emedia.__audioContext, but only in response to a tap.\");\n    }\n}\n\n\nif (!window.requestAnimationFrame || !emedia.config._useRequestAnimationFrame) {\n    emedia.requestAnimationFrame = function(fn, timeoutMillis) {\n        return setTimeout(fn, timeoutMillis || emedia.config.getMediaMeterIntervalMillis);\n    };\n}else{\n    emedia.requestAnimationFrame = function(callback){\n        window.requestAnimationFrame(callback);\n    }\n}\n\nif (!window.cancelAnimationFrame || !emedia.config._useRequestAnimationFrame) {\n    emedia.cancelAnimationFrame = function(id) {\n        clearTimeout(id);\n    };\n}else{\n    emedia.cancelAnimationFrame = function(id){\n        window.cancelAnimationFrame(id);\n    }\n}\n\n\nemedia.isWifi = function isWifi() {\n    try {\n        var wifi = true;\n        var ua = window.navigator.userAgent;\n        var con = window.navigator.connection || window.navigator.mozConnection || window.navigator.webkitConnection;\n        // 如果是微信\n        if (/MicroMessenger/.test(ua)) {\n            if (ua.indexOf('WIFI') >= 0) {\n                return true;\n            }else{\n                wifi = false\n            }\n\n        } else if (con) { //navigator.connection //type: unknown, ethernet, wifi, 2g, 3g, 4g, none.\n            var network = con.type;\n            if (network !== 'wifi' && network !== '2' && network !== 'unknown') {\n                wifi = false\n            }\n        }\n        return wifi;\n    } catch (e) {\n        return false\n    }\n};\n\n\nemedia.stopAudioTracks = function (_stream) {\n    _stream && _stream.getAudioTracks().forEach(function (track) {\n        track.stop();\n        util.logger.info(\"Media stream stop audio track. stream =\", _stream.id, \"track =\", track.id, track.kind);\n    });\n};\nemedia.stopAndRemoveAudioTracks = function (_stream) {\n    var tracks = [];\n    _stream && _stream.getAudioTracks().forEach(function (track) {\n        track.stop();\n        tracks.push(track);\n        util.logger.info(\"Media stream stop and remove audio tracks. stream =\", _stream.id, \"track =\", track.id, track.kind);\n    });\n\n    util.forEach(tracks, function (_index, track) {\n        _stream.removeTrack(track);\n    });\n};\n\nemedia.stopTracks = function (_stream) {\n    try{\n        if(!_stream || _stream.active === false){\n            util.logger.debug(\"stream tracks had been stoped. it \", _stream && _stream.id);\n            return;\n        }\n\n        function stop() {\n            _stream.getTracks().forEach(function (track) {\n                track.stop();\n                util.logger.info(\"Media stream stop track. stream =\", _stream.id, \" track =\", track.id, track.kind);\n            });\n\n            if(_stream._bindAttendee){\n                //push stream时，由于异步，在未返回成功后，退出会议，摄像头不会被关闭问题\n                util.removeAttribute(_stream._bindAttendee._openedRtcMediaStreams, _stream.id);\n                _stream._bindAttendee = null;\n            }\n            util.logger.info(\"stream tracks stoped. it \", _stream.id);\n        }\n        stop();\n        //setTimeout(stop, 300);\n    }catch (e) {\n        util.logger.error(e);\n    }\n};\n\nemedia.enableVideoTracks = function (_stream, enabled) {\n    _stream && _stream.getVideoTracks().forEach(function (track) {\n        if(typeof track.enable === \"function\"){\n            track.enable();\n            util.logger.info(\"Media stream enable video track. stream =\",\n                _stream.id, \"track =\", track.kind, track.enabled, track.id);\n            track.enabled === enabled || track.enable(enabled);\n            return;\n        }\n\n        track.enabled === enabled || (track.enabled = enabled);\n        util.logger.info(\"Media stream enable video track. stream =\",\n            _stream.id, \"track =\", track.kind, track.enabled, track.id);\n    });\n};\n\nemedia.enableAudioTracks = function (_stream, enabled) {\n    _stream && _stream.getAudioTracks().forEach(function (track) {\n        if(typeof track.enable === \"function\"){\n            track.enable();\n            util.logger.info(\"Media stream enable audio track. stream =\",\n                _stream.id, \"track =\", track.kind, track.enabled, track.id);\n            track.enabled === enabled || track.enable(enabled);\n            return;\n        }\n\n        track.enabled === enabled || (track.enabled = enabled);\n        util.logger.info(\"Media stream enable audio track. stream =\",\n            _stream.id, \"track =\", track.kind, track.enabled, track.id);\n    });\n};\n\nemedia.hasEnabledTracks = function (mediaStream) {\n    if(!mediaStream || (typeof mediaStream.getAudioTracks !== 'function')){\n        return false;\n    }\n\n    if(!mediaStream.active){\n        return false;\n    }\n\n    var tracks = mediaStream.getAudioTracks();\n\n    if(tracks.length === 0){\n        return false;\n    }\n\n    for(var i in tracks){\n        if(typeof tracks[i].enable === \"function\"){\n            tracks[i].enable();\n        }\n        if(tracks[i].enabled){\n            return true;\n        }\n    }\n\n    return false;\n};\n\n\nemedia.genReportName = function(){\n\n    var date = (emedia._lastSetupDate || (new Date()));\n    //date = date.toLocaleString().replace(/[\\/\\s]/g, '-');\n    return (emedia._lastSetupTktId || emedia._lastSetupConfr)\n        + \"_\" + emedia._lastSetupMemName\n        + \"_\" + date.getTime()\n        + \".log\";\n};\n\nemedia.getReportUploadUrl = function(method, url, cb){\n    var xhr = new XMLHttpRequest();\n    xhr.open(method, url, true);\n    xhr.addEventListener('load', function (response) {\n        cb && cb(response);\n    },false);\n\n    xhr.send(null);\n};\n\nemedia.uploadReport = function(fileName, url, commitData, success, error, addHeader){\n    var fileContent = emedia.genReport();\n    if(!fileContent){\n        error && error(\"not logs\");\n        return;\n    }\n\n    if(typeof commitData === \"function\"){\n        addHeader = error;\n        error = success;\n        success = commitData;\n        commitData = undefined;\n    }\n\n    function onUploadFile(response) {\n        console.info(\"log begin upload. result = \", response.currentTarget.status, fileName, \" > \", url);\n\n        if (response.currentTarget.status === 200) {\n            //response.currentTarget.getResponseHeader('response-text');\n            success && success(response);\n        } else {\n            //this.reportError = response.currentTarget.status;\n            error && error(response);\n        }\n    }\n\n    // Create report file.\n    var blob = new Blob([fileContent], {type: 'text/plain'});\n    var formData = new FormData();\n    formData.append(fileName, blob, fileName);\n    if(commitData && typeof formData.set === \"function\"){\n        util.forEach(commitData, function (key, value) {\n            formData.set(key, value);\n        });\n    }\n\n    // Upload the report file using the URL in the response-text header.\n    var xhr = new XMLHttpRequest();\n    xhr.open('POST', url, true);\n    \n    xhr.setRequestHeader('X-File-Name', fileName);\n    addHeader && addHeader(xhr);\n    xhr.addEventListener('load', onUploadFile, false);\n    xhr.send(formData);\n\n    console.info(\"log begin upload. \", fileName, \" > \", url)\n};\n\nemedia.genReport = function(){\n    if(!emedia._logContext){\n        return;\n    }\n    if(!(emedia._logContext instanceof Array)){\n        return;\n    }\n    if(typeof emedia._logContextIndex === 'undefined' || emedia._logContextIndex < 0){\n        return;\n    }\n\n    var start = 0;\n    var end = emedia._logContextIndex;\n    if(emedia._logContextIndex >= emedia._logContext.length){\n        start = emedia._logContextIndex - emedia._logContext.length + 1;\n    }\n\n    var report = \"\";\n    for(var i = start; i <= end; i++){\n        var index = i % emedia._logContext.length;\n        var oneConfrLogs = emedia._logContext[index];\n        report += oneConfrLogs.join(\"\\r\\n\") + \"\\r\\n\";\n    }\n\n    if(emedia._logContext.loadlogs && emedia._logContext.loadlogs instanceof Array){\n        report += \"-------------------------------------------------------------\\r\\n\";\n        report += emedia._logContext.loadlogs.join(\"\\r\\n\") + \"\\r\\n\";\n    }\n\n    return report;\n};\n\nemedia.fileReport = function (filename, exception) {\n    var fileContent = emedia.genReport();\n    if(!fileContent){\n        return;\n    }\n\n    if(exception){ //遇到的异常加到日志\n        fileContent = `遇到的异常描述如下：\\r\\n ${exception} \\r\\n ${fileContent}`\n    }\n\n\n    var content = encodeURIComponent(fileContent);\n\n    var link = document.createElement('a');\n    link.style.display = 'none';\n    link.download = filename || 'emedia-' + (new Date().toJSON()) + '.log';\n    link.href = 'data:text/plain;charset=utf-8,' + content;\n    //link.setAttribute('download', link.download);\n    //link.setAttribute('href', 'data:text/plain;charset=utf-8,' + content); //'data:attachment/file;charset=utf-8,' + content\n\n    document.body.appendChild(link);\n    link.click();\n    link.parentNode.removeChild(link);\n};\n\nif(navigator.mediaDevices){\n    var supportedConstraints = navigator.mediaDevices.getSupportedConstraints();\n    util.logger.info(\"Supported constraints\", supportedConstraints);\n}\n\n\nemedia.config({\n    globalConstraints:{\n        // audio:{\n        //\n        // }\n    }\n});\n\n\nvar Service = require('./components/Service');\nvar __event = require('./components/event');\n\nemedia.Webrtc = require('./components/_Webrtc');\n\nemedia.Service = Service;\nemedia.P2P = require('./components/AddonsP2P');\n// var cloneService = util.extend({}, Service).extend(Service);\nemedia.XService = Service;\nemedia.XServiceWithP2P = emedia.P2P(Service);\n\n// emedia.mgr = require(\"./components/mgr/Manager\");\n// emedia.mgr = emedia.mgr.single;\nemedia.mgr = require(\"./components/mgr/outer\").outer;\n\nemedia.ctrl = require('./components/pannelVideo');\nemedia.CompositeCanvas = require('./components/CompositeCanvas');\n\nemedia.pannel || (emedia.pannel = {});\nemedia.pannel.DefaultMouseTrack = require('../../pannel/src/components/DefaultTrack');\nemedia.pannel.MouseTrack = require('../../pannel/src/components/MouseTrack');\nemedia.pannel.KeyboardTrack = require('../../pannel/src/components/KeyboardTrack');\n\nvar PCStats = emedia.PCStats = require('./components/PCStats');\n\nemedia.helper = emedia.helper || {};\n\nemedia.helper.PCStats = PCStats;\n\nemedia.helper.pcstats = PCStats.echo;\nemedia.helper.intervalPcstats= PCStats.intervalEcho;\n\nemedia.helper.inboundAudio = PCStats.inboundAudio;\nemedia.helper.inboundVideo = PCStats.inboundVideo;\n\nemedia.helper.outboundAudio = PCStats.outboundAudio;\nemedia.helper.outboundVideo = PCStats.outboundVideo;\n\n\nemedia.event = __event;\n\n\nemedia.LOG_LEVEL = 0;\n\nemedia.isFirefox = 'firefox' === emedia.browser;\nemedia.isChrome = 'chrome' === emedia.browser;\nemedia.isSafari = 'safari' === emedia.browser;\nemedia.isEdge = 'edge' === emedia.browser;\n\nemedia.isElectron = /Electron/.test(navigator.userAgent);\nif(emedia.isElectron){\n    try{\n        require(\"./components/electron\");\n    }catch(e){\n        util.logger.error(e)\n    }\n}\n\nemedia.youInSomeBrowsers = function(){\n    //return emedia.isSafari;\n        //|| (emedia.isChrome && emedia.browserVersion >= 75);\n\n    if(emedia.isSafari){\n        // return true;\n        // safari 从13起，不在需要先打开摄像头获取权限，后再去订阅了, webrtc 可以生成canidata了\n        // 但是只有audio时 订阅成功但是无法播放声音，还是需要先去getUserMedia下\n        var reg = new RegExp(\"(Version)/([0-9\\.]+)\", \"i\");\n        var r = navigator.userAgent.match(reg);\n        if (r != null) {\n            var version = unescape(r[2]);\n            version = parseInt(version);\n\n            return version < 13;\n        }\n    }\n\n    return false;\n};\n\n//candidate:3 1 UDP 2013266431 116.62.36.187 31574 typ host\n//candidate:4006386702 1 udp 41819903 39.107.152.84 33631 typ relay raddr 0.0.0.0 rport 0 generation 0 ufrag zOjH network-id 1 network-cost 10\nemedia.replaceIpAndPortOfCandidate = function(candidate, ip, port){\n    var str = typeof candidate === \"string\" ? candidate : candidate.candidate;\n    str = str.replace(/(candidate:\\d+\\s+\\d+\\s+udp\\s+\\d+\\s+)([\\d\\.]+)\\s+(\\d+)(\\s+.*)/g, function (all, $pre, $ip, $port, $after) {\n        // console.log(all);\n        // console.log(pre, ip, port, after);\n        return $pre + ip + \" \" + port + $after;\n    });\n\n    if(candidate.candidate){\n        candidate = util.extend(true, {}, candidate);\n        candidate.candidate = str;\n    }else{\n        candidate = str;\n    }\n    return candidate;\n};\nemedia.replaceIpAndPort = function(candidate, cb){\n    if(typeof cb !== 'function'){\n        return candidate;\n    }\n\n    var str = typeof candidate === \"string\" ? candidate : candidate.candidate;\n    str = str.replace(/(candidate:\\d+\\s+\\d+\\s+udp\\s+\\d+\\s+)([\\d\\.]+)\\s+(\\d+)(\\s+.*)/g, function (all, $pre, $ip, $port, $after) {\n        var newIpPort = cb($ip, $port);\n        if(typeof newIpPort === 'string'){\n            newIpPort = newIpPort.replace(':', ' ');\n            return  $pre + newIpPort + $after;\n        }\n        return $pre + $ip + \" \" + $port + $after;\n    });\n\n    if(candidate.candidate){\n        candidate = util.extend(true, {}, candidate);\n        candidate.candidate = str;\n    }else{\n        candidate = str;\n    }\n    return candidate;\n};\n\nemedia.replaceURL = function(wsUrl, cb){\n    if(typeof cb !== 'function'){\n        return wsUrl;\n    }\n\n    return wsUrl.replace(/([^:\\/?&#=]+):\\/\\/([^\\/:?#]+)(:\\d+)?(\\/[^?#]*)?(\\?[^\\/#]*)?(#[^\\/?]*)?/g, function (all, $protocol, $host, $port, $path, $query, $fragment) {\n        if($port){\n            $port = $port.substring(1);\n        }\n\n        var url = cb(all, $protocol, $host, $port, $path, $query, $fragment);\n        if(!url){\n            return wsUrl;\n        }\n        if(typeof url === 'string'){\n            return  url;\n        }\n\n        var protocol = url.protocol || $protocol;\n        var host = url.host || $host;\n        var port = url.port || $port;\n        var path = url.path || $path;\n        var query = url.query || $query;\n        var fragment = url.fragment || $fragment;\n\n        return protocol\n            + \"://\" + host\n            + (port ? (\":\" + port) : \"\")\n            + (path ? path : \"\")\n            + (query ? query : \"\")\n            + (fragment ? fragment : \"\");\n    });\n};\n\nemedia.requireTrustBeforeJoin = function(){\n    //return (/windows|win32/i.test(navigator.userAgent) && emedia.isChrome && emedia.browserVersion >= 75);\n    return false;\n};\n\nemedia.isWebRTC = window.RTCPeerConnection && /^https\\:$/.test(window.location.protocol);\n\n/**\n * 判断是否支持pranswer\n */\nif (emedia.isChrome || emedia.isSafari) {\n    emedia.supportPRAnswer = true;\n}\n/**\n * 2019.02.21\n * 发现chrome72版本 对pranswer支持有问题，https://webrtc.github.io/samples/src/content/peerconnection/pr-answer 事例也不能正显示视频\n * video.srcObject [remote media stream] active: false.\n *\n * 统一设置为不支持pranswer\n *\n */\nemedia.supportPRAnswer = false;\n\n\nemedia.config({\n   baseAcptOps: [\n       102, 104, 105, 106, 107, 300, 302, 303, 304, 301, \n       204, 206, 400, 401, 1001, 100221, 100222, 100223,\n       100224,100201,100202, 100203\n    ]\n    // baseAcptOps: [107, 300, 302, 303, 304, 301, 204, 206, 400, 401, 1001]\n});\nemedia.config({\n    clientType: 'WEB',\n    version: '3.2.2',\n\n    userAgent: navigator.userAgent,\n\n    acptOps:[\n        100230, //远程控制\n        100205, //远程抓图\n        1003, //透传消息\n        1004,  //P2P消息支持\n        // 100201, //缩放\n        // 100202, //聚焦\n        // 100203, //曝光\n        // 100204, //定格\n        // 100205 //远程抓图\n    ]\n});\n\n// emedia.config({\n//     reconfigRTCConfiguration: function(iceServerConfig){\n//         window.coturnIp || (window.coturnIp = \"39.105.132.217\");\n//         iceServerConfig.iceTransportPolicy = 'relay';\n//         iceServerConfig.iceServers && emedia.util.forEach(iceServerConfig.iceServers, function(_i, iceServer){\n//             iceServer.url = \"turn:\" + window.coturnIp + \":3478\";\n//         });\n//         return iceServerConfig;\n//     },\n//     reChanageCandidate: function (candidate) {\n//         // return emedia.replaceIpAndPortOfCandidate(candidate, \"121.41.55.114\", 41111);\n//         //或者\n//         return emedia.replaceIpAndPort(candidate, function(ip, port){ //ip, port是从 candidate中解析出来的\n//             // if(ip === '39.107.157.65'){\n//             //     ip = '10.66.204.222';\n//             // }\n//             // if(ip === '39.107.152.84'){\n//             //     ip = '10.66.178.216';\n//             // }\n//             if(ip === '39.105.132.217'){\n//                 ip = '172.16.0.69';\n//             }\n//             if(ip === '39.97.115.231'){\n//                 ip = '172.16.0.105';\n//             }\n//             // if(port == 1234){\n//             //     port = 新端口replaceIpAndPortOfCandidate\n//             // }\n//             return ip + \":\" + port;\n//         });\n//     }\n// });\n\n\n// /**\n//  *  Enter 客户端携带，进入\n//  *  服务端可支持，Json字符串，或Json数据\n//  */\n// var res = {\n//     type: 'ios|android|web',\n//     ver: '1.0.2',\n//     agent: '', //ios android可以不传，web navigator.userAgent\n//     //可缺省，缺省默认支持\n//     //107 300 302 303 304 301 204 206 400 401 1001\n//     ops:[\n//         1003, //透传消息\n//         100201, //缩放\n//         100202, //聚焦\n//         100203, //曝光\n//         100204, //定格\n//         100205 //远程抓图\n//     ],\n//\n//     vcodes:['H264', 'VP8'] //客户端进入，可以携带，也可以不携带。携带了，就使用这个广播给其他人。\n//                            // A进入，没有携带此参数，服务端通过 type ver agent 补全此字段，广播给B C\n// }\n\n\nmodule.exports =  emedia;","\nimport axios from 'axios'\nimport {message} from 'antd'\n\nexport default function ajax(url, data={}, type='GET') {\n\n    return new Promise((resolve, reject) => {\n      let promise\n      // 1. 执行异步ajax请求\n      if(type==='GET') { // 发GET请求\n        promise = axios.get(url, { // 配置对象\n          params: data // 指定请求参数\n        })\n      } else { // 发POST请求\n        promise = axios.post(url, data)\n      }\n      // 2. 如果成功了, 调用resolve(value)\n      promise.then(response => {\n        resolve(response.data)\n      // 3. 如果失败了, 不调用reject(reason), 而是提示异常信息\n      }).catch(error => {\n        // reject(error)\n        message.error('请求出错了: ' + error.message);\n        reject(error)\n      })\n    })\n  \n  \n  }","\nexport const appkey = 'easemob-demo#chatdemoui'\nexport const version = '2.0.0' \n","import ajax from './ajax';\nimport { appkey } from '../config';\n\n\nconst BASE = process.env.REACT_APP_IM_HOST;\n\nlet org_name = appkey.split('#')[0];\nlet app_name = appkey.split('#')[1];\n\nlet register_url = `${BASE}/${org_name}/${app_name}/users`;\nlet login_url = `${BASE}/${org_name}/${app_name}/token`;\n\nexport const req_register = params => ajax(\n    register_url, \n    params, \n    'POST'\n);\nexport const req_login = params => ajax(\n    login_url, \n    params, \n    'POST'\n);\n","\nimport { req_register, req_login } from '../../api';\n\nfunction Login() {\n    this.user = {};\n    this.get_uuid = () => {\n        return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n            var r = Math.random() * 16 | 0,\n                v = c == 'x' ? r : (r & 0x3 | 0x8);\n            return v.toString(16);\n        });\n    }\n\n    this.register = async () => {\n\n        let params = {\n            username : this.get_uuid().split('-').join(''),\n            password: '123456'\n        }\n    \n        const result = await req_register(params);\n\n        if(\n            result.entities &&\n            result.entities[0] &&\n            result.entities[0].activated\n        ){\n            let user = {\n                username: params.username,\n                password:params.password\n            }\n            this.user = user;\n            window.sessionStorage.setItem('easemob-user', JSON.stringify( this.user ))\n        }\n    }\n    this.login = async () => {\n        let params = {\n            grant_type: \"password\",\n            username: this.user.username,\n            password: this.user.password,\n            timestamp: new Date().getTime()\n        }\n        const user_info = await req_login(params);\n\n        if(!user_info.access_token){\n            return \n        };\n\n        let user = {\n            username: user_info.user && user_info.user.username,\n            token: user_info.access_token,\n            uuid: user_info.user && user_info.user.uuid\n        }\n\n        return user;\n    }\n    this.init = async () => {\n        this.user = JSON.parse(window.sessionStorage.getItem('easemob-user'));\n\n        if(\n            !this.user ||\n            !this.user.username || \n            !this.user.password\n        ) {\n            await this.register();\n            const user = await this.login()\n            return user;\n        } else {\n            const user = await this.login()\n            return user;\n        }\n\n\n    }\n\n    \n}\n\nexport default new Login().init;","import React, {Component, PureComponent} from 'react' \nimport ReactDOM from 'react-dom'\n// import debounce from 'lodash.debounce'; // 防抖函数\n\nimport { \n    Layout,\n    Button,\n    Icon,\n    Modal,\n    Form,\n    Input,\n    Checkbox,\n    message,\n    Tooltip,\n    Drawer,\n    Avatar,\n    Dropdown,\n    Menu,\n    Switch,\n    Radio,\n    Tabs,\n    Alert,\n    notification,\n    Spin\n} from 'antd';\nimport './room.less';\n\n\nimport emedia from 'easemob-emedia';\nimport whiteBoards from './whiteboardsSdk';\nimport login from './login.js'\nimport { appkey, version } from '../../config';\n\n\n// assets\nfunction notification_show(type, message) {\n    notification[type]({\n        message,\n        placement: 'bottomRight',\n        className: 'openNotification',\n        // duration: 50000\n    });\n}\nconst requireContext = require.context('../../assets/images', true, /^\\.\\/.*\\.png$/)// 通过webpack 获取 img\nconst get_img_url_by_name = (name) => {\n    if(!name){\n        return\n    }\n    let id = requireContext.resolve(`./${name}.png`);\n\n    return __webpack_require__(id);\n}\n\n// 获取优化后的 nickName \nconst get_nickname = member => {\n            \n    const get_spliced_name = name => {\n        let before_username = name.slice(0,4); //优化成较短的显示\n        let after_username = name.slice(-4);\n    \n        return before_username + '****' + after_username\n    }\n\n    let nick_name = undefined;\n\n    if(\n        !member.nickName ||\n        member.nickName.split('_')[1]\n    ) { // 没有 nickName 或者 nickName 是username 裁剪 username\n        let name = member.name.split('_')[1];\n        nick_name = get_spliced_name(name);\n        return nick_name\n    }\n\n    if(member.nickName.length < 15){\n        nick_name = member.nickName;\n        return nick_name;\n    }\n\n    nick_name = get_spliced_name(member.nickName) //过长的裁剪\n    return nick_name\n\n}\n\nconst Item = Form.Item \n\nconst { Header, Content, Footer } = Layout;\nclass ToAudienceList extends Component {\n    state = {\n        checked_talker: null,//checked talkers name(also username)\n        show:false\n    }\n    // 展示这个框的时候，传入一个回调，处理完了执行这个回调，用来执行谁上麦\n    show = (handle_apply_talker_callback) => {\n\n        this.handle_apply_talker_callback = handle_apply_talker_callback;\n\n        this.setState({ show: true})\n    }\n    hide = () => {\n        this.setState({ show: false, checked_talker: null })\n    }\n    onChange = e => {\n        this.setState({\n            checked_talker: e.target.value,\n        });\n    }\n    confirm = async () => {\n        let confr = this.props.user_room;\n        let { checked_talker } = this.state\n        try {\n            await emedia.mgr.grantRole(confr, [checked_talker], 1);\n        \n            if(\n                this.handle_apply_talker_callback && \n                typeof this.handle_apply_talker_callback == 'function'\n            ){\n                this.handle_apply_talker_callback()\n            }\n\n            this.hide()\n        } catch (error) {\n            message.error('选人下麦失败，请重试')\n        }\n        \n    }\n    render() {\n        let { stream_list } = this.props;\n        let { show, checked_talker } = this.state\n\n        let base_url = 'https://download-sdk.oss-cn-beijing.aliyuncs.com/downloads/RtcDemo/headImage/';\n\n        return (\n            <Drawer \n                placement=\"left\"\n                closable={false}\n                visible={show}\n                mask={false}\n                getContainer={false}\n                width=\"336px\"\n                className=\"to-audience-list\"\n                destroyOnClose={true}\n            >\n\n               <div className=\"title\">\n                    <Button \n                        style={{background:'transparent',color:'#fff'}}\n                        onClick={this.hide}\n                    >返回</Button>\n\n                    <span style={{textAlign:'center'}}>主播人数已满<br/>可选择替换主播</span> \n\n                    <Button onClick={this.confirm}\n                    >确定</Button>\n                </div> \n               <Radio.Group \n                    onChange={this.onChange}\n                    value={checked_talker}\n                    name=\"to-audience\"\n               >\n                   { stream_list.map(item => {\n                        if( // 自己不显示 并且共享桌面的 不重复显示\n                            item &&\n                            item.member &&\n                            !item.member.is_me &&\n                            item.stream.type != emedia.StreamType.DESKTOP\n                        ) {\n                            let headImage = item.member.ext && item.member.ext.headImage;\n                            return (\n                                <div className=\"info-wrapper\" key={item.member.name}>\n\n                                    <Avatar src={ base_url + headImage }/>\n                                    <span className=\"name\">{\n                                        get_nickname(item.member) + (item.member.role == 7 ? '(主持人)' : '')\n                                    }</span>\n                                    <Radio value={item.member.name} />\n                                </div>\n                            )\n                        }\n                    })}\n               </Radio.Group>\n            </Drawer>\n        )\n    }\n}\n\nclass MuteAction extends Component {\n    state = {\n        mute_all: false\n    }\n    mute_all_action = async () => {\n\n        let { confrId } = this.props.user_room;\n\n        await emedia.mgr.muteAll(confrId);\n        this.setState({ mute_all:true })\n    }\n    unmute_all_action = async () => {\n\n        let { confrId } = this.props.user_room;\n\n        await emedia.mgr.unmuteAll(confrId);\n        this.setState({ mute_all:false })\n    }\n    render() {\n        let { mute_all } = this.state\n        return(\n\n            <Tooltip title={ mute_all ? '解除静音' : '全体静音' } placement=\"left\">\n                {\n                    mute_all ? \n                    <img className='mute-action' src={get_img_url_by_name('mute-all-icon')} onClick={this.unmute_all_action}/> :\n                    <img className='mute-action' src={get_img_url_by_name('unmute-all-icon')} onClick={this.mute_all_action}/>\n                    \n                }\n            </Tooltip>\n        )\n    }\n}\n\nclass ManageTalker extends Component {\n    // 静音某一人\n    mute = () => {\n        let { confrId } = this.props.user_room;\n        let { id:memberId } = this.props.member;\n        emedia.mgr.muteBymemberId(confrId, memberId);\n    }\n    // 解除静音某人\n    unmute = () => {\n        let { confrId } = this.props.user_room;\n        let { id:memberId } = this.props.member;\n        emedia.mgr.unmuteBymemberId(confrId, memberId);\n    }\n    // 更多的操作\n    more_action = ( {key} ) => {\n        \n        if(key == 'appoint_as_admin'){\n            this.appoint_as_admin()\n        } else if(key == 'move_out'){\n            this.move_out()\n        }\n    }\n    // 指定为主持人\n    appoint_as_admin = async () => {\n        let { user_room } = this.props;\n        let { memName, nickName } = this.props.member;\n            nickName = nickName || memName; //兼容显示\n\n        if(!user_room || !memName){\n            return\n        }\n\n        try {\n            await emedia.mgr.grantRole(user_room, [memName], 7);\n\n            message.success(`已把${nickName}设为主持人`)\n        } catch (error) {\n            message.error('设为主持人失败')\n        }\n    }\n    // 移出会议\n    move_out = () => {\n        \n\n        let { user_room } = this.props;\n        let { memName } = this.props.member;\n\n        if(!user_room || !memName){\n            return\n        }\n        emedia.mgr.kickMembersById(user_room, [memName]);\n\n    }\n\n    render() {\n\n        let { aoff } = this.props.stream;\n        let { role } = this.props.member;\n\n        const menu = (\n            <Menu onClick={this.more_action}>\n                <Menu.Item key=\"appoint_as_admin\">\n                    设为主持人\n                </Menu.Item>\n                <Menu.Item key=\"move_out\">\n                    移出会议\n                </Menu.Item>\n            </Menu>\n        );\n\n        return (\n            <div className='manage-talker-mask'>\n                <div className=\"action\" ref=\"action-wrapper\">\n\n                    {\n                        aoff ? <Button size='small' onClick={() => this.unmute()}>解除静音</Button>\n                             : <Button size='small' onClick={() => this.mute()}>静音</Button>\n                    }\n                    \n                    { role != 7 ? //非主持人才显示更多\n                        <Dropdown \n                            overlay={menu} \n                            placement=\"bottomLeft\"\n                            trigger={[\"click\"]}\n                            getPopupContainer={() => this.refs['action-wrapper']}\n                        >\n                            <Button size='small'>更多</Button>\n                        </Dropdown> : ''}\n                </div>\n            </div>\n        )\n    }\n}\n\n// 获取头像组件\nimport axios from 'axios'\nclass HeadImages extends Component {\n\n    state = {\n        visible: false,\n        url_list:{},\n        headimg_url_suffix: ''\n    }\n\n    componentDidMount() {\n        this.get_url_json()\n    }\n    async get_url_json () {\n\n        let url = 'https://download-sdk.oss-cn-beijing.aliyuncs.com/downloads/RtcDemo/headImage/headImage.conf';\n        const result = await axios({\n            method:'get',\n            url\n        })\n        this.setState({ url_list:result.data.headImageList }); \n    }\n\n    show = () => {\n        this.setState({ visible: true })\n    }\n    handleCancel = () => {\n        this.setState({ \n            visible: false,\n            headimg_url_suffix: ''\n        })\n    }\n\n    change(headimg_url_suffix) {\n        if(!headimg_url_suffix) {\n            return\n        }\n        this.setState({ headimg_url_suffix })\n    }\n    handleSubmit = () => {\n        let { headimg_url_suffix } = this.state;\n        this.props.headimg_change(headimg_url_suffix);\n        this.setState({ visible:false })\n    }\n    render() {\n\n        let { visible, url_list, headimg_url_suffix } = this.state;\n        let base_url = 'https://download-sdk.oss-cn-beijing.aliyuncs.com/downloads/RtcDemo/headImage/';\n        return (\n            <Modal \n                title=\"请选择头像\"\n                visible={visible}\n                onOk={this.handleSubmit}\n                onCancel={this.handleCancel}\n                footer={null}\n                getContainer={false}\n                className=\"head-images-modal\"\n                width=\"470px\"\n            >\n                <div className=\"head-image-list\">\n                    {\n                        Object.keys(url_list).map((item, index) => {\n                            return (\n                                <div \n                                    className=\"avatar-wrapper\"  \n                                    key={index}\n                                    onClick={() => this.change(url_list[item])}\n                                >\n                                    <Avatar src={ base_url + url_list[item] }/>\n                                    { headimg_url_suffix == url_list[item] ? //被选中的显示样式\n                                        <div className='checked-mask'>\n                                            <Icon type=\"check\" />\n                                        </div> : ''\n                                    }\n                                </div>\n                            )\n                        })\n                    }\n                </div>\n                        \n                <div className=\"action\">\n                    <Button type=\"primary\" onClick={this.handleSubmit}>保存并返回</Button>\n                </div>\n                \n            </Modal>\n        )\n    }\n}\n\n// 设置 昵称、音视频开关、头像 modal\nclass Setting extends Component {\n\n    state = {\n        visible: false,\n        headimg_url_suffix: '',\n\n        push_cdn: false,\n        cdn: '',\n        rec:false,\n        recMerge:false,\n        join_as_audience: false\n    }\n    \n    componentWillReceiveProps(nextProps) {\n\n        this.setState({ \n            // nickName: nextProps.nickName,   \n            headimg_url_suffix: nextProps.headimg_url_suffix,   \n        });\n    }\n    show = () => {\n        this.setState({ visible: true })\n    }\n    handleCancel = () => {\n        this.setState({ visible: false });\n\n        this.reset()\n    }\n    handleSubmit = () => {\n\n        let {\n            headimg_url_suffix,\n            cdn,\n            push_cdn,\n            rec,\n            recMerge,\n            join_as_audience\n        } = this.state;\n\n        \n        // 回调上去\n        this.props._get_setting_values({\n            headimg_url_suffix, cdn, push_cdn,\n            rec,recMerge,join_as_audience\n        })\n        this.setState({ visible: false });\n        \n        window.sessionStorage.setItem('easemob-headimg_url_suffix', headimg_url_suffix); //保存 头像 url\n        \n    }\n    \n    headimg_change = headimg_url_suffix => {\n\n        if(!headimg_url_suffix){\n            return\n        }\n\n        this.setState({ headimg_url_suffix })\n    }\n\n\n\n\n    handleChange = (event) => {\n        const target = event.target;\n        const value = target.name === 'cdn' ? target.value : target.checked;\n        const name = target.name;\n    \n        this.setState({\n          [name]: value\n        });\n\n    }\n    \n    // 更换头像\n    get_headimg_url = () => {\n        this.head_images.show()\n    }\n    \n    reset() {\n        this.setState({\n            push_cdn: false,\n            cdn: '',\n            rec:false,\n            recMerge:false,\n            join_as_audience: false\n    \n        })\n    }\n    render() {\n        let { \n            visible, \n            headimg_url_suffix\n         } = this.state;\n\n        let base_url = 'https://download-sdk.oss-cn-beijing.aliyuncs.com/downloads/RtcDemo/headImage/';\n\n        let _this = this;\n        return (\n            <Modal \n                visible={visible}\n                onOk={this.handleSubmit}\n                onCancel={this.handleCancel}\n                footer={null}\n                getContainer={false}\n                className=\"setting-modal\"\n                width=\"470px\"\n            >\n                <form action=\"\" onSubmit={this.handleSubmit}>\n\n                    <div className=\"avatar-wrapper \">\n                        <Avatar \n                            src={base_url + headimg_url_suffix} \n                            onClick={this.get_headimg_url} \n                            className='setting-avatar'/>\n                        <HeadImages \n                        ref={head_images => this.head_images = head_images}\n                        headimg_change={this.headimg_change}/>\n                    </div>\n\n                    {\n                        [\n                            {key: 'push_cdn', text: '开启推流 CDN'},\n                            {key: 'cdn', text: '推流CDN地址'},\n                            {key: 'rec', text: '开启录制'},\n                            {key: 'recMerge', text: '开启录制合并'},\n                            {key: 'join_as_audience', text: '以观众身份加入会议'},\n                        ].map((item,index) => {\n                            let { key, text } = item;\n                            if(key == 'cdn') {\n                                return <Input \n                                            key={index}\n                                            placeholder={text} \n                                            name={key} \n                                            value={_this.state[key]} \n                                            onChange={_this.handleChange} disabled={!_this.state['push_cdn']} \n                                        />\n                            } else {\n                                return <Checkbox \n                                        key={index}\n                                        checked={_this.state[key]} \n                                        name={key} \n                                        onChange={_this.handleChange}>{text}</Checkbox>\n                            }\n                        })\n                    }\n                    \n                    <div className='join_as_audience_tips'>加入后只能观看，需申请上麦</div>\n\n                    <div className=\"action\">\n                        <Button type=\"primary\" onClick={this.handleSubmit}>保存并返回</Button>\n                    </div>\n                </form>\n            </Modal>\n        )\n    }\n}\n\n// 网络连接状态监听\nwindow.addEventListener(\"offline\", function() {\n    message.error('您的网络链接断开了')\n})\n\nwindow.addEventListener(\"online\", () =>  message.success('您的网络链接成功'));\n\n// 申请主持人 或者 放弃主持人操作\nfunction AdminChangeHandle(props) {\n    let {\n        my_username,\n        my_role,\n        stream_list,\n        user_room\n    } = props;\n\n    // 主播角色\n    if(my_role == 3) {\n        const apply_admin = () => {\n    \n            message.success('主持人申请已发出，请等待主持人同意');\n            emedia.mgr.requestToAdmin(user_room.confrId);\n        \n        }\n        return(\n            <div className=\"admin-change-handle\" onClick={apply_admin}>申请主持人</div>\n        ) \n    }\n\n    // 主持人角色\n    if(my_role == 7) {\n\n        let admin_number = 0;\n        stream_list.map(item => { //必须大于2个主持人，才可放弃主持人，否则会有问题\n            if(\n                item && \n                item.member && \n                item.member.role == 7 &&\n                item.stream.type != emedia.StreamType.DESKTOP\n            ) {\n                admin_number++\n            }\n        });\n\n        if( admin_number < 2) {\n            return ''\n        }\n\n        const apply_talker = async () => {\n    \n            if(!my_username) {\n                console.warn('ApplyAdmin username is required');\n                return\n            }\n    \n            let memName = appkey + '_' + my_username;\n            try {\n                await emedia.mgr.grantRole(user_room, [memName], 3);\n                message.success('您已经变为了主播')\n            } catch (error) {\n                message.error('变更主播失败')\n            }\n        \n        }\n        return(\n            <div className=\"admin-change-handle\" onClick={apply_talker}>放弃主持人</div>\n        )\n    }\n\n    return ''\n}\n\n// 网络状态\nclass NetworkStatus extends Component {\n\n\n    render() {\n\n        let { network_status } = this.props; // 0: 断网 1: 弱网 2: 良好\n        network_status = network_status == undefined ? 2 : network_status;\n\n        let c_status = { 0: 'dis', 1: 'weak', 2: ''};\n\n        return (\n            <div className={`network-wrapper ${c_status[network_status]}`}>\n                <div className={`network-item one ${network_status>0 ? 'high-light' : ''}`}></div>\n                <div className={`network-item two ${network_status>0 ? 'high-light' : ''}`}></div>\n                <div className={`network-item three ${network_status>1 ? 'high-light' : ''}`}></div>\n                <div className={`network-item four ${network_status>1 ? 'high-light' : ''}`}></div>\n\n                <div className=\"icon\">\n                    <span className=\"line\"></span>\n                </div>\n            </div>\n        ) \n    }\n}\n// 房间设置 modal\nfunction RoomSetting(props) {\n    let { \n            room_setting_modal_show, \n            roomName, \n            stream_list,\n\n            // confr,\n            user,\n            user_room\n        } = props;\n\n    \n    let { username: my_username } = user;\n    let { role: my_role } = user_room;\n    const get_admins = () => {\n        let admins = [];\n\n       \n        stream_list.map(item => {\n            if(\n                item &&\n                item.member &&\n                item.member.role == 7 &&\n                item.stream.type != emedia.StreamType.DESKTOP\n            ) {\n                admins.push(get_nickname(item.member))\n            }\n        })\n        \n        return admins\n    }\n\n    return (\n        <div \n            className={`room-setting${room_setting_modal_show ? \" open\":''}`}\n        >\n            <div className=\"toast-title\">\n                <span>会议名称</span>\n                <Icon \n                    type=\"close-circle\"\n                    onClick={() => props.toggle_room_setting_modal()}\n                />\n            </div>\n            <div className=\"text\">{roomName}</div>\n            <div className=\"item-wrapper\">\n                <div className=\"title\">主持人</div>\n                {\n                    get_admins().map((item,index) => {\n                        return <div key={index} className=\"text\">{item}</div>\n                    })\n                }\n            </div>\n            <AdminChangeHandle { ...{my_username, stream_list, my_role, user_room} }/>\n\n        </div>\n    )\n}\n\n// toast 框组件 退出白板\nfunction toast(config) {\n\n    const div = document.createElement('div');\n    document.body.appendChild(div);\n\n    \n    function destroy() {\n        const unmountResult = ReactDOM.unmountComponentAtNode(div);\n        if (unmountResult && div.parentNode) {\n          div.parentNode.removeChild(div);\n        }\n        \n    }\n\n    function onOk_handle() {\n        let { onOk } = config\n        if(\n            !onOk ||\n            typeof onOk != 'function'\n        ) {\n            return\n        }\n\n        onOk();\n\n        destroy();\n    }\n    ReactDOM.render(\n        <div className=\"toast\" >\n            <div className=\"toast-title\">\n                <span>提示</span>\n                <Icon type=\"close-circle\" onClick={() => destroy()}/>\n            </div>\n            <div className=\"text\"> 退出后将结束互动白板 </div>\n            <div className=\"handle\">\n                {/*  */}\n                <span className=\"leave\" onClick={() => onOk_handle()}>继续退出</span><br />\n                <span className=\"end\" onClick={() => destroy()}>取消</span>\n            </div>\n        </div>, div)\n}\n\n// toast message\nfunction toast_msg_show(text) {\n\n    let el_m = document.createElement('div');\n    el_m.id = 'toast-msg'; // 只能有一个\n    el_m.innerText = text\n    document.body.appendChild(el_m);\n\n\n    setTimeout(() => {\n        if(document.querySelector('#toast-msg')){\n            document.body.removeChild(document.querySelector('#toast-msg'))\n        }\n    },2000)\n}\n\n// 邀请他人文案框\nfunction inviteModal(info) {\n\n    if(!info) {\n        return\n    }\n\n    if(document.querySelector('#inviteModal')) {\n        return\n    }\n    const div = document.createElement('div');\n    div.id = 'inviteModal'\n    document.body.appendChild(div);\n\n    function destroy() {\n        const unmountResult = ReactDOM.unmountComponentAtNode(div);\n        if (unmountResult && div.parentNode) {\n          div.parentNode.removeChild(div);\n        }\n        \n    }\n\n    function copy() { // 复制邀请文本\n        let textarea = document.querySelector('textarea#invite');\n        textarea.select();//选中文本\n        try {\n            document.execCommand('copy');\n            message.success('已复制邀请文本到粘贴板')\n        } catch (error) {\n            message.error('复制邀请文本失败')\n        }\n    }\n\n    const roomName = info.roomName || '';\n    const invitees = info.invitees || ''; //邀请人\n\n    let content = invitees + '邀请您参加视频会议\\r\\n' +\n    '会议名称：' + roomName + '\\r\\n\\r\\n' + \n    \n    '点击链接直接加入会议:\\r\\n' + \n    'https://meeting.easemob.com/invite/index.html?'+\n    'roomName='+ encodeURI(roomName) + '&invitees='+ encodeURI(invitees) +'\\r\\n\\r\\n' +\n    \n    'app下载地址：http://www.easemob.com/download/rtc';\n\n    \n    ReactDOM.render(\n        <div className=\"inviteModal\" >\n            <span className=\"close\" onClick={destroy}>x</span>\n            <div className=\"title\">会议名称：{roomName}</div>\n            <textarea value={content} readOnly id='invite'></textarea>\n            <Button type=\"primary\" onClick={copy}>复制</Button>\n        </div>, div)\n}\n\n// 问题反馈按钮\nclass Exc_feed extends PureComponent {\n    constructor(props) {\n        super(props)\n        this.state = {\n            visible: false\n        }\n\n        this.handle_click = this.handle_click.bind(this)\n        this.handleCancel = this.handleCancel.bind(this)\n        this.handleOk = this.handleOk.bind(this)\n        this.onChange = this.onChange.bind(this)\n    }\n\n    handle_click(){\n        this.setState({ visible: true })\n    }\n\n    handleOk() {\n        let { msg } = this.state;\n\n\n        this.setState({\n            confirmLoading: true,\n        });\n        setTimeout(() => {\n            this.setState({\n              visible: false,\n              confirmLoading: false,\n            });\n\n            emedia.fileReport('', msg);\n\n            Modal.success({\n                title: '您的会议日志，已经保存到了本地',\n                content: `请添加QQ：454374569, 进行问题反馈`,\n                okText: '知道了'\n            });\n        }, 500);\n    }\n\n    handleCancel() {\n        this.setState({ visible: false })\n    }\n\n    onChange(e) {\n        let value = e.target.value;\n\n        this.setState({\n            msg: value\n        })\n    }\n    render() {\n\n        let {\n            visible ,\n            confirmLoading\n        } = this.state;\n\n        const { TextArea } = Input\n        return (\n            <div>\n                <Modal\n                title=\"请填写您遇到的问题\"\n                visible={visible}\n                onOk={this.handleOk}\n                confirmLoading={confirmLoading}\n                onCancel={this.handleCancel}\n                okText='确定'\n                cancelText='取消'\n                >\n                    <TextArea rows={4} onChange={this.onChange}/>\n                </Modal>\n                <div className=\"exception-feedback-action\" onClick={this.handle_click}>问题反馈</div>\n            </div>\n        )\n    }\n}\n// 选择共享桌面流组件\nclass ChooseDesktopMedia extends PureComponent {\n\n    state = {\n        visible:false,\n        sources:[],\n        accessApproved: null,\n        choosed_stream: null\n    }\n\n    show (sources, accessApproved, accessDenied) {\n\n        this.setState({ \n            sources,\n            accessApproved,\n            accessDenied,\n            visible: true \n        })\n    }\n\n    hide() {\n        this.setState({ \n            visible: false,\n            choosed_stream: null \n        });\n        \n        let { accessDenied } = this.state\n        if(\n            accessDenied &&\n            typeof accessDenied == 'function'\n        ) {\n            accessDenied()\n        }\n    }\n\n    // 选中某个桌面流\n    choose(stream) {\n        if(!stream) {\n            return\n        }\n\n\n        this.setState({\n            choosed_stream: stream\n        })\n    }\n\n    //分享\n    share() {\n        let { accessApproved, choosed_stream } = this.state;\n\n        if(\n            !accessApproved ||\n            !choosed_stream\n        ) {\n            return\n        }\n        \n        if(typeof accessApproved != 'function'){\n            return\n        }\n\n        accessApproved(choosed_stream)\n\n        this.setState({\n             visible: false,\n             choosed_stream: null\n        })\n    }\n    render(){\n        let { visible, sources, choosed_stream } = this.state;\n\n        let screen_list = [];\n        let window_list = [];\n\n        sources.map(item => { // 区分 整个屏幕和应用窗口\n            if(item){\n                if(/window/.test(item.id)) {\n                    window_list.push(item)\n                } else if(/screen/.test(item.id)) {\n                    screen_list.push(item)\n                }\n            }\n        })\n        const { TabPane } = Tabs;\n\n        return (\n            <Modal\n                title=\"共享屏幕\"\n                visible={visible}\n                destroyOnClose={true}\n                mask={false}\n                maskClosable={false}\n                okText='分享'\n                cancelText='取消'\n                closable={false}\n                onOk={() => this.share()}\n                okButtonProps={{ disabled: !choosed_stream }}\n                onCancel={() => this.hide()}\n                wrapClassName='electorn-choose-desktop-media'\n                getContainer={false}\n                width={600}\n                style={{ top: 20 }}\n            >\n                    <div>Electorn 想要共享您屏幕上的内容。请选择你希望共享哪些内容</div>\n\n                    <Tabs defaultActiveKey=\"1\">\n                        <TabPane tab=\"您的整个屏幕\" key=\"1\">\n                            <div className=\"tab-content\">\n\n                                {\n                                    screen_list.map((item, index) => {\n\n                                        let choosed_style = {};\n\n                                        if(choosed_stream){ //判断是否选中的\n                                            if(choosed_stream.id == item.id) {\n                                                choosed_style = {\n                                                    borderColor: 'rgba(146, 210, 241, 0.7)'\n                                                }\n                                            }\n                                        }\n                                        return (\n                                            <div \n                                                className=\"img-wrapper\" \n                                                onClick={() => this.choose(item)}\n                                                style={choosed_style}\n                                                key={index}\n                                            >\n                                                <img src={item.hxThumbDataURL} />\n                                                <div className='name'> {item.name} </div>\n                                            </div>\n                                        )\n                                    })\n                                }\n                            </div>\n                        </TabPane>\n                        <TabPane tab=\"应用窗口\" key=\"2\">\n                        <div className=\"tab-content\">\n                            {\n                                window_list.map((item, index) => {\n                                    \n                                        let choosed_style = {};\n\n\n                                        if(choosed_stream){ //判断是否选中的\n                                            if(choosed_stream.id == item.id) {\n                                                choosed_style = {\n                                                    borderColor: 'rgba(146, 210, 241, 0.7)'\n                                                }\n                                            }\n                                        }\n                                        \n                                        return (\n                                            <div \n                                                className=\"img-wrapper\" \n                                                onClick={() => this.choose(item)}\n                                                style={choosed_style}\n                                                key={index}\n                                            >\n                                            <img src={item.hxThumbDataURL} />\n                                            <div className='name'> {item.name} </div>\n                                        </div>\n                                    )\n                                })\n                            }\n                        </div>\n                        </TabPane>\n                    </Tabs>\n            </Modal>\n        )\n    }\n}\n\nfunction getPageQuery(query) { // 从url获取参数\n    if(!query) {\n        return ''\n    }\n\n    let search = window.location.href.split('?')[1];\n\n    if(!search) {\n        return ''\n    }\n\n    let query_value = '';\n\n    let key_value_arr = search.split('&');\n    key_value_arr.map(item => {\n        let key = item.split('=')[0];\n        let value = item.split('=')[1];\n\n        if(query == key) {\n            query_value = value\n        }\n\n    })\n\n    return decodeURI(query_value)\n\n}\n\nclass Room extends Component {\n    constructor(props) {\n        super(props);\n\n        \n        this.state = {\n\n            // join start\n            roomName: getPageQuery('roomName') ||'',\n            nickName:'',\n            user: {},\n            user_room: {\n                role: 3\n            },\n            own_stream:null,\n            own_desktop_stream: null, // 自己发起的桌面流，不显示（保存起来，用于停止共享）\n            own_member: null,\n            // join end\n            time:0,// 秒的单位\n            stream_list: [null],//默认 main画面为空\n            talker_list_show:false,\n            audio:true,\n            video:false,\n            headimg_url_suffix: '',\n            joined: false,\n            loading: false,\n\n            talker_is_full:false, //主播已满\n            talker_full_btn_disable: false, // talker_is_full model button disabled\n            shared_desktop:false,\n\n            set_nickname_modal_show: false,\n            room_setting_modal_show: false,\n\n            cdn:'', //推流 cdn url\n            push_cdn: false, //是否开启推流 cdn \n\n            liveCfg : { // 推流CDN的画布 配置、创建推流 CDN 时使用\n                cdn:'',\n                layoutStyle : 'GRID',\n                canvas :{ \n                    bgclr : 0x000000,\n                    w : 640,\n                    h : 480,\n                    fps: 20, //输出帧率\n                    bps: 1200000,  //输出码率\n                    codec: \"H264\" //视频编码，现在必须是H264\n                }\n            },\n\n            cdn_zorder:1, //更新CDN布局，递增 1，配合服务端\n\n            use_white_board:true, //是否启用白板\n            white_board_url: '', // 白板加载的外部链接\n            white_board_is_created: false, // 白板是否创建\n            am_i_white_board_creator: false, // 我是否是白板创建者\n\n\n            not_visible_arr: [], // 主播列表不可见标签集合，默认都可见\n            leaveConfirmModal_show: false,\n\n            prev_volumes: {}, // 每个流的音量集合\n            subed_v_els: {}, // 订阅过的 video 标签\n\n            join_btn_disable: false, // 是否可以加入会议\n\n            main_loading: false, // meeting-loading\n            main_loading_text: '',\n\n        };\n\n        this.toggle_main = this.toggle_main.bind(this);\n        this.join_handle = this.join_handle.bind(this);\n        this.talker_is_full_handle = this.talker_is_full_handle.bind(this);\n        this.leave = this.leave.bind(this);\n        this.toggle_audio = this.toggle_audio.bind(this);\n        this.toggle_video = this.toggle_video.bind(this);\n        this.apply_talker = this.apply_talker.bind(this); \n        this.apply_audience = this.apply_audience.bind(this); \n        this.stop_share_desktop = this.stop_share_desktop.bind(this); \n        this.share_desktop = this.share_desktop.bind(this); \n        \n        this.toggle_room_setting_modal = this.toggle_room_setting_modal.bind(this); \n        \n        \n        this.confirm_destory_white_board = this.confirm_destory_white_board.bind(this);   \n        this.create_white_board = this.create_white_board.bind(this);\n        \n        this.talker_list_scroll = this.talker_list_scroll.bind(this, this.talker_list_scroll_stop.bind(this), 1000)();\n\n\n        this.hide_leaveConfirmModal = this.hide_leaveConfirmModal.bind(this);\n        this.leave_handle = this.leave_handle.bind(this);\n        this.leave = this.leave.bind(this);\n\n\n    }\n    whetherCanUse() {\n\n        if(navigator.userAgent.indexOf('Mobile') > -1) { // 手机不支持\n            this.setState({\n                join_btn_disable: true\n            })\n\n            return\n        }\n        if(\n            !emedia.isChrome &&\n            !emedia.isElectron && \n            !emedia.isEdge && \n            !emedia.isSafari \n        ) {\n            this.setState({\n                join_btn_disable: true\n            })\n        }\n        \n\n    }\n    // join fun start\n    async join() {\n\n        this.setState({ loading:true, talker_is_full:false });\n\n        let {\n            roomName,\n            nickName,\n            headimg_url_suffix,\n            push_cdn,\n            cdn,\n            rec, \n            recMerge\n        } = this.state;\n\n        let role = this.state.user_room.role;\n        \n        let params = {\n            roomName,\n            password: roomName,\n            role,\n            config:{ \n                nickName,\n                ext: {\n                    headImage: headimg_url_suffix //头像信息，用于别人接收\n                },\n                rec, \n                recMerge,\n\n                // maxTalkerCount:3,//会议最大主播人数\n                // maxVideoCount:2, //会议最大视频数\n                // maxPubDesktopCount:1 //会议最大共享桌面数\n            }\n        }\n\n        // 如果设置推流 添加 cdn配置\n        if(push_cdn && cdn) {\n\n            // let liveCfg = {\n            //     cdn,\n            //     layoutStyle : 'GRID'\n            // }\n            // let liveCfg = {\n            //     cdn,\n            //     layoutStyle : 'CUSTOM',\n            //     canvas :{ \n            //         bgclr : 980000,\n            //         w : 640,\n            //         h : 480\n            //     }\n            // }\n            let { liveCfg } = this.state;\n            liveCfg.cdn = cdn;\n            params.config.liveCfg = liveCfg\n        }\n\n        try {\n            const user_room = await emedia.mgr.joinRoom(params);\n    \n            process.env.NODE_ENV == 'development' ? '' : this.startTime();\n\n            this._set_config_to_localStorage(); \n\n            this.setState({ \n                joined: true,\n                user_room,\n            })\n    \n            window.location.hash = '' //加入会议成功，清除query 防止退出后，重复加入\n\n            if(user_room.role == emedia.mgr.Role.AUDIENCE){ // 观众不推流\n                \n                return\n            }\n            this.publish();\n\n            \n        } catch (error) { \n            \n            if(/cause: -523|cause:-523/.test(error.errorMessage)){ // 主播已满\n                this.setState({ \n                    talker_is_full: true, \n                    loading:false,\n                    talker_full_btn_disable: true\n                });\n                return\n            }\n\n            let err_o = {\n                '-530':'创建session失败',\n                '-531':'设置布局失败',\n                '-532':'画布不能为空',\n                '-533':'删除session失败',\n                '-534':'自定义录制失败',\n                '-200':'参数错误',\n\n            }\n            message.error(err_o[error.error] || error.errorMessage || error.message) // errorMessage: 接口错误， message：js 语法错误 \n            this.setState({ loading:false });\n\n        }\n    }\n    join_handle = (e) => {\n\n        e && e.preventDefault();\n        \n        var _this = this;\n        this.props.form.validateFields((err, values) => {\n            let { \n                roomName,\n                nickName,\n                audio, \n                video\n             } = values;\n\n            _this.setState({\n                roomName,\n                audio,\n                video,\n                nickName\n            },() => {\n                if (!err) {\n                    _this.join()\n                }\n            })\n        });\n    }\n    talker_is_full_handle() { // 主播已满，修改角色\n        \n        this.setState({\n            join_as_audience: true,\n            user_room: {\n                role: 1\n            }\n        }, this.join_handle)\n\n    }\n    // join fun end\n\n    // 收集设置表单的数据， setState\n    _get_setting_values = (values) => {\n\n        if(!values) {\n            return\n        }\n        for (const key in values) {\n            this.setState({ [key]: values[key]})\n        }\n\n        // 设置角色\n        if(values.join_as_audience){\n            this.setState({\n                user_room: {\n                    role: 1\n                }\n            })\n        }\n    }\n    async componentDidMount () {\n\n        this.whetherCanUse()\n        \n        this.setState({loading: true})\n        const user = await login(); // IM 登录\n        this.setState({loading: false})\n\n        this.setState({ user })\n        this.init_emedia_callback(); //登录之后 初始化 emedia\n        this.init_white_board(); //初始化 white_board\n        \n        let _this = this;\n        window.onbeforeunload=function(e){     \n            var e = window.event||e;  \n            if(\n                _this.state.am_i_white_board_creator\n            ) { // 是白板创建者 首先销毁白板\n\n                _this.emit_white_board_is_destroyed();\n                _this.destroy_white_board()\n            }\n\n            if(_this.state.shared_desktop) {\n                _this.stop_share_desktop()\n            }\n\n            emedia.mgr.exitConference();\n\n        } \n\n        this._get_config_from_localStorage();\n        this._get_headimg_url_suffix_from_session();\n\n        if(getPageQuery('roomName')) { // 有roomName 认定为邀请的，自动加入会议\n            let _this = this;\n            setTimeout(() => {\n                _this.join_handle()\n            },1000) // 给个延时，让页面充分加载\n        }\n    }\n\n    \n    componentWillUnmount() {\n        clearInterval(this.timeID);\n    }\n    init_emedia_callback() {\n        let _this = this;\n        \n        let { username, token } = this.state.user;\n\n        emedia.config({\n            restPrefix: process.env.REACT_APP_RTC_HOST,\n            appkey,\n            // useDeployMore:true //开启多集群部署\n        });\n\n\n        let memName = appkey +'_'+ username;\n        emedia.mgr.setIdentity(memName, token); //设置memName 、token\n\n        emedia.mgr.onStreamAdded = function (member, stream) {\n            console.log('onStreamAdded >>>', member, stream);\n\n            _this._on_stream_added(member, stream)\n        };\n        emedia.mgr.onStreamRemoved = function (member, stream) {\n            console.log('onStreamRemoved',member,stream);\n\n            _this._on_stream_removed(stream)\n        };\n        emedia.mgr.onMemberJoined = function (member) {\n            console.log('onMemberJoined',member);\n            message.success(`${member.nickName || member.name} 加入了会议`);\n        };\n\n        emedia.mgr.onMemberLeave = function (member, reason, failed) {\n            console.log('onMemberLeave', member, reason, failed);\n            message.success(`${member.nickName || member.name} 退出了会议`);\n\n        };\n\n        \n        emedia.mgr.onConferenceExit = function (reason, failed) {\n            function get_failed_reason(failed) {\n                let reasons = {\n                    '-9527' : \"失败,网络原因\",\n                    '-500' : \"Ticket失效\",\n                    '-502' : \"Ticket过期\",\n                    '-504' : \"链接已失效\",\n                    '-508' : \"会议无效\",\n                    '-510' : \"服务端限制\"\n                }\n\n                return reasons[failed]\n            }\n\n            let reason_text = '正常挂断';\n\n\n            let reasons = {\n                0: '正常挂断', \n                1: \"没响应\",\n                2: \"服务器拒绝\",\n                3: \"对方忙\",\n                4: \"网络原因\",\n                5: \"不支持\",\n                6: \"超时\",\n                10: \"其他设备登录\",\n                11: \"会议关闭\",\n                12: \"被踢出了会议\"\n            }\n\n            if(reason){\n                reason_text = reasons[reason];\n            }\n\n            if(reason == 4 && failed){\n                reason_text = get_failed_reason(failed);\n            }\n\n            console.log('onConferenceExit', reason, failed);\n            \n            \n            if(\n                _this.state.am_i_white_board_creator\n                //  &&\n                // reason == 11\n            ){ // 会议结束、 销毁白板,\n                _this.destroy_white_board();\n            }\n\n            if(_this.state.shared_desktop) {\n                _this.stop_share_desktop()\n            }\n            \n            message.warn(reason_text, 1, () => {\n                \n                if(_this.state.talker_is_full){ // 主播已满的加入会议，也会走正常挂断 -- 但是不能刷新\n                    _this.setState({\n                        talker_full_btn_disable: false\n                    })\n                    return\n                }\n\n                window.location.reload()\n            });\n        };\n        emedia.mgr.onConfrAttrsUpdated = function(confr_attrs){ \n            console.log('onConfrAttrsUpdated', confr_attrs);\n            // 会议属性变更\n            _this.confrAttrsUpdated(confr_attrs)\n        };\n\n        emedia.mgr.onRoleChanged = function (role) {\n            _this._on_role_changed(role)\n        };\n\n        // 主持人变更回调\n        emedia.mgr.onAdminChanged = function(admin) {\n            \n            let { memberId } = admin;\n            if(!memberId){\n                return\n            }\n            _this.admin_changed(admin)\n        }\n\n        // 视频流达到最大数失败回调\n        emedia.mgr.onPubVideoTooMuch = async () => {\n            message.warn('已达到最大视频数，只能开启音频')\n\n            let { own_stream } = _this.state;\n            if(own_stream) { // 断开自己的流\n                await emedia.mgr.unpublish(own_stream)\n            }\n\n            _this.setState({ \n                audio:true, video:false \n            }, _this.publish)\n        }\n        // 共享桌面最大数发布 回调\n        emedia.mgr.onPubDesktopTooMuch = () => {\n            message.warn('共享桌面数已经达到最大');\n            _this.stop_share_desktop()\n        }\n\n        // 主持人 收到上麦申请回调\n        // applicat 申请者信息 {memberId, nickName}\n        // 只有管理员会收到这个回调\n        \n        emedia.mgr.onRequestToTalker = function(applicat, agreeCallback, refuseCallback) {\n            \n            _this.handle_apply_talker(applicat, agreeCallback, refuseCallback)\n        }\n\n        // 观众收到 上麦申请的回复 result 0: 同意 1: 拒绝\n        emedia.mgr.onRequestToTalkerReply = function(result) {\n            if(result == 1){\n                message.error('管理员拒绝了你的上麦申请')\n            }\n        }\n        // 主播收到 申请主持人的回复 result 0: 同意 1: 拒绝\n        emedia.mgr.onRequestToAdminReply = function(result) {\n            if(result == 1){\n                message.error('管理员拒绝了你的主持人申请')\n            }\n        }\n\n        // 收到主播的主持人申请, applicat 申请者信息 {memberId, nickName}\n        emedia.mgr.onRequestToAdmin = function(applicat, agreeCallback, refuseCallback) {\n            \n            let { memberId, nickName } = applicat; \n\n            if(!memberId){\n                return\n            }\n            const { confirm } = Modal;\n            confirm({\n                title:`是否同意${nickName || memberId}的主持人请求`,\n                onOk: () => agreeCallback(memberId),\n                onCancel: () => refuseCallback(memberId),\n                cancelText:'拒绝',\n                okText:'同意'\n            });\n        }\n\n        // 某人被管理员静音或取消静音的回调\n        emedia.mgr.onMuted = () => { \n            message.warn('你被管理员静音了'); \n            _this.close_audio()\n        }\n        emedia.mgr.onUnmuted = () => { \n            message.success('你被管理员取消了静音');\n            _this.open_audio()\n        }\n\n        // 全体静音或取消全体静音\n        emedia.mgr.onMuteAll = () => { \n            message.warn('管理员启用了全体静音');\n            setTimeout(_this.close_audio, 500)  //如果静音，加入会议就会触发，所以设置延时\n        }\n        emedia.mgr.onUnMuteAll = () => { \n            message.success('管理员取消了全体静音');\n            _this.open_audio()\n        }\n\n        // 网络质量检测\n        emedia.mgr.onNetworkQuality = (sId, status) => {\n\n            let { stream_list, n_weak_ms_t } = _this.state;\n\n\n            let changed = false;\n            stream_list.map(item => {\n                if(\n                    item &&\n                    item.stream &&\n                    item.stream.id == sId\n                ) {\n                    let perv_n_status = item.stream.network_status;\n                    if(perv_n_status != status) {\n                        changed = true;\n                        item.stream.network_status = status;\n                        console.log(`onNetworkQuality change: sid=${sId}, status=${status}`);\n\n                    }\n\n                    // 自己弱网的提示\n                    if(item.member && item.member.is_me && status !=2 ) {\n                        let t = new Date().getTime()\n                        if(!n_weak_ms_t) {\n                            _this.setState({ n_weak_ms_t: t});\n                            toast_msg_show('您的网络状态不佳');\n                        } else {\n                            \n                            if(t - n_weak_ms_t > 10000) {\n                                _this.setState({ n_weak_ms_t: t});\n                                toast_msg_show('您的网络状态不佳')\n                            };\n                        }\n                    }\n                }\n\n\n            });\n\n            if(changed) {\n                _this.setState({ stream_list })\n            }\n\n        }\n       \n\n        // electorn 兼容 \n        if(emedia.isElectron) {\n            emedia.chooseElectronDesktopMedia = function(sources, accessApproved, accessDenied){\n                \n                if(_this.choose_desktop_media) {\n                    _this.choose_desktop_media.show(sources, accessApproved, accessDenied);\n                }\n            }\n        }\n\n\n    }\n\n    // 初始化白板\n    init_white_board() {\n        this.white_board = new whiteBoards({\n\t\t\trestApi: process.env.REACT_APP_WHITE_BOARD_HOST,\n            appKey: appkey\n            \n\t\t});\n    }\n    _on_role_changed(role) {\n        if(!role) {\n            return\n        }\n\n        let { user_room } = this.state;\n        let old_role = user_room.role;\n        user_room.role = role;\n\n        let _this = this;\n\n        this.setState({ user_room }, () => {\n\n            // 从观众变为主播\n            if(\n                old_role == 1 &&\n                role == 3\n            ) {\n                _this.setState({\n                    audio:true\n                },_this.publish)\n                message.success('你已经上麦成功,并且推流成功');\n                \n                return\n            }\n\n            // 被允许下麦\n            if(\n                (old_role == 3 || old_role == 7) &&\n                role == 1\n            ) {\n                message.success('你已经下麦了,并且停止推流');\n                _this.setState({\n                    join_as_audience: true\n                })\n                return\n            }\n\n            // 变成主持人\n            if(\n                old_role == 3 &&\n                role == 7\n            ) {\n                message.success('你已经是主持人了')\n                return\n            }\n        })\n\n        const set_role_to_my_member = () => {// 变更流里面的角色\n            let { joinId } = _this.state.user_room;\n            let { stream_list } = _this.state;\n\n            stream_list.map(item => {\n                if(\n                    item &&\n                    item.member &&\n                    item.member.id == joinId\n                ) {\n                    item.member.role = role\n                }\n            });\n\n            _this.setState({ stream_list })\n        }\n\n        set_role_to_my_member();\n\n\n    }\n    // 会议属性变更\n    confrAttrsUpdated(confr_attrs) {\n        // confr_attrs ---  Array \n\n        // 白板相关\n        let white_board_attr = confr_attrs.filter(item => item.key == 'whiteBoard');\n        \n        if(white_board_attr.length > 0) {\n            let { op, val } = white_board_attr[0];\n\n            if( op == 'DEL') {\n                message.success('白板管理员销毁了白板');\n                this.setState({\n                    white_board_is_created: false,\n                })\n                return\n            }\n\n\n            val = JSON.parse(val)\n\n            // 如果是自己创建的白板，忽略会议属性\n            let { username } = this.state.user;\n            if( val.creator == username ) {\n                return\n            }\n\n            // 如果不是 删除白板的会议属性，都是加入\n            message.success('有人创建了白板');\n\n            let { roomName, roomPswd:password } = val;\n            let { username:userName, token } = this.state.user;\n\n            let join_white_board_params = {\n                roomName,\n                password,\n                userName,\n                token\n            }\n\n            this.setState({ \n                join_white_board_params,\n                talker_list_show: true\n            }, this.join_white_board);\n        }\n    }\n\n    // 从 sessionStore 拿昵称 return false: 没有昵称，需要设置， true：有昵称，不需要设置\n    _get_nickname_from_session() {\n        let nickName = window.localStorage.getItem('easemob-nickName');\n        let nickName_used = window.localStorage.getItem('easemob-nickName-used');\n\n        if(!nickName) {\n            window.localStorage.setItem('easemob-nickName-used', true);\n            this.setState({ // 没有nickName，肯定是拥有者，用于判断是否需要 存到 localStorge-nickName\n                is_localStorage_nickName_admin: true\n            })\n            return\n        } \n        \n        if(nickName_used == 'true') { // 有人打开了 一个页面了 已经\n            return \n        } else { // null 或者 false 说明是拥有者，直接置为 true\n            window.localStorage.setItem('easemob-nickName-used', true);\n            this.setState({ \n                is_localStorage_nickName_admin: true,\n                nickName \n            });\n            return\n        }\n\n    }\n\n    // 从 昵称、音视频开启状态、头像路径，存储在本地\n    _get_config_from_localStorage() {\n        let config = window.localStorage.getItem('em-meeting-config');\n        console.log('config', config);\n        config = JSON.parse(config);\n\n        for (const key in config) {\n            this.setState({\n                [key]: config[key]\n            })\n        }\n\n    }\n    _set_config_to_localStorage() {\n\n        // 将昵称、音频开启状态、视频开启状态 存储起来\n        let {\n            nickName,\n            audio,\n            video\n        } = this.state;\n\n        let config = {\n            nickName,\n            audio,\n            video\n        }\n        \n        window.localStorage.setItem('em-meeting-config', JSON.stringify(config))\n    }\n    \n    _get_headimg_url_suffix_from_session() {\n        let headimg_url_suffix = window.sessionStorage.getItem('easemob-headimg_url_suffix');\n\n        if(!headimg_url_suffix) {// 默认给的头像\n            headimg_url_suffix = 'Image1.png'\n        }\n        this.setState({ headimg_url_suffix })\n    }\n\n    _set_nickname = nickName => {\n        let { username } = this.state.user;\n\n        this.setState({ nickName: nickName || username },this.join_handle);\n\n        if(this.state.is_localStorage_nickName_admin) { \n            // 是否是 localStorage_nickName 拥有者，一个浏览器只有第一个页面拥有localStorage_nickName\n            window.localStorage.setItem('easemob-nickName', nickName);\n        }\n    }\n\n    // 退出会议相关\n    hide_leaveConfirmModal() {\n        this.setState({ leaveConfirmModal_show: false})\n    }\n    get_leaveConfirmModal() {\n        let { leaveConfirmModal_show } = this.state;\n        if(!leaveConfirmModal_show) return '';\n        \n        let { confrId } = this.state.user_room;\n\n        return <div className=\"leave-confirm-modal\" >\n                <div className=\"toast-title\">\n                    <span>警告</span>\n                    <Icon type=\"close-circle\"  onClick={this.hide_leaveConfirmModal} />\n                </div>\n                <div className=\"text\">\n                    如果您不想结束会议<br></br>请在离开会议前指定新的主持人\n                </div>\n                <div className=\"handle\">\n                    <span className=\"leave\" onClick={this.leave}>离开会议</span><br />\n                    <span className=\"end\" onClick={() => emedia.mgr.destroyConference(confrId)}>结束会议</span>\n                </div>\n            </div>\n    }\n    leave_handle() {\n\n        let { role } = this.state.user_room;\n\n        if(role == 7) {\n            this.setState( state => ({leaveConfirmModal_show: !state.leaveConfirmModal_show}) )\n        } else {\n            let is_confirm = window.confirm('确定退出会议吗？');\n    \n            if(is_confirm){\n                this.leave()\n            }\n        }\n\n    }\n    leave(){\n        let { am_i_white_board_creator,shared_desktop } = this.state;\n        if(am_i_white_board_creator) {\n            this.emit_white_board_is_destroyed()\n            this.destroy_white_board()\n        }\n        if(shared_desktop) {\n            Modal.info({\n                title: '您还在共享桌面，请先停止共享桌面'\n            });\n            return\n        }\n\n        setTimeout(emedia.mgr.exitConference,300) // 用于发送 销毁会议的消息\n    }\n\n    publish() {\n        let { audio, video }  = this.state;\n        // video = { // 设置 video 分辨率\n        //     width: {\n        //         exact: 1280\n        //     },\n        //     height: {\n        //         exact: 720\n        //     }\n        // }\n        let constraints = { audio, video };\n        if(!audio && !video) { // mic 和 camera 都没打开， 直接publish会报错\n            constraints = { audio: true }\n        }\n\n        let _this = this;\n        (async function() {\n            try {\n                const stream = await emedia.mgr.publish(constraints);\n                notification_show('success', '发布流成功');\n                if(!audio && !video) { // getUserMedia 后再关闭音频\n                    _this.close_audio()\n                }\n            } catch (error) {\n                console.error('发布流失败',error);\n                notification_show('error', '发布流失败');\n                if(error.error == -201) {\n                    notification_show('error', '请检查摄像头或麦克风是否被允许');\n                }\n            }\n        })()\n\n    }\n    // 上麦申请\n    apply_talker() {\n\n        let { confrId } = this.state.user_room;\n        message.success('上麦申请已发出，请等待主持人同意');\n        emedia.mgr.requestToTalker(confrId)\n\n    }\n    handle_apply_talker(applicat, agreeCallback, refuseCallback) {\n\n        \n        let { memberId, nickName } = applicat; //申请者信息\n\n        if(!memberId){\n            return\n        }\n        const { confirm } = Modal;\n\n        confirm({\n            title:`是否同意${nickName || memberId}的上麦请求`,\n            onOk: () => agreeCallback(memberId, to_audience_modal), // 如果主播已满（sdk 内部测试）, to_audience_modal: 为回调函数\n            onCancel: () => refuseCallback(memberId),\n            cancelText:'拒绝',\n            okText:'同意'\n        });\n\n        let _this = this;\n        const to_audience_modal = () => { //选人下麦提示框\n\n            confirm({\n                title:'主播人数已满，请选人下麦',\n                cancelText:'取消',\n                okText:'确定',\n                onOk() {\n                    _this.to_audience_list.show(() => agreeCallback(memberId)) // 再回调一下同意上麦\n                },\n                onCancel: () => refuseCallback(memberId)\n            })\n        }\n\n    }\n    // 下麦申请\n    async apply_audience() {\n\n        let { stream_list, am_i_white_board_creator, shared_desktop } = this.state;\n        \n        if(am_i_white_board_creator){ // 白板进行中不允许下麦\n            message.warn('当前您正在共享白板，请退出白板后，再下麦');\n            return\n        }\n\n        if(stream_list.filter(item => item).length == 1){ // 过滤后 如果只有一个主播\n            message.warn('当前您是唯一主播，不允许下麦');\n            return\n        }\n        let { username:my_username } = this.state.user;\n        let { confrId } = this.state.user_room;\n\n        if(!my_username) {\n            return\n        }\n        let memName = appkey + '_' + my_username;\n\n        let _this = this;\n        Modal.confirm({\n            title: '下麦后不能发布语音视频',\n            okText: '确认下麦',\n            cancelText: '取消',\n            onOk: async () => {\n                try {\n                    await emedia.mgr.degradeRole(confrId, [memName], emedia.mgr.Role.AUDIENCE);\n                    if(shared_desktop) {\n                        _this.stop_share_desktop()\n                    }\n                } catch (error) {\n                    \n                }\n            }\n        });\n\n\n    }\n    \n    reset_state() { // 重置 state、比如下麦成功后\n        this.setState({\n            // audio:false,\n            // video:false,\n            shared_desktop:false,\n            room_setting_modal_show: false\n        })\n    }\n    admin_changed(admin) {\n\n        if(!admin) {\n            return\n        }\n        let { memberId, role } = admin;\n        let { stream_list } = this.state;\n\n        stream_list.map(item => { //遍历所有 stream_list 将这个流的role 变为主持人\n            if(item && item.member){\n                if(memberId == item.member.id) {\n                    item.member.role = role;\n                    let name = item.member.nickName || item.member.name //优先获取昵称\n                    let text = role == 7 ? '成为了主持人' : '变成了主播';\n                    message.success(name + text)\n                }\n\n            }\n        })\n\n        this.setState({ stream_list })\n\n    }\n    \n    toggle_main(index) {\n        let shared_content = this._check_has_shared();\n        if(shared_content) { // 共享桌面或者白板，不可切换大图\n            message.warn(`${shared_content == 'desktop' ? '有人在共享桌面，不可切换大图': '有人在共享白板，不可切换大图'}`);\n            return \n        }\n\n        let { stream_list } = this.state;\n        let first_item = stream_list.splice(index,1)[0];\n        stream_list.unshift(first_item);\n\n\n        this.setState({ \n            stream_list\n        }, this.move_v_els)\n    }\n    // 更新 stream by id\n    upload_stream_by_id(sId, source) { \n        // 只做一层拷贝\n        if(sId == this.state.own_stream.id) {\n\n            let own_stream = Object.assign(this.state.own_stream, source)\n            this.setState({ own_stream })\n        }\n\n\n        let { stream_list } = this.state;\n        stream_list.map(item => {\n            if(\n                item &&\n                item.stream &&\n                item.stream.id == sId\n            ) {\n                Object.assign(item.stream, source)\n            }\n        });\n\n        this.setState({ stream_list })\n    }\n    // toggle 代指关闭或开启\n    // 关闭或开启自己的\n    async toggle_video(e) {\n\n        let { role } = this.state.user_room;\n        let { own_stream } = this.state;\n        if(role == 1){\n            return\n        }\n\n        \n        if(!own_stream) {\n            return\n        }\n        \n        let { video } = this.state;\n    \n        if(video){\n            await emedia.mgr.pauseVideo(own_stream);\n            video = !video\n            this.setState({ video })\n        }else {\n            let t_el;\n            if(e) { //loading\n                t_el = e.target;\n                t_el.style.cursor = 'wait'\n            }\n            await emedia.mgr.resumeVideo(own_stream);\n\n            if(t_el) {\n                t_el.style.cursor = 'pointer'\n            }\n\n            video = !video\n            this.setState({ \n                video \n            })\n        }\n\n\n\n        let {id: sId} = own_stream;\n        this.upload_stream_by_id(sId, { voff: video ? 0 : 1})\n\n    }\n    video_change = e => {\n        this.setState({\n          video: e.target.checked,\n        });\n    };\n    async toggle_audio() {\n        let { role } = this.state.user_room;\n        let { own_stream } = this.state;\n        if(role == 1){\n            return\n        }\n\n        if(!own_stream) {\n            return\n        }\n\n        let { audio } = this.state\n        if(audio){\n            await emedia.mgr.pauseAudio(own_stream);\n            audio = !audio\n            this.setState({ audio })\n        }else {\n            await emedia.mgr.resumeAudio(own_stream);\n            audio = !audio\n            this.setState({ audio })\n        }\n    }\n\n    close_audio = async () => {\n\n        \n        let { role } = this.state.user_room;\n        let { own_stream } = this.state;\n        if(role == 1){\n            return\n        }\n        \n        if(!own_stream) {\n            return\n        }\n\n        await emedia.mgr.pauseAudio(own_stream);\n        this.setState({ audio:false })\n    }\n    open_audio = async () => {\n        let { role } = this.state.user_room;\n        let { own_stream } = this.state;\n        if(role == 1){\n            return\n        }\n\n        if(!own_stream) {\n            return\n        }\n\n        \n        await emedia.mgr.resumeAudio(own_stream);\n        this.setState({ audio: true })\n    }\n\n    audio_change = e => {\n        this.setState({\n          audio: e.target.checked,\n        });\n    };\n    \n    async share_desktop() {\n\n        let { confrId } = this.state.user_room;\n\n        try {\n            let _this = this; \n\n            var options = {\n                withAudio:true,\n                confrId,\n                stopSharedCallback: sId => _this.stop_share_desktop(sId)\n            }\n            await emedia.mgr.shareDesktopWithAudio(options);\n            this.setState({ shared_desktop:true });\n\n        } catch (err) {\n            if( //用户取消也是 -201 所以两层判断\n                err.error == -201 &&\n                err.errorMessage.indexOf('ShareDesktopExtensionNotFound') > 0\n            ){\n                message.error('请确认已安装共享桌面插件 或者是否使用的 https域名');\n            }\n        }\n    }\n\n    stop_share_desktop(sId) {\n        let { own_desktop_stream } = this.state;\n\n        if(!own_desktop_stream) return;\n\n        emedia.mgr.unpublish(own_desktop_stream);\n        \n        this.setState({ \n            shared_desktop:false,\n            own_desktop_stream: null\n        });\n    }\n    _on_stream_added(member, stream) {\n\n        if(\n            stream.type == emedia.StreamType.DESKTOP \n            && stream.located()\n        ) { // 自己的共享桌面不显示\n            this.setState({ // 保存下来，用于停止共享\n                own_desktop_stream: stream\n            })\n            return\n        }\n        if(!member || !stream) {\n            return\n        }\n\n        let { stream_list } = this.state\n\n        if(stream.located()) {//自己 publish的流，添加role 属性\n            let { role } = this.state.user_room;\n            member.role = role;\n            member.is_me = true;\n            if( stream.type != emedia.StreamType.DESKTOP ) { // 自己推的人像流（用来被控制开关摄像头）\n                this.setState({ own_stream: stream }) //用来控制流\n            }\n\n            this.setState({own_member: member})\n        }\n\n        if(stream.type == emedia.StreamType.DESKTOP) {\n            stream_list.unshift({stream,member});\n        } else if( // 将自己推的流显示到 main\n            !this._check_has_shared() // 没人在共享\n            && stream.located() \n            && !stream_list[0] \n        ) {\n            stream_list.unshift({stream,member});\n        } else {\n            stream_list.push({stream,member});\n        }\n        \n\n\n        let _this = this;\n        this.setState({ \n            stream_list:stream_list,\n            talker_list_show: true\n        },() => {\n            _this.insert_video_by_stream(member,stream);\n\n            if(stream.type == 1) { // 桌面流还要移动 位置\n                _this.move_v_els()\n            }\n\n            let { push_cdn, user_room } = _this.state;\n            if(push_cdn && user_room.isCreator){ //只有创建者 并且开启推流 可更新布局\n\n                _this.setState(state => ({ // 每次更新布局 cdn_zorder 递增1\n                    cdn_zorder: state.cdn_zorder + 1\n                }), _this._update_live_layout)\n            }\n        })\n    } \n\n    insert_video_by_stream(member,stream) {\n\n        let el = document.createElement('video');\n        el.autoplay = true;\n\n        if(stream.located() && stream.type != 1) { //自己的媒体流 镜像显示\n            el.setAttribute('is-main-media', true);\n        }\n        \n        let w_el = document.querySelector('[sid='+ stream.id +']');\n\n        let loading_el = this._get_video_loading_el();\n        w_el.appendChild(loading_el);\n\n        setTimeout(() => { // 删除 v-loading\n            let v_ls = document.querySelectorAll('.v-wrapper .loading-wrapper');\n\n            for (let index = 0; index < v_ls.length; index++) {\n                const element = v_ls[index];\n                element.parentNode.removeChild(element)\n            }\n        },1000)\n        if( stream.located() ){\n            emedia.mgr.streamBindVideo(stream, el);\n            \n            // w_el.appendChild(el)\n\n            // w_el.removeChild(loading_el)\n        }else {\n            let sub_optioon = { video: true, audio: true };\n            console.log('%c sub','color:green');\n            emedia.mgr.subscribe(member, stream, sub_optioon.video, sub_optioon.audio, el)\n            .then(() => { \n                // w_el.appendChild(el);\n                \n                // w_el.removeChild(loading_el)\n            })\n            .catch(error => {\n                console.error('订阅流失败',error);\n                notification_show('error', `订阅${member.nickName}的流失败`);\n                \n                // w_el.removeChild(loading_el)\n            });\n        }\n\n        w_el.appendChild(el);\n        this._on_media_chanaged_by_stream(el, stream)\n\n        let { subed_v_els } = this.state;\n        subed_v_els[stream.id] = el;\n        this.setState({\n            subed_v_els\n        });\n\n    }\n\n    move_v_els() {\n        // 通过原生 js， 移动 DOM 节点\n        let v_wrappers = document.querySelectorAll('.v-wrapper[sid]');\n\n        for (let index = 0; index < v_wrappers.length; index++) {\n            const v_wrapper = v_wrappers[index];\n            \n            let sId = v_wrapper.getAttribute('sid');\n            let v_el = this.state.subed_v_els[sId];\n\n            let prev_v_el = v_wrapper.querySelector('video');\n            prev_v_el ? v_wrapper.removeChild(prev_v_el) : '' // 先删除\n\n\n            v_wrapper.appendChild(v_el);\n        }\n\n    }\n\n\n    _on_stream_removed(stream) {\n        if(!stream){\n            return\n        }\n\n        let { stream_list } = this.state\n\n        stream_list.map((item, index) => {\n            if(\n                item &&\n                item.stream && \n                item.stream.id == stream.id \n            ) {\n                stream_list.splice(index, 1)\n            }\n        });\n\n        let _this = this;\n        this.setState({ stream_list },() => {\n            _this.move_v_els()\n            let { push_cdn, user_room } = _this.state;\n            if(push_cdn && user_room.isCreator){ //只有创建者 并且开启推流 可更新布局\n\n                _this.setState(state => ({ // 每次更新布局 cdn_zorder 递增1\n                    cdn_zorder: state.cdn_zorder + 1\n                }), _this._update_live_layout)\n            }\n        });\n\n        // 删除退出的流 el\n        let { subed_v_els } = this.state;\n        if(subed_v_els[stream.id]) delete subed_v_els[stream.id];\n\n        this.setState({ subed_v_els })\n    }\n    \n    // 检查是否有别人共享了桌面或者 白板\n    _check_has_shared(type) {\n\n        let { own_desktop_stream, white_board_is_created, am_i_white_board_creator } = this.state;\n        let main_stream = this.state.stream_list[0];\n\n        // 返回是共享的屏幕或者白板，可区分\n        if(!type) { // type 没值，就是不是图标状态的变化\n            if(own_desktop_stream) { // 自己共享的屏幕\n                return 'desktop'\n            }\n\n            if( // 有人在共享桌面\n                main_stream \n                && main_stream.stream \n                && main_stream.stream.type == 1\n            ) {\n                return 'desktop'\n            }\n      \n            if(white_board_is_created) { return 'white-board' } // 有人共享白板\n\n            return false\n        } else { // 就是图标状态 需要检测是否自己共享的白板或者屏幕\n            // 当有type 时, 是操作按钮的显示状态，需要判断是否是自己共享的桌面 或者 创建的白板\n            // type， desktop: 共享桌面，white-board: 白板\n            // 如果是自己共享的 需要停止共享 return false\n            // 只检测不可点击状态 \n\n            let check = false;\n\n            if(\n                type == 'desktop'\n            ) { // 有人共享白板，别人共享屏幕 \n                if( white_board_is_created ) check = 'white-board';\n                if (\n                    main_stream \n                    && main_stream.stream \n                    && main_stream.stream.type == 1\n                ) check = 'desktop';\n            }\n            \n            if( type == 'white-board' ) {\n                if(\n                    own_desktop_stream \n                    || (\n                        main_stream \n                        && main_stream.stream \n                        && main_stream.stream.type == 1\n                    )\n                ) check = 'desktop'; // 有人共享屏幕\n                if (white_board_is_created && !am_i_white_board_creator) { //  别人共享白板\n                    check = 'white-board'\n                }\n            }\n\n            return check\n\n        }\n\n        \n    }\n\n    //监听音视频变化\n    _on_media_chanaged_by_stream(el, stream) {\n\n        // 音视频变化，触发 setState stream_list\n         this.set_stream_item_changed = (constaints, id) => {\n\n            if(!id || !constaints) {\n                return\n            }\n\n            let { stream_list } = this.state\n            let { aoff, voff } = constaints\n            stream_list = stream_list.map(item => {\n                if(\n                    item &&\n                    item.stream &&\n                    item.stream.id == id\n                ){\n                    item.stream.aoff = aoff\n                    item.stream.voff = voff\n                }\n\n                return item\n            })\n\n            this.setState({ stream_list })\n        }\n\n        // 有人在说话处理流 status: is_speak 在说话、no_speak 没说话\n        this.sound_chanaged = (id, volume) => { \n\n            if(!id) {\n                return\n            }\n\n            let { stream_list } = this.state;\n\n            stream_list = stream_list.map(item => {\n                if(\n                    item &&\n                    item.stream &&\n                    item.stream.id == id\n                ){\n                    item.stream.volume = volume\n                }\n\n                return item\n            })\n\n            this.setState({ stream_list })\n        }\n        let _this = this;\n        \n        // 监听音视频的开关\n        emedia.mgr.onMediaChanaged(el, function (constaints, stream) {\n            _this.set_stream_item_changed(constaints, stream.id)\n        });\n\n        process.env.NODE_ENV == 'development' ? '' : \n        // 监听谁在说话\n        // 函数触发，就证明有人说话 拿 stream_id\n        emedia.mgr.onSoundChanaged(el, function (meterData, stream) {\n            let { instant } = meterData;\n\n            let one_unit_pic = 0.15/14; // 音量（instant）high 为 0.25，也就是图片显示为14\n\n            let volume = Math.round(instant/one_unit_pic);\n            volume = volume > 14 ? 14 : volume; \n\n\n            let prev_volumes = _this.state.prev_volumes;\n            if(prev_volumes[stream.id] != volume ) { // 避免每次 setState\n                _this.sound_chanaged(stream.id, volume);\n                prev_volumes[stream.id] != volume\n                _this.setState({\n                    prev_volumes\n                })\n            }\n        });\n\n    }\n\n    // 推流 CDN 更新布局 九宫格布局\n    _update_live_layout() {\n\n            let { stream_list } = this.state;\n\n            let _this = this;\n\n            // 根据流的数据 计算应该排几行几列\n            const get_layout_info = () => {\n\n                let streamcounts = 0; //获取 stream 的个数\n                let { stream_list } = _this.state;\n                stream_list.map(item => { // 过滤到空项\n                    if(item) {\n                        streamcounts++ \n                    }\n                })\n\n\n                // 九宫格设计\n                // 根据个数开方求列\n                // 根据个数除以 列数求行数\n                // 都是向上取整\n    \n                let col_num = Math.ceil( Math.sqrt(streamcounts) );// 获取列数\n                let row_num = Math.ceil( streamcounts/col_num );// 获取行数\n    \n                // 计算每个流占据的尺寸\n                let { liveCfg } = _this.state;\n                let { w: canvas_width, h: canvas_height } = liveCfg.canvas; //获取画布的尺寸\n                \n                let cell_width = parseInt(canvas_width/col_num);\n                let cell_height = parseInt(canvas_height/row_num);\n\n                let layout_info = {\n                    col_num,\n                    row_num,\n                    cell_width,\n                    cell_height,\n                }\n                return layout_info\n\n            }\n\n            // 根据在画布中 是第几个流 拿到position\n            const get_position_in_canvas = (index, layout_info) => {\n                let position = {\n                    x:0,\n                    y:0\n                }\n\n\n                // 计算在 第几行第几列\n                let {\n                    col_num,\n                    cell_width,\n                    cell_height,\n                } = layout_info;\n\n                let position_row = Math.ceil(index/col_num);\n                let position_col = index%col_num;\n\n                if(position_col == 0) {\n                    position_col += col_num\n                }\n                // 根据第几行第几列计算 x、y\n                position.x = cell_width * (position_col - 1);\n                position.y = cell_height * (position_row - 1);\n\n\n                return position\n            }\n\n\n            let layout_info = get_layout_info();\n\n            let regions = [];\n            let index = 0;//在画布中的第几个流\n            let { cdn_zorder } = this.state;\n\n            stream_list.map(item => {\n                if(item){\n                    index ++;\n                    let position = get_position_in_canvas(index, layout_info);\n\n                    let { id: stream_id } = item.stream;\n                    regions.push({\n                        \"sid\": stream_id,\n                        \"x\": position.x,\n                        \"y\": position.y,\n                        \"z\": cdn_zorder,\n                        \"w\": layout_info.cell_width,\n                        \"h\": layout_info.cell_height,\n                        \"style\": \"AspectFit\"\n                    })\n                }\n            })\n\n            let { confrId } = this.state.user_room;\n            let { liveCfgs } = emedia.config;\n            if(liveCfgs && liveCfgs[0]) emedia.mgr.updateLiveLayout(confrId, liveCfgs[0].id, regions);\n    }\n    _get_header_el() { \n\n        let { roomName, own_stream } = this.state;\n\n        return (\n            <div className=\"header-wrapper\">\n                <img className='logo' src={get_img_url_by_name('logo-text-room')}/>\n                <div className=\"name-wrapper\">\n                    <div className=\"name\">{roomName || '房间名称'}</div>\n                    <div className=\"time\">{this._get_tick()}</div>\n                </div>\n\n                <div className='leave-action-wrapper'>\n                    \n                    { own_stream ? \n                        <div className=\"network-icon\">\n                            <NetworkStatus network_status={own_stream.network_status} />\n                        </div> : ''\n                    }\n                    \n                    <div onClick={this.leave_handle} className=\"leave-action\">\n                        <img src={get_img_url_by_name('leave-icon')} />\n                        <span>离开会议</span>\n                    </div>\n\n                    <Exc_feed />\n                </div>\n            </div>\n        )\n    }\n\n    \n    // 视频关闭的显示框，不直接显示 video 是个黑框\n    // type: 区分 main画面和talker-list， 默认不显示admin 标志和 名字（因为talker-list 上面有）\n    _voff_show(stream, type) {\n\n        if(!stream) {\n            return <div className=\"voff-show\"></div>\n        }\n\n        let { ext } = stream.member;\n        if( !ext || !ext.headImage ) {\n            return <div className=\"voff-show\"></div>\n        }\n\n        let base_url = 'https://download-sdk.oss-cn-beijing.aliyuncs.com/downloads/RtcDemo/headImage/';\n        return <div className=\"voff-show\">\n                    <div className=\"avatar-wrapper\">\n                        <img className='avatar' src={ base_url + ext.headImage }/>\n                        {/* 只在main 画面显示 */}\n                        { type == 'main' ? \n                            <div className='nick-name'> \n                                { get_nickname(stream.member) } \n                                { stream.member.role == 7 ? <img src={ get_img_url_by_name('admin-icon') }/> : ''}\n                            </div> : ''\n                        }\n                    </div>\n                </div>\n                \n    }\n\n    // get loading el\n    _get_video_loading_el() {\n\n        let el = document.createElement('div')\n        el.classList.add('loading-wrapper');\n\n\n        let children = [\n            `<div class=\"loading\">\n                <div class=\"circle circle1\">\n                    <span></span>\n                    <span></span>\n                    <span></span>\n                    <span></span>\n                </div>\n                <div class=\"circle circle2\">\n                    <span></span>\n                    <span></span>\n                    <span></span>\n                    <span></span>\n                </div>\n                <div class=\"circle circle3\">\n                    <span></span>\n                    <span></span>\n                    <span></span>\n                    <span></span>\n                </div>\n            </div>`\n        ]\n\n        el.innerHTML = children;\n        return el\n    }\n\n    // 主播列表滚动 \n    // 更新订阅，不可见的只订阅音频\n    talker_list_scroll(fun, wait) {\n        // 当画面不可见时，重新订阅（只订阅音频）\n        let timer;\n        let _this = this;\n\n        return function() {\n            // 获取需要更新的video元素\n            let els = document.querySelectorAll('.talker-list-wrapper video');\n\n            const prev_not_visible = sid => {\n                let { not_visible_arr } = _this.state;\n                if(not_visible_arr.indexOf(sid) > -1) {\n                    // 上次是不可见\n\n                    return true\n                }\n\n                return false\n            }\n\n            const getItemBySid = sid => { // 获取 stream 和 member\n                if(!sid) {\n                    return null\n                }\n    \n                let result = null\n                _this.state.stream_list.map(item => {\n                    if(\n                        item\n                        && item.member\n                        && item.stream\n                        && item.stream.id == sid\n                    ) {\n                        result = item\n                    }\n                })\n    \n                return result\n            }\n\n            for (let index = 0; index < els.length; index++) {\n\n                const element = els[index];\n\n\n                let par_node = element.parentNode;\n                let sid = element.getAttribute('hx_stream');\n\n                let item = getItemBySid(sid);\n\n                if(item.stream.voff) { continue }; //不添加\n\n                if(\n                    !_this.talker_is_not_visble(element)\n                    && prev_not_visible(sid)\n                ) { \n                    if(!par_node.querySelector('.loading-wrapper')) {\n                        par_node.appendChild(_this._get_video_loading_el());\n                    } \n                } else {\n                    let loading_el = par_node.querySelector('.loading-wrapper');\n                    loading_el ? par_node.removeChild(loading_el) : '';\n                }\n\n            }\n            \n            \n                if(timer) clearTimeout(timer);\n\n                timer = setTimeout(fun, wait)\n        }\n    }\n    // 主播列表滚动 停止\n    // 更新订阅，不可见的只订阅音频\n    talker_list_scroll_stop() {\n        \n        \n        // 当画面不可见时，重新订阅（只订阅音频）\n\n        // 获取需要更新的video元素\n        let els = document.querySelectorAll('.talker-list-wrapper video');\n\n        let _this = this;\n        const getItemBySid = sid => { // 获取 stream 和 member\n            if(!sid) {\n                return null\n            }\n\n            let result = null\n            _this.state.stream_list.map(item => {\n                if(\n                    item\n                    && item.member\n                    && item.stream\n                    && item.stream.id == sid\n                ) {\n                    result = item\n                }\n            })\n\n            return result\n        }\n\n        const visible_change = (sid, type) => { \n\n            let { not_visible_arr } = _this.state;\n            // 存储一个不可见 arr\n            if(type == 'not-visible' && not_visible_arr.indexOf(sid) > -1) {\n                // 上次也是不可见\n\n                return false\n            }\n\n            if(type == 'not-visible' && not_visible_arr.indexOf(sid) == -1) {\n                // 上次可见 或者首次\n                not_visible_arr.push(sid);\n\n                _this.setState({ not_visible_arr })\n                return true\n            }\n\n            if(type == 'visible' && not_visible_arr.indexOf(sid) > -1) {\n                // 上次是不可见, 这次是可见，从不可见剔除出来\n                let index = not_visible_arr.indexOf(sid);\n                not_visible_arr.splice(index, 1)\n\n                _this.setState({ not_visible_arr })\n                return true\n            }\n\n            if(type == 'visible' && not_visible_arr.indexOf(sid) == -1) {\n                // 上次是可见, 这次也是可见，不做处理\n                \n                return false\n            }\n\n        }\n\n        const del_loading = par_node => { // 删除loading el\n            \n            let loading_el = par_node.querySelector('.loading-wrapper');\n            loading_el ? par_node.removeChild(loading_el) : '';\n        }\n\n        for (let index = 0; index < els.length; index++) {\n\n            const element = els[index];\n\n            let sid = element.getAttribute('hx_stream');\n            if(!sid) { continue };\n            \n            let item = getItemBySid(sid);\n\n            if(item.stream.voff) { continue }; // 没开视频，不管都订阅，不影响性能\n            if(item.stream.located()) { continue }; // 自己的不做任何处理\n\n\n            let par_node = element.parentNode;\n            del_loading(par_node);       \n\n            if(this.talker_is_not_visble(element)) {\n                \n                if(visible_change(sid, 'not-visible')) {// 检测可见行是否变化\n                    // 不订阅视频\n                    // emedia.mgr.subscribe(item.member, item.stream, false, true, element)\n                    emedia.useCurrentXService.subscribe(item.stream.id, {subSVideo: false, subSAudio: true})\n                    \n                } \n            } else { // 恢复订阅视频\n                if(visible_change(sid, 'visible')) { \n                    // emedia.mgr.subscribe(item.member, item.stream, false, true, element)\n                    emedia.useCurrentXService.subscribe(item.stream.id, {subSVideo: true, subSAudio: true})\n                    \n                }\n            }\n\n            \n        }\n\n\n        \n    }\n\n    // 主播列表内主播是否可见\n    talker_is_not_visble(element) {\n        let body_height = document.body.getBoundingClientRect().height;\n        let el_height = document.querySelectorAll('.talker-list-wrapper .v-wrapper')[0].getBoundingClientRect().height;\n        let footer_height = document.querySelector('footer').getBoundingClientRect().height;\n\n        let top = element.getBoundingClientRect().top;\n\n        if(top >= (body_height-footer_height )) { // top 比(容器 - 底部栏高度 )还高，说明在容器下面\n            return true\n        }\n\n        // 在上面 往上滑 125：是第一个可见的 video 的位置 滑出去了看不见了\n        if(top < 125 && Math.abs(top - 125) > el_height) {\n            return true\n        }\n\n        return false // 介于 125 ~ boby_height 之间的为可见\n\n    }\n\n\n    // 视频列表\n    _get_drawer_component() {\n\n        let _this = this;\n        let { stream_list, talker_list_show } = this.state;\n        let { role } = this.state.user_room;\n\n        function get_talkers() {\n            let talkers = 0;\n            let { stream_list } = _this.state;\n            stream_list.map(item => {\n                if(\n                    item &&\n                    item.stream &&\n                    item.stream.type != emedia.StreamType.DESKTOP\n                ){ //null 的不计数 共享桌面不计数\n                    talkers++\n                }\n            })\n            return talkers\n        }\n\n        return  <div className=\"talker-list-placeholder\">\n                    <div \n                        className=\"talker-list-wrapper\" \n                        style={talker_list_show ? {} : {transform: 'translateX(calc(100% + 10px))'}}\n                    >\n                        <div className=\"control-btn\" onClick={this.control_talker_list}>\n                            <img \n                                src={get_img_url_by_name('expand-icon')} \n                                style={ talker_list_show ? {transform: 'rotateY(180deg)'} : {} }\n                            />\n                        </div>\n                        <div className=\"header\">\n                            参会人数 {get_talkers()}\n                            { role == 7 ? <MuteAction {...this.state}/> : ''}\n                        </div>\n                        <div className=\"content\"\n                            onScroll={this.talker_list_scroll}\n                        >\n                            { stream_list.map((item, index) => {\n\n                                if(index != 0 && item){ // 不渲染主画面， 0位置：代表的主页面\n                                    return _this._get_video_item(item,index);\n                                }\n                            }) }\n                        </div>\n                    </div>\n                </div>\n    }\n    \n    _get_main_el() {\n        let main_stream = this.state.stream_list[0];\n\n        if(main_stream) {\n            let { volume, type, voff, aoff } = main_stream.stream; //volume 说话音量\n\n            return (\n                <div className=\"main-video-wrapper v-wrapper\" sid={main_stream.stream.id} >\n                    \n                    {type == 1 ? '' :\n                     aoff ? \n                        <img src={get_img_url_by_name('micro-is-close-icon')} className='is-speak-icon'/> : \n                        <img src={get_img_url_by_name('volume-' + (volume || 0))} className='is-speak-icon'/>\n                    }\n                    { voff ? this._voff_show(main_stream, 'main') :'' } {/* 覆盖到 video上, 不能替换否则 stream 丢失*/}\n                    \n                </div>\n            )\n        }\n\n        return <i></i>\n    }\n    _get_video_item(talker_item,index) {\n\n        let { stream, member } = talker_item;\n        if(\n            !stream ||\n            !member ||\n            Object.keys(stream).length == 0 ||\n            Object.keys(member).length == 0 \n        ) {\n            return ''\n        }\n\n        let { id, aoff, volume, type, voff } = stream;\n        let { role, is_me } = member;\n        let { role:my_role } = this.state.user_room;//拿到我自己的角色\n        let { username:my_username } = this.state.user;//拿到我自己的username\n        let { user_room } = this.state\n        \n        let nickName = get_nickname(member);\n\n\n        return (\n            <div \n                key={id} \n                className=\"item v-wrapper\"\n                sid={stream.id}\n                onDoubleClick={ () => this.toggle_main(index) } //mian 图不需要点击事件，所以不传index÷\n            >\n\n                <div className=\"info\">\n                    <span className=\"name\">\n                        { nickName + (is_me ? '(我)' : '')}\n                    </span>\n\n                    {/* <img src={get_img_url_by_name('no-speak-icon')}/> */}\n                    {/* \n                     * 对方没有开启音频 显示audio-is-close-icon\n                     * 对方开启音频 不说话 不显示图标\n                     * 对方开启音频 在说话 显示volume-icon\n                     */}\n                    <div className=\"status-icon\"> \n                        <div className=\"network-icon\">\n                            <NetworkStatus network_status={stream.network_status} />\n                        </div>\n                        { role == 7 ? <img className='admin' src={ get_img_url_by_name('admin-small-icon') }/> : ''}\n                        {\n                            aoff ? \n                            <img src={get_img_url_by_name('micro-is-close-icon')} /> : \n                            <img src={get_img_url_by_name('volume-'+(volume || 0))} />\n                        }\n                        \n                    </div>\n                </div>\n                { voff ? this._voff_show(talker_item) :'' }\n\n                {/* <video ref={`list-video-${id}`} autoPlay></video> */}\n                {/* 不是主持人 并且不是主持人自己 并且流不是共享桌面 才加载 */}\n                { \n                    (my_role == 7 && !is_me && type != emedia.StreamType.DESKTOP) ? \n                        <ManageTalker { ...{stream, member, my_username, user_room} } /> : '' \n                } \n            </div>\n        )\n\n                            \n    }\n\n    _get_action_el() {\n        let { role } = this.state.user_room\n\n        let { \n                audio,\n                video, \n                shared_desktop,\n                room_setting_modal_show,\n                roomName,\n                own_member,\n                join_as_audience,\n                nickName\n            } = this.state\n        \n\n        let icons = { // 图标的样式和动作\n            micro:{\n                icon_index: 'audio'\n            },\n            camera: {\n                icon_index: 'video'\n            },\n            change_role: {\n                icon_index: 'role'\n            }, \n            share_desktop: {\n                icon_index: 'shared_desktop'\n            },\n            share_white_board: {\n                icon_index: 'white_board_is_created'\n            },\n            invitees: {\n                icon_index: 'invitees'\n            },\n            seeting: {\n                icon_index: ''\n            }\n        }\n        \n        let shared_content = this._check_has_shared('desktop');\n\n        return (\n                \n                <div className=\"actions\">\n                    <div className=\"wrapper\">\n                        <img \n                            className={role == 1 ? 'disabled' : '' } \n                            src={\n                                role == 1 ? \n                                get_img_url_by_name('micro-is-close-icon') :\n\n                                audio ? get_img_url_by_name('micro-is-open-icon') : \n                                get_img_url_by_name('micro-is-close-icon')} \n\n                             onClick={() => this.toggle_audio()}\n                        />\n                        <span className=\"text\">{role == 1 ? '解除静音': audio ? '静音' : '解除静音'}</span>\n                    </div>\n                    <div className=\"wrapper\">\n                        <img \n                            className={role == 1 ? 'disabled' : '' } \n                            src={\n                                role == 1 ?\n                                get_img_url_by_name('video-is-close-icon') :\n\n                                video ? get_img_url_by_name('video-is-open-icon') : \n                                get_img_url_by_name('video-is-close-icon')} \n\n                             onClick={(e) => this.toggle_video(e)}\n                        />\n                        <span className=\"text\">{role == 1 ? '开启视频': video ? '关闭视频' : '开启视频'}</span>\n                    </div>\n                    {/* 只有以观众进入的才展示 上下麦按钮 */}\n                    { join_as_audience ? \n                        <div className=\"wrapper\">\n                            { role == 1 ? \n                                <img \n                                    src={get_img_url_by_name('apply-to-talker-icon')} \n                                    onClick={() => this.apply_talker()}\n                                /> :\n                                <img \n                                    src={get_img_url_by_name('apply-to-audience-icon')} \n                                    onClick={() => this.apply_audience()}\n                                /> \n                            }\n                            <span>{ role == 1 ? '上麦' : '下麦' }</span>\n                        </div>\n                        : ''\n                    }\n\n                    { this.get_white_board_action_btn() }\n                    \n                    <div className=\"wrapper\">\n                        <img \n                            src={get_img_url_by_name('invite-icon')} \n                            onClick={() => inviteModal({\n                                roomName, \n                                invitees: nickName\n                            })}\n                        />\n                        <span>邀请他人</span>\n                    </div>\n                    <div className=\"wrapper\">\n                        {\n                            role == 1 ? (\n                                <Tooltip title='观众不可共享桌面'>\n                                    <img \n                                        src={get_img_url_by_name('share-desktop-icon')} \n                                        style={{opacity:'0.7', cursor:'not-allowed'}}\n                                    />\n                                </Tooltip>\n                            ) :\n\n                            shared_content ? \n                            <Tooltip title={ shared_content == 'desktop' ? \n                                            '有人在共享桌面，不可再共享桌面': '有人在共享白板，不可再共享桌面'}>\n                                <img \n                                    src={get_img_url_by_name('share-desktop-icon')} \n                                    style={{opacity:'0.7', cursor:'not-allowed'}}\n                                />\n                            </Tooltip> :\n                            shared_desktop ? \n                                <img \n                                    src={get_img_url_by_name('stop-share-desktop-icon')} \n                                    onClick={() => this.stop_share_desktop()}\n                                /> :\n                                <img \n                                    src={get_img_url_by_name('share-desktop-icon')} \n                                    onClick={() => this.share_desktop()}\n                                />\n                        }\n                        <span>{shared_desktop? '停止共享' : '共享桌面'}</span>\n                    </div>\n                    <div className=\"wrapper\">\n                        <img \n                            src={ room_setting_modal_show ? \n                                    get_img_url_by_name('room-setting-open-icon') : \n                                    get_img_url_by_name('room-setting-close-icon')\n                                } \n                            onClick={() => this.toggle_room_setting_modal()}\n                        /> \n                        <span>会议信息</span>\n                    </div>\n                    \n\n                </div>\n        )\n    }\n    // toggle 会议信息 modal\n    toggle_room_setting_modal() {\n        let { room_setting_modal_show } = this.state;\n\n        this.setState({\n            room_setting_modal_show: !room_setting_modal_show\n        })\n    }\n\n\n    // 白板相关的方法\n    // 获取发起白板的操作按钮\n    get_white_board_action_btn() {\n\n        let { \n            use_white_board,\n            white_board_is_created,\n        } = this.state;\n\n        if(!use_white_board) { // 不启用白板\n            return ''\n        }\n        \n        let { role } = this.state.user_room;\n        if( role == emedia.mgr.Role.AUDIENCE) { // 观众不能启用 \n            return ''\n        }\n        let shared_content = this._check_has_shared('white-board');\n\n        if(shared_content)\n        { \n            return <div className=\"wrapper\">\n                        <Tooltip title={ shared_content == 'desktop' ? \n                                            '有人在共享桌面，不可再发起白板': '有人在共享白板，不可再发起白板'}>\n                            <img \n                                src={get_img_url_by_name('join-white-board-icon')} \n                                style={{opacity:'0.7', cursor:'not-allowed'}}\n                            />\n                        </Tooltip>\n                        <span>发起白板</span>\n                </div>\n        }\n\n        // 白板没有创建，都能发起白板\n        if(!white_board_is_created) {\n            return <div className=\"wrapper\">\n                        <img \n                            src={get_img_url_by_name('join-white-board-icon')} \n                            onClick={() => this.create_white_board()}\n                        />\n                        <span>发起白板</span>\n                    </div>\n        }\n\n        return <div className=\"wrapper\">\n                    <img \n                        src={get_img_url_by_name('destory-white-board-icon')} \n                        onClick={() => this.confirm_destory_white_board()}\n                    />\n                    <span>退出白板</span>\n                </div>\n\n\n                \n        \n    }\n    // 获取白板的操作界面\n    get_white_board_content_el() {\n        let { \n            white_board_is_created, \n            white_board_url\n        } = this.state; //白板相关\n\n        if( !white_board_is_created ) {\n            return ''\n        }\n\n        \n        // 如果是 https 协议，将返回的路径 协议名替换为 https 否则 iframe报错（不同协议）\n        // 返回的是 http 协议\n        if(location.protocol == 'https:') {\n            white_board_url = white_board_url.replace(/http:\\/\\//g,'https://')\n        }\n\n        \n        return <iframe \n                name=\"white-board\" \n                src={ white_board_url } \n               >\n            </iframe>\n    }\n    // 白板创建成功 在会议中进行广播\n    emit_white_board_is_created() {\n\n        let { username:creator } = this.state.user;\n\n        let { roomName } = this.state;\n\n        let options = {\n            key:'whiteBoard',\n            val:JSON.stringify({\n                creator, \n                roomName,\n                roomPswd: roomName, // 房间密码和名称一样\n                timestamp: new Date().getTime() \n            })\n        }\n        \n        emedia.mgr.setConferenceAttrs(options)\n    }\n    // 白板销毁成功 在会议中进行广播\n    emit_white_board_is_destroyed() {\n        \n        emedia.mgr.deleteConferenceAttrs({\n            key:'whiteBoard'\n        })\n    }\n    \n    create_white_board() {\n        let { roomName } = this.state;\n        let { username:userName, token } = this.state.user;\n\n        let _this = this;\n        let params = {\n            roomName,\n            password: roomName, // 房间名称和密码一样\n            userName,\n            token,\n\n            suc: (res) => {\n                let white_board_url =  res.whiteBoardUrl; //为白板房间地址\n                \n                _this.setState({\n                    white_board_url,\n                    white_board_is_created: true,\n                    am_i_white_board_creator: true,\n                    talker_list_show: true,\n\n\n                    // main_loading: false,\n                    // main_loading_text: ''\n                    \n                })\n                message.success('创建白板成功');\n                _this.emit_white_board_is_created()\n                _this.set_main_stream_to_talker_list()\n\n                this.setState({\n                    white_board_info: res\n                })\n            },\n            error: (error) => {\n                message.error(error)\n            },\n        }\n\n        this.setState({\n            main_loading: true,\n            main_loading_text: '正在创建白板...'\n        })\n        this.white_board.join(params)\n\n    }\n \n    // 加入白板\n    join_white_board() {\n        let { join_white_board_params } = this.state;\n\n        if(!join_white_board_params) {\n            return\n        }\n\n        let _this = this;\n        this.white_board.join({\n            ...join_white_board_params,\n            suc: function(res){\n                let white_board_url =  res.whiteBoardUrl; //为白板房间地址\n                _this.setState({\n                    white_board_url,\n                    white_board_is_created: true,\n                })\n                message.success('加入白板成功')\n                _this.set_main_stream_to_talker_list()\n            },\n            error: function(err){\n                console.log(\"加入白板失败\", err);\n\n            }\n        })\n\n    }\n\n    // 白板加入成功，将mian 画面挤到列表\n    set_main_stream_to_talker_list() {\n        let { stream_list } = this.state;\n        stream_list.unshift(null)\n\n        this.setState({\n            stream_list\n        }, this.move_v_els)\n    }\n    // confirm destory_white_board\n    confirm_destory_white_board() {\n        toast({\n            onOk: this.destroy_white_board.bind(this)\n        });\n    }\n    // 销毁白板\n    destroy_white_board() {\n\n        let { white_board_info } = this.state;\n\n        if(!white_board_info) {\n            return\n        }\n\n        let { roomId } = white_board_info;\n        let { username: userName, token } = this.state.user;\n\n        this.setState({\n            main_loading: true,\n            main_loading_text: '正在销毁白板...'\n        })\n        let _this = this;\n        this.white_board.destroy({\n            roomId,\n            userName,\n            token,\n            suc: function(data){\n\n                message.success('已经退出了白板');\n                _this.setState({ \n                    white_board_is_created: false,\n                    am_i_white_board_creator: false,\n\n                    main_loading: false,\n                    main_loading_text: ''\n                });// 默认不显示\n                _this.emit_white_board_is_destroyed()\n            },\n            error: function(err){\n                message.error('退出白板失败');\n            }\n        });\n        \n    }\n\n    control_talker_list = () => {\n        this.setState(state => ({ talker_list_show: !state.talker_list_show }) )\n    }\n    \n    startTime() {\n        let _this = this;\n        this.timeID = setInterval(\n            () => {\n                _this.setState(state => ({\n                    time:state.time + 1\n                }))\n            },\n            1000\n        )\n    }\n    _get_tick() { // 会议时间\n        let { time } = this.state\n\n        function get_second(second){\n            return second<10 ? ('0'+second) : second\n        }\n        function get_minute(minute){\n            return minute<10 ? ('0'+minute) : minute\n        }\n        let time_str = ''\n        if(time < 60){\n            time_str = '00:' + get_second(time)\n        }else if(time >= 60){\n            let minute = get_minute(parseInt(time/60));\n            let surplus_second = get_second(time%60)\n            time_str = minute +':'+ surplus_second\n        }\n        return time_str\n    }\n\n    close_talker_model = () => {\n        this.setState({\n            talker_is_full: false\n        })\n    }\n\n    // loading 状态 --- 白板、退出。。。\n    _get_loading_el() {\n\n        let {\n            main_loading,\n            main_loading_text\n        } = this.state;\n\n        if(main_loading) {\n            return <div className=\"main-loading-wrapper\">\n                        <Spin tip={main_loading_text}> </Spin>\n                    </div>\n        }\n\n        return ''\n    }\n    render() {\n\n        const { getFieldDecorator } = this.props.form;\n\n        let { joined } = this.state;\n        let { role } = this.state.user_room;\n\n        let { \n            audio,\n            video, \n            nickName, \n            headimg_url_suffix,\n            roomName,\n            talker_full_btn_disable,\n            shared_desktop,\n            join_btn_disable\n        } = this.state;\n\n        return (\n            <div style={{width:'100%', height:'100%'}}>\n\n                {/* join compoent */}\n                <div \n                    className=\"login-wrap\" \n                    style={{\n                        display: joined ? 'none' : 'flex',\n                        background: \"url(\"+ get_img_url_by_name('login-bg') +\")\",\n                        backgroundSize: 'cover'\n                    }}\n                >\n                    {\n                        join_btn_disable ? <Alert message=\"为了最佳使用体验，请使用chrome浏览器\" type=\"warning\" closable/> : ''\n                    }\n                    <div className=\"header\">\n                        <img src={get_img_url_by_name('logo-text-login')} />\n                    </div>\n                    <Form className=\"login-form\" onSubmit={this.join_handle}>\n                        <img \n                            src={get_img_url_by_name('setting-icon')}\n                            className=\"setting-handle\" \n                            onClick={() => this.setting_modal.show()}\n                        /> \n                            \n                        <img src={get_img_url_by_name('logo')} />\n                        <div className='app-name'>环信视频会议</div>\n                        \n                        <Item>\n                            {getFieldDecorator('roomName', {\n                                initialValue: roomName || process.env.REACT_APP_ROOMNAME,\n                                rules: [\n                                    { required: true, message: '请输入会议名称' },\n                                    { min:3 , message: '会议名称不能少于3位'},\n                                    { pattern: /^[\\u4e00-\\u9fa5\\w-]*$/, message: '请输入中文、英文、数字、减号或下划线'},\n                                ],\n                                \n                            })(\n                                <Input\n                                    prefix={<Icon type=\"home\" style={{ color: 'rgba(0,0,0,.25)' }} />}\n                                    placeholder=\"会议名称\"\n                                    maxLength={18}\n                                    autoComplete=\"off\"\n                                />\n                            )}\n                            \n                        </Item>\n                        <Item>\n                        {getFieldDecorator('nickName', {\n                                initialValue: nickName || '',\n                                rules: [\n                                    { required: true, message: '请输入您的昵称' },\n                                ],\n                                \n                            })(\n                                <Input\n                                prefix={<Icon type=\"user\" style={{ color: 'rgba(0,0,0,.25)' }} />}\n                                placeholder=\"请输入您的昵称\"\n                                autoComplete=\"off\"\n                                />\n                            )}\n                            \n                        </Item>\n                        <div className='control-contraints'>\n                            {getFieldDecorator('video', {\n                                valuePropName:'checked',\n                                initialValue: video\n                            })( <Checkbox >打开摄像头</Checkbox> )}\n                            {getFieldDecorator('audio', {\n                                valuePropName:'checked',\n                                initialValue: audio\n                            })( <Checkbox >打开麦克风</Checkbox> )}\n                            \n                        </div>\n                        <div className=\"action\">\n                            <Button \n                                type=\"primary\"  \n                                htmlType=\"submit\"\n                                onClick={this.join_handle}\n                                loading={this.state.loading}\n                                style={{width:'100%'}}\n                                disabled={join_btn_disable}\n                            >\n                                加入会议\n                            </Button>\n                            <div className='info-tips'>\n                                <Icon type=\"info-circle\" /> \n                                不用创建会议，初次加入则自动创建\n                            </div>\n                        </div>\n                        <div className='version-text'>Version:{version}</div>\n                    </Form>\n                \n                    {/* 主播人数已满提醒框 */}\n                    <Modal\n                        visible={this.state.talker_is_full}\n                        closable={false}\n                        onOk={() => this.talker_is_full_handle()}\n                        onCancel={this.close_talker_model}\n                        okText=\"以观众身份登录\"\n                        cancelText=\"暂不登录\"\n                        centered={true}\n                        mask={false}\n                        maskClosable={false}\n                        width='470px'\n                        className=\"talker-is-full-modal\"\n\n                        okButtonProps={{disabled: talker_full_btn_disable}}\n                        cancelButtonProps={{disabled: talker_full_btn_disable}}\n                    >\n                        <div>\n                            <img src={get_img_url_by_name('warning-icon')}/>\n                        </div>\n                        <div>主播人数已满<br></br>是否以观众身份进入？</div>\n                    </Modal>\n\n                    {/* 设置框 */}\n                    <Setting \n                        { ...{audio, video, nickName, headimg_url_suffix} }\n                        _get_setting_values={this._get_setting_values} \n                        // is_localStorage_nickName_admin={this.state.is_localStorage_nickName_admin}\n                        ref={setting_modal => this.setting_modal = setting_modal} />\n\n                </div>\n                \n                {/* room compoent */}\n                \n                <Layout className=\"meeting\" style={{display: joined ? 'block' : 'none'}}>\n                    <Header>\n                        {this._get_header_el()}\n                    </Header>\n\n                    {/* 白板的iframe  */}\n                    <Content>\n                        { this._get_loading_el()}\n                        { this.get_white_board_content_el() }\n                        {this._get_main_el()}\n                    </Content>\n                    \n                    {this._get_drawer_component()}\n                    <Footer>\n                        {this._get_action_el()}\n                        <RoomSetting {...this.state} toggle_room_setting_modal={this.toggle_room_setting_modal}/>\n                    </Footer>\n                    {/* 退出确认框 */}\n                    { this.get_leaveConfirmModal() }\n                    {/* 左侧选人下麦框 */}\n                    {\n                        role == 7 ?\n                        <ToAudienceList {...this.state} ref={to_audience_list => this.to_audience_list = to_audience_list}/> :\n                        <i></i>\n                    }\n\n                    {/* electorn 选择屏幕的插件 */}\n                    {\n                        emedia.isElectron ? \n                        <ChooseDesktopMedia  \n                            ref={choose_desktop_media => this.choose_desktop_media = choose_desktop_media } />\n                        : ''\n                    }\n\n                { shared_desktop ? \n                    <Alert \n                        className='shared-desktop-alert' \n                        message=\"您正在共享桌面\" \n                        type=\"info\"\n                        showIcon\n                    /> : ''}\n                </Layout>\n            </div>\n        )\n    }\n}\nconst WrapRoom = Form.create()(Room)\nexport default WrapRoom\n\n\n","import React, {Component} from 'react'\nimport {\n  HashRouter as Router, \n  Route, \n  Switch\n} from 'react-router-dom'\n\nimport './App.css'\n\nimport Room from './pages/room/room'\n\n/*\n应用的根组件\n */\nexport default class App extends Component {\n\n\n  render () {\n    return (\n      <Router>\n        <Switch> {/*只匹配其中一个*/}\n          <Route path='/room' component={Room}></Route>\n          <Route path='/' component={Room}></Route>\n        </Switch>\n      </Router>\n    )\n  }\n}","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport App from './App'\n\n// 将App组件标签渲染到index页面的div上\nReactDOM.render((\n    <App />\n), document.getElementById('root'))\n\n","\nimport __event from '../event';\n/**\n * this.data Array\n * [{\n *  type\t整型\t0表示初始化数据，1表示音视频统计数据，2为事件，此处填1\n *  counterId\t整型\t递增ID\n *  appCpuUsage\t整型\t应用的cpu占用率，0-100\n *  systemCpuUsage\t整型\t系统的cpu占用率，0-100\n *  streamType\t整型\t流类型,0为正常音视频流，1为共享桌面流\n *  subMemName\t字符串\t对方的memName，isPub为false有效\n *  subMemId\t字符串\t对方的memId，isPub为fasle有效\n *  sId\t字符串\t流ID\n *  rtcId\t字符串\trtcId，sdk生成的\n *  isPub\tBOOL\t是否上传者\n *  audioInputLevel\t整型\t采集音量大小，isPub为true时有效\n *  time\t整型\t时间戳，utc时间，单位毫秒\n *  vKBps\t整型\t视频码率，单位kbps，isPub为ture时为上行，false时为下行\n *  vFps\t整型\t视频帧率，单位fps，isPub为ture时为上行，false时为下行\n *  vW\t整型\t视频宽，isPub为ture时为上行，false时为下行\n *  vH\t整型\t视频高，isPub为ture时为上行，false时为下行\n *  vP\t整型\t视频包计数，isPub为ture时为上行，false时为下行\n *  vPL\t整型\t视频包丢失数，isPub为ture时为上行，false时为下行\n *  vPLR\t整型\t视频丢包率，0-100，isPub为ture时为上行，false时为下行\n *  aKBps\t整型\t音频码率，单位kbps，isPub为ture时为上行，false时为下行\n *  aP\t整型\t音频包计数，isPub为ture时为上行，false时为下行\n *  aPL\t整型\t音频包丢失计数，isPub为ture时为上行，false时为下行\n *  aPLR\t整型\t音频丢包率，0-100，isPub为ture时为上行，false时为下行\n *  vCodec\t字符串\t视频编码\n *  aCodec\t字符串\t音频编码\n * }]\n */\nclass UploadStats {\n    constructor(emedia) {\n        this.emedia = emedia; // emedia 对象 只可读\n\n        this.streams = [];\n        this._intervals_get = null; // 收集数据的 interval\n        this._intervals_upload = null; // 上报数据的 interval，从这里取数据上报 --- 唯一的\n        this.data = [];\n        this.counterId = 1;\n\n        \n        this.prev_obj = {\n            //  store video、audio of prev package package_lost; sent and receive ...\n            /*\n            * {\n                [sid]: {\n                    time:,\n                    audio: {\n                        bytes:56780,\n                        packets: 890,\n                        packetsLost: 2\n\n                    },\n                    video: {\n                        bytes:56780,\n                        packets: 890,\n                        packetsLost: 2\n                    }\n                }\n            }\n            */\n        }\n\n        this.sessionId = null;\n\n        this.network_quality_obj = {\n            /**\n             * [sId]: {\n             *  RTT: { time, value }\n             *  aPLR: { time, value}\n             *  vPLR: { time, value}\n             *  disconnect: { time }\n            //  *  status: 0 | 1 | 2 , 0: 没有数据，1:网络不好 2: 网络好 \n             * }\n            */\n        }\n        this.network_quality_threshold = { // 网络质量差的阈值 , 连续 time 内大于 value\n            RTT: {\n               time: 8000, // ms\n               value: 500 // ms\n            },\n            aPLR: {\n               time: 8000, // ms\n               value: 18 // %\n            },\n            vPLR: {\n               time: 8000, // ms\n               value: 23 // %\n            },\n            disconnect: { time: 5000 } // ms\n        },\n\n        this.re_timer_count = 0; // 重连次数\n\n    }\n    _get_url() {\n\n        let url = '';\n        let { current } =  this.emedia.useCurrentXService;\n\n        if(!current) {\n            return url\n        }\n\n        let { qoeUpUrl, memName } = current.ticket;\n            memName = memName.split('_')[1];\n\n        let { appkey } = emedia.config;\n        let orgName = appkey.split('#')[0],\n            appName = appkey.split('#')[1];\n\n        let ts = new Date().getTime();\n        let access_token = emedia.mgr.identityToken;\n\n        url = `${qoeUpUrl}?orgName=${orgName}&appName=${appName}&memName=${memName}&ts=${ts}&access_token=${access_token}`;\n\n        return url\n\n    }\n\n\n    connect_ws() { // 创建websocket长连接\n\n        let url = this._get_url()\n        if(!url) {\n            console.error('upload stats not have ws url');\n            return\n        }\n\n        var socket = new WebSocket(url);\n        let _this = this;\n        socket.onopen = () => {\n            console.log('upload stats ws connected');\n            _this.ws_connected = true;\n            _this.socket = socket;\n\n            if(_this.re_connect) {// 如果是重连的\n                console.log('has Reconnectioned');\n\n                console.log('before joinS');\n                if(_this.sessionId) {\n                    console.log('have sessID');\n                    _this.join_success(_this.sessionId)\n                }\n            }\n        }\n\n        socket.onclose = (error) => {\n            _this.stop();\n            _this.ws_connected = false;\n            console.error('upload stats ws close');\n\n            if(navigator.onLine ) _this.reconnection(); // 只在有网的状态下重连\n        }\n\n        socket.message = (evt) => {\n            console.log('upload stats ws recv msg', evt);\n        }\n\n        socket.onerror = (error) => {\n            console.error('upload stats ws error', error);\n        }\n\n        window.addEventListener(\"online\", () => {\n            _this.re_timer_count = 0;\n            _this.reconnection()\n        });\n        \n    }\n\n    // 断网重连 Reconnection\n    reconnection() {\n\n        if(this.ws_connected) return;\n\n        let _this = this;\n        this.reconnection_timer = setInterval(() => {\n            if(_this.ws_connected || _this.re_timer_count >= 10) {\n                clearInterval(_this.reconnection_timer);\n            } else {\n                console.log('reconnection...');\n                _this.re_connect = true;\n                _this.connect_ws()\n                _this.re_timer_count++;\n\n            }\n        },5000)\n    }\n\n\n    start() {\n        // 开始发送数据 -- 直到退出会议\n        let _this = this;\n        this._intervals_get = setInterval(\n            _this.get.bind(this),\n            2000\n        );\n        this._intervals_upload = setInterval(\n            _this.upload.bind(this),\n            500\n        )\n    }\n\n    join_success(sessionId) { // 加入成功，开始发送 stats\n\n        if(!sessionId) {\n            return\n        }\n\n        this.sessionId  = sessionId;\n        this.data.unshift( this._get_init_data() );\n\n        this.start()\n\n    }\n\n    join_fail() { // 加入失败，发送一条错误的 msg\n\n        let _o = {\n            type:0,\n            result: 1,\n            errorInfo: 'join fail'\n        }\n\n        // 直接发送一条数据\n        if(this.socket) {\n            this.socket.send(_o)\n        }\n    }\n    \n    get() { // 收集\n        if(\n            !this.emedia.useCurrentXService ||\n            !this.emedia.useCurrentXService.current || \n            !this.emedia.useCurrentXService.current._cacheStreams\n        ) {\n            return  // no streams return\n        }\n        \n        let streams = this.emedia.useCurrentXService.current._cacheStreams; // object { streamid: stream }\n\n        let _this = this;\n        Object.keys(streams).map(key => {\n            _this.push_stats_to_data(streams[key])\n        })\n    }\n\n    upload() { // 上报\n\n        if(this.data.length == 0) {\n            console.warn('upload_stats upload fun -- this.data.length == 0');\n            return\n        }\n\n        if(!this.socket) { // 如果没有连接成功, 不发数据\n            return\n        }\n\n        const item =  this.data.shift(); // 发送出去并删除\n        \n        if(item.counterId == undefined) { // 给每一个 data 添加 counterId、在这里添加才能保持 唯一性\n            item.counterId = this.counterId\n            this.counterId = this.counterId + 1; // 递增\n        } \n        \n        this.socket.send(JSON.stringify(item));\n\n\n\n        // display html start\n        if(item.type == 1) {\n            let el = document.querySelector(`#${item.sId}`);\n\n            if(el) {\n                let str = '';\n                Object.keys(item).map(key => {\n                    str += `<div>${key} : ${item[key]}</div>`\n                })\n                el.innerHTML = str;\n            }\n        }\n        // display html end\n    }\n\n    // 事件上报\n    upload_event(evt) {\n        if(!evt) { \n            return\n        }\n\n        let event_obj = this._get_format_event_obj(evt);\n\n        if(!event_obj) {\n            return\n        }\n\n        this.data.splice(1, 0, event_obj); // send event frist , but init data must array[0]\n\n    }\n    // format event\n    _get_format_event_obj(evt) {\n\n        let _o = {\n            type: 2,\n            time: new Date().getTime()\n        };\n\n        if(\n            typeof evt.event != 'object' && // 有的 会有 event obj ignore\n            evt.event != undefined\n        ) { // 从另一个地方接收 EventsObservable.js 直接组织好\n\n            return Object.assign(_o, evt)\n        }\n\n        let sessionId = this.sessionId;\n\n        if(evt instanceof __event.ICEConnected){\n\n            let obj = this._get_ice_connect_state_obj(evt.webrtc, 2)\n            _o = Object.assign( _o, obj );\n        } else if(evt instanceof __event.ICEConnectFail){\n            let obj = this._get_ice_connect_state_obj(evt.webrtc, 4)\n            _o = Object.assign( _o, obj );\n        } else if(evt instanceof __event.ICEDisconnected){ //只要ICE断开\n            let obj = this._get_ice_connect_state_obj(evt.webrtc, 5)\n            _o = Object.assign( _o, obj );\n        }else if(evt instanceof __event.PushSuccess){\n\n            if(!evt.hidden) { // hidden: false 为多余的\n                return undefined\n            }\n\n            let {\n                rtcId,\n                voff,\n                aoff,\n                // w: ???\n                // h: ???\n\n                type: streamType,\n                \n            } = evt.stream;\n\n            let obj = {\n                event:14,\n                sessionId,\n                rtcId,\n                voff,\n                aoff,\n                streamType,\n                result: 0,\n                // vcode: ???\n            }\n\n            _o = Object.assign( _o, obj )\n\n        } else if(evt instanceof __event.SubSuccess){\n\n\n            let {\n                rtcId,\n                id: sId,\n                type: streamType,\n                memId: subMemId,\n                memName: subMemName,\n                \n            } = evt.stream;\n\n            let obj = {\n                event: 16,\n                rtcId,\n                sId,\n                sessionId,\n                result: 0,\n                streamType,\n                subMemName,\n                subMemId\n            };\n\n            _o = Object.assign( _o, obj )\n\n        } else if(evt instanceof __event.EnterSuccess){\n            let obj = {\n                event: 0,\n                ip: evt.ip,\n                // hopeVCode: ???\n            }\n\n            _o = Object.assign( _o, obj )\n        } \n\n\n        if(_o.event == undefined) { // filter not use\n            return undefined\n        }\n        return _o;\n    }\n\n    _get_ice_connect_state_obj(webrtc, state) {\n        // adopt webrtc get stream\n        let { current } =  this.emedia.useCurrentXService;\n\n        var stream = null;\n        \n        for(var sid in current._linkedStreams){\n            \n            if(current._linkedStreams[sid].rtcId == webrtc.getRtcId()){\n                stream = current._linkedStreams[sid]\n            }\n        }\n\n        if(!stream) {\n            return {}\n        }\n\n        let _o = {\n            event:20,\n            rtcId: stream.rtcId,\n            connState: state,\n            isPub: stream.located(),\n            sId: stream.id,\n            rtcCfg: stream.rtcCfg,\n            voff: stream.voff,\n            aoff: stream.aoff\t\n        };\n\n        if(!stream.located()) { // 订阅的字段\n            let sub_o = {\n                subSId: stream.id,\n                subMemName: stream.memName,\n                subMemId: stream.memId,\n                subVideo: stream.subSVideo,\n                subAudio: stream.subSAudio\n            }\n\n            _o = Object.assign(_o, sub_o)\n        }\n\n        return _o;\n\n    }\n\n    // 停止上报和收集\n    stop() {\n        clearInterval(this._intervals_get);\n        clearInterval(this._intervals_upload);\n        \n    }\n\n\n\n\n\n    async push_stats_to_data(stream) { // 将stats 推到 data 队列\n\n        if(!stream._webrtc){\n            return\n        }\n        const stats = await stream._webrtc._rtcPeerConnection.getStats();\n        const upload_obj = this._get_format_upload_obj(stats, stream);\n\n        this.data.push(upload_obj);\n\n    }\n\n    _get_init_data() { // 初始化的一条数据\n        let _o = {}\n\n        let currentXService = this.emedia.useCurrentXService.current;\n        if(!currentXService) {\n            return\n        }\n\n        let { appkey, version: sdkVersion } = this.emedia.config,\n            { confrId, _memberId: memId, memName } = currentXService,\n            sessionId  = this.sessionId,\n            { browser: deviceInfo, browserVersion: osVersion, isWifi} = this.emedia;\n\n        _o = {\n            type: 0,\n            counterId: 0,\n            appkey,\n            confrId,\n            memId,\t//字符串\t上传者的memId，result为0时有效\n            memName,\n            time: new Date().getTime(),\n            joinConfrTime: currentXService.ticket.timestamp, \t//整型\t加入会议成功的时间，result为0时有效\n            sessionId, //字符串\t会议的sessionID，result为0时有效\n            networkType:'WIFI',\t//字符串\t网络类型，包括“WIFI”，“LAN”，“4G”\n            sdkOS:'Web',\n            sdkVersion,\t\n            deviceInfo,\t\n            osVersion,\n            result:0\t//整型\t加入会议的结果，0为成功，其他失败\n        }\n\n        return _o\n    }\n    // 将 stats 和 stream 融合成后端 需要的 核心方法\n    _get_format_upload_obj(stats, stream) { // 在 stats 中采集需要的数据\n        /**\n         * stats： webRtc 的原始数组，包含多种数据\n         * stream_info : 流的信息，sId、memId ...\n         * sample：https://webrtc.github.io/samples/src/content/peerconnection/constraints/\n         */\n\n        // 可以判断sent、received\n        let _o = {\n            type: 1, \n            time: new Date().getTime(),\n            streamType: stream.type,\n            sId: stream.id,\n            rtcId: stream.rtcId\n        };\n\n        if(stream.located()) { // 上行的流\n            _o.isPub = true;\n            const outbound_stats_obj = this._get_outbound_stats(stats);\n\n            _o = Object.assign(_o, outbound_stats_obj)\n        } else { // 下行的流\n            _o.isPub = false;\n            _o.subMemName = stream.memName;\n            _o.subMemId = stream.memId;\n            \n            const inbound_stats_obj = this._get_inbound_stats(stats);\n\n            _o = Object.assign(_o, inbound_stats_obj)\n        }\n\n        // 获取码率 和丢包率\n        _o = this._calc_KBps_and_PLR(_o);\n\n        // 将 某些 data 的值转化为 int\n        _o = this._set_stats_int(_o);\n\n        return _o\n    }\n    \n    // 上行数据\n    _get_outbound_stats(stats) {\n        let _o = { };\n\n        stats.forEach(item => {\n\n            if(item.type == 'outbound-rtp') {\n                if(item.mediaType == 'audio') {\n                    _o.aP = item.packetsSent; \n\n                    _o.aB = item.bytesSent; // 临时存储\n                   \n                }\n                if(item.mediaType == 'video') {\n                    _o.vW = item.frameWidth\n                    _o.vH = item.frameHeight\n                    _o.vP = item.packetsSent\n\n                    _o.vB = item.bytesSent; // 临时存储\n                }\n                \n            }\n\n            if(item.type == 'remote-inbound-rtp') { // get packetlost\n                if(item.kind == 'audio') {\n                    _o.aPL = item.packetsLost\n                }\n                if(item.kind == 'video') {\n                    _o.vPL = item.packetsLost\n                }\n            }\n\n            if(item.type=='media-source') {\n\n                if(item.kind=='audio') {\n                    _o.audioInputLevel = item.audioLevel*1000\n                }\n\n                if(item.kind == 'video'){\n                    _o.vFps = item.framesPerSecond\n                }\n\n            }\n\n            if(item.type == 'candidate-pair') {\n                _o.RTT = (item.totalRoundTripTime*1000)/item.responsesReceived // totalRoundTripTime: s ---> 换算成ms \n            }\n\n        });\n\n        \n        return _o;\n    }\n    \n    // 下行数据\n    _get_inbound_stats(stats) {\n        let _o = { }\n        stats.forEach(item => {\n\n            if(item.type == 'inbound-rtp') {\n                if(item.kind == 'audio' || item.id.indexOf('AudioStream')>-1) { //兼容 safiri\n                    _o.aP = item.packetsReceived;\n                    _o.aPL = item.packetsLost;\n\n                    _o.aB = item.bytesReceived // 临时存储\n                }\n\n                if(item.kind == 'video' || item.id.indexOf('VideoStream')>-1) { //兼容 safiri\n                    _o.vP = item.packetsReceived;\t\n                    _o.vPL = item.packetsLost;\n\n                    _o.vB = item.bytesReceived // 临时存储\n                }\n                \n            }\n\n            if(item.type == 'track') {\n                if(item.kind == 'video') {\n                    _o.vW = item.frameWidth\n                    _o.vH = item.frameHeight\n\n                    _o.vFR = item.framesReceived // 暂存\n                }\n\n                if(item.kind == 'audio') {\n                    _o.audioInputLevel = item.audioLevel*1000 // 貌似一直为 0\n                }\n            }\n\n            if(item.type == 'candidate-pair') {\n                _o.RTT = (item.totalRoundTripTime*1000)/item.responsesReceived // totalRoundTripTime: s ---> 换算成ms \n            }\n\n        });\n\n        return _o;\n    }\n\n    // 计算码率和丢包率和下行帧率\n    _calc_KBps_and_PLR(upload_obj) {\n\n\n        let {\n            sId,\n            aB,\n            vB,\n            time\n        } = upload_obj;\n\n        // 计算码率\n\n        upload_obj.aKBps = this._get_KBps_by_sId(sId, 'audio', aB, time) || 0;\n        upload_obj.vKBps = this._get_KBps_by_sId(sId, 'video', vB, time) || 0;\n\n        // 计算丢包率\n        let {\n            aP,\n            aPL,\n            vP,\n            vPL\n        } = upload_obj;\n\n        let aPLR = this._get_PLR_by_sId(sId, 'audio', aP, aPL);\n        let vPLR = this._get_PLR_by_sId(sId, 'video', vP, vPL);\n\n        if(aPLR || aPLR == 0) {\n            upload_obj.aPLR = aPLR;\n        }\n\n        if(vPLR || vPLR == 0) {\n            upload_obj.vPLR = vPLR;\n        }\n\n        // 下行帧率\n        if(!upload_obj.isPub){\n            let {\n                vFR\n            } = upload_obj;\n\n            if(\n                this.prev_obj[sId] &&\n                this.prev_obj[sId]['video'] &&\n                this.prev_obj[sId]['video']['framesReceived']\n            ) {\n                let prev_time = this.prev_obj[sId].time;\n                let prev_vFR = this.prev_obj[sId]['video']['framesReceived'];\n\n                let interval = (time-prev_time)/1000 // 单位：s\n                let vFps = (vFR - prev_vFR)/interval;\n                if(vFps<0) { vFps = 0 };\n                upload_obj.vFps = vFps;\n            }\n\n        }\n        // 获取网络质量\n        // const network_quality = this._network_quality(upload_obj);\n        // const network_disconnect = this._network_disconnect(upload_obj);\n        const network_quality = this._get_w_quality(upload_obj);\n\n        if(network_quality != 2){\n\n            let event_obj = {\n                time: new Date().getTime(),\n                event: 4,\n                type:2,\n                counterId: this.counterId,\n                sessionId: this.sessionId,\n                rtcId: upload_obj.rtcId,\n                sId: upload_obj.sId,\n                isPub: upload_obj.isPub,\n                streamType: upload_obj.sId,\n                aoff: upload_obj.aoff,\n                voff: upload_obj.voff,\n                subMemName: upload_obj.subMemName,\n                subMemId: upload_obj.subMemId\n            }\n\n            this.data.push(event_obj); // 上报事件\n\n        }\n        \n        \n\n\n        // 触发网络状态检测回调\n        if(\n            this.emedia.mgr &&\n            this.emedia.mgr.onNetworkQuality\n        ) {\n            let callback = this.emedia.mgr.onNetworkQuality;\n\n            if(typeof callback == 'function') {\n                callback(upload_obj.sId, network_quality)\n            }\n        }\n\n        \n\n\n        // 存储上一个数据\n        this._set_prev_obj(upload_obj);\n\n        // 删除 aB、vB、vFR 发送不需要，只用来计算码率\n        delete upload_obj.aB; // audio bytesSent or bytesReceived\n        delete upload_obj.vB; // video bytesSent or bytesReceived\n        delete upload_obj.vFR; // video framesReceived \n        delete upload_obj.RTT; // RTT 计算网络质量\n\n        return upload_obj\n    }\n\n    _set_stats_int(_o) { // 将stats 转换为 整型\n\n        let need_int_keys = [\n            'audioInputLevel','vKBps','vFps','vW','vH',\n            'vP','vPL','vPLR','aKBps','aP','aPL','aPLR'\n        ]\n        for (const key in _o) {\n            if(need_int_keys.indexOf(key) > -1) {\n                _o[key] = Math.round(_o[key])\n            }\n        }\n\n        return _o\n    }\n    \n\n    // 通过和上一次的字节比较 计算码率 通过 sId\n    _get_KBps_by_sId(sId, kind, bytes, time) {\n\n        if(!sId || !kind || !bytes) {\n            return null\n        }\n\n        let prev_info = this.prev_obj[sId];\n\n        if(\n            !prev_info ||\n            !prev_info[kind] ||\n            !prev_info[kind]['bytes']\n        ) { // 首次或者 没有\n            return null\n        }\n\n        let { time: prev_time } = prev_info;\n        let {\n            bytes: prev_bytes\n        } = prev_info[kind];\n\n        var interval = parseInt(time - prev_time) // 时间间隔 ms\n\n        var increment = bytes - prev_bytes;\n\n        if(increment < 0) { // 这种情况出现在 开启摄像头， 直接置为 0 \n            increment = 0\n        }\n\n        var bytes_rate = increment/(interval/1000).toFixed(2) // 以 S 为单位\n\n        return bytes_rate/1000 // KBps\n    }\n\n    /**\n     * 丢包率\n     * 某一时间段内 --  丢包数量/(接收或者发送包数+丢包数量)\n     * kind: video or audio\n     * end_type: sent or received\n     * package_num : total of package sent or receive, \n     * package_loat_num: total of package lost  sent or receive\n     * */ \n    _get_PLR_by_sId(sId, kind, packets, packets_lost) {\n\n        if(!sId) {\n            return null\n        }\n\n        if(\n            !kind ||\n            !packets || \n            !packets_lost\n        ) {\n            return 0\n        }\n\n\n        let prev_info = this.prev_obj[sId];\n\n        if(\n            !prev_info ||\n            !prev_info[kind] ||\n            !prev_info[kind]['packets'] ||\n            !prev_info[kind]['packets_lost']\n        ) {\n            return 0\n        }\n\n        let {\n            packets: prev_packets,\n            packets_lost: prev_packets_lost\n        } = prev_info[kind];\n\n\n        let packets_increment = packets-prev_packets,\n            packets_lost_increment = packets_lost-prev_packets_lost;\n\n        let packets_lost_rate = packets_lost_increment/(packets_increment+packets_lost_increment);\n            packets_lost_rate = Math.round(packets_lost_rate*100)\n\n        return packets_lost_rate;\n\n    }\n\n    \n    // 存储上次数据\n    _set_prev_obj(_o) {\n\n        let { sId } = _o;\n        if(!sId) {\n            return\n        }\n        \n        let {\n            aB,\n            vB,\n            time,\n            aP,\n            aPL,\n            vP,\n            vPL,\n            vFR\n        } = _o;\n\n\n\n        let audio = {}, video = {};\n\n        if(aB) {\n            audio.bytes = aB\n        }\n        if(aP) {\n            audio.packets = aP\n        }\n        if(aPL || aPL == 0) {\n            audio.packets_lost = aPL\n        }\n        // video\n        if(vB) {\n            video.bytes = vB\n        }\n        if(vP) {\n            video.packets = vP\n        }\n        if(vPL || vPL == 0) {\n            video.packets_lost = vPL\n        }\n        if(vFR) {\n            video.framesReceived = vFR\n        }\n\n        if(\n            Object.keys(audio).length == 0 &&\n            Object.keys(video).length == 0\n        ) { // 都是空对象\n            return \n        }\n\n        if(!this.prev_obj[sId]) {\n            this.prev_obj[sId] = {}\n        }\n        this.prev_obj[sId].time = time;\n\n        if(\n            Object.keys(audio).length > 0\n        ) { \n            this.prev_obj[sId].audio = audio;\n        }\n\n        if(\n            Object.keys(video).length > 0\n        ) { \n            this.prev_obj[sId].video = video;\n        }\n        \n    }\n\n\n    // 检测网络质量 0 无数据 1 网络差 2 网络好\n    _get_w_quality(upload_obj) {\n        let {\n            RTT,\n            aPLR,\n            vPLR,\n            time,\n            vKBps, \n            aKBps,\n            sId\n        } = upload_obj;\n\n        if(!sId) {\n            return 2\n        }\n\n\n        let _this = this;\n        // start calc disconnect\n        const is_dis = () => {\n            let sId_info = _this.network_quality_obj[sId];\n\n            // 断网检测 vKBps, aKBps 同时为零连续一段时间 基本可判断 断网\n            if(!sId_info) { // 首次获取数据\n                _this.network_quality_obj[sId] = { disconnect: { time } };\n                return false\n            }\n\n            if(!sId_info['disconnect']) { // 第一次计算这个, 赋值\n                _this.network_quality_obj[sId] = { disconnect: { time } };\n                return false\n            }\n\n            \n\n            let frist_time = sId_info['disconnect'].time;\n\n            let timeout = _this.network_quality_threshold['disconnect'].time;\n\n            if(time - frist_time >= timeout) {// 累计到一定时间\n                return true\n            }\n            \n            return false\n            // 初始化或者 比较是否累计到了一定时间\n            // time 当前时间\n            // s --> f_dis_time 流下面的第一次 无数据时间\n            // dis_timeout 设定的累计时间\n            \n        }\n\n        // stop disconnect\n        const reset_dis_time = () => {\n            let sId_info = _this.network_quality_obj[sId];\n            if(!sId_info || !sId_info['disconnect']) return; //从未赋值过，返回\n\n            _this.network_quality_obj[sId]['disconnect'] = undefined;\n        } \n\n\n        // start calc weak\n        // 检测弱网\n\n        const is_weak = (type) => {\n            if(\n                !type ||\n                !time\n            ) {\n                return false\n            }\n\n            let sId_info = _this.network_quality_obj[sId];\n\n            if(!sId_info) { // 第一次接收数据 type、\n                _this.network_quality_obj[sId] = { [type]: { time } }\n\n                return false\n            }\n            if(!sId_info[type]) { // 第一次达到弱网阈值 type\n                _this.network_quality_obj[sId][type] = { time }\n                return false\n            }\n\n            \n            \n            let frist_time = sId_info[type].time;\n            let timeout = _this.network_quality_threshold[type].time;\n\n            // 达到阈值，并且timeout 返回 true\n            if(time - frist_time >= timeout) {\n                return true\n            }\n        \n\n            return false;\n        }\n        // stop weak\n        const reset_weak_tiem = (type) => {\n            let sId_info = _this.network_quality_obj[sId];\n\n            if(!sId_info || !sId_info[type]) return; //从未赋值过，返回\n\n            _this.network_quality_obj[sId][type] = undefined;\n        }\n        // good\n        \n        // vKBps=0,aKBps=0;\n        \n\n        if(!vKBps && !aKBps) {\n            if(is_dis()){\n                return 0\n            }\n            \n            return 2\n        }else {\n            reset_dis_time();\n            \n            let checks = ['RTT', 'aPLR', 'vPLR'];// 检测弱网的条件，一个符合则弱网\n            let weak = 2;\n\n            for (let index = 0; index < checks.length; index++) {\n                const type = checks[index];\n                let threshold = this.network_quality_threshold[type].value;\n\n                \n                if(upload_obj[type] >= threshold){// 达到阈值，开始计算\n                    if(is_weak(type, time)) weak = 1;\n                } else {\n                    reset_weak_tiem(type)\n                }\n                \n            }\n\n            return weak;\n        }\n\n    }\n\n}\nexport default UploadStats","import _util from '../Util';\nimport zepto  from 'zepto-webpack';\nimport _ from 'underscore';\nimport UploadStats from './UploadStats'\n\nimport { Observable, of, throwError } from 'rxjs';\nimport { map, concatMap, catchError } from 'rxjs/operators';\n\nimport __Stream from '../_Stream';\n\nvar _logger = _util.tagLogger(\"mgr\");\n\nwindow.emedia = window.emedia || {};\n\nvar restApis  = {\n    createConfr: \"/easemob/rtc/req/ticket\",\n    reqTkt: \"/easemob/rtc/req/ticket\",\n    chanageRoles: \"/easemob/rtc/chanage/roles\",\n    disbandConfr: \"/easemob/rtc/disband/conference\",\n    kickMember: \"/easemob/rtc/kick/member\",\n    selectConfr: \"/easemob/rtc/select/confr\"\n};\n\nfunction Manager(){\n    this._confrs = {};\n    this._services = {};\n    this._events = {};\n    this._videos = {};\n}\n\nManager.prototype.ConfrType = {\n    COMMUNICATION: 10,\n    COMMUNICATION_MIX: 11,\n    LIVE: 12,\n    P2P: 13,\n    INTERCOMM: 14\n};\n\nManager.prototype.Role = {\n    ADMIN: 7,\n    TALKER: 3,\n    AUDIENCE: 1\n};\n\nManager.prototype.StreamType = {\n    VIDEO:0,\n    DESKTOP:1,\n    MIXVIDEO:2\n};\n\nvar _ajax = function(ajaxUrl, confrArgs){\n    return new Promise(function(resolve, reject) {\n        zepto.ajax({\n            type: 'POST',\n            url: ajaxUrl,\n            data: JSON.stringify(confrArgs),\n            contentType: 'application/json',\n            dataType: 'json',\n            success: function(data, status, xhr){\n                _logger.debug(\"REST: \", data, \" -> \", confrArgs, ajaxUrl);\n                if(data.error === 0){\n                    _util.removeAttribute(data, \"error\");\n                    resolve(data);\n                }else{\n                    _util.extend(data, {errorType: \"server_refuse\"});\n                    reject(data);\n                }\n            },\n            error: function(xhr, errorType, error){\n                var data = {\n                    errorType: \"http_error\",\n                    error: xhr.status,\n                    errorMessage: error\n                };\n                _logger.debug(\"REST: \", data, \" -> \", confrArgs, ajaxUrl);\n\n                reject({\n                    errorType: \"http_error\",\n                    error: xhr.status,\n                    errorMessage: error\n                });\n            }\n        });\n    });\n};\n\nvar _ajax2 = function(ajaxUrl, confrArgs){\n\n    return function onSubscription(observer) {\n        zepto.ajax({\n            type: 'POST',\n            url: ajaxUrl,\n            data: JSON.stringify(confrArgs),\n            contentType: 'application/json',\n            dataType: 'json',\n            success: function(data, status, xhr){\n                _logger.debug(\"REST: \", data, \" -> \", confrArgs, ajaxUrl);\n                if(data.error === 0){\n                    _util.removeAttribute(data, \"error\");\n                    observer.next(data);\n                    observer.complete();\n                }else{\n                    _util.extend(data, {errorType: \"server_refuse\"});\n                    observer.error(data);\n                }\n            },\n            error: function(xhr, errorType, error){\n                var data = {\n                    errorType: \"http_error\",\n                    error: xhr.status,\n                    errorMessage: error\n                };\n                _logger.debug(\"REST: \", data, \" -> \", confrArgs, ajaxUrl);\n\n                observer.error({\n                    errorType: \"http_error\",\n                    error: xhr.status,\n                    errorMessage: error\n                });\n            }\n        })\n    }\n};\n\n\n(function loadApi(_urls){\n    _util.forEach(_urls, function (api, url) {\n        Manager.prototype[api] = function(apiArgs){\n            var _url = url;\n            _url = _url + \"?_ct=\" + (new Date().getTime());\n            apiArgs.region && (_url = _url + \"&REGION=\" + apiArgs.region);\n            apiArgs.confrId && (_url = _url + \"&CONFRID=\" + apiArgs.confrId);\n\n            var restURL = this.createUrl(_url, api);\n            return _ajax2(restURL, apiArgs);\n        };\n    })\n})(restApis);\n\nManager.prototype.createUrl = function(url, api){\n    var restURL = (emedia.config && emedia.config.restPrefix) || \"\";\n    return restURL + url;\n};\n\nManager.prototype.setUrlCreator = function(creator){\n    this.createUrl = creator.bind(this);\n};\n\nManager.prototype.destroy = function(){\n\n};\n\nManager.prototype.ZeroStream = __Stream.extend({\n    __init__: function () {\n        var self = this;\n\n        self.type = 2;\n        self.id = \"0\";\n        self._located = false;\n\n        self.mutedMuted = false;\n    },\n\n    onGotRemoteMediaStream: function(remoteMediaStream){\n        var self = this;\n\n        if(!self.remotePlayAudioObject){\n            var _audioId = \"__o_remote_play_audio_\" + self.id;\n\n            var audioObject = document.createElement(\"audio\");\n            audioObject.style.display = \"none\";\n            audioObject.id = \"__o_remote_play_audio_\" + self.id;\n            audioObject.autoplay = true;\n            audioObject.playsinline = true;\n\n            //monitorEvents && monitorEvents(audioObject);\n\n            self.remotePlayAudioObject = audioObject;\n\n            document.body.appendChild(audioObject);\n        }\n\n        // self.remotePlayAudioObject.autoplay = true;\n        // self.remotePlayAudioObject.playsinline = true;\n        self.remotePlayAudioObject.srcObject = remoteMediaStream;\n\n        //window.__$_remoteMediaStream = remoteMediaStream;\n    }\n})\n\nManager.prototype.setIdentity = function(identityName, identityToken, extInfo){\n    this.identityName = identityName;\n    this.identityToken = identityToken;\n    this.ext = extInfo;\n\n    this._terminalInfo = {\n        \"browser\": emedia.browser,\n        \"browserVersion\": emedia.browserVersion,\n        \"version\": window._emediaVersion || emedia.config.version,\n        \"userAgent\": emedia.config.userAgent\n    };\n\n    _logger.info(\"set identity: \", identityName, identityToken);\n    this.destroy();\n\n    emedia.config({\n        autoSub: false,\n        onlyEnter: true\n    })\n};\n\nManager.prototype.EventsObservable = require(\"./EventsObservable\").default;\n\nvar errorHandler = catchError((err, caught) => {\n    _logger.error(err);\n    throw err;\n});\n\nfunction rxCreateConfr(confrType, password, rec, recMerge) {\n    var self = this;\n\n    var region = undefined,liveCfg = undefined;\n    if(arguments.length >= 0 && (typeof arguments[0] === 'object')){\n        var args = arguments[0];\n\n        region = args.region;\n        confrType = args.confrType;\n        password = args.password;\n        rec = args.rec;\n        recMerge = args.recMerge;\n        liveCfg = args.liveCfg\n    }\n\n    if(typeof confrType === 'string'){\n        confrType = parseInt(confrType);\n    }\n\n    return Observable.create(Manager.prototype.createConfr.call(self, {\n        region: region,\n        uid: self.identityName,\n        token: self.identityToken,\n        confrType: confrType,\n        password: password,\n        terminal: self._terminalInfo,\n        rec,\n        recMerge,\n        liveCfg // 推流CDN 参数\n    })).pipe(map((response) => {\n        response.mixed = response.type === 11 || response.type === 12;\n        response.id = response.serverConfrId = response.confrId;\n        self._confrs[response.confrId] = _.extend({}, response);\n\n        //_util.removeAttribute(response, \"ticket\");\n        //_util.removeAttribute(response, \"roleToken\");\n        _util.removeAttribute(response, \"rtcCfg\");\n\n        return response;\n    }), errorHandler);\n}\n\nfunction rxCreateConfrSptMnPrg(confrType, password, rec, recMerge, supportWechatMiniProgram){\n    var self = this;\n\n    var params = {};\n    if(arguments.length >= 0 && (typeof arguments[0] === 'object')){ //对象参数写法\n        var create_config = arguments[0];\n\n        params = {\n            uid: self.identityName,\n            token: self.identityToken,\n            terminal: self._terminalInfo,\n\n            ...create_config\n        }\n        \n    } else { // 单个值类型参数\n        params = {\n            uid: self.identityName,\n            token: self.identityToken,\n            terminal: self._terminalInfo,\n\n            confrType,\n            password,\n            rec,\n            recMerge,\n            supportWechatMiniProgram,\n        }\n    }\n\n    if(params.confrType){ // 转为 number 类型\n        params.confrType = parseInt(params.confrType);\n    }\n\n    if (supportWechatMiniProgram) { //支持小程序时，指定编码方式\n        params.useVCodes = ['VP8', 'H264']\n    }\n\n    return Observable.create(Manager.prototype.createConfr.call(self, params)).pipe(map((response) => {\n        response.mixed = response.type === 11 || response.type === 12;\n        response.id = response.serverConfrId = response.confrId;\n        self._confrs[response.confrId] = _.extend({}, response);\n\n        //_util.removeAttribute(response, \"ticket\");\n        //_util.removeAttribute(response, \"roleToken\");\n        _util.removeAttribute(response, \"rtcCfg\");\n\n        return response;\n    }), errorHandler);\n}\n\nfunction rxReqTkt(confrId, password) {\n    var self = this;\n\n    var role;\n    if(arguments.length >= 0 && (typeof arguments[0] === 'object')){\n        var args = arguments[0];\n\n        confrId = args.confrId;\n        password = args.password;\n        role = args.role;\n    }\n\n    var confr = self._confr(confrId);\n\n    var apiArgs = {\n        uid: self.identityName,\n        token: self.identityToken,\n        confrId: (confr && confr.id) || confrId,\n        password: password,\n        role: role,\n        terminal: self._terminalInfo\n    };\n\n    self._confrs[confrId] && (apiArgs.roleToken = self._confrs[confrId].roleToken);\n    return Observable.create(Manager.prototype.reqTkt.call(self, apiArgs)).pipe(map((response) => {\n        response.mixed = response.type === 11 || response.type === 12;\n        response.id = response.serverConfrId = response.confrId = confrId;\n        self._confrs[confrId] = _util.extend(self._confrs[confrId] || {}, response);\n\n        //_util.removeAttribute(response, \"ticket\");\n        //_util.removeAttribute(response, \"roleToken\");\n        _util.removeAttribute(response, \"rtcCfg\");\n\n        return response;\n    }), errorHandler);\n}\n\nfunction rxChanageRoles(role, uids, confrId) {\n    var self = this;\n\n    var confr = self._confr(confrId);\n    var service = self._service(confrId);\n\n    var apiArgs = {\n        confrId: (confr && confr.id) || confrId,\n        uids: uids,\n        role: role,\n        roleToken: confr.roleToken\n    };\n\n    return Observable.create(Manager.prototype.chanageRoles.call(self, apiArgs)).pipe(map((response) => {\n        service && service.current && service.current._sysCopy();\n        //return response.error === 0;\n        return confr.id;\n    }), errorHandler);\n}\n\nfunction rxDisbandConfr(confrId, roleToken) {\n\n    var self = this;\n\n    var confr = self._confr(confrId);\n    var apiArgs = {\n        confrId: (confr && confr.id) || confrId,\n        roleToken: confr && confr.roleToken || roleToken\n    };\n    \n    return Observable.create(Manager.prototype.disbandConfr.call(self, apiArgs)).pipe(map((response) => {\n        if(self.upload_stats) {// stop upload qoe\n            setTimeout(() => self.upload_stats.stop(),3000) // set timeout wait onEixt upload eixt event\n        }\n        _util.removeAttribute(self._confrs, confrId);\n        return confr.id;\n    }), errorHandler);\n}\n\nfunction rxKickMember(uids, confrId) {\n    var self = this;\n\n    var confr = self._confr(confrId);\n    var apiArgs = {\n        confrId: (confr && confr.id) || confrId,\n        uids: uids,\n        roleToken: confr.roleToken\n    };\n\n    return Observable.create(Manager.prototype.kickMember.call(self, apiArgs)).pipe(map((response) => {\n        //return response.error === 0;\n        return confr.id;\n    }), errorHandler);\n}\n\nfunction rxSelectConfr(confrId, password) {\n    var self = this;\n\n    var confr = self._confr(confrId);\n\n    var apiArgs = {\n        uid: self.identityName,\n        token: self.identityToken,\n        confrId: (confr && confr.id) || confrId,\n        password: password\n    };\n\n    if(confr){\n        apiArgs.password = password || confr.password;\n        apiArgs.roleToken = confr.roleToken\n    }\n\n    return Observable.create(Manager.prototype.selectConfr.call(self, apiArgs)).pipe(errorHandler);\n}\n\nfunction onRemoteStream(confrId, stream) {\n\n}\n\nfunction rxAfterJoinedConfr(confrId, joinMemberId) {\n    var self = this;\n    var confr = self._confr(confrId);\n    var service = self._service(confrId);\n\n    switch (confr.type) {\n        case  0: //CONFR\n        case 10: //COMMUNICATION\n            break;\n        case 11: //COMMUNICATION_MIX  Audio:Mixed\n            break;\n        case 12: //LIVE  Audio:Mixed=\n            var zeroStream = new self.ZeroStream();\n            service.current._cacheStreams[zeroStream.id] = zeroStream;\n            if(service.current.role == single.Role.AUDIENCE){ //观众 订阅0\n                return rxSubscribe.call(self, confrId, zeroStream, false, true).pipe(\n                    concatMap(() => {\n                        return of(_util.extend({}, self._confrs[confrId]));;\n                    })\n                );\n            }\n            break;\n        case 13: //P2P\n        case 14: //INTERCOMM\n            return throwError(\"not support conf type: \" + confr.type);\n        default:\n            return throwError(\"not support conf type: \" + confr.type);\n    }\n\n    return of(_util.extend({}, self._confrs[confrId]));;\n}\n\nfunction rxSupportRemoteControl(confrId, joinMemberId, service) {\n    var self = this;\n    emedia.ctrl.support(service,\n        function onHasRemoteControl(stream, controler, controlRequest){\n            self.onHasRemoteControl(stream, controler, controlRequest, confrId);\n        },\n\n        function onRemoteFreeControl(stream, controler, cId) {\n            self.onRemoteFreeControl(stream, controler, cId, confrId);\n        }\n    );\n    _logger.info(\"support remote control. \", confrId, joinMemberId);\n\n    return of(_util.extend({}, self._confrs[confrId]));\n}\n\nfunction rxJoinUseTicket(confrId, ticket, ext) {\n    var self = this;\n\n    if(self.joined(confrId)){\n        return throwError(\"had joined confr \" + confrId + \", if you want join again, please call exitConference\");\n    }\n\n    var events = self._events[confrId] = new self.EventsObservable(self, confrId, function (stream) {\n        onRemoteStream.call(self, confrId, stream);\n    });\n\n    self.confrEventsObserver && events.subscribe(self.confrEventsObserver);\n\n    var service = self._service(confrId);\n    service = self._services[confrId] = new emedia.XService({\n        listeners: events,\n        nickName: ext && ext.nickName\n    });\n\n    service.setup(ticket, ext);\n\n    return Observable.create(function onSubscription(observer) {\n\n        if(emedia.config.uploadStats) { // 开启 stats 上报\n            self.upload_stats = new UploadStats(emedia); // 将 emedia 传入，在里面获取数据\n\n            try {\n                self.upload_stats.connect_ws();\n            } catch (error) {\n                console.error('upload_stats.connect_ws error', error);\n            }\n        }\n\n\n        service.join(function (memId) {\n\n            if(self.upload_stats) { // 开始上报\n                let sessionId = service.current._session._sessionId;\n                self.upload_stats.join_success(sessionId)\n            }\n\n            self.__current_confrId = confrId;\n            self._confrs[confrId].joinId = memId;\n            self._confrs[confrId].role = service.current && service.current.role;\n\n            observer.next(self._confrs[confrId]);\n            observer.complete();\n        }, function (event) {\n\n            if(self.upload_stats) { // 上报一条错误信息\n                self.upload_stats.join_fail()\n            }\n\n            service.exit();\n            observer.error({\n                errorType: \"join_fail\",\n                error: -200,\n                errorMessage: event.message()\n            });\n        })\n    }).pipe(concatMap((joinMemberId, _index) => {\n        return rxSupportRemoteControl.call(self, confrId, joinMemberId, service);\n    }), concatMap((joinMemberId, _index) => {\n        return rxAfterJoinedConfr.call(self, confrId, joinMemberId);\n    }), errorHandler);\n}\n\nfunction rxJoinUsePassword(confrId, password, ext) {\n    var self = this;\n\n    return rxReqTkt.call(self, confrId, password, ext)\n        .pipe(concatMap((_confr, _index) => {\n            return rxJoinUseTicket.call(self, confrId, _confr.ticket, ext);\n        }));\n}\n\nfunction rxJoinExistConfrUsePassword(confrId, password, ext) {\n    var self = this;\n    return rxSelectConfr.call(self, confrId, password, ext).pipe(\n        concatMap((_confr, _index) => {\n            return rxJoinUsePassword.call(self, confrId, password, ext);\n        }));\n}\n\nfunction openUserMedia(confrId, openingStream) {\n    var self = this;\n    var service = self._service(confrId);\n\n    return Observable.create(function onSubscription(observer) {\n        service.openUserMedia(openingStream).then(function(){\n            observer.next(openingStream);\n            observer.complete();\n        }, function fail(evt) {\n            observer.error({\n                errorType: \"open_user_media_fail\",\n                error: -201,\n                errorMessage: evt.message()\n            });\n        });\n    }).pipe(errorHandler);\n}\n\nfunction rxPublish(confrId, userStream) {\n    var self = this;\n    var service = self._service(confrId);\n\n    return Observable.create(function onSubscription(observer) {\n        service.push(userStream, function(pushedStream){\n            observer.next(pushedStream);\n            observer.complete();\n        }, function fail(evt) {\n            observer.error({\n                errorType: \"push_fail\",\n                error: -203,\n                errorMessage: evt.message()\n            });\n        });\n    }).pipe(errorHandler);\n}\n\nfunction rxResumePauseVideo(pubS, videoConstaints, confrId) {\n    var self = this;\n    var confr = self._confr(confrId);\n    var service = self._service(confrId);\n\n    if(typeof pubS === 'string'){\n        pubS = service.getStreamById(pubS);\n    }else{\n        pubS = service.getStreamById(pubS.id);\n    }\n    if(!pubS){\n        return throwError(\"pub stream not exsits. it is \" + pubS);\n    }\n\n    // if((typeof videoConstaints !== 'boolean' && pubS.constaints && _.isEqual(videoConstaints, pubS.constaints.video))\n    //     || videoConstaints == !pubS.voff){\n    //     return of(_.extend({}, confr.av));\n    // }\n\n    if(!videoConstaints){\n        return rxVoff.call(self, confrId, pubS, 1);\n    }\n\n    if(_.isEqual(videoConstaints, pubS.constaints.video)){\n        return rxVoff.call(self, confrId, pubS, 0);\n    }\n\n    return rxChanageVideoConstraints.call(self, confrId, pubS, videoConstaints);\n}\n// 质量监控上报 开关音视频事件\nfunction upload_aoff_or_voff_event(event, pubS) {\n\n\n    if(!this.upload_stats) {\n        return\n    }\n\n    if(!event || !pubS) {\n        return\n    }\n\n    let current = this._services[this.__current_confrId].current;\n    if(!current) {\n        return\n    }\n\n    let _o = {\n        event,\n        rtcId: pubS.rtcId,\n        sId: pubS.id,\n        sessionId: current._session._sessionId,\n        streamType: pubS.type,\n        voff: pubS.voff,\n        aoff: pubS.aoff,\n\n    }\n    this.upload_stats.upload_event(_o);\n}\nfunction rxVoff(confrId, pubS, voff) {\n    var self = this;\n    var service = self._service(confrId);\n\n    return Observable.create(function onSubscription(observer) {\n        service.voff(pubS, voff, function fail(evt) {\n            observer.error({\n                errorType: \"voff_fail\",\n                error: -203,\n                errorMessage: evt.message()\n            });\n        }, function success() {\n\n            let stream = service.getStreamById(pubS.id);\n            observer.next(stream);\n            observer.complete();\n\n            let event = voff == 1 ? 8 : 6;\n            upload_aoff_or_voff_event.bind(self)(event,stream) // 质量监控上报\n        });\n    }).pipe(errorHandler);\n}\n\nfunction rxChanageVideoConstraints(confrId, pubS, videoConstaints) {\n    var self = this;\n    var service = self._service(confrId);\n\n    return Observable.create(function onSubscription(observer) {\n        var constaints = {};\n        if(_.isObject(pubS.constaints)){\n            constaints = _util.extend(true, {}, pubS.constaints);\n        }\n        constaints.video = videoConstaints;\n\n        service.chanageConstraints(pubS, constaints, function fail(evt) {\n            observer.error({\n                errorType: \"ChanageVideoConstraints_fail\",\n                error: -203,\n                errorMessage: evt.message()\n            });\n        }, function success() {\n            observer.next(service.getStreamById(pubS.id));\n            observer.complete();\n        });\n    }).pipe(errorHandler);\n}\n\nfunction rxResumePauseAudio(pubS, aoff, confrId) {\n\n\n    var self = this;\n    var confr = self._confr(confrId);\n    var service = self._service(confrId);\n\n    if(typeof pubS === 'string'){\n        pubS = service.getStreamById(pubS);\n    }else{\n        pubS = service.getStreamById(pubS.id);\n    }\n    if(!pubS){\n        return throwError(\"pub stream not exsits. it is \" + pubS);\n    }\n\n    if(confr.type === self.ConfrType.COMMUNICATION_MIX || confr.type === self.ConfrType.LIVE){\n        //混音时，共享桌面带声音，会造成 服务端错误。\n        if(pubS.type === 1 && !aoff){\n            _logger.warn(\"confr mix. not allow desktop with audio.\");\n            return throwError(\"confr mix. not allow desktop with audio.\")\n        }\n    }\n\n    return rxAoff.call(self, confrId, pubS, aoff);\n}\n\nfunction rxAoff(confrId, pubS, aoff) {\n    var self = this;\n    var service = self._service(confrId);\n\n    return Observable.create(function onSubscription(observer) {\n        service.aoff(pubS, aoff, function fail(evt) {\n            observer.error({\n                errorType: \"aoff_fail\",\n                error: -203,\n                errorMessage: evt.message()\n            });\n        }, function success() {\n            let stream = service.getStreamById(pubS.id);\n            observer.next(stream);\n            observer.complete();\n\n            let event = aoff == 1 ? 7 : 5;\n            upload_aoff_or_voff_event.bind(self)(event,stream) // 质量监控上报\n        });\n    }).pipe(errorHandler);\n}\n\nfunction rxPublishMedia(confrId, constaints, videoTag, ext) {\n    var self = this;\n\n    var confr = self._confr(confrId);\n    var service = self._service(confrId);\n\n    if(service.current.role == self.Role.AUDIENCE){\n        return throwError(\"Audience not allow publish\");\n    }\n    if(confr.av){\n        return throwError(\"Audio and video stream has been published. not allow repeat publish.\");\n    }\n\n    var Stream = confr.mixed ? service.AudioMixerPubstream : service.AVPubstream;\n    var stream = confr.av = new Stream({\n        constaints: constaints,\n        aoff: 0,\n        voff: 0,\n        ext: ext\n    });\n\n    return openUserMedia.call(self, confr.id, stream).pipe(\n        concatMap((userStream) => {\n            videoTag && _util.targetDOM(videoTag) && attachMediaStream(videoTag, userStream.localStream);\n            return rxPublish.call(self, confr.id, userStream, ext);\n        }),\n        map((pushedStream) => {\n            confr.av = pushedStream;\n            videoTag && self.streamBindVideo(confr.av, videoTag);\n            confr.type == self.ConfrType.LIVE && self.hungup(0);\n            return _util.extend({}, pushedStream);\n        }),\n        catchError((err, caught) => {\n            confr.av && self.hungup(confr.av);\n            confr.av = undefined;\n\n            _logger.error(err);\n            throw err;\n        }));\n}\n\nfunction rxSwitchMobileCamera(confrId) {\n    var self = this;\n\n    var confr = self._confr(confrId);\n    var service = self._service(confrId);\n\n    if(service.current.role == self.Role.AUDIENCE){\n        return throwError(\"Audience not allow publish\");\n    }\n\n    return Observable.create(function onSubscription(observer) {\n        service.switchMobileCamera(confr.av, function fail(evt) {\n            observer.error({\n                errorType: \"switch_camera_fail\",\n                error: -203,\n                errorMessage: evt.message()\n            });\n        }, function success() {\n            observer.complete();\n        });\n    }).pipe(errorHandler);\n}\n\nfunction rxChanageCamera(confrId) {\n    var self = this;\n\n    var confr = self._confr(confrId);\n    var service = self._service(confrId);\n\n    if(service.current.role == self.Role.AUDIENCE){\n        return throwError(\"Audience not allow publish\");\n    }\n\n    return Observable.create(function onSubscription(observer) {\n        service.chanageCamera(confr.av, function fail(evt) {\n            observer.error({\n                errorType: \"switch_camera_fail\",\n                error: -203,\n                errorMessage: evt.message()\n            });\n        }, function success() {\n            observer.complete();\n        });\n    }).pipe(errorHandler);\n}\n\nfunction rxShareDesktop(options) {\n    let {\n            confrId,\n            constaints,\n            videoTag,\n            ext,\n            stopSharedCallback\n        } = options;\n\n    var self = this;\n\n    var confr = self._confr(confrId);\n    var service = self._service(confrId);\n\n    if(service.current.role == self.Role.AUDIENCE){\n        return throwError(\"Audience not allow publish\");\n    }\n    if(confr.desktop){\n        return throwError(\"desktop stream has been published. not allow repeat publish.\")\n    }\n\n    if(confr.type === self.ConfrType.COMMUNICATION_MIX || confr.type === self.ConfrType.LIVE){\n        //混音时，共享桌面带声音，会造成 服务端错误。\n        if(constaints.audio){\n            _logger.warn(\"confr mix. not allow desktop with audio.\");\n            return throwError(\"confr mix. not allow desktop with audio.\")\n        }\n    }\n\n    if(!constaints.audio && confr.av && !confr.av.aoff){\n        _logger.warn(\"repeat audio. desktop and av\");\n    }\n\n    var stream = confr.desktop = new service.ShareDesktopPubstream({\n        screenOptions: (constaints.video && constaints.video.screenOptions) || ['screen', 'window', 'tab'],\n        mandatory: (constaints.video && constaints.video.mandatory) || {},\n        vbitrate: (constaints.video && constaints.video.bitrate),\n        abitrate: (constaints.audio && constaints.audio.bitrate),\n        aoff: !!constaints.audio ? 0 : 1,\n        ext: ext,\n        onMediaInactive: function () {\n            // stopShareDesktop callback\n\n            typeof stopSharedCallback == 'function'\n                && stopSharedCallback();\n        },\n        // onMediaActive: function () {\n        //     typeof sharedCallback == 'function'\n        //         && sharedCallback();\n        // }\n    });\n\n    return openUserMedia.call(self, confr.id, stream).pipe(\n        concatMap((userStream) => {\n            videoTag && _util.targetDOM(videoTag) && attachMediaStream(videoTag, userStream.localStream);\n            return rxPublish.call(self, confr.id, userStream, ext);\n        }),\n        map((pushedStream) => {\n            confr.desktop = pushedStream;\n            videoTag && _util.targetDOM(videoTag) && self.streamBindVideo(confr.desktop, videoTag);\n            return _util.extend({}, pushedStream);\n        }),\n        catchError((err, caught) => {\n            confr.desktop = undefined;\n            _logger.error(err);\n            throw err;\n        }));\n}\n\nfunction rxSubscribe(confrId, stream, subSVideo, subSAudio, videoTag) {\n    var self = this;\n    var streamId = typeof stream === \"string\" ? stream : stream.id;\n\n    var confr = self._confr(confrId);\n    var service = self._service(confrId);\n\n    if(stream.type === 2 && subSAudio == true && stream.id != 0){\n        //return throwError(\"Mixed audio stream. not allow repeat sub audio\");\n        subSAudio = false;\n        _logger.warn(\"Mixed audio stream. not allow repeat sub audio. force reset subSAudio = false\")\n    }\n\n    videoTag && _util.targetDOM(videoTag) && self.streamBindVideo(streamId, videoTag);\n\n    return Observable.create(function onSubscription(observer) {\n        service.subscribe(streamId, function (remoteMediaStream){\n            try{\n                if(streamId != \"0\"){\n                    var cacheStream = service.getStreamById(streamId);\n                    var constaints = {\n                        video: cacheStream.subArgs ? cacheStream.subArgs.subSVideo : !cacheStream.voff,\n                        audio: cacheStream.subArgs ? cacheStream.subArgs.subSAudio : !cacheStream.aoff\n                    };\n                    if(cacheStream.type === 2){\n                        constaints.audio = true;\n                    }\n                    self._onMemberMediaChanaged(cacheStream.owner, cacheStream, constaints, confr.confrId);\n                }\n            }finally{\n                observer.next(remoteMediaStream);\n                observer.complete();\n            }\n        }, function (evt) {\n            observer.error({\n                errorType: \"sub_fail\",\n                error: -203,\n                errorMessage: evt.message()\n            });\n        }, {subSVideo: subSVideo, subSAudio: subSAudio});\n    }).pipe(errorHandler);\n}\n\nfunction streamBindVideo(stream, _videoTag, confrId) {\n    var self = this;\n\n    var service = self._service(confrId);\n    stream = service.current._cacheStreams[typeof stream === \"string\" ? stream : stream.id];\n\n    var videoTag = _videoTag || self.crtAndReturnVideo(stream.owner, stream);\n    if(!videoTag){\n        return;\n    }\n    self._videos[stream.id] = videoTag;\n\n    videoTag.setAttribute(\"autoplay\", \"autoplay\");\n    videoTag.setAttribute(\"playsinline\", \"playsinline\");\n    videoTag.setAttribute(\"hx_stream\", stream.id);\n\n    stream.aoff ? videoTag.setAttribute(\"aoff\", \"aoff\") : videoTag.removeAttribute(\"aoff\");\n    stream.voff ? videoTag.setAttribute(\"voff\", \"voff\") : videoTag.removeAttribute(\"voff\");\n\n    stream.ifMediaStream(function (mediaStream) {\n        videoTag && attachMediaStream(videoTag, mediaStream);\n\n        if(videoTag.hasAttribute(\"flow\")){\n            self.onMediaTransmission(videoTag, function cb(trackId, type, subtype, data) {\n                zepto(videoTag).trigger(\"onMediaTransmission\", [trackId, type, subtype, data]);\n            });\n        }\n    });\n\n    var $video = zepto(videoTag);\n    $video.off(\"hungup\");\n    $video.on(\"hungup\", function (e, fail, success) {\n        self.hungup(stream, confrId);\n        success && success();\n    });\n\n    $video.off(\"subscribe\");\n    $video.on(\"subscribe\", function (e, subSVideo, subSAudio, fail, success) {\n        if(stream.located()){\n            fail && fail(\"local stream not allow sub\");\n        }else{\n            subSVideo = stream.subArgs && stream.subArgs.subSVideo || true;\n            subSAudio = stream.subArgs && stream.subArgs.subSAudio || true;\n            self.subscribe(stream.owner, stream, subSVideo, subSAudio, confrId).then(success).catch(fail);\n        }\n    });\n\n    $video.off(\"pauseVideo\");\n    $video.on(\"pauseVideo\", function (e, fail, success) {\n        stream = service.current._cacheStreams[typeof stream === \"string\" ? stream : stream.id];\n\n        if(stream.located()){\n            $video[0].__constaints_video = stream.constaints && stream.constaints.video;\n            self.pauseVideo(stream, confrId).then(success).catch(fail);\n        }else{\n            self.subscribe(stream.owner, stream, false, stream.subArgs && stream.subArgs.subSAudio || !stream.aoff, confrId).then(success).catch(fail);\n        }\n    });\n\n    $video.off(\"resumeVideo\");\n    $video.on(\"resumeVideo\", function (e, fail, success, constaintsVideo) {\n        stream = service.current._cacheStreams[typeof stream === \"string\" ? stream : stream.id];\n\n        if(stream.located()){\n            if(constaintsVideo === undefined){\n                constaintsVideo = $video[0].__constaints_video;\n                if(constaintsVideo === undefined || constaintsVideo == null){\n                    constaintsVideo = true;\n                }\n            }\n            $video[0].__constaints_video = undefined;\n\n            self.resumeVideo(stream, constaintsVideo, confrId).then(success).catch(fail);\n        }else{\n            self.subscribe(stream.owner, stream, true, stream.subArgs && stream.subArgs.subSVideo || !stream.voff, confrId).then(success).catch(fail);\n        }\n    });\n\n    $video.off(\"pauseAudio\");\n    $video.on(\"pauseAudio\", function (e, fail, success) {\n        if(stream.located()){\n            self.pauseAudio(stream, confrId).then(success).catch(fail);\n        }else{\n            self.subscribe(stream.owner, stream, stream.subArgs.subSVideo, false, confrId).then(success).catch(fail);\n        }\n    });\n\n    $video.off(\"resumeAudio\");\n    $video.on(\"resumeAudio\", function (e, fail, success) {\n        if(stream.located()){\n            self.resumeAudio(stream, confrId).then(success).catch(fail);\n        }else{\n            self.subscribe(stream.owner, stream, stream.subArgs.subSVideo, true, confrId).then(success).catch(fail);\n        }\n    });\n\n    $video.off(\"remoteControl\");\n    $video.on(\"remoteControl\", function (e, mirror, onDisControlled, onAccept, onNotAllowRemoteControl, onRemoteControlTimeout, onReject, onBusy) {\n        if(stream.located()){\n            _logger.error(\"not allow remote control at local\");\n            throw \"not allow remote control at local\"\n        }else{\n            self.remoteControl(stream, videoTag, videoTag, mirror,\n                onDisControlled, onAccept, onNotAllowRemoteControl, onRemoteControlTimeout, onReject, onBusy, confrId);\n        }\n    });\n\n    $video.off(\"chanageCamera\");\n    $video.on(\"chanageCamera\", function (e, fail, success) {\n        self.chanageCamera(confrId).then(success).catch(fail);\n    });\n\n    $video.off(\"captureVideo\");\n    $video.on(\"captureVideo\", function (e, success, storeLocal, filename) {\n        var base64 = self.captureVideo(videoTag, storeLocal, filename, confrId);\n        success && success(base64);\n    });\n\n    $video.off(\"capturePictureRemote\");\n    $video.on(\"capturePictureRemote\", function (e, fail, success) {\n        self.capturePictureRemote(stream, false, confrId).then(success).catch(fail);\n    });\n\n    $video.off(\"freezeFrameRemote\");\n    $video.on(\"freezeFrameRemote\", function (e, fail, success) {\n        self.freezeFrameRemote(stream, confrId).then(success).catch(fail);\n    });\n\n    $video.off(\"zoomRemote\");\n    $video.on(\"zoomRemote\", function (e, multiples, fail, success) {\n        self.zoomRemote(stream, multiples, confrId).then(success).catch(fail);\n    });\n\n    $video.off(\"torchRemote\");\n    $video.on(\"torchRemote\", function (e, torch, fail, success) {\n        self.torchRemote(stream, torch, confrId).then(success).catch(fail);\n    });\n\n    $video.off(\"freeRemoteControl\");\n    $video.on('freeRemoteControl', function (e, fail, success) {\n        try{\n            self.freeRemoteControl(stream, confrId);\n        }finally {\n            success && success();\n        }\n    });\n\n    var constaints = {video: !stream.voff, audio: !stream.aoff, voff: stream.voff, aoff: stream.aoff};\n    if(!stream.located()){\n        constaints = {\n            video: stream.subArgs ? stream.subArgs.subSVideo : !stream.voff,\n            audio: stream.subArgs ? stream.subArgs.subSAudio : !stream.aoff,\n            voff: stream.voff,\n            aoff: stream.aoff\n        };\n    }\n    $video.trigger(\"onMediaChanaged\", [constaints, stream, stream.owner, confrId]);\n\n    if(videoTag.getAttribute(\"sound\")){\n        service.current._monitSoundChanagedStreams = service.current._monitSoundChanagedStreams || {};\n        service.current._monitSoundChanagedStreams[stream.id] = stream.id;\n    }\n}\n\nfunction rxFocusExpoRemote(confrId, streamId, videoTag, clickEvent) {\n    var self = this;\n\n    if(typeof streamId !== 'string'){\n        streamId = streamId.id;\n    }\n\n    var confr = self._confr(confrId);\n    var service = self._service(confrId);\n\n    return Observable.create(function onSubscription(observer) {\n        service.focusExpoRemote(streamId, videoTag, clickEvent, function (evt) {\n            observer.error({\n                errorType: \"focusexpo_remote_fail\",\n                error: -203,\n                errorMessage: evt.message()\n            });\n        }, function (){\n            observer.complete();\n        });\n    }).pipe(errorHandler);\n}\n\nfunction rxCapturePictureRemote(confrId, streamId, rspBase64Pic){\n    var self = this;\n\n    if(typeof streamId !== 'string'){\n        streamId = streamId.id;\n    }\n\n    var confr = self._confr(confrId);\n    var service = self._service(confrId);\n\n    return Observable.create(function onSubscription(observer) {\n        service.capturePictureRemote(streamId, rspBase64Pic, function (base64){\n            observer.next(base64);\n            observer.complete();\n        }, function (evt) {\n            observer.error({\n                errorType: \"capture_remote_fail\",\n                error: -203,\n                errorMessage: evt.message()\n            });\n        });\n    }).pipe(errorHandler);\n}\n\nfunction rxZoomRemote(confrId, streamId, multiples) {\n    var self = this;\n\n    if(typeof streamId !== 'string'){\n        streamId = streamId.id;\n    }\n\n    var confr = self._confr(confrId);\n    var service = self._service(confrId);\n\n    return Observable.create(function onSubscription(observer) {\n        service.zoomRemote(streamId, multiples, function fail(evt) {\n            observer.error({\n                errorType: \"capture_remote_fail\",\n                error: -203,\n                errorMessage: evt.message()\n            });\n        }, function () {\n            observer.complete();\n        });\n    }).pipe(errorHandler);\n}\n\nfunction rxTorchRemote(confrId, streamId, torch) {\n    var self = this;\n\n    if(typeof streamId !== 'string'){\n        streamId = streamId.id;\n    }\n\n    var confr = self._confr(confrId);\n    var service = self._service(confrId);\n\n    return Observable.create(function onSubscription(observer) {\n        service.torchRemote(streamId, torch, function (torch) {\n            observer.next(torch);\n            observer.complete();\n        }, function fail(evt) {\n            observer.error({\n                errorType: \"torch_remote_fail\",\n                error: -203,\n                errorMessage: evt.message()\n            });\n        });\n    }).pipe(errorHandler);\n}\n\nfunction rxFreezeFrameRemote(confrId, streamId) {\n    var self = this;\n\n    if(typeof streamId !== 'string'){\n        streamId = streamId.id;\n    }\n\n    var confr = self._confr(confrId);\n    var service = self._service(confrId);\n\n    return Observable.create(function onSubscription(observer) {\n        service.freezeFrameRemote(streamId, function (freezeFrame) {\n            observer.next(freezeFrame);\n            observer.complete();\n        }, function fail(evt) {\n            observer.error({\n                errorType: \"freeze_remote_fail\",\n                error: -203,\n                errorMessage: evt.message()\n            });\n        });\n    }).pipe(errorHandler);\n}\n\nvar _single = _util.extend(new Manager(), {\n    _confr: function(confrId){\n        var self = this;\n        confrId || (confrId = self.__current_confrId);\n        return self._confrs[confrId];\n    },\n    _service: function(confrId){\n        var self = this;\n        confrId || (confrId = self.__current_confrId);\n        return this._services[confrId];\n    },\n\n    getStreamById: function(streamId, confrId){\n        var self = this;\n        var service = self._service(confrId);\n        return service && service.getStreamById(streamId);\n    },\n    getMemberById: function(memId, confrId){\n        var self = this;\n        var service = self._service(confrId);\n        return service && service.getMemberById(memId);\n    },\n\n    streamBindVideo: function(stream, videoTag, confrId){\n        streamBindVideo.call(this, stream, videoTag, confrId);\n    },\n    getBindVideoBy: function(stream){\n        var self = this;\n        if(typeof stream !== \"string\" && stream && stream.id){\n            stream = stream.id;\n        }\n        if(typeof stream !== \"string\"){\n            _logger.error(\"Bad stream \", stream);\n            throw \"Bad stream \" + stream;\n        }\n        return self._videos[stream];\n    },\n    createConfr: function (confrType, password, rec, recMerge) {\n        return rxCreateConfr.apply(this, arguments).toPromise();\n    },\n\n    createConfrSptMnPrg: function(confrType, password, rec, recMerge){\n        return rxCreateConfrSptMnPrg.apply(this, arguments).toPromise();\n    },\n\n    reqTkt: function (confrId, password) {\n        return rxReqTkt.apply(this, arguments).toPromise();\n    },\n\n    chanageRoles: function (role, uids, confrId) {\n        return rxChanageRoles.apply(this, arguments).toPromise();\n    },\n\n    disbandConfr: function (confrId, roleToken) {\n        return rxDisbandConfr.apply(this, arguments).toPromise();\n    },\n\n    kickMember: function (uids, confrId) {\n        return rxKickMember.apply(this, arguments).toPromise();\n    },\n\n    selectConfr: function (confrId, password) {\n        return rxSelectConfr.apply(this, arguments).toPromise();\n    },\n\n    joinUsePassword: function (confrId, password, ext) {\n        return rxJoinExistConfrUsePassword.call(this, confrId, password, ext).toPromise();\n    },\n    joinUseTicket: function (confrId, ticket, ext) {\n        return rxJoinUseTicket.call(this, confrId, ticket, ext).toPromise();\n        // return rxJoinUseTicket.call(this, confrId, ticket, ext);\n    },\n    joined: function(confrId){\n        return (confrId && this._confrs[confrId] && this._confrs[confrId].joinId);\n    },\n\n    shareDesktopWithAudio: function (params) {\n\n        if(navigator.mediaDevices.getDisplayMedia && !emedia.isElectron){\n            return this.shareDesktopWithAudioNew(params)\n        }\n\n        let {\n            videoConstaints,\n            withAudio,\n            videoTag,\n            ext,\n            confrId,\n            sharedCallback,\n            stopSharedCallback\n         } = params;\n        var self = this;\n\n        if(!_util.targetDOM(videoTag)){\n            confrId = ext;\n            ext = videoTag;\n            videoTag = undefined;\n        }\n\n        var constaints = {\n            video: videoConstaints,\n            audio: withAudio\n        };\n\n        var options = {\n            confrId,\n            constaints,\n            videoTag,\n            ext,\n            sharedCallback,\n            stopSharedCallback\n        }\n\n        return rxShareDesktop.call(self, options).toPromise();\n    },\n    \n    // use new navigator api don't rely on plugin\n    shareDesktopWithAudioNew: async function(params) {\n\n        let { \n            confrId,\n            withAudio,\n            ext,\n            video,\n            stopSharedCallback\n        } = params;\n\n        if(!confrId) {\n            throw new Error('shareDesktop confrId is required');\n        }\n\n        let constaints = {\n            video:video || true,\n            audio:withAudio\n        }\n\n        const desktopMedia =  await navigator.mediaDevices.getDisplayMedia(constaints); // get screen media\n        \n        desktopMedia._located = true; //用于给标签添加 muted 属性\n        let pubS = {\n            localStream: desktopMedia,\n            type: 1,\n            aoff: withAudio ? 0 : 1,\n            voff: 0,\n            constaints,\n            _located:true\n        }\n\n        try {\n            const desktopStream = await rxPublish.call(this, confrId, pubS, ext).toPromise(); // publish stream\n            // [停止共享] 按钮监听\n            desktopMedia.getVideoTracks()[0].addEventListener('ended', () => {\n                if(typeof stopSharedCallback == 'function') {\n                    stopSharedCallback(desktopStream.id)\n                } \n            });\n\n            return desktopStream\n        } catch (error) {\n            \n        }\n        \n        \n\n    },\n\n    changeCamera: function(confrId){\n        return rxChanageCamera.call(this, confrId).toPromise();\n    },\n    switchMobileCamera: function(confrId){\n        return rxSwitchMobileCamera.call(this, confrId).toPromise();\n    },\n    shareVideoWithAudio: function (videoConstaints, withAudio, videoTag, ext, confrId) {\n        var self = this;\n\n        if(!_util.targetDOM(videoTag)){\n            confrId = ext;\n            ext = videoTag;\n            videoTag = undefined;\n        }\n\n        var constaints = {\n            video: videoConstaints,\n            audio: withAudio\n        };\n\n        return rxPublishMedia.call(self, confrId, constaints, videoTag, ext).toPromise();\n    },\n    captureVideo: function captureVideo(videoObj, storeLocal, filename, confrId) {\n        var self = this;\n        var service = self._service(confrId);\n        return service.captureVideo(videoObj, storeLocal, filename);\n    },\n\n    openUserMedia: function openUserMedia(constaints, confrId){\n        var self = this;\n        var service = self._service(confrId);\n\n        return Observable.create(function onSubscription(observer) {\n            service.__getUserMedia(constaints, function (attendee, stream) {\n                observer.next(stream);\n                observer.complete();\n            }, function (error) {\n                observer.error(error);\n            })\n        }).pipe(errorHandler).toPromise();\n    },\n\n    mediaDevices: function mediaDevices(kind){\n        if(typeof kind === 'function'){\n            kind = undefined;\n        }\n\n        return Observable.create(function onSubscription(observer) {\n            navigator.mediaDevices.enumerateDevices().then(function(deviceInfos){\n                var resultDeviceInfos = [];\n\n                for (var i = 0; i !== deviceInfos.length; ++i) {\n                    var deviceInfo = deviceInfos[i];\n                    var deviceId = deviceInfo.deviceId;\n\n                    if(!kind){\n                        resultDeviceInfos.push(deviceInfo);\n                    }\n\n                    if(kind && kind === deviceInfo.kind){\n                        resultDeviceInfos.push(deviceInfo);\n                    }else if (deviceInfo.kind === 'audioinput') {\n                    } else if (deviceInfo.kind === 'audiooutput') {\n                    } else if (deviceInfo.kind === 'videoinput') {\n                    } else {\n                        _logger.info('Some other kind of source/device: ', deviceInfo);\n                    }\n                }\n\n                observer.next(resultDeviceInfos);\n                observer.complete();\n            }).catch(function handleError(error) {\n                _logger.warn('navigator.getUserMedia error: ', error);\n                observer.error(error);\n            });\n        }).pipe(errorHandler).toPromise();\n    },\n    resumeVideo: function (pubS, videoConstaints, confrId) {\n        return rxResumePauseVideo.call(this, pubS, videoConstaints || true, confrId).toPromise();\n    },\n    pauseVideo: function(pubS, confrId){\n        return rxResumePauseVideo.call(this, pubS, false, confrId).toPromise();\n    },\n\n    resumeAudio: function (pubS, confrId) {\n        return rxResumePauseAudio.call(this, pubS, false, confrId).toPromise();\n    },\n    pauseAudio: function(pubS, confrId){\n        return rxResumePauseAudio.call(this, pubS, true, confrId).toPromise();\n    },\n\n    freezeFrameRemote: function(stream, confrId){\n        return rxFreezeFrameRemote.call(this, confrId, stream).toPromise();\n    },\n    torchRemote: function(stream, torch, confrId){\n        return rxTorchRemote.call(this, confrId, stream, torch).toPromise();\n    },\n    zoomRemote: function (stream, multiples, confrId) {\n        return rxZoomRemote.call(this, confrId, stream, multiples).toPromise();\n    },\n    capturePictureRemote: function(streamId, confrId){\n        return rxCapturePictureRemote.call(this, confrId, streamId, false).toPromise();\n    },\n\n    focusExpoRemote: function(stream, videoTag, clickEvent, confrId){\n        return rxFocusExpoRemote.call(this, confrId, stream, videoTag, clickEvent).toPromise();\n    },\n\n    onFocusExpoRemoteWhenClickVideo: function(tag, event, fail, success){\n        var self = this;\n\n        if(typeof event === 'function'){\n            success = fail;\n            fail = event;\n            event = undefined;\n        }\n\n        zepto(tag).off(event || 'click');\n        zepto(tag).on(event || 'click', function (e) {\n            var streamId = tag.getAttribute(\"hx_stream\");\n            self.focusExpoRemote(streamId, tag, e).then(success).catch(fail);\n        });\n\n        return event;\n    },\n    offEventAtTag: function(tag, event){\n        event && zepto(tag).off(event);\n    },\n\n    hungup: function (stream, confrId) {\n        var self = this;\n\n        var streamId;\n        if (typeof stream === \"string\") {\n            streamId = stream;\n        } else {\n            streamId = stream.id || (stream + \"\");\n        }\n\n        var service = self._service(confrId);\n        var confr = self._confr(confrId);\n        if(!confr || !service){\n            _logger.warn(\"when hungup stream. not found confr and service.\", stream);\n            return;\n        }\n\n        service.hungup(streamId);\n\n        var hungeAv = false;\n        confr.av && (hungeAv = confr.av.id === streamId) && (confr.av = undefined);\n        confr.desktop && confr.desktop.id === streamId && (confr.desktop = undefined);\n\n        if(hungeAv && confr.type == self.ConfrType.LIVE && service.current.role == single.Role.AUDIENCE){ //观众 订阅0  && service.current.role == single.Role.AUDIENCE\n            var zeroStream = service.current && service.current._cacheStreams[\"0\"];\n            self.subscribe(service.current, zeroStream, false, true, confrId);\n        }\n    },\n\n    subscribe: function (member, stream, subSVideo, subSAudio, videoTag, confrId) {\n        var self = this;\n        if(!_util.targetDOM(videoTag)){\n            confrId = videoTag;\n            videoTag = undefined;\n        }\n        return rxSubscribe.call(self, confrId, stream, subSVideo, subSAudio, videoTag).toPromise();\n    },\n\n    exit: function (closeMyConfrIfICrtConfr, confrId) {\n        var self = this;\n\n        var service = self._service(confrId);\n        if(!service){\n            _logger.warn(\"when exit. not found service.\", confrId);\n            return;\n        }\n        service.exit(closeMyConfrIfICrtConfr);\n\n        if(self.upload_stats) {// stop upload qoe\n            setTimeout(() => self.upload_stats.stop(),3000) // set timeout wait onEixt upload eixt event\n        }\n    },\n\n    _onExit: function (confrId, reason, failed) {\n        var self = this;\n        \n        try{\n            self.__current_confrId = undefined;\n            self.onExit(reason, failed, confrId);\n        } finally {\n            _util.removeAttribute(self._confrs, confrId);\n            _util.removeAttribute(self._services, confrId);\n            _util.removeAttribute(self._videos, confrId);\n            _util.removeAttribute(self._events, confrId);\n        }\n    },\n    onExit: (reason, failed, confrId) => {\n    },\n    _onRoleUpdated: (role, confrId) => {\n    },\n\n    onMemberJoin: (member, confrId) => {\n    },\n    onMemberLeave: (member, reason, confrId) => {\n    },\n    _onRecvRemoteMessage: function (fromMember, argsObject, confrId) {\n    },\n\n    crtAndReturnVideo: (member, stream, confrId) => {\n        //throw \"Please set crtAndReturnVideo\";\n    },\n    unloadVideo: (member, stream, video, confrId) => {\n        //throw \"Please set unloadVideo\";\n    },\n\n    remoteControl: function (stream, videoObj, targetDiv, mirror,\n                             onDisControlled, onAccept, onNotAllowRemoteControl, onRemoteControlTimeout, onReject, onBusy, confrId) {\n        var self = this;\n        var service = self._service(confrId);\n\n        mirror = !!mirror;\n\n        var streamId = typeof stream === \"string\" ? stream : stream.id;\n\n        if(mirror){\n            emedia.ctrl.mirrorControlled(service, streamId, videoObj, targetDiv,\n                onDisControlled, onAccept, onNotAllowRemoteControl, onRemoteControlTimeout, onReject, onBusy);\n        }else{\n            emedia.ctrl.controlled(service, streamId, videoObj, targetDiv,\n                onDisControlled, onAccept, onNotAllowRemoteControl, onRemoteControlTimeout, onReject, onBusy);\n        }\n    },\n\n    freeRemoteControl: function(stream, confrId){\n        var self = this;\n        var service = self._service(confrId);\n        var streamId = typeof stream === \"string\" ? stream : stream.id;\n        emedia.ctrl.disControlled(service, streamId);\n    },\n\n    zeptoTrigger: function (tag, event) {\n        var otherArgs = [];\n        Array.prototype.push.apply(otherArgs, Array.prototype.slice.call(arguments, 2));\n\n        //zepto(tag).trigger(event, [fail, success]);\n        return Observable.create(function onSubscription(observer) {\n            var eventArgs = [function fail() {\n                observer.error.apply(observer, arguments);\n            }, function success() {\n                observer.next.apply(observer, arguments);\n                observer.complete();\n            }];\n            Array.prototype.push.apply(eventArgs, otherArgs);\n\n            zepto(tag).trigger(event, eventArgs);\n        }).pipe(errorHandler).toPromise();\n    },\n    _onAddMemberStream: function(stream, confrId){\n\n    },\n    _onRemoveMemberStream: function(stream, confrId){\n\n    },\n    _onUpdateMemberStream: function(stream, constaints, confrId){\n\n    },\n    _onMemberMediaChanaged: function(member, stream, constaints, confrId){\n        var tag = this._videos[stream.id];\n        constaints && (constaints.voff = stream.voff, constaints.aoff = stream.aoff);\n        tag && zepto(tag).trigger(\"onMediaChanaged\", [constaints, stream, member, confrId]);\n    },\n    onMediaChanaged: function(tag, cb){ // cb video audio\n        this.addVideoEventListener(tag, \"onMediaChanaged\", cb);\n    },\n\n    _onMemberSoundChanaged: function (member, stream, meterData, confrId) {\n        var tag = this._videos[stream.id];\n        tag && zepto(tag).trigger(\"onSoundChanaged\", [meterData, stream, member, confrId]);\n    },\n    onSoundChanaged: function(tag, cb){ // cb video audio\n        if(!emedia.config.getMediaMeterIntervalMillis || emedia.config.getMediaMeterIntervalMillis <= 0){\n            _logger.error(\"monit sound chanaged not config. please config getMediaMeterIntervalMillis\");\n            throw \"monit sound chanaged not config. please config getMediaMeterIntervalMillis\";\n        }\n\n        tag.setAttribute(\"sound\", \"sound\");\n        this.addVideoEventListener(tag, \"onSoundChanaged\", cb);\n    },\n\n    onMediaTransmission: function(tag, cb){ // cb video audio\n        if(!emedia.helper || typeof emedia.helper.inboundVideo !== \"function\"){\n            _logger.warn(\"please import helper. <script>\");\n            return;\n        }\n\n        var service = this._service();\n\n        var streamId = tag.getAttribute(\"hx_stream\");\n        var stream = streamId && service.getStreamById(streamId);\n        var flowWebrtc = tag.getAttribute(\"flowWebrtc\");\n\n        if(stream && stream._webrtc && flowWebrtc == stream._webrtc.__id){\n            return;\n        }\n\n        if(tag.hasAttribute(\"flow\")\n            && stream\n            && stream._webrtc){ //开启流量监控\n\n            if(stream.located()){\n                emedia.helper.outboundVideo(stream, cb, 1000);\n            }else{\n                emedia.helper.inboundVideo(stream, cb, 1000);\n            }\n\n            tag.setAttribute(\"flowWebrtc\", stream._webrtc.__id);\n        }else{\n            this.addVideoEventListener(tag, \"onMediaTransmission\", cb);\n            tag.setAttribute(\"flow\", \"flow\");\n        }\n    },\n\n    _onTalking: function (member, stream, meterData, confrId) {\n    },\n\n    _onNotSupportMemberPublishVideoCodecs: function (member, stream, confrId) {\n        var tag = this._videos[stream.id];\n        tag && zepto(tag).trigger(\"onNotSupportVideoCodecs\", [stream, member, confrId]);\n    },\n    onNotSupportVideoCodecs: function(tag, cb){\n        this.addVideoEventListener(tag, \"onNotSupportVideoCodecs\", cb);\n    },\n\n    _onStreamIceStateChanged: function (member, stream, state, confrId) {\n        var tag = this._videos[stream.id];\n        tag && zepto(tag).trigger(\"onIceStateChanged\", [state, stream, member, confrId]);\n    },\n    onIceStateChanged: function(tag, cb){\n        this.addVideoEventListener(tag, \"onIceStateChanged\", cb);\n    },\n\n    onHasRemoteControl: function onHasRemoteControl(stream, controler, controlRequest, confrId) {\n        var tag = this._videos[stream.id];\n        tag && zepto(tag).trigger(\"onRemoteControl\", [controler, controlRequest, stream, confrId]);\n    },\n    onRemoteControl: function(tag, cb){\n        this.addVideoEventListener(tag, \"onRemoteControl\", cb);\n    },\n\n    onRemoteFreeControl: function onRemoteFreeControl(stream, controler, cId, confrId) {\n        var tag = this._videos[stream.id];\n        tag && zepto(tag).trigger(\"onFreeControl\", [controler, cId, stream, confrId]);\n    },\n    onFreeControl: function(tag, cb){\n        this.addVideoEventListener(tag, \"onFreeControl\", cb);\n    },\n\n    addVideoEventListener: function (tag, event, callback) {\n        zepto(tag).off(event);\n        zepto(tag).on(event, function () {\n            var args = [];\n            for(var i = 1; i < arguments.length; i++){\n                args.push(arguments[i]);\n            }\n            callback && callback.apply(tag, args);\n        });\n    }\n});\n\n_.each([\"hungup\", \"subscribe\", \"pauseVideo\", \"resumeVideo\", \"pauseAudio\",\n    \"resumeAudio\", \"chanageCamera\", \"freeRemoteControl\",\n    \"capturePictureRemote\", \"freezeFrameRemote\"], function (val, index) {\n    var name = val.replace(/\\b[a-z]/g,function(s){return s.toUpperCase();});\n    _single[\"trigger\" + name] = function (tag) {\n        var args = [];\n        args.push(tag);\n        args.push(val);\n        Array.prototype.push.apply(args, Array.prototype.slice.call(arguments, 1));\n        return _single.zeptoTrigger.apply(_single, args);\n    }\n});\n\n_single.triggerTorchRemote = function(tag, torch){\n    return Observable.create(function onSubscription(observer) {\n        zepto(tag).trigger(\"torchRemote\", [torch, function fail() {\n            observer.error.apply(observer, arguments);\n        }, function success() {\n            observer.next.apply(observer, arguments);\n            observer.complete();\n        }]);\n    }).pipe(errorHandler).toPromise();\n};\n\n_single.triggerZoomRemote = function(tag, multiples){\n    return Observable.create(function onSubscription(observer) {\n        zepto(tag).trigger(\"zoomRemote\", [multiples, function fail() {\n            observer.error.apply(observer, arguments);\n        }, function success() {\n            observer.next.apply(observer, arguments);\n            observer.complete();\n        }]);\n    }).pipe(errorHandler).toPromise();\n};\n\n_single.triggerSubscribe = function(tag, subSVideo, subSAudio){\n    return Observable.create(function onSubscription(observer) {\n        zepto(tag).trigger(\"subscribe\", [subSVideo, subSAudio, function fail() {\n            observer.error.apply(observer, arguments);\n    }, function success() {\n            observer.next.apply(observer, arguments);\n            observer.complete();\n        }]);\n    }).pipe(errorHandler).toPromise();\n};\n\n_single.triggerRemoteControl = function (tag, mirror, onDisControlled, onAccept, onNotAllowRemoteControl, onRemoteControlTimeout, onReject, onBusy) {\n    zepto(tag).trigger(\"remoteControl\", [mirror, onDisControlled, onAccept, onNotAllowRemoteControl, onRemoteControlTimeout, onReject, onBusy]);\n};\n_single.triggerCaptureVideo = function (tag, storeLocal, filename) {\n    return Observable.create(function onSubscription(observer) {\n        zepto(tag).trigger(\"captureVideo\", [function success() {\n            observer.next.apply(observer, arguments);\n            observer.complete();\n        }, storeLocal, filename]);\n    }).pipe(errorHandler).toPromise();\n};\n\n\nexport let single = _single;","import { single as inner } from \"./Manager\";\n\nimport _ from 'underscore';\nimport zepto  from 'zepto-webpack';\n\nvar _outer = {};\n\ninner.onMemberJoin = function (member, confrId){\n    emedia.decodeMemeberName(member);\n    this.onMemberJoined(member, inner._confr(confrId));\n};\ninner.onMemberLeave = function (member, reason, confrId){\n    emedia.decodeMemeberName(member);\n    this.onMemberExited(member, reason, inner._confr(confrId));\n};\ninner._onRoleUpdated = function (role, confrId){\n    this.onRoleChanged(role, inner._confr(confrId));\n};\ninner._onAddMemberStream = function (stream, confrId){\n    stream && emedia.decodeMemeberName(stream.owner);\n    this.onStreamAdded(stream.owner, stream, inner._confr(confrId));\n};\ninner._onRemoveMemberStream = function (stream, confrId){\n    stream && emedia.decodeMemeberName(stream.owner);\n    this.onStreamRemoved(stream.owner, stream, inner._confr(confrId));\n};\ninner._onUpdateMemberStream = function(stream, constaints, confrId){\n    stream && emedia.decodeMemeberName(stream.owner);\n    this.onStreamUpdated && this.onStreamUpdated(stream.owner, stream, constaints, inner._confr(confrId));\n};\ninner.onExit = function(reason, failed, confrId){\n    this.onConferenceExit(reason, failed, inner._confr(confrId));\n};\n\n/**\n * 有人加入会议的回调 返回member\n * @method onMemberJoined\n */\n_outer.onMemberJoined = function (member) {\n\n};\n/**\n * 有人退出的回调 返回member，reason\n * @method onMemberExited\n */\n_outer.onMemberExited = function (member, reason) {\n\n};\n/**\n * 改变角色的回调 返回role\n * @method onRoleChanged\n */\n_outer.onRoleChanged = function (role) {\n\n};\n/**\n * 有媒体流加入的回调 返回role\n * @method onStreamAdded\n */\n_outer.onStreamAdded = function (member, stream) {\n\n};\n/**\n * 有媒体流移除的回调 返回role\n * @method onStreamRemoved\n */\n_outer.onStreamRemoved = function (member, stream) {\n\n};\n/**\n * 退出会议的回调 返回role\n * @method onConferenceExit\n */\n_outer.onConferenceExit = function (reason, error) {\n\n};\n\n/**\n * 通过ticket加入会议\n * @method joinConferenceWithTicket\n * @param {String} confrId - 会议id\n * @param {String} ticket - 会议ticket\n * @param {String} ext - 扩展\n */\n_outer.joinConferenceWithTicket = inner.joinUseTicket;\n\n/**\n * 通过password加入会议\n * @method joinConference\n * @param {String} confrId - 会议id\n * @param {String} password - 会议密码\n * @param {String} ext - 扩展\n */\n_outer.joinConference = inner.joinUsePassword;\n\n/**\n * 获取会议ticket\n * @method getConferenceTkt\n * @param {String} confrId - 会议id\n * @param {String} password - 会议密码\n */\n_outer.getConferenceTkt = inner.reqTkt;\n\n/**\n * 发布媒体流\n * @method publish\n * @param {Object} constaints - \n * @param {boolean} audio - 是否发布音频\n * @param {boolean} video - 是否发布视频\n * @param {Object} videoTag - video标签\n * @param {string} ext - 扩展\n */\n_outer.publish = function (constaints, videoTag, ext) {\n    return inner.shareVideoWithAudio(constaints.video, constaints.audio, videoTag, ext);\n};\n\n/**\n * 取消发布媒体流\n * @method unpublish\n * @param {Object} constaints - \n * @param {boolean} audio - 是否发布音频\n * @param {boolean} video - 是否发布视频\n * @param {Object} videoTag - video标签\n * @param {string} ext - 扩展\n */\n_outer.unpublish = function (stream) {\n    return inner.hungup(stream);\n};\n//_outer.subscribe = inner.subscribe; //subscribe: function (member, stream, subSVideo, subSAudio, videoTag, confrId)\n\n/**\n * 取消订阅媒体流\n * @method unsubscribe\n * @param {Object} stream - 媒体流\n */\n_outer.unsubscribe = function (stream) {\n    return inner.hungup(stream);\n};\n\n/**\n * 退出会议\n * @method exitConference\n * @param {boolean} closedSelfConfr - 是否关闭创建的会议，默认false\n */\n_outer.exitConference = function (closedSelfConfr) {\n    return inner.exit(closedSelfConfr || false);\n};\n\n/**\n * 获取会议信息\n * @method getConferenceInfo\n * @param {string} confrId - 会议id\n * @param {string} password - 会议密码\n */\n_outer.getConferenceInfo = function (confrId, password) {\n    return inner.selectConfr(confrId, password);\n};\n\n/**\n * 创建会议\n * @method createConference\n * @param {Number} confrType - 会议类型 COMMUNICATION: 10, COMMUNICATION_MIX: 11, LIVE: 12, P2P: 13, INTERCOMM: 14\n * @param {string} password - 会议密码\n * @param {boolean} rec - 是否录制\n * @param {boolean} recMerge - 是否合并\n * @param {boolean} supportWechatMiniProgram - 是否支持小程序\n * @example createConference(emedia.mgr.ConfrType.COMMUNICATION_MIX, pwd, rec, recMerge, suportMiniProgarm)\n */\n_outer.createConference = inner.createConfrSptMnPrg;\n\n/**\n * 改变角色\n * @method grantRole\n * @param {Object} confr - 会议对象\n * @param {Array} members - 会议成员\n * @param {string} role - 角色\n */\n_outer.grantRole = function (confr, members, role) {\n    // emedia.decodeMemeberName(members); 暂时注释，在 IM 一起的时候，appkey 会被删掉\n    return inner.chanageRoles(role, members, confr.id);\n};\n\n/**\n * 降级角色 -- 只能降级\n * @method degradeRole\n * @param {string} confrId - 会议id\n * @param {Array} members - 会议成员\n * @param {string} role - 角色\n */\n_outer.degradeRole = function(confrId, members, toRole) {\n    if(!confrId) {\n        return\n    }\n    if(\n        !members ||\n        members instanceof Array == false ||\n        members.length == 0\n    ) {\n        console.warn('members is must Array also length > 0');\n        return\n    }\n\n    if(!toRole){\n        return\n    }\n\n    let confr = this._confrs[confrId];\n\n    if(!confr) {\n        console.warn('confr is not exist');\n        return\n    }\n    let { role:oldRole, roleToken } = confr;\n\n    if(Number(toRole) >= Number(oldRole)){ //只能降级操作\n        console.warn('only degradeRole,oldRole: ' + oldRole + ' >>> toRole: '+ toRole);\n        return\n    }\n\n    let params = {\n        type:'POST',\n        url: emedia.config.restPrefix + '/easemob/rtc/role/degrade',\n        data: JSON.stringify({\n            roleToken,\n            uids:members,\n            role:toRole\n        }),\n        contentType: 'application/json',\n    }\n    return new Promise((resolve, reject) => {\n        $.ajax({\n            ...params,\n            success(data) {\n                if(data.error == 0){\n                    resolve(data)\n                } else {\n                    reject(data)\n                }\n                \n            },\n            error(error) {\n                reject(error)\n            }\n        })\n    })\n}\n/**\n * 通过id踢出成员\n * @method kickMembersById\n * @param {Object} confr - 会议对象\n * @param {Array} members - 会议成员\n */\n_outer.kickMembersById = function (confr, members) {\n    // emedia.decodeMemeberName(members); 暂时注释，在 IM 一起的时候，appkey 会被删掉\n    return inner.kickMember(members, confr.id);\n};\n\n/**\n * 销毁会议\n * @method destroyConference\n * @param {Object} confr - 会议对象\n */\n_outer.destroyConference = function (confr) {\n    return inner.disbandConfr(confr, confr.roleToken);\n};\n// setConference and deleteConference\nfunction _update_confr_attrs(options) {\n    if(\n        !options || \n        Object.keys(options).length == 0\n    ){\n        console.warn('options is not have')\n        return\n    }\n    if(!options.key){\n        console.warn('options.key is not have')\n        return\n    }\n\n    let {\n        key,\n        val,\n        success,\n        error,\n        type\n    } = options;\n\n    if(!this.__current_confrId) {\n        console.warn('please set_confr_attrs after joined')\n        return\n    }\n    let { roleToken } = this._confrs[this.__current_confrId];\n\n    \n    if(!roleToken) {\n        console.warn('roleToken is not have')\n        return\n    }\n    \n\n    let data = {\n        roleToken,\n        cattrs: [{\n            key,\n            val,\n            op: type\n        }],\n    };\n    \n    $.ajax({\n        type:'POST',\n        url: emedia.config.restPrefix + '/easemob/rtc/confr/attrs/update',\n        data: JSON.stringify(data),\n        contentType: 'application/json',\n        success(data) {\n            if(success && typeof success == 'function'){\n                success(data)\n            }\n        },\n        error(err) {\n            if(error && typeof error == 'function'){\n                error(err)\n            } \n        }\n    })\n}\n\n/**\n * 设置会议属性\n * @method setConferenceAttrs\n * @param {Object} option\n * @param {string} option.key - 自定义属性\n * @param {string} option.val - 自定义属性值\n * @param {function} option.success - 设置成功的回调\n * @param {function} option.error - 设置失败的回调\n */\n_outer.setConferenceAttrs = function(options) {\n    options.type = 'UPDATE';\n\n    _update_confr_attrs.call(this, options)\n}\n\n/**\n * 删除会议属性\n * @method deleteConferenceAttrs\n * @param {Object} option\n * @param {string} option.key - 自定义属性\n * @param {string} option.val - 自定义属性值\n * @param {function} option.success - 删除成功的回调\n * @param {function} option.error - 删除失败的回调\n */\n_outer.deleteConferenceAttrs = function(options) {\n    options.type = 'DEL';\n\n    _update_confr_attrs.call(this, options)\n}\n/**\n * 会议状态回调函数\n * @method onConfrStateUpdated\n * @param {Object} confr_state - 会议状态集合\n */\n_outer.onConfrStateUpdated = function(confr_state) {\n\n    // 全体静音、全体解除静音功能\n    let _this = this;\n    const mute_all_action = () => {\n        let { muteAll } = confr_state;\n\n        if(muteAll === undefined){\n            return\n        }\n\n        if(muteAll) {\n            if(\n                _this.onMuteAll &&\n                typeof _this.onMuteAll == 'function'\n            ) {\n                _this.onMuteAll()\n            }\n        } else {\n            if(\n                _this.onUnMuteAll &&\n                typeof _this.onUnMuteAll == 'function'\n            ) {\n                _this.onUnMuteAll()\n            }\n        }\n    }\n\n    // 主持人不被执行 全体静音和非全体静音\n    let confrId = this.__current_confrId;\n    if(!confrId) {\n        return\n    }\n\n    let service = this._services[confrId];\n    if(!service) {\n        return\n    }\n\n    let { current } = service;\n    if(!current) {\n        return\n    }\n\n\n    if(current.role && current.role != this.Role.ADMIN){ //不是主持人 执行全体静音回调\n        mute_all_action();\n    }\n\n} \n/**\n * 创建房间并加入\n * step 1. 创建房间\n * step 2. 获取ticket\n * step 3. joinConfrence\n * */ \n\n /**\n * 创建房间并加入\n * @method joinRoom\n * @param {Object} option\n * @param {string} option.roomName - 房间名称\n * @param {string} option.password - 房间密码\n * @param {string} option.role - 进入房间时的角色\n * @param {Object} option.config - 进入房间时的拓展配置 rec: 是否录制；recMerge:是否合并；supportWechatMiniProgram：是否支持小程序\n */\n_outer.joinRoom = async function(options){\n    \n    // 请求 room 接口\n    const create = create_params => {\n        let { restPrefix, appkey } = emedia.config;\n\n        if(!appkey) {\n            throw new Error('in joinRoom appkey is not defined');\n        }\n        let org_name = appkey.split('#')[0];\n        let app_name = appkey.split('#')[1];\n\n        let url = `${restPrefix}/${org_name}/${app_name}/conferences/room`;\n        return new Promise((resolve, reject) => {\n            let ajax_options = {\n                url,\n                data:JSON.stringify(create_params),\n                type:'POST',\n                contentType: 'application/json',\n                success: result => {\n                    if(!result.error){\n                        resolve(result)\n                    }else{\n                        reject(result)\n                    }\n                },\n                error: error => {\n                    reject(error)\n                }\n            }\n            $.ajax(ajax_options)\n        })\n    }\n\n    let _this = this;\n    // get_ticket  加入会议之前获取 ticket\n    const get_ticket = get_ticket_params => {\n\n        let url = emedia.config.restPrefix + \"/easemob/rtc/req/ticket\" + \"?_ct=\" + (new Date().getTime());\n        if(get_ticket_params.region) {\n            url += `&REGION=${get_ticket_params.region}`\n        }\n        if(get_ticket_params.confrId) {\n            url += `&CONFRID=${get_ticket_params.confrId}`\n        }\n\n        let params = {\n            type: 'POST',\n            url,\n            data: JSON.stringify(get_ticket_params),\n            contentType: 'application/json',\n            dataType: 'json',\n        }\n\n        return new Promise((resolve, reject) => {\n            $.ajax({\n                ...params,\n                success(data) {\n                    if(data.error == 0){\n                        resolve(data)\n                    } else {\n                        reject(data)\n                    }\n                    \n                },\n                error(error) {\n                    reject(error)\n                }\n            })\n        })\n    }\n\n    // 加入房间的参数\n    let {\n        roomName,\n        password,\n        role,\n        config\n    } = options\n\n    let {\n        identityName: memName,\n        identityToken: token\n    } = this;\n\n\n    if(!roomName){\n        throw new Error('the roomName is required at joinRoom')\n    }\n    if(!password){\n        throw new Error('the password is required at joinRoom')\n    }\n    if(!memName){\n        throw new Error('the memName is required at joinRoom')\n    }\n    if(!token){\n        throw new Error('the token is required at joinRoom')\n    }\n    if(!role){\n        throw new Error('the role is required at joinRoom')\n    } \n    \n\n    let create_params = {\n        roomName,\n        password,\n        memName,\n        token,\n        ...config\n    }\n    if (config && config.supportWechatMiniProgram) {\n        create_params.useVCodes = ['H264', 'VP8'];\n    }\n\n    const room = await create(create_params); // 加入房间\n\n    let { confrId } = room;\n\n    let get_ticket_params = {\n        uid: memName,\n        token,\n        confrId,\n        password: password,\n        role: role,\n        terminal: this._terminalInfo\n    }\n\n    let ticket_info = await get_ticket(get_ticket_params); // 获取ticket\n\n\n    // 给会议添加 参数\n    ticket_info.mixed = ticket_info.type === 11 || ticket_info.type === 12;\n    ticket_info.id = ticket_info.serverConfrId = ticket_info.confrId = confrId;\n    this._confrs[confrId] = Object.assign(this._confrs[confrId] || {}, ticket_info);\n\n\n    let { ticket } = ticket_info;\n    \n    let { nickName, ext } = config ? config : {};\n    // join confrence 通过 ticket 接口\n    let {isCreator} = room;\n    let user_room = await _this.joinConferenceWithTicket(confrId, ticket, { nickName, ...ext });\n\n    if(isCreator){// 是否为创建者\n        user_room.isCreator = isCreator\n    }\n\n    return user_room\n}\n\n/**\n * 观众申请上麦\n */\n\n_outer.requestToTalker = function(confrId) {\n\n    if(!confrId) {\n        console.warn('requestToTalker confrId is required');\n        return\n    }\n\n    let service = this._services[confrId];\n    service.requestToTalker()\n}\n\n/**\n * 申请主持人\n */\n\n_outer.requestToAdmin = function(confrId) {\n\n    if(!confrId) {\n        console.warn('requestToTalker confrId is required');\n        return\n    }\n\n    let service = this._services[confrId];\n    service.requestToAdmin()\n}\n\n/**\n * 指定静音通过 memberId\n */\n_outer.muteBymemberId = function(confrId, memberId) {\n    if(\n        !confrId ||\n        !memberId\n    ) {\n        console.warn('muteBymemberId confrId and memberId is required');\n        return\n    }\n\n    let service = this._services[confrId];\n    service.muteBymemberId(memberId)\n\n}\n\n/**\n * 指定取消静音通过 memberId\n */\n_outer.unmuteBymemberId = function(confrId, memberId) {\n    if(\n        !confrId ||\n        !memberId\n    ) {\n        console.warn('muteBymemberId confrId and memberId is required');\n        return\n    }\n\n    let service = this._services[confrId];\n    service.unmuteBymemberId(memberId)\n\n}\n// 更新会议状态 接口\nfunction _update_confr_state(roleToken,muteAll) {\n    // muteAll: true 全体静音，false:取消全体静音\n    let params = {\n        type:'POST',\n        url: emedia.config.restPrefix + '/easemob/rtc/confr/attrs/update',\n        data: JSON.stringify({\n            roleToken,\n            cstate: {\n                muteAll\n            }\n        }),\n        contentType: 'application/json',\n    };\n\n    return new Promise((resolve, reject) => {\n        $.ajax({\n            ...params,\n            success(data) {\n                if(data.error == 0){\n                    resolve(data)\n                } else {\n                    reject(data)\n                }\n                \n            },\n            error(error) {\n                reject(error)\n            }\n        })\n    }) \n}\n\n// 全体静音\n_outer.muteAll = function(confrId) {\n    \n    if(!confrId) {\n        throw new Error('muteAll confrId is required');\n    }\n\n    let confr = this._confrs[confrId];\n\n    if(!confr) {\n        throw new Error('confr is not exist');\n    }\n    let { role, roleToken } = confr;\n    \n    if(role != 7) { //只有管理员能够操作\n        throw new Error('only admin can action');\n    }\n    if(!roleToken) {\n        throw new Error('roleToken is not exist');\n    }\n\n    let muteAll = true;\n    return _update_confr_state.call(this,roleToken,muteAll);\n\n}\n// 取消全体静音\n_outer.unmuteAll = function(confrId) {\n    if(!confrId) {\n        throw new Error('unmuteAll confrId is required');\n    }\n\n    let confr = this._confrs[confrId];\n\n    if(!confr) {\n        throw new Error('confr is not exist');\n    }\n    let { role, roleToken } = confr;\n    \n    if(role != 7) { //只有管理员能够操作\n        throw new Error('only admin can action');\n    }\n    if(!roleToken) {\n        throw new Error('roleToken is not exist');\n    }\n\n    let muteAll = false;\n    return _update_confr_state.call(this,roleToken,muteAll);\n}\n// 多路推流 \n_outer.addLive = function(confrId, liveCfg) {\n    if(!confrId){\n        throw new Error('addLive confrId is required');\n    }\n    if(!liveCfg){\n        throw new Error('addLive liveCfg is required');\n    }\n\n    let confr = this._confrs[confrId];\n\n    if(!confr) {\n        throw new Error('confr is not exist');\n    }\n    let { role, roleToken } = confr;\n    \n    if(role !=7 ){\n        throw new Error('only admin can addLive');\n    }\n    if(!roleToken){\n        throw new Error('addLive roleToken is required');\n    }\n\n    let url = emedia.config.restPrefix + '/easemob/rtc/livecfg';\n    let params = {\n        confrId,\n        roleToken,\n        liveCfg\n    }\n\n    return new Promise((resolve, reject) => {\n        $.ajax({\n            url,\n            type: 'POST',\n            data: JSON.stringify(params),\n            contentType: 'application/json',\n            dataType: 'json',\n            success: function(data){\n                if(data.error == 0) {\n                    resolve(data)\n                } else {\n                    reject(data)\n                }\n            },\n            error: function(error){\n                reject(error)\n            }\n        });\n    })\n\n}\n// 推流 CDN 更新布局\n_outer.updateLiveLayout = function(confrId, liveId, regions){\n    if(!confrId){\n        throw new Error('updateLiveLayout confrId is required');\n    }\n    if(!liveId){\n        throw new Error('updateLiveLayout liveId is required');\n    }\n\n    if(!regions){\n        throw new Error('updateLiveLayout regions is required');\n    }\n\n    let confr = this._confrs[confrId];\n\n    if(!confr) {\n        throw new Error('confr is not exist');\n    }\n    let { role, roleToken } = confr;\n\n    if(role !=7 ){\n        throw new Error('only admin can updateLiveLayout');\n    }\n    if(!roleToken){\n        throw new Error('updateLiveLayout roleToken is required');\n    }\n\n    let url = emedia.config.restPrefix + '/easemob/rtc/live/layout';\n    \n    let params = {\n        confrId, \n        liveId,\n        regions,\n        roleToken\n    }\n\n    return new Promise((resolve, reject) => {\n        $.ajax({\n            url,\n            type: 'POST',\n            data: JSON.stringify(params),\n            contentType: 'application/json',\n            dataType: 'json',\n            success: function(data){\n                if(data.error == 0) {\n                    resolve(data)\n                } else {\n                    reject(data)\n                }\n            },\n            error: function(error){\n                reject(error)\n            }\n        });\n    })\n}\n\n// 取消推流 CDN\n_outer.deleteLive = function (confrId, liveId) {\n    if(!confrId) {\n        throw new Error('deleteLive confrId is required');\n    }\n    if(!liveId) {\n        throw new Error('deleteLive liveId is required');\n    }\n\n    let confr = this._confrs[confrId];\n\n    if(!confr) {\n        throw new Error('confr is not exist');\n    }\n    let { role, roleToken } = confr;\n\n    if(role != 7) {\n        console.warn('only admin can deleteLive');\n        return\n    }\n    if(!roleToken){\n        console.error('updateLiveLayout roleToken is required');\n        return\n    }\n    \n    let url = emedia.config.restPrefix + '/easemob/rtc/delete/live';\n    let params = { confrId, liveId, roleToken }\n\n    return new Promise((resolve,reject) => {\n        $.ajax({\n            url,\n            type:'DELETE',\n            data: JSON.stringify(params),\n            contentType: 'application/json',\n            dataType: 'json',\n            success: function(data){\n                if(data.error == 0) {\n                    resolve(data)\n                } else {\n                    reject(data)\n                }\n            },\n            error: function(error){\n                reject(error)\n            }\n        })\n    })\n}\n\nemedia.decodeMemeberName = function (member) {\n    if(typeof emedia.decodeMemeberNameString !== \"function\"){\n        return member;\n    }\n\n    if(typeof member === 'string'){\n        return emedia.decodeMemeberNameString(member);\n    }\n\n    if(_.isArray(member)){\n        for(var i = 0; i < member.length; i++){\n            member[i] = emedia.decodeMemeberName(member[i]);\n        }\n        return member;\n    }\n\n    if(member.name){\n        member.globalName = member.name;\n        member.memName = member.name = emedia.decodeMemeberName(member.name);\n        return;\n    }\n\n    if(member.memName){\n        member.globalName = member.memName;\n        member.memName = member.name = emedia.decodeMemeberName(member.memName);\n        return;\n    }\n}\n\n\n/**\n * 会议类型\n * @static\n */\nemedia.ConfrType = inner.ConfrType;\n\n/**\n * 角色\n * @static\n */\nemedia.Role = inner.Role;\n\n/**\n * 媒体流类型\n * @static\n */\nemedia.StreamType = inner.StreamType;\n\nzepto(function () {\n    var WebIM = window.WebIM;\n\n    if(WebIM && WebIM.conn && typeof WebIM.conn.onOpened === \"function\"){\n        // noinspection JSAnnotator\n        function useIM() {\n            emedia.decodeMemeberNameString = function (member) {\n                if(typeof member === 'string'){\n                    if(member.indexOf(WebIM.conn.orgName) < 0) {\n                        return member;\n                    }\n\n                    var _index = member.indexOf(\"_\");\n                    if(_index < 0){\n                        _index = 0;\n                    }else{\n                        _index++;\n                    }\n\n                    var endIndex = member.indexOf(\"@\");\n                    if(endIndex < 0){\n                        endIndex = member.length;\n                    }\n\n                    return member.substring(_index, endIndex);\n                }\n\n                return member;\n            };\n\n            inner.setUrlCreator(function(url, apiName){\n                return WebIM.conn.apiUrl + url;\n            });\n\n            inner.setIdentity(WebIM.conn.orgName + \"#\" + WebIM.conn.appName + \"_\" + WebIM.conn.user, WebIM.conn.token);\n            emedia.config({ appkey: WebIM.conn.appKey })\n        }\n\n        var _onOpened = WebIM.conn.onOpened;\n        WebIM.conn.onOpened = function () {\n            _onOpened.apply(WebIM.conn, arguments);\n            useIM();\n        };\n\n        if(WebIM.conn.token){\n            useIM();\n        };\n    }\n});\n\n\nexport let outer = _.extend(inner, _outer);","/*\n * ! Math.uuid.js (v1.4) http://www.broofa.com mailto:robert@broofa.com\n *\n * Copyright (c) 2010 Robert Kieffer Dual licensed under the MIT and GPL\n * licenses.\n */\n\n/*\n * Generate a random uuid.\n *\n * USAGE: Math.uuid(length, radix) length - the desired number of characters\n * radix - the number of allowable values for each character.\n *\n * EXAMPLES: // No arguments - returns RFC4122, version 4 ID >>> Math.uuid()\n * \"92329D39-6F5C-4520-ABFC-AAB64544E172\" // One argument - returns ID of the\n * specified length >>> Math.uuid(15) // 15 character ID (default base=62)\n * \"VcydxgltxrVZSTV\" // Two arguments - returns ID of the specified length, and\n * radix. (Radix must be <= 62) >>> Math.uuid(8, 2) // 8 character ID (base=2)\n * \"01001010\" >>> Math.uuid(8, 10) // 8 character ID (base=10) \"47473046\" >>>\n * Math.uuid(8, 16) // 8 character ID (base=16) \"098F4D35\"\n */\n(function () {\n    // Private array of chars to use\n    var CHARS = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'.split('');\n\n    Math.uuid = function (len, radix) {\n        var chars = CHARS, uuid = [], i;\n        radix = radix || chars.length;\n\n        if (len) {\n            // Compact form\n            for (i = 0; i < len; i++) uuid[i] = chars[0 | Math.random() * radix];\n        } else {\n            // rfc4122, version 4 form\n            var r;\n\n            // rfc4122 requires these characters\n            uuid[8] = uuid[13] = uuid[18] = uuid[23] = '-';\n            uuid[14] = '4';\n\n            // Fill in random data. At i==19 set the high bits of clock sequence\n            // as\n            // per rfc4122, sec. 4.1.5\n            for (i = 0; i < 36; i++) {\n                if (!uuid[i]) {\n                    r = 0 | Math.random() * 16;\n                    uuid[i] = chars[(i == 19) ? (r & 0x3) | 0x8 : r];\n                }\n            }\n        }\n\n        return uuid.join('');\n    };\n\n    // A more performant, but slightly bulkier, RFC4122v4 solution. We boost\n    // performance\n    // by minimizing calls to random()\n    Math.uuidFast = function () {\n        var chars = CHARS, uuid = new Array(36), rnd = 0, r;\n        for (var i = 0; i < 36; i++) {\n            if (i == 8 || i == 13 || i == 18 || i == 23) {\n                uuid[i] = '-';\n            } else if (i == 14) {\n                uuid[i] = '4';\n            } else {\n                if (rnd <= 0x02) rnd = 0x2000000 + (Math.random() * 0x1000000) | 0;\n                r = rnd & 0xf;\n                rnd = rnd >> 4;\n                uuid[i] = chars[(i == 19) ? (r & 0x3) | 0x8 : r];\n            }\n        }\n        return uuid.join('');\n    };\n\n    // A more compact, but less performant, RFC4122v4 solution:\n    Math.uuidCompact = function () {\n        return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n            var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\n            return v.toString(16);\n        });\n    };\n})();\n\n\nif(!String.prototype.startsWith){\n    String.prototype.startsWith = function(searchString, position) {\n        position = position || 0;\n        return this.indexOf(searchString, position) === position;\n    };\n}\n\n/**\n * Util\n *\n * @constructor\n */\nfunction Util() {\n}\n\n/**\n * Function Logger\n *\n * @constructor\n */\nvar Logger = function (tag) {\n    var self = this;\n\n    var LogLevel = {\n        TRACE: 0,\n        DEBUG: 1,\n        INFO: 2,\n        WARN: 3,\n        ERROR: 4,\n        FATAL: 5\n    }\n\n    var LogLevelName = [\n        'TRACE',\n        'DEBUG',\n        'INFO',\n        'WARN',\n        'ERROR',\n        'FATAL'\n    ]\n\n    this._log = function () {\n        var level = arguments[0];\n\n        level = arguments[0] = LogLevelName[level];\n\n        emedia._logContext && sdklog.apply(null, arguments);\n        if(emedia.config.consoleLogger !== true){\n            return;\n        }\n\n        if(emedia && emedia.isElectron){\n            console.log.apply(console, arguments);\n            return;\n        }\n        if(console && level){\n            (console[level.toLowerCase()] || console.warn).apply(console, arguments);\n        }\n    };\n\n    function callLog(level, args) {\n        try{\n            _callLog(level, args);\n        }catch(e){\n            if(console){\n                if(console.error) {\n                    console.error(e);\n                    return;\n                }\n                if(console.log) {\n                    console.log(e);\n                    return;\n                }\n            }\n\n            throw e;\n        }\n    }\n\n\n    function _sdklog() {\n        if(emedia._logContextIndex < 0){\n            return;\n        }\n        if(!emedia._logContext || !(emedia._logContext instanceof Array)){\n            return;\n        }\n\n        var contextIndex = emedia._logContextIndex % emedia._logContext.length;\n        var logInfos = emedia._logContext[contextIndex];\n        if(!logInfos || !(logInfos instanceof Array)){\n            logInfos = emedia._logContext[contextIndex] = [];\n        }\n\n        var info = [];\n        info.push(emedia._logContextIndex);\n\n        var now = new Date();\n        if(typeof now.toLocaleString === 'function'){\n            info.push(now.toLocaleString());\n        }else if(now.toJSON){\n            info.push(now.toJSON());\n        }else if (now.toISOString){\n            info.push(now.toISOString());\n        }else{\n            info.push(now + \"\");\n        }\n\n\n        for (var i = 0; i < arguments.length; i++) {\n            var arg = arguments[i];\n\n            if(typeof arg === \"string\"){\n                info.push(arg);\n                continue;\n            }\n            if(!arg){\n                info.push(arg);\n                continue;\n            }\n\n            if(typeof arg.message === \"string\"){\n                info.push(arg.message);\n                continue;\n            }\n            if(typeof arg.message === \"function\"){\n                info.push(arg.message());\n                continue;\n            }\n            if(typeof arg.stack === \"string\"){\n                info.push(arg.stack);\n                continue;\n            }\n            if(arg.event && typeof arg.event.toString === \"function\"){\n                info.push(arg.event.toString());\n                continue;\n            }\n            if(arg.event && typeof arg.event.toString === \"function\"){\n                info.push(arg.event.toString());\n                continue;\n            }\n\n            if(typeof arg.candidate === \"string\"){\n                info.push(arg.candidate);\n                continue;\n            }\n            if(typeof arg.sdp === \"string\"){\n                info.push(arg.sdp);\n                continue;\n            }\n\n            if(isPlainObject(arg)){\n                info.push(JSON.stringify(arg));\n            }else{\n                info.push(String(arg));\n            }\n        }\n\n        var infoString;\n        if(emedia.config.loglastStoreArray){\n            logInfos.push(infoString = info.join(' '));\n        }\n\n        if(typeof emedia.config.onSdkLog === 'function'){\n            try{\n                infoString || (infoString = info.join(' '));\n                emedia.config.onSdkLog(infoString);\n            }catch(e){\n                console.error(e);\n            }\n        }\n    }\n\n    function sdklog() {\n        try{\n            _sdklog.apply(null, arguments);\n        }catch(e){\n            console.warn(e)\n        }\n    };\n\n    function _callLog(level, args) {\n        if(emedia && emedia.LOG_LEVEL && (level < emedia.LOG_LEVEL)){\n            return;\n        }\n\n        var _args = [];\n\n        _args.push(level);\n        tag && _args.push(tag);\n\n        for (var i = 0; i < args.length; i++) {\n            _args.push(args[i] && args[i]._toString ? args[i]._toString.call(args[i]) : args[i]);\n        }\n\n        //_args.caller && _args.push(_args.caller);\n\n        self._log.apply(self, _args);\n    };\n\n    this.log = function () {\n        this._log && callLog(LogLevel.INFO, arguments)\n    };\n\n    this.trace = function () {\n        this._log && callLog(LogLevel.TRACE, arguments)\n    };\n\n    this.debug = function () {\n        this._log && callLog(LogLevel.DEBUG, arguments)\n    };\n\n    this.info = function () {\n        this._log && callLog(LogLevel.INFO, arguments)\n    };\n\n    this.warn = function () {\n        this._log && callLog(LogLevel.WARN, arguments)\n    };\n\n    this.error = function () {\n        this._log && callLog(LogLevel.ERROR, arguments)\n    };\n\n    this.fatal = function () {\n        this._log && callLog(LogLevel.FATAL, arguments)\n    };\n}\n\nLogger.prototype.count = function(){\n    if(emedia._logContext){\n        emedia._logContextIndex++;\n\n        var contextIndex = emedia._logContextIndex % emedia._logContext.length;\n\n        if(contextIndex === 0 && emedia._logContextIndex !== 0){\n            emedia._logContext.loadlogs = emedia._logContext[contextIndex];\n        }\n        emedia._logContext[contextIndex] = [];\n    }\n}\n\nUtil.prototype.logger = new Logger();\n\nUtil.prototype.tagLogger = function (tag) {\n    return new Logger(tag);\n}\n\n/**\n * parse json\n *\n * @param jsonString\n */\nUtil.prototype.parseJSON = function (jsonString) {\n    return JSON.parse(jsonString);\n};\n\n/**\n * json to string\n *\n * @type {Util.stringifyJSON}\n */\nvar stringifyJSON = Util.prototype.stringifyJSON = function (jsonObj) {\n    return JSON.stringify(jsonObj);\n};\n\n\nvar class2type = {};\n\nvar toString = class2type.toString;\n\nvar hasOwn = class2type.hasOwnProperty;\n\nvar fnToString = hasOwn.toString;\n\nvar ObjectFunctionString = fnToString.call(Object);\n\n/**\n * check object type\n *\n * @type {Util.isPlainObject}\n */\nvar isPlainObject = Util.prototype.isPlainObject = function (obj) {\n    var proto, Ctor;\n\n    // Detect obvious negatives\n    // Use toString instead of jQuery.type to catch host objects\n    var objectString;\n    if (!obj\n        || (objectString = toString.call(obj)) !== \"[object Object]\"\n        || (obj.toString() === \"<JSAPI-Auto Javascript Object>\")\n        || (obj.toString() === \"[object IFBComJavascriptObject]\")) {\n        return false;\n    }\n\n    proto = Object.getPrototypeOf(obj);\n\n    // Objects with no prototype (e.g., `Object.create( null )`) are plain\n    if (!proto) {\n        return true;\n    }\n\n    // Objects with prototype are plain iff they were constructed by a\n    // global Object function\n    Ctor = hasOwn.call(proto, \"constructor\") && proto.constructor;\n    return typeof Ctor === \"function\" && fnToString.call(Ctor) === ObjectFunctionString;\n};\n\nUtil.prototype.isArray = Array.isArray;\n\n/**\n * check empty object\n *\n * @param obj\n * @returns {boolean}\n */\nUtil.prototype.isEmptyObject = function (obj) {\n    var name;\n    for (name in obj) {\n        return false;\n    }\n    return true;\n};\n\nUtil.prototype.type = function (obj) {\n    if (obj == null) {\n        return obj + \"\";\n    }\n    return typeof obj === \"object\" || typeof obj === \"function\" ? class2type[toString.call(obj)] || \"object\" : typeof obj;\n};\n\n/**\n * Function extend\n *\n * @returns {*|{}}\n */\nUtil.prototype.extend = function () {\n    var self = this;\n    var options, name, src, copy, copyIsArray, clone,\n        target = arguments[0] || {},\n        i = 1,\n        length = arguments.length,\n        deep = false;\n\n    // Handle a deep copy situation\n    if (typeof target === \"boolean\") {\n        deep = target;\n\n        // Skip the boolean and the target\n        target = arguments[i] || {};\n        i++;\n    }\n\n    // Handle case when target is a string or something (possible in deep\n    // copy)\n    if (typeof target !== \"object\" && !self.isFunction(target)) {\n        target = {};\n    }\n\n    // Extend self itself if only one argument is passed\n    if (i === length) {\n        target = this;\n        i--;\n    }\n\n    for (; i < length; i++) {\n\n        // Only deal with non-null/undefined values\n        if (( options = arguments[i] ) != null) {\n\n            // Extend the base object\n            for (name in options) {\n                src = target[name];\n                copy = options[name];\n\n                // Prevent never-ending loop\n                if (target === copy) {\n                    continue;\n                }\n\n                // Recurse if we're merging plain objects or arrays\n                if (deep && copy && ( self.isPlainObject(copy) ||\n                    ( copyIsArray = self.isArray(copy) ) )) {\n\n                    if (copyIsArray) {\n                        copyIsArray = false;\n                        clone = src && self.isArray(src) ? src : [];\n\n                    } else {\n                        clone = src && self.isPlainObject(src) ? src : {};\n                    }\n\n                    // Never move original objects, clone them\n                    target[name] = self.extend(deep, clone, copy);\n\n                    // Don't bring in undefined values\n                } else if (copy !== undefined) {\n                    target[name] = copy;\n                }\n            }\n        }\n    }\n\n    // Return the modified object\n    return target;\n}\n\nUtil.prototype.removeAttribute = function (elem, key) {\n    if(elem === null || elem === undefined){\n        return;\n    }\n\n    var obj = elem[key];\n\n    // if(emedia.isSafari && obj && obj.__undefinedEQDelete){ // safari delete stream时，地址栏会有个小喇叭; 要延迟删除\n    //     emedia._stream_garbages || (emedia._stream_garbages = [])\n    //     emedia._stream_garbages.push(obj);\n    // }\n    delete elem[key];\n\n    return obj;\n}\n\nUtil.prototype.prototypeExtend_000 = Util.prototype.classExtend = function(){\n    var self = this;\n\n    function _Obj__(){\n        for(var i = 0; i < arguments.length; i++){\n            var cfg = arguments[i] || {};\n            self.extend(true, this, cfg);\n        }\n\n        this.__init__ && this.__init__.apply(this, arguments);\n    }\n\n    var lastConstructor;\n\n    for(var i = 0; i < arguments.length; i++){\n        var cfg = arguments[i] || {};\n\n        if(typeof cfg === \"function\"){\n            if(lastConstructor){\n                cfg.constructor = lastConstructor;\n                cfg.__proto__ = lastConstructor.prototype;\n            }else{\n                lastConstructor = cfg;\n            }\n        }else{\n            self.extend(true, _Obj__.prototype, cfg);\n        }\n    }\n\n    lastConstructor && (_Obj__.prototype.__proto__ = lastConstructor.prototype);\n    lastConstructor && (_Obj__.prototype.constructor = lastConstructor);\n\n    _Obj__.extend || (_Obj__.extend = function (_prototypeExtend) {\n        return self.prototypeExtend(_Obj__, _prototypeExtend);\n    });\n\n    return _Obj__;\n}\n\nUtil.prototype.prototypeExtend = Util.prototype.classExtend = function(){\n    var self = this;\n\n    function _Obj__(){\n        for(var i = 0; i < arguments.length; i++){\n            var cfg = arguments[i] || {};\n            self.extend(true, this, cfg);\n        }\n\n        this.__init__ && this.__init__.apply(this, arguments);\n    }\n\n    for(var i = 0; i < arguments.length; i++){\n        var cfg = arguments[i] || {};\n        if(typeof cfg === \"function\"){\n            cfg = cfg.prototype;\n        }\n\n        self.extend(true, _Obj__.prototype, cfg);\n    }\n\n    _Obj__.extend || (_Obj__.extend = function (_prototypeExtend) {\n        return self.prototypeExtend(_Obj__, _prototypeExtend);\n    });\n\n    return _Obj__;\n}\n\n/**\n * get local cache\n *\n * @memberOf tool\n * @name hasLocalData\n * @param key{string}\n *            localStorage的key值\n * @return boolean\n */\nUtil.prototype.hasLocalStorage = function (key) {\n    // null -> localStorage.removeItem时\n    // '{}' -> collection.models.destroy时\n    if (localStorage.getItem(key) == null || localStorage.getItem(key) == '{}') {\n        return false;\n    }\n    return true;\n}\n\nUtil.prototype.toggleClass = function (node, className) {\n    if (node.hasClass(className)) {\n        node.removeClass(className);\n        return;\n    }\n    node.addClass(className);\n}\n\n\n/**\n * set cookie\n *\n * @param name{String}\n *\n * @param value{String}\n *\n * @param hour{Number}\n *\n * @return void\n */\nUtil.prototype.setCookie = function (name, value, hour) {\n    var exp = new Date();\n    exp.setTime(exp.getTime() + hour * 60 * 60 * 1000);\n    document.cookie = name + \"=\" + escape(value) + \";expires=\" + exp.toGMTString();\n}\n\n/**\n * read cookie\n *\n * @param name(String)\n *            cookie key\n * @return cookie value\n * @memberOf Tool\n */\nUtil.prototype.getCookie = function (name) {\n    var arr = document.cookie.match(new RegExp(\"(^| )\" + name + \"=([^;]*)(;|$)\"));\n    if (arr != null) {\n        return unescape(arr[2]);\n    }\n    return null;\n}\n\n\n/**\n * query parameter from url\n *\n * @name parseURL\n * @memberof C.Tools\n * @param {string}\n *\n * @return {string}\n * @type function\n * @public\n */\nUtil.prototype.parseURL = function (name) {\n    var reg = new RegExp(\"(^|&)\" + name + \"=([^&]*)(&|$)\", \"i\");\n    var r = window.location.search.substr(1).match(reg);\n    if (r != null) {\n        return unescape(r[2]);\n    }\n    return null;\n}\n\n/**\n * function(index, value){\n\n}\n * @param obj\n */\nUtil.prototype.forEach = function (obj, func){\n    if(!obj){\n        return;\n    }\n\n    if(this.isArray(obj) && obj.length === 0){\n        return;\n    }\n    if(obj.length !== undefined && obj.length === 0){\n        return;\n    }\n    if(obj.length){\n        for(var i = 0; i < obj.length; i++){\n            func(i, obj[i]);\n        }\n        return;\n    }\n\n    if(!obj || this.isEmptyObject(obj)){\n        return;\n    }\n\n    obj = obj || {};\n\n    var copy = this.extend(false, {}, obj);\n\n    for(var index in copy){\n        func(index, obj[index]);\n    }\n}\n\nUtil.prototype.isInt = function(n){\n    return Number(n) === n && n % 1 === 0;\n}\n\nUtil.prototype.isFloat = function(n){\n    return Number(n) === n && n % 1 !== 0;\n}\n\nUtil.prototype.list = function () {\n    var args = (arguments.length === 1 ? [arguments[0]] : Array.apply(null, arguments));\n    return args;\n}\n\nUtil.prototype.addEvent = function (element, name, func) {\n    if (element.attachEvent)\n        return element.attachEvent(\"on\" + name, func);\n    if (element.addEventListener)\n        return element.addEventListener(name, func, false);\n    throw \"Handler could not be attached\";\n}\n\nUtil.prototype.removeEvent = function (element, name, func) {\n    if (element.detachEvent)\n        return element.detachEvent(\"on\" + name, func);\n    if (element.removeEventListener)\n        return element.removeEventListener(name, func, false);\n    throw \"Handler could not be removed\";\n}\n\nUtil.prototype.stopEvent = function (event) {\n    event.stopPropagation ? event.stopPropagation() : event.cancelBubble = true;\n    event.preventDefault ? event.preventDefault() : event.returnValue = false;\n}\n\nUtil.prototype.getDomPageRect = function(element) {\n    var domRect = element.getBoundingClientRect();\n    return {\n        x: domRect.left + (window.pageXOffset || window.document.documentElement.scrollLeft),\n        y: domRect.top + (window.pageYOffset || window.document.documentElement.scrollTop),\n        width: domRect.width || element.offsetWidth,\n        height: domRect.height || element.offsetHeight\n    }\n}\n\nUtil.prototype.getEventElementXY = function(event, element, scale) {\n    event = (event || window.event);\n\n    var touch = event.changedTouches ? event.changedTouches[0] : (event.touches ? event.touches[0] : event);\n\n    var pageX, pageY;\n    if(touch.pageX != undefined && touch.pageY != undefined){\n        pageX = touch.pageX;\n        pageY = touch.pageY;\n    }else if(touch.clientX != undefined && touch.clientY != undefined){\n        pageX = touch.clientX + document.body.scrollLeft + document.documentElement.scrollLeft;\n        pageY = touch.clientY + document.body.scrollTop + document.documentElement.scrollTop;\n    }\n\n    var elementPageXY = this.getDomPageRect(element);\n\n    var relativeX = pageX - elementPageXY.x;\n    var relativeY = pageY - elementPageXY.y;\n\n    (scale === 0 || scale == undefined) && (scale = 1);\n    return {\n        x: Math.round(Math.max(Math.min(relativeX, elementPageXY.width - 1), 0) / scale),\n        y: Math.round(Math.max(Math.min(relativeY, elementPageXY.height - 1), 0) / scale),\n        width: Math.round(elementPageXY.width / scale),\n        height: Math.round(elementPageXY.height / scale),\n\n        realX: relativeX,\n        realY: relativeY\n    }\n}\n\nUtil.prototype.layoutEngine = (function () {\n    var engine = {\n        presto: !!window.opera,\n        trident: !!window.ActiveXObject && (window.XMLHttpRequest ? document.querySelectorAll ? 6 : 5 : 4),\n        webkit: function() {\n            try {\n                return !navigator.taintEnabled && (i.Features.xpath ? i.Features.query ? 525 : 420 : 419)\n            } catch (e) {\n                return !1\n            }\n        }(),\n        gecko: !(!document.getBoxObjectFor && null == window.mozInnerScreenX) && (document.getElementsByClassName ? 19 : 18)\n    };\n\n    engine.webkit && (engine.webkit = function(e) {\n        var n = (navigator.userAgent.match(/WebKit\\/([0-9\\.]*) /) || [\"\", e])[1];\n        return parseFloat(n, 10);\n    }(engine));\n\n    return engine;\n})();\n\n\nUtil.prototype.targetDOM = ( typeof HTMLElement === 'object' ) ?\n    function(obj){\n        return obj instanceof HTMLElement;\n    } :\n    function(obj){\n        return obj && typeof obj === 'object' && obj.nodeType === 1 && typeof obj.nodeName === 'string';\n    };\n\nUtil.prototype.cloneCSS = function (srcElement, destElement) {\n    /**\n     * IE8不支持window.getComputedStyle\n     * IE9~11中，window.getComputedStyle().cssText返回的总为空字符串\n     * 默认的window.getComputedStyle || dom.currentStyle, 返回的css键值对中，键是驼峰命名的。\n     */\n    var oStyle = (window.getComputedStyle && window.getComputedStyle(srcElement, null)) || srcElement.currentStyle;\n    for (var key in oStyle) {\n        var v = oStyle[key];\n        if (/^[a-z]/i.test(key) && [null, '', undefined].indexOf(v) < 0) {\n            destElement.style[key] = v;\n        }\n    }\n};\n\nUtil.prototype.canYield = (function(){\n    try {\n        return eval(\"!!Function('yield true;')().next()\");\n    } catch(e) {\n        return false;\n    }\n})();\n\nmodule.exports = new Util();\n"],"sourceRoot":""}